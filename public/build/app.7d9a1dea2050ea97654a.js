!function(t){function e(e){for(var n,s,o=e[0],l=e[1],c=e[2],d=0,p=[];d<o.length;d++)s=o[d],a[s]&&p.push(a[s][0]),a[s]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);for(u&&u(e);p.length;)p.shift()();return i.push.apply(i,c||[]),r()}function r(){for(var t,e=0;e<i.length;e++){for(var r=i[e],n=!0,o=1;o<r.length;o++){var l=r[o];0!==a[l]&&(n=!1)}n&&(i.splice(e--,1),t=s(s.s=r[0]))}return t}var n={},a={1:0},i=[];function s(e){if(n[e])return n[e].exports;var r=n[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.e=function(t){var e=[],r=a[t];if(0!==r)if(r)e.push(r[2]);else{var n=new Promise(function(e,n){r=a[t]=[e,n]});e.push(r[2]=n);var i,o=document.getElementsByTagName("head")[0],l=document.createElement("script");l.charset="utf-8",l.timeout=120,s.nc&&l.setAttribute("nonce",s.nc),l.src=function(t){return s.p+""+({4:"explore"}[t]||t)+".7d9a1dea2050ea97654a.js"}(t),i=function(e){l.onerror=l.onload=null,clearTimeout(c);var r=a[t];if(0!==r){if(r){var n=e&&("load"===e.type?"missing":e.type),i=e&&e.target&&e.target.src,s=new Error("Loading chunk "+t+" failed.\n("+n+": "+i+")");s.type=n,s.request=i,r[1](s)}a[t]=void 0}};var c=setTimeout(function(){i({type:"timeout",target:l})},12e4);l.onerror=l.onload=i,o.appendChild(l)}return Promise.all(e)},s.m=t,s.c=n,s.d=function(t,e,r){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(r,n,function(e){return t[e]}.bind(null,n));return r},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="public/build/",s.oe=function(t){throw console.error(t),t};var o=window.webpackJsonp=window.webpackJsonp||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var u=l;i.push([1368,0]),r()}([,,,,,function(t,e,r){"use strict";r.d(e,"a",function(){return s}),r.d(e,"b",function(){return i});var n=r(6),a=r.n(n),i=a.a.module("grafana.core",["ngRoute"]),s=[i,a.a.module("grafana.controllers",[]),a.a.module("grafana.directives",[]),a.a.module("grafana.factories",[]),a.a.module("grafana.services",[]),a.a.module("grafana.filters",[]),a.a.module("grafana.routes",[])];e.c=i},,,function(t,e,r){"use strict";var n=r(1),a=r.n(n),i=function(){return function(t){a.a.extend(this,{datasources:{},windowTitlePrefix:"OGE - ",panels:{},newPanelTitle:"Panel Title",playlist_timespan:"1m",unsaved_changes_warning:!0,appSubUrl:"",buildInfo:{version:"v1.0",commit:"1",env:"production",isEnterprise:!1},verificationCode:!0},t)}}(),s=window.grafanaBootData||{settings:{}},o=s.settings;o.bootData=s;var l=new i(o);e.a=l},function(t,e,r){"use strict";var n=new(r(111).a);e.a=n},,,function(t,e,r){"use strict";var n=r(1),a=r.n(n),i=r(4),s=r.n(i),o={valueFormats:{},regexEscape:function(t){return t.replace(/[\\^$*+?.()|[\]{}\/]/g,"\\$&")},round_interval:function(t){switch(!0){case t<15:return 10;case t<35:return 20;case t<75:return 50;case t<150:return 100;case t<350:return 200;case t<750:return 500;case t<1500:return 1e3;case t<3500:return 2e3;case t<7500:return 5e3;case t<12500:return 1e4;case t<17500:return 15e3;case t<25e3:return 2e4;case t<45e3:return 3e4;case t<9e4:return 6e4;case t<21e4:return 12e4;case t<45e4:return 3e5;case t<75e4:return 6e5;case t<105e4:return 9e5;case t<15e5:return 12e5;case t<27e5:return 18e5;case t<54e5:return 36e5;case t<9e6:return 72e5;case t<162e5:return 108e5;case t<324e5:return 216e5;case t<864e5:return 432e5;case t<6048e5:return 864e5;case t<18144e5:return 6048e5;case t<36288e5:return 2592e6;default:return 31536e6}},secondsToHms:function(t){var e=Math.floor(t/31536e3);if(e)return e+"y";var r=Math.floor(t%31536e3/86400);if(r)return r+"d";var n=Math.floor(t%31536e3%86400/3600);if(n)return n+"h";var a=Math.floor(t%31536e3%86400%3600/60);if(a)return a+"m";var i=Math.floor(t%31536e3%86400%3600%60);if(i)return i+"s";var s=Math.floor(1e3*t);return s?s+"ms":"less than a millisecond"},secondsToHhmmss:function(t){var e=[],r=Math.floor(t/3600),n=Math.floor(t%3600/60),a=Math.floor(t%3600%60);return r>9?e.push(""+r):e.push("0"+r),n>9?e.push(""+n):e.push("0"+n),a>9?e.push(""+a):e.push("0"+a),e.join(":")},to_percent:function(t,e){return Math.floor(t/e*1e4)/100+"%"},addslashes:function(t){return t=(t=(t=(t=t.replace(/\\/g,"\\\\")).replace(/\'/g,"\\'")).replace(/\"/g,'\\"')).replace(/\0/g,"\\0")},interval_regex:/(\d+(?:\.\d+)?)(ms|[Mwdhmsy])/,intervals_in_seconds:{y:31536e3,M:2592e3,w:604800,d:86400,h:3600,m:60,s:1,ms:.001},calculateInterval:function(t,e,r){var n,a=1;return r&&(">"===r[0]&&(r=r.slice(1)),a=o.interval_to_ms(r)),a>(n=o.round_interval((t.to.valueOf()-t.from.valueOf())/e))&&(n=a),{intervalMs:n,interval:o.secondsToHms(n/1e3)}},describe_interval:function(t){var e=t.match(o.interval_regex);if(e&&a.a.has(o.intervals_in_seconds,e[2]))return{sec:o.intervals_in_seconds[e[2]],type:e[2],count:parseInt(e[1],10)};throw new Error('Invalid interval string, expecting a number followed by one of "Mwdhmsy"')},interval_to_ms:function(t){var e=o.describe_interval(t);return 1e3*e.sec*e.count},interval_to_seconds:function(t){var e=o.describe_interval(t);return e.sec*e.count},query_color_dot:function(t,e){return'<div class="icon-circle" style="'+["display:inline-block","color:"+t,"font-size:"+e+"px"].join(";")+'"></div>'},slugifyForUrl:function(t){return t.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-")},stringToJsRegex:function(t){if("/"!==t[0])return new RegExp("^"+t+"$");var e=t.match(new RegExp("^/(.*?)/(g?i?m?y?)$"));return new RegExp(e[1],e[2])},toFixed:function(t,e){if(null===t)return"";var r=e?Math.pow(10,Math.max(0,e)):1,n=String(Math.round(t*r)/r);if(-1!==n.indexOf("e")||0===t)return n;if(null!=e){var a=n.indexOf("."),i=-1===a?0:n.length-a-1;if(i<e)return(i?n:n+".")+String(r).substr(1,e-i)}return n},toFixedScaled:function(t,e,r,n,a){return null===r?o.toFixed(t,e)+a:o.toFixed(t,r+n)+a},roundValue:function(t,e){if(null===t)return null;var r=Math.pow(10,e),n=(r*t).toFixed(e);return Math.round(parseFloat(n))/r},formatBuilders:{}};o.formatBuilders.fixedUnit=function(t){return function(e,r){return null===e?"":o.toFixed(e,r)+" "+t}},o.formatBuilders.scaledUnits=function(t,e){return function(r,n,a){if(null===r)return"";for(var i=0,s=e.length;Math.abs(r)>=t;)if(r/=t,++i>=s)return"NA";return i>0&&null!==a&&(n=a+3*i),o.toFixed(r,n)+e[i]}},o.formatBuilders.decimalSIPrefix=function(t,e){var r=["n","µ","m","","k","M","G","T","P","E","Z","Y"],n=(r=r.slice(3+(e||0))).map(function(e){return" "+e+t});return o.formatBuilders.scaledUnits(1e3,n)},o.formatBuilders.binarySIPrefix=function(t,e){var r=["","Ki","Mi","Gi","Ti","Pi","Ei","Zi","Yi"].slice(e).map(function(e){return" "+e+t});return o.formatBuilders.scaledUnits(1024,r)},o.formatBuilders.currency=function(t){var e=o.formatBuilders.scaledUnits(1e3,["","K","M","B","T"]);return function(r,n,a){if(null===r)return"";var i=e(r,n,a);return t+i}},o.formatBuilders.simpleCountUnit=function(t){var e=o.formatBuilders.scaledUnits(1e3,["","K","M","B","T"]);return function(r,n,a){return null===r?"":e(r,n,a)+" "+t}},o.valueFormats.none=o.toFixed,o.valueFormats.short=o.formatBuilders.scaledUnits(1e3,[""," K"," Mil"," Bil"," Tri"," Quadr"," Quint"," Sext"," Sept"]),o.valueFormats.dB=o.formatBuilders.fixedUnit("dB"),o.valueFormats.percent=function(t,e){return null===t?"":o.toFixed(t,e)+"%"},o.valueFormats.percentunit=function(t,e){return null===t?"":o.toFixed(100*t,e)+"%"},o.valueFormats.hex=function(t,e){return null==t?"":parseFloat(o.toFixed(t,e)).toString(16).toUpperCase()},o.valueFormats.hex0x=function(t,e){if(null==t)return"";var r=o.valueFormats.hex(t,e);return"-"===r.substring(0,1)?"-0x"+r.substring(1):"0x"+r},o.valueFormats.sci=function(t,e){return null==t?"":t.toExponential(e)},o.valueFormats.locale=function(t,e){return null==t?"":t.toLocaleString(void 0,{maximumFractionDigits:e})},o.valueFormats.currencyUSD=o.formatBuilders.currency("$"),o.valueFormats.currencyGBP=o.formatBuilders.currency("£"),o.valueFormats.currencyEUR=o.formatBuilders.currency("€"),o.valueFormats.currencyJPY=o.formatBuilders.currency("¥"),o.valueFormats.currencyRUB=o.formatBuilders.currency("₽"),o.valueFormats.currencyUAH=o.formatBuilders.currency("₴"),o.valueFormats.currencyBRL=o.formatBuilders.currency("R$"),o.valueFormats.currencyDKK=o.formatBuilders.currency("kr"),o.valueFormats.currencyISK=o.formatBuilders.currency("kr"),o.valueFormats.currencyNOK=o.formatBuilders.currency("kr"),o.valueFormats.currencySEK=o.formatBuilders.currency("kr"),o.valueFormats.currencyCZK=o.formatBuilders.currency("czk"),o.valueFormats.currencyCHF=o.formatBuilders.currency("CHF"),o.valueFormats.currencyPLN=o.formatBuilders.currency("zł"),o.valueFormats.currencyBTC=o.formatBuilders.currency("฿"),o.valueFormats.bits=o.formatBuilders.binarySIPrefix("b"),o.valueFormats.bytes=o.formatBuilders.binarySIPrefix("B"),o.valueFormats.kbytes=o.formatBuilders.binarySIPrefix("B",1),o.valueFormats.mbytes=o.formatBuilders.binarySIPrefix("B",2),o.valueFormats.gbytes=o.formatBuilders.binarySIPrefix("B",3),o.valueFormats.decbits=o.formatBuilders.decimalSIPrefix("b"),o.valueFormats.decbytes=o.formatBuilders.decimalSIPrefix("B"),o.valueFormats.deckbytes=o.formatBuilders.decimalSIPrefix("B",1),o.valueFormats.decmbytes=o.formatBuilders.decimalSIPrefix("B",2),o.valueFormats.decgbytes=o.formatBuilders.decimalSIPrefix("B",3),o.valueFormats.pps=o.formatBuilders.decimalSIPrefix("pps"),o.valueFormats.bps=o.formatBuilders.decimalSIPrefix("bps"),o.valueFormats.Bps=o.formatBuilders.decimalSIPrefix("B/s"),o.valueFormats.KBs=o.formatBuilders.decimalSIPrefix("Bs",1),o.valueFormats.Kbits=o.formatBuilders.decimalSIPrefix("bps",1),o.valueFormats.MBs=o.formatBuilders.decimalSIPrefix("Bs",2),o.valueFormats.Mbits=o.formatBuilders.decimalSIPrefix("bps",2),o.valueFormats.GBs=o.formatBuilders.decimalSIPrefix("Bs",3),o.valueFormats.Gbits=o.formatBuilders.decimalSIPrefix("bps",3),o.valueFormats.Hs=o.formatBuilders.decimalSIPrefix("H/s"),o.valueFormats.KHs=o.formatBuilders.decimalSIPrefix("H/s",1),o.valueFormats.MHs=o.formatBuilders.decimalSIPrefix("H/s",2),o.valueFormats.GHs=o.formatBuilders.decimalSIPrefix("H/s",3),o.valueFormats.THs=o.formatBuilders.decimalSIPrefix("H/s",4),o.valueFormats.PHs=o.formatBuilders.decimalSIPrefix("H/s",5),o.valueFormats.EHs=o.formatBuilders.decimalSIPrefix("H/s",6),o.valueFormats.ops=o.formatBuilders.simpleCountUnit("ops"),o.valueFormats.reqps=o.formatBuilders.simpleCountUnit("reqps"),o.valueFormats.rps=o.formatBuilders.simpleCountUnit("rps"),o.valueFormats.wps=o.formatBuilders.simpleCountUnit("wps"),o.valueFormats.iops=o.formatBuilders.simpleCountUnit("iops"),o.valueFormats.opm=o.formatBuilders.simpleCountUnit("opm"),o.valueFormats.rpm=o.formatBuilders.simpleCountUnit("rpm"),o.valueFormats.wpm=o.formatBuilders.simpleCountUnit("wpm"),o.valueFormats.watt=o.formatBuilders.decimalSIPrefix("W"),o.valueFormats.kwatt=o.formatBuilders.decimalSIPrefix("W",1),o.valueFormats.mwatt=o.formatBuilders.decimalSIPrefix("W",-1),o.valueFormats.kwattm=o.formatBuilders.decimalSIPrefix("W/Min",1),o.valueFormats.Wm2=o.formatBuilders.fixedUnit("W/m²"),o.valueFormats.voltamp=o.formatBuilders.decimalSIPrefix("VA"),o.valueFormats.kvoltamp=o.formatBuilders.decimalSIPrefix("VA",1),o.valueFormats.voltampreact=o.formatBuilders.decimalSIPrefix("var"),o.valueFormats.kvoltampreact=o.formatBuilders.decimalSIPrefix("var",1),o.valueFormats.watth=o.formatBuilders.decimalSIPrefix("Wh"),o.valueFormats.kwatth=o.formatBuilders.decimalSIPrefix("Wh",1),o.valueFormats.joule=o.formatBuilders.decimalSIPrefix("J"),o.valueFormats.ev=o.formatBuilders.decimalSIPrefix("eV"),o.valueFormats.amp=o.formatBuilders.decimalSIPrefix("A"),o.valueFormats.kamp=o.formatBuilders.decimalSIPrefix("A",1),o.valueFormats.mamp=o.formatBuilders.decimalSIPrefix("A",-1),o.valueFormats.volt=o.formatBuilders.decimalSIPrefix("V"),o.valueFormats.kvolt=o.formatBuilders.decimalSIPrefix("V",1),o.valueFormats.mvolt=o.formatBuilders.decimalSIPrefix("V",-1),o.valueFormats.dBm=o.formatBuilders.decimalSIPrefix("dBm"),o.valueFormats.ohm=o.formatBuilders.decimalSIPrefix("Ω"),o.valueFormats.lumens=o.formatBuilders.decimalSIPrefix("Lm"),o.valueFormats.celsius=o.formatBuilders.fixedUnit("°C"),o.valueFormats.farenheit=o.formatBuilders.fixedUnit("°F"),o.valueFormats.kelvin=o.formatBuilders.fixedUnit("K"),o.valueFormats.humidity=o.formatBuilders.fixedUnit("%H"),o.valueFormats.pressurebar=o.formatBuilders.decimalSIPrefix("bar"),o.valueFormats.pressurembar=o.formatBuilders.decimalSIPrefix("bar",-1),o.valueFormats.pressurekbar=o.formatBuilders.decimalSIPrefix("bar",1),o.valueFormats.pressurehpa=o.formatBuilders.fixedUnit("hPa"),o.valueFormats.pressurekpa=o.formatBuilders.fixedUnit("kPa"),o.valueFormats.pressurehg=o.formatBuilders.fixedUnit('"Hg'),o.valueFormats.pressurepsi=o.formatBuilders.scaledUnits(1e3,[" psi"," ksi"," Mpsi"]),o.valueFormats.forceNm=o.formatBuilders.decimalSIPrefix("Nm"),o.valueFormats.forcekNm=o.formatBuilders.decimalSIPrefix("Nm",1),o.valueFormats.forceN=o.formatBuilders.decimalSIPrefix("N"),o.valueFormats.forcekN=o.formatBuilders.decimalSIPrefix("N",1),o.valueFormats.lengthm=o.formatBuilders.decimalSIPrefix("m"),o.valueFormats.lengthmm=o.formatBuilders.decimalSIPrefix("m",-1),o.valueFormats.lengthkm=o.formatBuilders.decimalSIPrefix("m",1),o.valueFormats.lengthmi=o.formatBuilders.fixedUnit("mi"),o.valueFormats.lengthft=o.formatBuilders.fixedUnit("ft"),o.valueFormats.areaM2=o.formatBuilders.fixedUnit("m²"),o.valueFormats.areaF2=o.formatBuilders.fixedUnit("ft²"),o.valueFormats.areaMI2=o.formatBuilders.fixedUnit("mi²"),o.valueFormats.massmg=o.formatBuilders.decimalSIPrefix("g",-1),o.valueFormats.massg=o.formatBuilders.decimalSIPrefix("g"),o.valueFormats.masskg=o.formatBuilders.decimalSIPrefix("g",1),o.valueFormats.masst=o.formatBuilders.fixedUnit("t"),o.valueFormats.velocityms=o.formatBuilders.fixedUnit("m/s"),o.valueFormats.velocitykmh=o.formatBuilders.fixedUnit("km/h"),o.valueFormats.velocitymph=o.formatBuilders.fixedUnit("mph"),o.valueFormats.velocityknot=o.formatBuilders.fixedUnit("kn"),o.valueFormats.accMS2=o.formatBuilders.fixedUnit("m/sec²"),o.valueFormats.accFS2=o.formatBuilders.fixedUnit("f/sec²"),o.valueFormats.accG=o.formatBuilders.fixedUnit("g"),o.valueFormats.litre=o.formatBuilders.decimalSIPrefix("L"),o.valueFormats.mlitre=o.formatBuilders.decimalSIPrefix("L",-1),o.valueFormats.m3=o.formatBuilders.fixedUnit("m³"),o.valueFormats.Nm3=o.formatBuilders.fixedUnit("Nm³"),o.valueFormats.dm3=o.formatBuilders.fixedUnit("dm³"),o.valueFormats.gallons=o.formatBuilders.fixedUnit("gal"),o.valueFormats.flowgpm=o.formatBuilders.fixedUnit("gpm"),o.valueFormats.flowcms=o.formatBuilders.fixedUnit("cms"),o.valueFormats.flowcfs=o.formatBuilders.fixedUnit("cfs"),o.valueFormats.flowcfm=o.formatBuilders.fixedUnit("cfm"),o.valueFormats.litreh=o.formatBuilders.fixedUnit("l/h"),o.valueFormats.flowlpm=o.formatBuilders.fixedUnit("l/min"),o.valueFormats.flowmlpm=o.formatBuilders.fixedUnit("mL/min"),o.valueFormats.degree=o.formatBuilders.fixedUnit("°"),o.valueFormats.radian=o.formatBuilders.fixedUnit("rad"),o.valueFormats.grad=o.formatBuilders.fixedUnit("grad"),o.valueFormats.radbq=o.formatBuilders.decimalSIPrefix("Bq"),o.valueFormats.radci=o.formatBuilders.decimalSIPrefix("Ci"),o.valueFormats.radgy=o.formatBuilders.decimalSIPrefix("Gy"),o.valueFormats.radrad=o.formatBuilders.decimalSIPrefix("rad"),o.valueFormats.radsv=o.formatBuilders.decimalSIPrefix("Sv"),o.valueFormats.radrem=o.formatBuilders.decimalSIPrefix("rem"),o.valueFormats.radexpckg=o.formatBuilders.decimalSIPrefix("C/kg"),o.valueFormats.radr=o.formatBuilders.decimalSIPrefix("R"),o.valueFormats.radsvh=o.formatBuilders.decimalSIPrefix("Sv/h"),o.valueFormats.ppm=o.formatBuilders.fixedUnit("ppm"),o.valueFormats.conppb=o.formatBuilders.fixedUnit("ppb"),o.valueFormats.conngm3=o.formatBuilders.fixedUnit("ng/m³"),o.valueFormats.conngNm3=o.formatBuilders.fixedUnit("ng/Nm³"),o.valueFormats.conμgm3=o.formatBuilders.fixedUnit("μg/m³"),o.valueFormats.conμgNm3=o.formatBuilders.fixedUnit("μg/Nm³"),o.valueFormats.conmgm3=o.formatBuilders.fixedUnit("mg/m³"),o.valueFormats.conmgNm3=o.formatBuilders.fixedUnit("mg/Nm³"),o.valueFormats.congm3=o.formatBuilders.fixedUnit("g/m³"),o.valueFormats.congNm3=o.formatBuilders.fixedUnit("g/Nm³"),o.valueFormats.hertz=o.formatBuilders.decimalSIPrefix("Hz"),o.valueFormats.ms=function(t,e,r){return null===t?"":Math.abs(t)<1e3?o.toFixed(t,e)+" ms":Math.abs(t)<6e4?o.toFixedScaled(t/1e3,e,r,3," s"):Math.abs(t)<36e5?o.toFixedScaled(t/6e4,e,r,5," min"):Math.abs(t)<864e5?o.toFixedScaled(t/36e5,e,r,7," hour"):Math.abs(t)<31536e6?o.toFixedScaled(t/864e5,e,r,8," day"):o.toFixedScaled(t/31536e6,e,r,10," year")},o.valueFormats.s=function(t,e,r){return null===t?"":Math.abs(t)<1e-6?o.toFixedScaled(1e9*t,e,r-e,-9," ns"):Math.abs(t)<.001?o.toFixedScaled(1e6*t,e,r-e,-6," µs"):Math.abs(t)<1?o.toFixedScaled(1e3*t,e,r-e,-3," ms"):Math.abs(t)<60?o.toFixed(t,e)+" s":Math.abs(t)<3600?o.toFixedScaled(t/60,e,r,1," min"):Math.abs(t)<86400?o.toFixedScaled(t/3600,e,r,4," hour"):Math.abs(t)<604800?o.toFixedScaled(t/86400,e,r,5," day"):Math.abs(t)<31536e3?o.toFixedScaled(t/604800,e,r,6," week"):o.toFixedScaled(t/31556900,e,r,7," year")},o.valueFormats["µs"]=function(t,e,r){return null===t?"":Math.abs(t)<1e3?o.toFixed(t,e)+" µs":Math.abs(t)<1e6?o.toFixedScaled(t/1e3,e,r,3," ms"):o.toFixedScaled(t/1e6,e,r,6," s")},o.valueFormats.ns=function(t,e,r){return null===t?"":Math.abs(t)<1e3?o.toFixed(t,e)+" ns":Math.abs(t)<1e6?o.toFixedScaled(t/1e3,e,r,3," µs"):Math.abs(t)<1e9?o.toFixedScaled(t/1e6,e,r,6," ms"):Math.abs(t)<6e10?o.toFixedScaled(t/1e9,e,r,9," s"):o.toFixedScaled(t/6e10,e,r,12," min")},o.valueFormats.m=function(t,e,r){return null===t?"":Math.abs(t)<60?o.toFixed(t,e)+" min":Math.abs(t)<1440?o.toFixedScaled(t/60,e,r,2," hour"):Math.abs(t)<10080?o.toFixedScaled(t/1440,e,r,3," day"):Math.abs(t)<604800?o.toFixedScaled(t/10080,e,r,4," week"):o.toFixedScaled(t/525948,e,r,5," year")},o.valueFormats.h=function(t,e,r){return null===t?"":Math.abs(t)<24?o.toFixed(t,e)+" hour":Math.abs(t)<168?o.toFixedScaled(t/24,e,r,2," day"):Math.abs(t)<8760?o.toFixedScaled(t/168,e,r,3," week"):o.toFixedScaled(t/8760,e,r,4," year")},o.valueFormats.d=function(t,e,r){return null===t?"":Math.abs(t)<7?o.toFixed(t,e)+" day":Math.abs(t)<365?o.toFixedScaled(t/7,e,r,2," week"):o.toFixedScaled(t/365,e,r,3," year")},o.toDuration=function(t,e,r){if(null===t)return"";if(0===t)return"0 "+r+"s";if(t<0)return o.toDuration(-t,e,r)+" ago";var n=[{short:"y",long:"year"},{short:"M",long:"month"},{short:"w",long:"week"},{short:"d",long:"day"},{short:"h",long:"hour"},{short:"m",long:"minute"},{short:"s",long:"second"},{short:"ms",long:"millisecond"}];t*=1e3*o.intervals_in_seconds[n.find(function(t){return t.long===r}).short];for(var a=[],i=!1,s=0;s<n.length&&e>=0;s++){var l=1e3*o.intervals_in_seconds[n[s].short],c=t/l;if(c>=1||i){i=!0;var u=Math.floor(c),d=n[s].long+(1!==u?"s":"");a.push(u+" "+d),t%=l,e--}}return a.join(", ")},o.toClock=function(t,e){if(null===t)return"";if(t<1e3)return s.a.utc(t).format("SSS\\m\\s");if(t<6e4){var r="ss\\s:SSS\\m\\s";return 0===e&&(r="ss\\s"),s.a.utc(t).format(r)}if(t<36e5){var n="mm\\m:ss\\s:SSS\\m\\s";return 0===e?n="mm\\m":1===e&&(n="mm\\m:ss\\s"),s.a.utc(t).format(n)}var a="mm\\m:ss\\s:SSS\\m\\s",i=("0"+Math.floor(s.a.duration(t,"milliseconds").asHours())).slice(-2)+"h";return 0===e?a="":1===e?a="mm\\m":2===e&&(a="mm\\m:ss\\s"),a?i+":"+s.a.utc(t).format(a):i},o.valueFormats.dtdurationms=function(t,e){return o.toDuration(t,e,"millisecond")},o.valueFormats.dtdurations=function(t,e){return o.toDuration(t,e,"second")},o.valueFormats.dthms=function(t,e){return o.secondsToHhmmss(t)},o.valueFormats.timeticks=function(t,e,r){return o.valueFormats.s(t/100,e,r)},o.valueFormats.clockms=function(t,e){return o.toClock(t,e)},o.valueFormats.clocks=function(t,e){return o.toClock(1e3*t,e)},o.valueFormats.dateTimeAsIso=function(t,e){var r=e?s.a.utc(t):s()(t);return s()().isSame(t,"day")?r.format("HH:mm:ss"):r.format("YYYY-MM-DD HH:mm:ss")},o.valueFormats.dateTimeAsUS=function(t,e){var r=e?s.a.utc(t):s()(t);return s()().isSame(t,"day")?r.format("h:mm:ss a"):r.format("MM/DD/YYYY h:mm:ss a")},o.valueFormats.dateTimeFromNow=function(t,e){return(e?s.a.utc(t):s()(t)).fromNow()},o.getUnitFormats=function(){return[{text:"none",submenu:[{text:"none",value:"none"},{text:"short",value:"short"},{text:"percent (0-100)",value:"percent"},{text:"percent (0.0-1.0)",value:"percentunit"},{text:"Humidity (%H)",value:"humidity"},{text:"decibel",value:"dB"},{text:"hexadecimal (0x)",value:"hex0x"},{text:"hexadecimal",value:"hex"},{text:"scientific notation",value:"sci"},{text:"locale format",value:"locale"}]},{text:"currency",submenu:[{text:"Dollars ($)",value:"currencyUSD"},{text:"Pounds (£)",value:"currencyGBP"},{text:"Euro (€)",value:"currencyEUR"},{text:"Yen (¥)",value:"currencyJPY"},{text:"Rubles (₽)",value:"currencyRUB"},{text:"Hryvnias (₴)",value:"currencyUAH"},{text:"Real (R$)",value:"currencyBRL"},{text:"Danish Krone (kr)",value:"currencyDKK"},{text:"Icelandic Króna (kr)",value:"currencyISK"},{text:"Norwegian Krone (kr)",value:"currencyNOK"},{text:"Swedish Krona (kr)",value:"currencySEK"},{text:"Czech koruna (czk)",value:"currencyCZK"},{text:"Swiss franc (CHF)",value:"currencyCHF"},{text:"Polish Złoty (PLN)",value:"currencyPLN"},{text:"Bitcoin (฿)",value:"currencyBTC"}]},{text:"time",submenu:[{text:"Hertz (1/s)",value:"hertz"},{text:"nanoseconds (ns)",value:"ns"},{text:"microseconds (µs)",value:"µs"},{text:"milliseconds (ms)",value:"ms"},{text:"seconds (s)",value:"s"},{text:"minutes (m)",value:"m"},{text:"hours (h)",value:"h"},{text:"days (d)",value:"d"},{text:"duration (ms)",value:"dtdurationms"},{text:"duration (s)",value:"dtdurations"},{text:"duration (hh:mm:ss)",value:"dthms"},{text:"Timeticks (s/100)",value:"timeticks"},{text:"clock (ms)",value:"clockms"},{text:"clock (s)",value:"clocks"}]},{text:"date & time",submenu:[{text:"YYYY-MM-DD HH:mm:ss",value:"dateTimeAsIso"},{text:"DD/MM/YYYY h:mm:ss a",value:"dateTimeAsUS"},{text:"From Now",value:"dateTimeFromNow"}]},{text:"data (IEC)",submenu:[{text:"bits",value:"bits"},{text:"bytes",value:"bytes"},{text:"kibibytes",value:"kbytes"},{text:"mebibytes",value:"mbytes"},{text:"gibibytes",value:"gbytes"}]},{text:"data (Metric)",submenu:[{text:"bits",value:"decbits"},{text:"bytes",value:"decbytes"},{text:"kilobytes",value:"deckbytes"},{text:"megabytes",value:"decmbytes"},{text:"gigabytes",value:"decgbytes"}]},{text:"data rate",submenu:[{text:"packets/sec",value:"pps"},{text:"bits/sec",value:"bps"},{text:"bytes/sec",value:"Bps"},{text:"kilobits/sec",value:"Kbits"},{text:"kilobytes/sec",value:"KBs"},{text:"megabits/sec",value:"Mbits"},{text:"megabytes/sec",value:"MBs"},{text:"gigabytes/sec",value:"GBs"},{text:"gigabits/sec",value:"Gbits"}]},{text:"hash rate",submenu:[{text:"hashes/sec",value:"Hs"},{text:"kilohashes/sec",value:"KHs"},{text:"megahashes/sec",value:"MHs"},{text:"gigahashes/sec",value:"GHs"},{text:"terahashes/sec",value:"THs"},{text:"petahashes/sec",value:"PHs"},{text:"exahashes/sec",value:"EHs"}]},{text:"throughput",submenu:[{text:"ops/sec (ops)",value:"ops"},{text:"requests/sec (rps)",value:"reqps"},{text:"reads/sec (rps)",value:"rps"},{text:"writes/sec (wps)",value:"wps"},{text:"I/O ops/sec (iops)",value:"iops"},{text:"ops/min (opm)",value:"opm"},{text:"reads/min (rpm)",value:"rpm"},{text:"writes/min (wpm)",value:"wpm"}]},{text:"length",submenu:[{text:"millimetre (mm)",value:"lengthmm"},{text:"meter (m)",value:"lengthm"},{text:"feet (ft)",value:"lengthft"},{text:"kilometer (km)",value:"lengthkm"},{text:"mile (mi)",value:"lengthmi"}]},{text:"area",submenu:[{text:"Square Meters (m²)",value:"areaM2"},{text:"Square Feet (ft²)",value:"areaF2"},{text:"Square Miles (mi²)",value:"areaMI2"}]},{text:"mass",submenu:[{text:"milligram (mg)",value:"massmg"},{text:"gram (g)",value:"massg"},{text:"kilogram (kg)",value:"masskg"},{text:"metric ton (t)",value:"masst"}]},{text:"velocity",submenu:[{text:"metres/second (m/s)",value:"velocityms"},{text:"kilometers/hour (km/h)",value:"velocitykmh"},{text:"miles/hour (mph)",value:"velocitymph"},{text:"knot (kn)",value:"velocityknot"}]},{text:"volume",submenu:[{text:"millilitre (mL)",value:"mlitre"},{text:"litre (L)",value:"litre"},{text:"cubic metre",value:"m3"},{text:"Normal cubic metre",value:"Nm3"},{text:"cubic decimetre",value:"dm3"},{text:"gallons",value:"gallons"}]},{text:"energy",submenu:[{text:"Watt (W)",value:"watt"},{text:"Kilowatt (kW)",value:"kwatt"},{text:"Milliwatt (mW)",value:"mwatt"},{text:"Watt per square metre (W/m²)",value:"Wm2"},{text:"Volt-ampere (VA)",value:"voltamp"},{text:"Kilovolt-ampere (kVA)",value:"kvoltamp"},{text:"Volt-ampere reactive (var)",value:"voltampreact"},{text:"Kilovolt-ampere reactive (kvar)",value:"kvoltampreact"},{text:"Watt-hour (Wh)",value:"watth"},{text:"Kilowatt-hour (kWh)",value:"kwatth"},{text:"Kilowatt-min (kWm)",value:"kwattm"},{text:"Joule (J)",value:"joule"},{text:"Electron volt (eV)",value:"ev"},{text:"Ampere (A)",value:"amp"},{text:"Kiloampere (kA)",value:"kamp"},{text:"Milliampere (mA)",value:"mamp"},{text:"Volt (V)",value:"volt"},{text:"Kilovolt (kV)",value:"kvolt"},{text:"Millivolt (mV)",value:"mvolt"},{text:"Decibel-milliwatt (dBm)",value:"dBm"},{text:"Ohm (Ω)",value:"ohm"},{text:"Lumens (Lm)",value:"lumens"}]},{text:"temperature",submenu:[{text:"Celsius (°C)",value:"celsius"},{text:"Farenheit (°F)",value:"farenheit"},{text:"Kelvin (K)",value:"kelvin"}]},{text:"pressure",submenu:[{text:"Millibars",value:"pressurembar"},{text:"Bars",value:"pressurebar"},{text:"Kilobars",value:"pressurekbar"},{text:"Hectopascals",value:"pressurehpa"},{text:"Kilopascals",value:"pressurekpa"},{text:"Inches of mercury",value:"pressurehg"},{text:"PSI",value:"pressurepsi"}]},{text:"force",submenu:[{text:"Newton-meters (Nm)",value:"forceNm"},{text:"Kilonewton-meters (kNm)",value:"forcekNm"},{text:"Newtons (N)",value:"forceN"},{text:"Kilonewtons (kN)",value:"forcekN"}]},{text:"flow",submenu:[{text:"Gallons/min (gpm)",value:"flowgpm"},{text:"Cubic meters/sec (cms)",value:"flowcms"},{text:"Cubic feet/sec (cfs)",value:"flowcfs"},{text:"Cubic feet/min (cfm)",value:"flowcfm"},{text:"Litre/hour",value:"litreh"},{text:"Litre/min (l/min)",value:"flowlpm"},{text:"milliLitre/min (mL/min)",value:"flowmlpm"}]},{text:"angle",submenu:[{text:"Degrees (°)",value:"degree"},{text:"Radians",value:"radian"},{text:"Gradian",value:"grad"}]},{text:"acceleration",submenu:[{text:"Meters/sec²",value:"accMS2"},{text:"Feet/sec²",value:"accFS2"},{text:"G unit",value:"accG"}]},{text:"radiation",submenu:[{text:"Becquerel (Bq)",value:"radbq"},{text:"curie (Ci)",value:"radci"},{text:"Gray (Gy)",value:"radgy"},{text:"rad",value:"radrad"},{text:"Sievert (Sv)",value:"radsv"},{text:"rem",value:"radrem"},{text:"Exposure (C/kg)",value:"radexpckg"},{text:"roentgen (R)",value:"radr"},{text:"Sievert/hour (Sv/h)",value:"radsvh"}]},{text:"concentration",submenu:[{text:"parts-per-million (ppm)",value:"ppm"},{text:"parts-per-billion (ppb)",value:"conppb"},{text:"nanogram per cubic metre (ng/m³)",value:"conngm3"},{text:"nanogram per normal cubic metre (ng/Nm³)",value:"conngNm3"},{text:"microgram per cubic metre (μg/m³)",value:"conμgm3"},{text:"microgram per normal cubic metre (μg/Nm³)",value:"conμgNm3"},{text:"milligram per cubic metre (mg/m³)",value:"conmgm3"},{text:"milligram per normal cubic metre (mg/Nm³)",value:"conmgNm3"},{text:"gram per cubic metre (g/m³)",value:"congm3"},{text:"gram per normal cubic metre (g/Nm³)",value:"congNm3"}]}]},e.a=o},function(t,e,r){"use strict";s.$inject=["$timeout"],c.$inject=["$compile"],u.$inject=["$compile"],d.$inject=["$compile","$sce","templateSrv"],p.$inject=["uiSegmentSrv","$q"],b.$inject=["$compile"],y.$inject=["$compile"],w.$inject=["$compile"],x.$inject=["$compile","$interpolate"],S.$inject=["$parse","$compile","$timeout"],_.$inject=["$compile","$window","$timeout","$rootScope"],M.$inject=["$animate"],At.$inject=["$rootScope"],Nt.$inject=["$compile","templateSrv"],qt.$inject=["$compile","templateSrv"],Xt.$inject=["googleAnalyticsSrv"],Zt.$inject=["$compile","$rootScope","$timeout"],te.$inject=["$sce","templateSrv"],ce.$inject=["templateSrv"];var n=r(1),a=r.n(n),i=r(5);function s(t){return{link:function(e,r){e.ctrl.dashboard.events.on("view-mode-changed",function(e){console.log("view-mode-changed",e.fullscreen),e.fullscreen?r.addClass("panel-in-fullscreen"):t(function(){r.removeClass("panel-in-fullscreen")})}),r.toggleClass("panel-in-fullscreen",!0===e.ctrl.dashboard.meta.fullscreen),e.$watch("ctrl.dashboardViewState.state.editview",function(t){t?(r.toggleClass("dashboard-page--settings-opening",a.a.isString(t)),setTimeout(function(){r.toggleClass("dashboard-page--settings-open",a.a.isString(t))},10)):(r.removeClass("dashboard-page--settings-opening"),r.removeClass("dashboard-page--settings-open"))})}}}i.c.directive("dashClass",s);var o=r(7),l=r.n(o);function c(t){return{scope:{menuItems:"=dropdownTypeahead",dropdownTypeaheadOnSelect:"&dropdownTypeaheadOnSelect",model:"=ngModel"},link:function(e,r,n){var i=l()('<input type="text" class="gf-form-input input-medium tight-form-input" spellcheck="false" style="display:none"></input>'),s=l()('<a class="gf-form-label tight-form-func dropdown-toggle" tabindex="1" gf-dropdown="menuItems" data-toggle="dropdown" data-placement="top"><i class="fa fa-plus"></i></a>');i.appendTo(r),s.appendTo(r),n.linkText&&s.html(n.linkText),n.ngModel&&e.$watch("model",function(t){a.a.each(e.menuItems,function(e){a.a.each(e.submenu,function(e){e.value===t&&s.html(e.text)})})});var o=a.a.reduce(e.menuItems,function(t,e,r){return e.submenu?a.a.each(e.submenu,function(n,a){n.click="menuItemSelected("+r+","+a+")",t.push(e.text+" "+n.text)}):(e.click="menuItemSelected("+r+")",t.push(e.text)),t},[]);e.menuItemSelected=function(t,r){var n=e.menuItems[t],a={$item:n};n.submenu&&void 0!==r&&(a.$subItem=n.submenu[r]),e.dropdownTypeaheadOnSelect(a)},i.attr("data-provide","typeahead"),i.typeahead({source:o,minLength:1,items:10,updater:function(t){var r={};return a.a.each(e.menuItems,function(e){a.a.each(e.submenu,function(n){t===e.text+" "+n.text&&(r.$subItem=n,r.$item=e)})}),r.$item&&e.$apply(function(){e.dropdownTypeaheadOnSelect(r)}),i.trigger("blur"),""}}),s.click(function(){s.hide(),i.show(),i.focus()}),i.keyup(function(){r.toggleClass("open",""===i.val())}),i.blur(function(){i.hide(),i.val(""),s.show(),s.focus(),setTimeout(function(){r.removeClass("open")},200)}),t(r.contents())(e)}}}function u(t){return{scope:{menuItems:"=dropdownTypeahead2",dropdownTypeaheadOnSelect:"&dropdownTypeaheadOnSelect",model:"=ngModel"},link:function(e,r,n){var i=l()('<input type="text" class="gf-form-input" spellcheck="false" style="display:none"></input>'),s=l()('<a class="gf-form-input dropdown-toggle" tabindex="1" gf-dropdown="menuItems" data-toggle="dropdown" data-placement="top"><i class="fa fa-plus"></i></a>');i.appendTo(r),s.appendTo(r),n.linkText&&s.html(n.linkText),n.ngModel&&e.$watch("model",function(t){a.a.each(e.menuItems,function(e){a.a.each(e.submenu,function(e){e.value===t&&s.html(e.text)})})});var o=a.a.reduce(e.menuItems,function(t,e,r){return e.submenu?a.a.each(e.submenu,function(n,a){n.click="menuItemSelected("+r+","+a+")",t.push(e.text+" "+n.text)}):(e.click="menuItemSelected("+r+")",t.push(e.text)),t},[]);e.menuItemSelected=function(t,r){var n=e.menuItems[t],a={$item:n};n.submenu&&void 0!==r&&(a.$subItem=n.submenu[r]),e.dropdownTypeaheadOnSelect(a)},i.attr("data-provide","typeahead"),i.typeahead({source:o,minLength:1,items:10,updater:function(t){var r={};return a.a.each(e.menuItems,function(e){a.a.each(e.submenu,function(n){t===e.text+" "+n.text&&(r.$subItem=n,r.$item=e)})}),r.$item&&e.$apply(function(){e.dropdownTypeaheadOnSelect(r)}),i.trigger("blur"),""}}),s.click(function(){s.hide(),i.show(),i.focus()}),i.keyup(function(){r.toggleClass("open",""===i.val())}),i.blur(function(){i.hide(),i.val(""),s.show(),s.focus(),setTimeout(function(){r.removeClass("open")},200)}),t(r.contents())(e)}}}function d(t,e,r){return{scope:{segment:"=",getOptions:"&",onChange:"&",debounce:"@"},link:function(n,i){var s=l()('<input type="text" data-provide="typeahead"  class="gf-form-input input-medium" spellcheck="false" style="display:none"></input>'),o=n.segment,c=l()(o.selectMode?'<a class="gf-form-input gf-form-input--dropdown" ng-class="segment.cssClass" tabindex="1" give-focus="segment.focus" ng-bind-html="segment.html"></a>':'<a class="gf-form-label" ng-class="segment.cssClass" tabindex="1" give-focus="segment.focus" ng-bind-html="segment.html"></a>'),u=null,d=null,p=!0,h=n.debounce;s.appendTo(i),c.appendTo(i),n.updateVariableValue=function(t){""!==t&&o.value!==t&&n.$apply(function(){var i=a.a.find(n.altSegments,{value:t});i?(o.value=i.value,o.html=i.html||e.trustAsHtml(r.highlightVariablesAsHtml(i.value)),o.fake=!1,o.expandable=i.expandable,i.type&&(o.type=i.type)):"false"!==o.custom&&(o.value=t,o.html=e.trustAsHtml(r.highlightVariablesAsHtml(t)),o.expandable=!0,o.fake=!1),n.onChange()})},n.switchToLink=function(t){p&&!t||(clearTimeout(d),d=null,p=!0,s.hide(),c.show(),n.updateVariableValue(s.val()))},n.inputBlur=function(){d=setTimeout(n.switchToLink,200)},n.source=function(t,e){n.$apply(function(){n.getOptions({$query:t}).then(function(t){n.altSegments=t,u=a.a.map(n.altSegments,function(t){return a.a.escape(t.value)}),"false"!==o.custom&&(o.fake||-1!==a.a.indexOf(u,o.value)||u.unshift(a.a.escape(o.value))),e(u)})})},n.updater=function(t){return(t=a.a.unescape(t))===o.value?(clearTimeout(d),s.focus(),t):(s.val(t),n.switchToLink(!0),t)},n.matcher=function(t){if(p)return!1;var e=this.query;"/"===e[0]&&(e=e.substring(1)),"/"===e[e.length-1]&&(e=e.substring(0,e.length-1));try{return t.toLowerCase().match(e.toLowerCase())}catch(t){return!1}},s.attr("data-provide","typeahead"),s.typeahead({source:n.source,minLength:0,items:1e4,updater:n.updater,matcher:n.matcher});var f=s.data("typeahead");f.lookup=function(){this.query=this.$element.val()||"";var t=this.source(this.query,l.a.proxy(this.process,this));return t?this.process(t):t},h&&(f.lookup=a.a.debounce(f.lookup,500,{leading:!0})),c.keydown(function(t){40!==t.keyCode&&13!==t.keyCode||c.click()}),c.click(function(){u=null,s.css("width",Math.max(c.width(),80)+16+"px"),c.hide(),s.show(),s.focus(),p=!1;var t=s.data("typeahead");t&&(s.val(""),t.lookup())}),s.blur(n.inputBlur),t(i.contents())(n)}}}function p(t,e){return{template:'<metric-segment segment="segment" get-options="getOptionsInternal()" on-change="onSegmentChange()"></metric-segment>',restrict:"E",scope:{property:"=",options:"=",getOptions:"&",onChange:"&"},link:{pre:function(r,n,i){var s;r.valueToSegment=function(e){var n=a.a.find(r.options,{value:e}),s={cssClass:i.cssClass,custom:i.custom,value:n?n.text:e,selectMode:i.selectMode};return t.newSegment(s)},r.getOptionsInternal=function(){return r.options?(s=r.options,e.when(a.a.map(r.options,function(t){return{value:t.text}}))):r.getOptions().then(function(t){return s=t,a.a.map(t,function(t){return t.html?t:{value:t.text}})})},r.onSegmentChange=function(){if(s){var t=a.a.find(s,{text:r.segment.value});t&&t.value!==r.property?r.property=t.value:"false"!==i.custom&&(r.property=r.segment.value)}else r.property=r.segment.value;r.$$postDigest(function(){r.$apply(function(){r.onChange()})})},r.segment=r.valueToSegment(r.property)}}}}i.c.directive("dropdownTypeahead",c),i.c.directive("dropdownTypeahead2",u),i.c.directive("metricSegment",d),i.c.directive("metricSegmentModel",p);var h=r(6),f=r.n(h),m=r(593),g=r.n(m),v=r(12);function b(t){return{restrict:"E",link:function(e,r,n){var a='<i class="grafana-tip fa fa-'+(n.icon||"question-circle")+'" bs-tooltip="\''+v.a.addslashes(r.text())+"'\"></i>";a=a.replace(/{/g,"\\{").replace(/}/g,"\\}"),r.replaceWith(t(f.a.element(a))(e))}}}function y(t){return{restrict:"A",link:function(e,r,n){e.$watch(function(t){return t.$eval(n.compile)},function(n){r.html(n),t(r.contents())(e)})}}}function w(t){return{restrict:"E",link:function(e,r,n){var a=n.change?' ng-change="'+n.change+'"':"",i=n.tip?" <tip>"+n.tip+"</tip>":"",s='<div class="editor-option gf-form-checkbox text-center"'+(n.showIf?' ng-show="'+n.showIf+'" ':"")+'> <label for="'+n.model+'" class="small">'+n.text+i+'</label><input class="cr1" id="'+n.model+'" type="checkbox"        ng-model="'+n.model+'"'+a+'       ng-checked="'+n.model+'"></input> <label for="'+n.model+'" class="cr1"></label>';r.replaceWith(t(f.a.element(s))(e))}}}function x(t,e){return{restrict:"E",link:function(r,n,a){var i=e(a.text)(r),s=e(a.model)(r),o=a.change?' ng-change="'+a.change+'"':"",l=a.tip?" <tip>"+a.tip+"</tip>":"",c='<label for="'+r.$id+s+'" class="checkbox-label">'+i+l+"</label>",u='<input class="cr1" id="'+r.$id+s+'" type="checkbox"        ng-model="'+s+'"'+o+'       ng-checked="'+s+'"></input> <label for="'+r.$id+s+'" class="cr1"></label>';u+=c,n.addClass("gf-form-checkbox"),n.html(t(f.a.element(u))(r))}}}function S(t,e,r){return{restrict:"EA",scope:!0,link:function(n,a,i){var s=t(i.gfDropdown)(n);r(function(){var t=a.data("placement");f.a.element(function t(e,r){for(var n=['<ul class="dropdown-menu '+("top"===r?"dropup":"")+'" role="menu" aria-labelledby="drop1">',"</ul>"],a=0;a<e.length;a++){var i=e[a];if(i.divider)n.splice(a+1,0,'<li class="divider"></li>');else{var s="<li"+(i.submenu&&i.submenu.length?' class="dropdown-submenu"':"")+'><a tabindex="-1" ng-href="'+(i.href||"")+'"'+(i.click?' ng-click="'+i.click+'"':"")+(i.target?' target="'+i.target+'"':"")+(i.method?' data-method="'+i.method+'"':"")+">"+(i.text||"")+"</a>";i.submenu&&i.submenu.length&&(s+=t(i.submenu).join("\n")),s+="</li>",n.splice(a+1,0,s)}}return n}(s,t).join("")).insertAfter(a),e(a.next("ul.dropdown-menu"))(n)}),a.addClass("dropdown-toggle").attr("data-toggle","dropdown")}}}i.c.directive("tip",b),i.c.directive("clipboardButton",function(){return{scope:{getText:"&clipboardButton"},link:function(t,e){t.clipboard=new g.a(e[0],{text:function(){return t.getText()}}),t.clipboard.on("success",function(){kt.a.emit("alert-success",["内容复制到剪贴板"])}),t.$on("$destroy",function(){t.clipboard&&t.clipboard.destroy()})}}}),i.c.directive("compile",y),i.c.directive("watchChange",function(){return{scope:{onchange:"&watchChange"},link:function(t,e){e.on("input",function(){t.$apply(function(){t.onchange({inputValue:e.val()})})})}}}),i.c.directive("editorOptBool",w),i.c.directive("editorCheckbox",x),i.c.directive("gfDropdown",S);var k=r(115);i.c.directive("ngModelOnblur",function(){return{restrict:"A",priority:1,require:"ngModel",link:function(t,e,r,n){"radio"!==r.type&&"checkbox"!==r.type&&(e.off("input keydown change"),e.bind("blur",function(){t.$apply(function(){n.$setViewValue(e.val())})}))}}}),i.c.directive("emptyToNull",function(){return{restrict:"A",require:"ngModel",link:function(t,e,r,n){n.$parsers.push(function(t){return""===t?null:t})}}}),i.c.directive("validTimeSpan",function(){return{require:"ngModel",link:function(t,e,r,n){n.$validators.integer=function(t,e){return!!n.$isEmpty(t)||0===e.indexOf("$")||0===e.indexOf("+$")||!0!==k.a(e).invalid}}}});var C=r(242);r(871);function T(t,e){var r=C.a.getTagColorsFromName(t),n=r.color,a=r.borderColor;e.css("background-color",n),e.css("border-color",a)}i.c.directive("tagColorFromName",function(){return{scope:{tagColorFromName:"="},link:function(t,e){T(t.tagColorFromName,e)}}}),i.c.directive("bootstrapTagsinput",function(){function t(t,e){if(e)return f.a.isFunction(t.$parent[e])?t.$parent[e]:function(t){return t[e]}}return{restrict:"EA",scope:{model:"=ngModel",onTagsUpdated:"&"},template:"<select multiple></select>",replace:!1,link:function(e,r,n){var a=this;f.a.isArray(e.model)||(e.model=[]);var i=l()("select",r);n.placeholder&&i.attr("placeholder",n.placeholder),i.tagsinput({typeahead:{source:f.a.isFunction(e.$parent[n.typeaheadSource])?e.$parent[n.typeaheadSource]:null},widthClass:n.widthClass,itemValue:t(e,n.itemvalue),itemText:t(e,n.itemtext),tagClass:f.a.isFunction(e.$parent[n.tagclass])?e.$parent[n.tagclass]:function(){return n.tagclass}}),i.on("itemAdded",function(t){-1===e.model.indexOf(t.item)&&(e.model.push(t.item),e.onTagsUpdated&&e.onTagsUpdated());var r=i.next().children("span").filter(function(){return l()(a).text()===t.item});T(t.item,r)}),i.on("itemRemoved",function(t){var r=e.model.indexOf(t.item);-1!==r&&(e.model.splice(r,1),e.onTagsUpdated&&e.onTagsUpdated())}),e.$watch("model",function(){f.a.isArray(e.model)||(e.model=[]),i.tagsinput("removeAll");for(var t=0;t<e.model.length;t++)i.tagsinput("add",e.model[t])},!0)}}});var E=function(){function t(t){this.$q=t}return t.$inject=["$q"],t.prototype.show=function(){var t=this;this.oldVariableText=this.variable.current.text,this.highlightIndex=-1,this.options=this.variable.options,this.selectedValues=a.a.filter(this.options,{selected:!0}),this.tags=a.a.map(this.variable.tags,function(e){var r={text:e,selected:!1};return a.a.each(t.variable.current.tags,function(t){t.text===e&&(r=t)}),r}),this.search={query:"",options:this.options.slice(0,Math.min(this.options.length,1e3))},this.dropdownVisible=!0},t.prototype.updateLinkText=function(){var t=this.variable.current;if(t.tags&&t.tags.length){var e=a.a.filter(this.variable.options,function(e){if(!e.selected)return!1;for(var r=0;r<t.tags.length;r++){var n=t.tags[r];if(-1!==a.a.indexOf(n.values,e.value))return!1}return!0}),r=a.a.map(e,"text");this.linkText=r.join(" + "),this.linkText.length>0&&(this.linkText+=" + ")}else this.linkText=this.variable.current.text},t.prototype.clearSelections=function(){a.a.each(this.options,function(t){t.selected=!1}),this.selectionsChanged(!1)},t.prototype.selectTag=function(t){var e=this;return t.selected=!t.selected,(t.values?this.$q.when(t.values):this.variable.getValuesForTag(t.text)).then(function(r){t.values=r,t.valuesText=r.join(" + "),a.a.each(e.options,function(e){-1!==a.a.indexOf(t.values,e.value)&&(e.selected=t.selected)}),e.selectionsChanged(!1)})},t.prototype.keyDown=function(t){27===t.keyCode&&this.hide(),40===t.keyCode&&this.moveHighlight(1),38===t.keyCode&&this.moveHighlight(-1),13===t.keyCode&&(0===this.search.options.length?this.commitChanges():this.selectValue(this.search.options[this.highlightIndex],{},!0,!1)),32===t.keyCode&&this.selectValue(this.search.options[this.highlightIndex],{},!1,!1)},t.prototype.moveHighlight=function(t){this.highlightIndex=(this.highlightIndex+t)%this.search.options.length},t.prototype.selectValue=function(t,e,r,n){var i=this;if(t){t.selected=!this.variable.multi||!t.selected,r=r||!1,n=n||!1;var s=function(e){a.a.each(i.options,function(r){t!==r&&(r.selected=e)})};r&&(t.selected=!0),"All"===t.text||n?(s(!1),r=!0):this.variable.multi?(e.ctrlKey||e.metaKey||e.shiftKey)&&(r=!0,s(!1)):(s(!1),r=!0),this.selectionsChanged(r)}},t.prototype.selectionsChanged=function(t){var e=this;this.selectedValues=a.a.filter(this.options,{selected:!0}),this.selectedValues.length>1&&"All"===this.selectedValues[0].text&&(this.selectedValues[0].selected=!1,this.selectedValues=this.selectedValues.slice(1,this.selectedValues.length)),a.a.each(this.tags,function(t){t.selected&&a.a.each(t.values,function(r){a.a.find(e.selectedValues,{value:r})||(t.selected=!1)})}),this.selectedTags=a.a.filter(this.tags,{selected:!0}),this.variable.current.value=a.a.map(this.selectedValues,"value"),this.variable.current.text=a.a.map(this.selectedValues,"text").join(" + "),this.variable.current.tags=this.selectedTags,this.variable.multi||(this.variable.current.value=this.selectedValues[0].value),t&&this.commitChanges()},t.prototype.commitChanges=function(){0===this.search.options.length&&this.search.query.length>0?this.variable.current={text:this.search.query,value:this.search.query}:0===this.selectedValues.length&&(this.options[0].selected=!0,this.selectionsChanged(!1)),this.dropdownVisible=!1,this.updateLinkText(),this.variable.current.text!==this.oldVariableText&&this.onUpdated()},t.prototype.queryChanged=function(){var t=this;this.highlightIndex=-1,this.search.options=a.a.filter(this.options,function(e){return-1!==e.text.toLowerCase().indexOf(t.search.query.toLowerCase())}),this.search.options=this.search.options.slice(0,Math.min(this.search.options.length,1e3))},t.prototype.init=function(){this.selectedTags=this.variable.current.tags||[],this.updateLinkText()},t}();function _(t,e,r,n){return{scope:{variable:"=",onUpdated:"&"},templateUrl:"public/app/partials/valueSelectDropdown.html",controller:"ValueSelectDropdownCtrl",controllerAs:"vm",bindToController:!0,link:function(t,a){var i=f.a.element(e.document.body),s=a.find(".variable-value-link"),o=a.find("input");function l(e){0===a.has(e.target).length&&t.$apply(function(){t.vm.commitChanges()})}t.$watch("vm.dropdownVisible",function(t){t?(o.css("width",Math.max(s.width(),80)+"px"),o.show(),s.hide(),o.focus(),r(function(){i.on("click",l)},0,!1)):(o.hide(),s.show(),i.off("click",l))});var c=n.$on("template-variable-value-updated",function(){t.vm.updateLinkText()});t.$on("$destroy",function(){c()}),t.vm.init()}}}function M(t){return{multiElement:!0,terminal:!0,transclude:!0,priority:600,restrict:"E",link:function(e,r,n,a,i){var s,o,c;function u(){c&&(c.remove(),c=null),o&&(o.$destroy(),o=null),s&&(c=function(t){var e,r=t[0],n=t[t.length-1];r=r.nextSibling;for(var a=1;r!==n&&r;a++)(e||t[a]!==r)&&(e||(e=l()([].slice.call(t,0,a))),e.push(r)),r=r.nextSibling;return e||t}(s.clone),t.leave(c).then(function(){c=null}),s=null)}e.$watch(n.property,function(e,a){o&&e!==a&&u(),o||!e&&!n.showNull?u():i(function(e,n){o=n,e[e.length++]=document.createComment(" end rebuild on change "),s={clone:e},t.enter(e,r.parent(),r)})})}}}i.c.controller("ValueSelectDropdownCtrl",E),i.c.directive("valueSelectDropdown",_),i.c.directive("rebuildOnChange",M),i.c.directive("giveFocus",function(){return function(t,e,r){e.click(function(t){t.stopPropagation()}),t.$watch(r.giveFocus,function(t){t&&setTimeout(function(){e.focus();var t=e[0];if(t.setSelectionRange){var r=2*e.val().length;t.setSelectionRange(r,r)}},200)},!0)}});var A=function(){function t(t){var e=this;this.$rootScope=t;this.observer=new MutationObserver(function(t){1===t.length&&e.$rootScope.appEvent("json-diff-ready")});this.observer.observe(f.a.element(".delta-html")[0],{attributes:!0,attributeFilter:["class"],characterData:!1,childList:!0,subtree:!1})}return t.$inject=["$rootScope"],t.prototype.$onDestroy=function(){this.observer.disconnect()},t}();i.c.directive("diffDelta",function(){return{controller:A,replace:!1,restrict:"A"}});var P=function(){function t(t,e,r){this.$scope=t,this.$rootScope=e,this.$anchorScroll=r}return t.$inject=["$scope","$rootScope","$anchorScroll"],t.prototype.goToLine=function(t){var e,r=this;this.$scope.switchView().then(function(){e=r.$rootScope.$on("json-diff-ready",function(){r.$anchorScroll("l"+t),e()}.bind(r))})},t}();i.c.directive("diffLinkJson",function(){return{controller:P,controllerAs:"ctrl",replace:!0,restrict:"E",scope:{line:"@lineDisplay",link:"@lineLink",switchView:"&"},template:'<a class="diff-linenum btn btn-inverse btn-small" ng-click="ctrl.goToLine(link)">Line {{ line }}</a>'}});var $=l()(window);l.a.fn.place_tt=function(){var t={offset:5};return function(e,r,n){var i=this;return n=l.a.extend(!0,{},t,n),this.each(function(){var t,s,o=l()(i);o.addClass("grafana-tooltip"),l()("#tooltip").remove(),o.appendTo(document.body),n.compile&&f.a.element(document).injector().invoke(["$compile","$rootScope",function(t,e){var r=e.$new(!0);a.a.extend(r,n.scopeData),t(o)(r),r.$digest(),r.$destroy()}]),t=o.outerWidth(!0),s=o.outerHeight(!0),o.css("left",e+n.offset+t>$.width()?e-n.offset-t:e+n.offset),o.css("top",r+n.offset+s>$.height()?r-n.offset-s:r+n.offset)})}}();r(872);function D(t){return!!t&&"object"===typeof t}function O(t){if(void 0===t)return"";if(null===t)return"Object";if("object"==typeof t&&!t.constructor)return"Object";var e=/function ([^(]*)/.exec(t.constructor.toString());return e&&e.length>1?e[1]:""}function I(t){return null===t?"null":typeof t}function N(t,e){var r=I(t);return"null"===r||"undefined"===r?r:("string"===r&&(e='"'+function(t){return t.replace('"','"')}(e)+'"'),"function"===r?t.toString().replace(/[\r\n]/g,"").replace(/\{.*\}/,"")+"{…}":e)}function F(t){return"json-formatter-"+t}function q(t,e,r){var n=document.createElement(t);return e&&n.classList.add(F(e)),void 0!==r&&(r instanceof Node?n.appendChild(r):n.appendChild(document.createTextNode(String(r)))),n}var L=/(^\d{1,4}[\.|\\/|-]\d{1,2}[\.|\\/|-]\d{1,4})(\s*(?:0?[1-9]:[0-5]|1(?=[012])\d:[0-5])\d\s*[ap]m)?$/,R=/\d{2}:\d{2}:\d{2} GMT-\d{4}/,j=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z/,U=window.requestAnimationFrame||function(t){return t(),0},V={animateOpen:!0,animateClose:!0,theme:null},B=function(){function t(t,e,r,n){void 0===e&&(e=1),void 0===r&&(r=V),this.json=t,this.open=e,this.config=r,this.key=n,this._isOpen=null,this.skipChildren=!1}return Object.defineProperty(t.prototype,"isOpen",{get:function(){return null!==this._isOpen?this._isOpen:this.open>0},set:function(t){this._isOpen=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDate",{get:function(){return"string"===this.type&&(L.test(this.json)||j.test(this.json)||R.test(this.json))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isUrl",{get:function(){return"string"===this.type&&0===this.json.indexOf("http")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isArray",{get:function(){return Array.isArray(this.json)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isObject",{get:function(){return D(this.json)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEmptyObject",{get:function(){return!this.keys.length&&!this.isArray},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEmpty",{get:function(){return this.isEmptyObject||this.keys&&!this.keys.length&&this.isArray},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasKey",{get:function(){return void 0!==this.key},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"constructorName",{get:function(){return O(this.json)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return I(this.json)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"keys",{get:function(){return this.isObject?Object.keys(this.json).map(function(t){return t||'""'}):[]},enumerable:!0,configurable:!0}),t.prototype.toggleOpen=function(){this.isOpen=!this.isOpen,this.element&&(this.isOpen?this.appendChildren(this.config.animateOpen):this.removeChildren(this.config.animateClose),this.element.classList.toggle(F("open")))},t.prototype.openAtDepth=function(t){void 0===t&&(t=1),t<0||(this.open=t,this.isOpen=0!==t,this.element&&(this.removeChildren(!1),0===t?this.element.classList.remove(F("open")):(this.appendChildren(this.config.animateOpen),this.element.classList.add(F("open")))))},t.prototype.isNumberArray=function(){return this.json.length>0&&this.json.length<4&&(a.a.isNumber(this.json[0])||a.a.isNumber(this.json[1]))},t.prototype.renderArray=function(){var t=q("span");return t.appendChild(q("span","bracket","[")),this.isNumberArray()?(this.json.forEach(function(e,r){r>0&&t.appendChild(q("span","array-comma",",")),t.appendChild(q("span","number",e))}),this.skipChildren=!0):t.appendChild(q("span","number",this.json.length)),t.appendChild(q("span","bracket","]")),t},t.prototype.render=function(t){void 0===t&&(t=!1),this.element=q("div","row");var e=q("a","toggler-link"),r=q("span","toggler");if(this.isObject&&e.appendChild(r),this.hasKey&&e.appendChild(q("span","key",this.key+":")),this.isObject){var n=q("span","value"),a=q("span"),i=q("span","constructor-name",this.constructorName);if(a.appendChild(i),this.isArray){var s=this.renderArray();a.appendChild(s)}n.appendChild(a),e.appendChild(n)}else{(n=this.isUrl?q("a"):q("span")).classList.add(F(this.type)),this.isDate&&n.classList.add(F("date")),this.isUrl&&(n.classList.add(F("url")),n.setAttribute("href",this.json));var o=N(this.json,this.json);n.appendChild(document.createTextNode(o)),e.appendChild(n)}var l=q("div","children");return this.isObject&&l.classList.add(F("object")),this.isArray&&l.classList.add(F("array")),this.isEmpty&&l.classList.add(F("empty")),this.config&&this.config.theme&&this.element.classList.add(F(this.config.theme)),this.isOpen&&this.element.classList.add(F("open")),t||this.element.appendChild(e),this.skipChildren?e.removeChild(r):this.element.appendChild(l),this.isObject&&this.isOpen&&this.appendChildren(),this.isObject&&e.addEventListener("click",this.toggleOpen.bind(this)),this.element},t.prototype.appendChildren=function(e){var r=this;void 0===e&&(e=!1);var n=this.element.querySelector("div."+F("children"));if(n&&!this.isEmpty)if(e){var a=0,i=function(){var e=r.keys[a],s=new t(r.json[e],r.open-1,r.config,e);n.appendChild(s.render()),(a+=1)<r.keys.length&&(a>10?i():U(i))};U(i)}else this.keys.forEach(function(e){var a=new t(r.json[e],r.open-1,r.config,e);n.appendChild(a.render())})},t.prototype.removeChildren=function(t){void 0===t&&(t=!1);var e=this.element.querySelector("div."+F("children"));if(t){var r=0,n=function(){e&&e.children.length&&(e.removeChild(e.children[0]),(r+=1)>10?n():U(n))};U(n)}else e&&(e.innerHTML="")},t}();i.c.directive("jsonTree",[function(){return{restrict:"E",scope:{object:"=",startExpanded:"@",rootName:"@"},link:function(t,e){var r=new B(t.object,3,{animateOpen:!0}).render(!0);e.html(r)}}}]);var Q=r(8),H=r(342),z=r.n(H),G=(r(1017),r(1018),r(1019),r(1020),r(1021),r(1022),r(1023),r(1024),r(1025),r(1026),r(1031),r(1032),r(1034),"ace/theme/grafana-dark"),W="ace/theme/textmate",Y="text",K=10,J=2,X=!0,Z=!0,tt="<div></div>";function et(t,e,r){var n=r.mode||Y,a=r.maxLines||K,i=void 0!==r.showGutter,s=r.tabSize||J,o=r.behavioursEnabled?"true"===r.behavioursEnabled:X,l=r.snippetsEnabled?"true"===r.snippetsEnabled:Z,c=e.get(0),u=z.a.edit(c),d=u.getSession(),p={maxLines:a,showGutter:i,tabSize:s,behavioursEnabled:o,highlightActiveLine:!1,showPrintMargin:!1,autoScrollEditorIntoView:!0};u.setOptions(p),u.$blockScrolling=1/0,u.renderer.setScrollMargin(15,15),u.renderer.setPadding(10),function(){var t=G;Q.a.bootData.user.lightTheme&&(t=W);u.setTheme(t)}(),function(e){if(z.a.acequire("ace/ext/language_tools"),u.setOptions({enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableSnippets:l}),t.getCompleter()){var r=u;r.completers=r.completers.slice(),r.completers.push(t.getCompleter())}var n="ace/mode/"+e;d.setMode(n)}(n),f(t.content),e.addClass("gf-code-editor");var h=e.find("textarea");function f(t){u.setValue(t),u.clearSelection()}h.addClass("gf-form-input"),t.codeEditorFocus&&setTimeout(function(){h.focus();var t=h[0];if(t.setSelectionRange){var e=2*h.val().length;t.setSelectionRange(e,e)}},100),d.on("change",function(e){t.$apply(function(){var e=u.getValue();t.content=e})}),t.$watch("content",function(e,r){var n=u.getValue();e!==n&&e!==r&&t.$$postDigest(function(){f(e)})}),u.on("blur",function(){t.onChange()}),t.$on("$destroy",function(){u.destroy()}),u.commands.addCommand({name:"executeQuery",bindKey:{win:"Ctrl-Enter",mac:"Command-Enter"},exec:function(){t.onChange()}})}i.c.directive("codeEditor",function(){return{restrict:"E",template:tt,scope:{content:"=",datasource:"=",codeEditorFocus:"<",onChange:"&",getCompleter:"&"},link:et}});r(1035);var rt=r(2),nt=r(0),at=r.n(nt),it=r(14),st=r.n(it),ot=r(60),lt=r.n(ot),ct=r(256),ut=r(57),dt=function(t){function e(e){var r=t.call(this,e)||this;return r.openColorPicker=r.openColorPicker.bind(r),r.closeColorPicker=r.closeColorPicker.bind(r),r.setPickerElem=r.setPickerElem.bind(r),r.onColorSelect=r.onColorSelect.bind(r),r}return rt.c(e,t),e.prototype.setPickerElem=function(t){this.pickerElem=l()(t)},e.prototype.openColorPicker=function(){var t=at.a.createElement(ct.a,{color:this.props.color,onColorSelect:this.onColorSelect}),e=document.createElement("div");st.a.render(t,e);var r=new lt.a({target:this.pickerElem[0],content:e,position:"top center",classes:"drop-popover",openOn:"click",hoverCloseDelay:200,tetherOptions:{constraints:[{to:"scrollParent",attachment:"none both"}]}});r.on("close",this.closeColorPicker),this.colorPickerDrop=r,this.colorPickerDrop.open()},e.prototype.closeColorPicker=function(){var t=this;setTimeout(function(){t.colorPickerDrop&&t.colorPickerDrop.tether&&t.colorPickerDrop.destroy()},100)},e.prototype.onColorSelect=function(t){this.props.onChange(t)},e.prototype.render=function(){return at.a.createElement("div",{className:"sp-replacer sp-light",onClick:this.openColorPicker,ref:this.setPickerElem},at.a.createElement("div",{className:"sp-preview"},at.a.createElement("div",{className:"sp-preview-inner",style:{backgroundColor:this.props.color}})))},e}(at.a.Component);Object(ut.a)("colorPicker",dt,["color",["onChange",{watchDepth:"reference",wrapApply:!0}]]);r(340);i.c.directive("spectrumPicker",function(){return{restrict:"E",require:"ngModel",scope:!0,replace:!0,template:'<color-picker color="ngModel.$viewValue" onChange="onColorChange"></color-picker>',link:function(t,e,r,n){t.ngModel=n,t.onColorChange=function(t){n.$setViewValue(t)}}}});var pt=r(116),ht=r(40),ft=r(59),mt=function(){function t(t,e){this.backendSrv=t,this.$q=e,this.recentIsOpen=ht.a.getBool("search.sections.recent",!0),this.starredIsOpen=ht.a.getBool("search.sections.starred",!0)}return t.$inject=["backendSrv","$q"],t.prototype.getRecentDashboards=function(t){var e=this;return this.queryForRecentDashboards().then(function(r){r.length>0&&(t.recent={title:"最近",icon:"fa fa-clock-o",score:-1,removable:!0,expanded:e.recentIsOpen,toggle:e.toggleRecent.bind(e),items:r})})},t.prototype.queryForRecentDashboards=function(){var t=a.a.take(pt.a.getDashboardOpened(),5);return 0===t.length?Promise.resolve([]):this.backendSrv.search({dashboardIds:t}).then(function(e){return t.map(function(t){return a.a.find(e,{id:t})}).filter(function(t){return t&&!t.isStarred})})},t.prototype.toggleRecent=function(t){return this.recentIsOpen=t.expanded=!t.expanded,ht.a.set("search.sections.recent",this.recentIsOpen),!t.expanded||t.items.length?Promise.resolve(t):this.queryForRecentDashboards().then(function(e){return t.items=e,Promise.resolve(t)})},t.prototype.toggleStarred=function(t){return this.starredIsOpen=t.expanded=!t.expanded,ht.a.set("search.sections.starred",this.starredIsOpen),Promise.resolve(t)},t.prototype.getStarred=function(t){var e=this;return ft.a.isSignedIn?this.backendSrv.search({starred:!0,limit:5}).then(function(r){r.length>0&&(t.starred={title:"Starred",icon:"fa fa-star-o",score:-2,expanded:e.starredIsOpen,toggle:e.toggleStarred.bind(e),items:r})}):Promise.resolve()},t.prototype.search=function(t){var e=this,r={},n=[],i=a.a.clone(t),s=t.query||t.tag&&t.tag.length>0||t.starred||t.folderIds&&t.folderIds.length>0;return t.skipRecent||s||n.push(this.getRecentDashboards(r)),t.skipStarred||s||n.push(this.getStarred(r)),i.folderIds=i.folderIds||[],s||(i.folderIds=[0]),n.push(this.backendSrv.search(i).then(function(t){return e.handleSearchResult(r,t)})),this.$q.all(n).then(function(){return a.a.sortBy(a.a.values(r),"score")})},t.prototype.handleSearchResult=function(t,e){if(0===e.length)return t;for(var r=0,n=e;r<n.length;r++){"dash-folder"===(o=n[r]).type&&(t[o.id]={id:o.id,uid:o.uid,title:o.title,expanded:!1,items:[],toggle:this.toggleFolder.bind(this),url:o.url,icon:"fa fa-folder",score:a.a.keys(t).length})}for(var i=0,s=e;i<s.length;i++){var o;if("dash-folder"!==(o=s[i]).type){var l=t[o.folderId||0];l||(l=o.folderId?{id:o.folderId,uid:o.folderUid,title:o.folderTitle,url:o.folderUrl,items:[],icon:"fa fa-folder-open",toggle:this.toggleFolder.bind(this),score:a.a.keys(t).length}:{id:0,title:"默认",items:[],icon:"fa fa-folder-open",toggle:this.toggleFolder.bind(this),score:a.a.keys(t).length},t[o.folderId||0]=l),l.expanded=!0,l.items.push(o)}}},t.prototype.toggleFolder=function(t){if(t.expanded=!t.expanded,t.icon=t.expanded?"fa fa-folder-open":"fa fa-folder",t.items.length)return Promise.resolve(t);var e={folderIds:[t.id]};return this.backendSrv.search(e).then(function(e){return t.items=e,Promise.resolve(t)})},t.prototype.getDashboardTags=function(){return this.backendSrv.get("/api/dashboards/tags")},t}();function gt(t,e){if(f.a.isFunction(t))return t;if(!t)throw new Error("ReactComponent name attribute must be specified");var r;try{r=e.get(t)}catch(t){}if(!r)try{r=t.split(".").reduce(function(t,e){return t[e]},window)}catch(t){}if(!r)throw Error("Cannot find react component "+t);return r}function vt(t,e,r){return Object.keys(t||{}).reduce(function(n,a){var i=t[a],s=(r||{})[a]||{};return n[a]=f.a.isFunction(i)&&!1!==s.wrapApply?function(t,e){if(t.wrappedInApply)return t;var r=function(){var r=arguments,n=e.$root.$$phase;return"$apply"===n||"$digest"===n?t.apply(null,r):e.$apply(function(){return t.apply(null,r)})};return r.wrappedInApply=!0,r}(i,e):i,n},{})}function bt(t,e,r,n){var a=f.a.isFunction(e.$watchCollection),i=f.a.isFunction(e.$watchGroup),s=[];r.forEach(function(r){var o=function(t){return Array.isArray(t)?t[0]:t}(r),l=function(t,e){return Array.isArray(e)&&f.a.isObject(e[1])&&e[1].watchDepth||t}(t,r);"collection"===l&&a?e.$watchCollection(o,n):"reference"===l&&i?s.push(o):"one-time"===l||e.$watch(o,n,"reference"!==l)}),"one-time"===t&&n(),s.length&&e.$watchGroup(s,n)}function yt(t,e,r,n){r.$evalAsync(function(){st.a.render(at.a.createElement(t,e),n[0])})}function wt(t){return Array.isArray(t)?t[0]:t}function xt(t){return Array.isArray(t)?t[1]:{}}i.c.service("searchSrv",mt);var St=f.a.module("react",[]);St.directive("reactComponent",["$injector",function(t){return{restrict:"E",replace:!0,link:function(e,r,n){var a=this,i=gt(n.name,t),s=function(){var t=vt(e.$eval(n.props),e);yt(i,t,e,r)};n.props?bt(n.watchDepth,e,[n.props],s):s(),e.$on("$destroy",function(){n.onScopeDestroy?e.$eval(n.onScopeDestroy,{unmountComponent:st.a.unmountComponentAtNode.bind(a,r[0])}):st.a.unmountComponentAtNode(r[0])})}}}]),St.factory("reactDirective",["$injector",function(t){return function(e,r,n,a){var i={restrict:"E",replace:!0,link:function(n,i,s){var o=this,l=gt(e,t),c=function(){var t={},e={};r.forEach(function(r){var a=wt(r);t[a]=n.$eval(function(t,e){return t[Object.keys(t).filter(function(t){return t.toLowerCase()===e.toLowerCase()})[0]]}(s,a)),e[a]=xt(r)}),t=vt(t,n,e),t=f.a.extend({},t,a),yt(l,t,n,i)},u=(r=r||Object.keys(l.propTypes||{})).map(function(t){return Array.isArray(t)?[s[wt(t)],xt(t)]:s[t]});r.length?bt(s.watchDepth,n,u,c):c(),n.$on("$destroy",function(){s.onScopeDestroy?n.$eval(s.onScopeDestroy,{unmountComponent:st.a.unmountComponentAtNode.bind(o,i[0])}):st.a.unmountComponentAtNode(i[0])})}};return f.a.extend(i,n)}}]);var kt=r(9),Ct=function(){function t(t,e,r,n){var a=this;this.$location=e,this.$timeout=r,this.searchSrv=n,this.getTags=function(){return a.searchSrv.getDashboardTags()},this.onTagFiltersChanged=function(t){a.query.tag=t,a.search()},kt.a.on("show-dash-search",this.openSearch.bind(this),t),kt.a.on("hide-dash-search",this.closeSearch.bind(this),t),this.initialFolderFilterTitle="All",this.isEditor=ft.a.isEditor,this.hasEditPermissionInFolders=ft.a.hasEditPermissionInFolders}return t.$inject=["$scope","$location","$timeout","searchSrv"],t.prototype.closeSearch=function(){this.isOpen=this.ignoreClose},t.prototype.openSearch=function(t,e){var r=this;this.isOpen?this.closeSearch():(this.isOpen=!0,this.giveSearchFocus=0,this.selectedIndex=-1,this.results=[],this.query={query:"",tag:[],starred:!1},this.currentSearchId=0,this.ignoreClose=!0,this.isLoading=!0,e&&e.starred&&(this.query.starred=!0),this.$timeout(function(){r.ignoreClose=!1,r.giveSearchFocus=r.giveSearchFocus+1,r.search()},100))},t.prototype.keyDown=function(t){if(27===t.keyCode&&this.closeSearch(),40===t.keyCode&&this.moveSelection(1),38===t.keyCode&&this.moveSelection(-1),13===t.keyCode){var e=this.getFlattenedResultForNavigation()[this.selectedIndex];if(e)if(void 0!==e.dashboardIndex){var r=this.results[e.folderIndex].items[e.dashboardIndex];r&&(this.$location.search({}),this.$location.path(r.url),this.closeSearch())}else{var n=this.results[e.folderIndex];n&&n.toggle(n)}}},t.prototype.onFilterboxClick=function(){this.giveSearchFocus=0,this.preventClose()},t.prototype.preventClose=function(){var t=this;this.ignoreClose=!0,this.$timeout(function(){t.ignoreClose=!1},100)},t.prototype.moveSelection=function(t){if(0!==this.results.length){var e=this.getFlattenedResultForNavigation(),r=e[this.selectedIndex];if(r&&(void 0!==r.dashboardIndex?this.results[r.folderIndex].items[r.dashboardIndex].selected=!1:this.results[r.folderIndex].selected=!1),0!==t){var n=e.length,a=(this.selectedIndex+t)%n;this.selectedIndex=a<0?a+n:a;var i=e[this.selectedIndex];if(void 0!==i.dashboardIndex||0!==this.results[i.folderIndex].id)return void 0!==i.dashboardIndex?this.results[i.folderIndex].expanded?void(this.results[i.folderIndex].items[i.dashboardIndex].selected=!0):void this.moveSelection(t):void(this.results[i.folderIndex].hideHeader?this.moveSelection(t):this.results[i.folderIndex].selected=!0);this.moveSelection(t)}else this.selectedIndex=-1}},t.prototype.searchDashboards=function(){var t=this;this.currentSearchId=this.currentSearchId+1;var e=this.currentSearchId,r=rt.a({},this.query,{tag:this.query.tag});return this.searchSrv.search(r).then(function(r){e<t.currentSearchId||(r.forEach(function(t){a.a.remove(t.items,function(t){return/^[@_]{2}/.test(t.title)})}),t.results=r||[],t.isLoading=!1,t.moveSelection(1))})},t.prototype.queryHasNoFilters=function(){var t=this.query;return""===t.query&&!1===t.starred&&0===t.tag.length},t.prototype.filterByTag=function(t){-1===a.a.indexOf(this.query.tag,t)&&(this.query.tag.push(t),this.search())},t.prototype.removeTag=function(t,e){this.query.tag=a.a.without(this.query.tag,t),this.search(),this.giveSearchFocus=this.giveSearchFocus+1,e.stopPropagation(),e.preventDefault()},t.prototype.clearSearchFilter=function(){this.query.tag=[],this.search()},t.prototype.showStarred=function(){this.query.starred=!this.query.starred,this.giveSearchFocus=this.giveSearchFocus+1,this.search()},t.prototype.search=function(){this.showImport=!1,this.selectedIndex=-1,this.searchDashboards()},t.prototype.folderExpanding=function(){this.moveSelection(0)},t.prototype.getFlattenedResultForNavigation=function(){var t=0;return a.a.flatMap(this.results,function(e){var r=[];r.push({folderIndex:t});var n=0;return r=r.concat(a.a.map(e.items||[],function(e){return{folderIndex:t,dashboardIndex:n++}})),t++,r})},t}();i.c.directive("dashboardSearch",function(){return{restrict:"E",templateUrl:"public/app/core/components/search/search.html",controller:Ct,bindToController:!0,controllerAs:"ctrl",scope:{}}}),i.c.directive("infoPopover",function(){return{restrict:"E",template:'<i class="fa fa-info-circle"></i>',transclude:!0,link:function(t,e,r,n,i){var s=r.offset||"0 -10px",o=r.position||"right middle",l="drop-help drop-hide-out-of-bounds";e.addClass("gf-form-help-icon"),r.wide&&(l+=" drop-wide"),r.mode&&e.addClass("gf-form-help-icon--"+r.mode),i(function(r,n){var i=document.createElement("div");i.className="markdown-html",a.a.each(r,function(t){i.appendChild(t)});var c={target:e[0],content:i,position:o,classes:l,openOn:"hover",hoverOpenDelay:400,tetherOptions:{offset:s,constraints:[{to:"window",attachment:"together",pin:!0}]}};t.$applyAsync(function(){var e=new lt.a(c),r=t.$on("$destroy",function(){e.destroy(),r()})})})}}});var Tt=function(){function t(){}return t.prototype.showSearch=function(){kt.a.emit("show-dash-search")},t.prototype.navItemClicked=function(t,e){t.clickHandler&&(t.clickHandler(),e.preventDefault())},t}();i.c.directive("pageH1",function(){return{restrict:"E",template:'\n    <h1 class="page-header__title">\n      <i class="page-header__icon {{::model.header.icon}}" ng-if="::model.header.icon"></i>\n      <img class="page-header__img" ng-src="{{::model.header.img}}" ng-if="::model.header.img"></i>\n      {{model.header.text}}\n    </h1>\n    ',scope:{model:"="}}}),i.c.directive("navbar",function(){return{restrict:"E",templateUrl:"public/app/core/components/navbar/navbar.html",controller:Tt,bindToController:!0,controllerAs:"ctrl",scope:{model:"="},link:function(t,e){}}}),i.c.directive("arrayJoin",function(){return{restrict:"A",require:"ngModel",link:function(t,e,r,n){n.$parsers.push(function(t){return(t||"").split(",")}),n.$formatters.push(function(t){return a.a.isArray(t)?(t||"").join(","):t})}}});var Et=r(54),_t=(new(function(){function t(){this.observers={}}return t.prototype.getWebSocketUrl=function(){var t=window.location;return("https:"===t.protocol?"wss://":"ws://")+t.host+Q.a.appSubUrl+"/ws"},t.prototype.getConnection=function(){var t=this;return this.initPromise?this.initPromise:this.conn&&1===this.conn.readyState?Promise.resolve(this.conn):(this.initPromise=new Promise(function(e,r){console.log("Live: connecting..."),t.conn=new WebSocket(t.getWebSocketUrl()),t.conn.onclose=function(e){console.log("Live: websocket onclose",e),r({message:"Connection closed"}),t.initPromise=null,setTimeout(t.reconnect.bind(t),2e3)},t.conn.onmessage=function(e){t.handleMessage(e.data)},t.conn.onerror=function(e){t.initPromise=null,r({message:"Connection error"}),console.log("Live: websocket error",e)},t.conn.onopen=function(r){console.log("opened"),t.initPromise=null,e(t.conn)}}),this.initPromise)},t.prototype.handleMessage=function(t){if((t=JSON.parse(t)).stream){var e=this.observers[t.stream];e?e.next(t):this.removeObserver(t.stream,null)}else console.log("Error: stream message without stream!",t)},t.prototype.reconnect=function(){var t=this;0!==a.a.keys(this.observers).length&&(console.log("LiveSrv: Reconnecting"),this.getConnection().then(function(e){a.a.each(t.observers,function(e,r){t.send({action:"subscribe",stream:r})})}))},t.prototype.send=function(t){this.conn.send(JSON.stringify(t))},t.prototype.addObserver=function(t,e){var r=this;this.observers[t]=e,this.getConnection().then(function(e){r.send({action:"subscribe",stream:t})})},t.prototype.removeObserver=function(t,e){var r=this;console.log("unsubscribe",t),delete this.observers[t],this.getConnection().then(function(e){r.send({action:"unsubscribe",stream:t})})},t.prototype.subscribe=function(t){var e=this;return console.log("LiveSrv.subscribe: "+t),Et.Observable.create(function(r){return e.addObserver(t,r),function(){e.removeObserver(t,r)}})},t}()),r(111),'\n<div class="layout-selector">\n  <button ng-click="ctrl.listView()" ng-class="{active: ctrl.mode === \'list\'}">\n    <i class="fa fa-list"></i>\n  </button>\n  <button ng-click="ctrl.gridView()" ng-class="{active: ctrl.mode === \'grid\'}">\n    <i class="fa fa-th"></i>\n  </button>\n</div>\n'),Mt=function(){function t(t){this.$rootScope=t,this.mode=ht.a.get("grafana.list.layout.mode")||"grid"}return t.$inject=["$rootScope"],t.prototype.listView=function(){this.mode="list",ht.a.set("grafana.list.layout.mode","list"),this.$rootScope.appEvent("layout-mode-changed","list")},t.prototype.gridView=function(){this.mode="grid",ht.a.set("grafana.list.layout.mode","grid"),this.$rootScope.appEvent("layout-mode-changed","grid")},t}();function At(t){return{restrict:"A",scope:{},link:function(e,r){var n="card-list-layout-"+(ht.a.get("grafana.list.layout.mode")||"grid");r.addClass(n),t.onAppEvent("layout-mode-changed",function(t,e){r.removeClass(n),n="card-list-layout-"+e,r.addClass(n)},e)}}}i.c.directive("layoutSelector",function(){return{restrict:"E",controller:Mt,bindToController:!0,controllerAs:"ctrl",scope:{},template:_t}}),i.c.directive("layoutMode",At);var Pt='\n<label for="check-{{ctrl.id}}" class="gf-form-label {{ctrl.labelClass}} pointer" ng-show="ctrl.label">\n  {{ctrl.label}}\n  <info-popover mode="right-normal" ng-if="ctrl.tooltip" position="top center">\n    {{ctrl.tooltip}}\n  </info-popover>\n</label>\n<div class="gf-form-switch {{ctrl.switchClass}}" ng-if="ctrl.show">\n  <input id="check-{{ctrl.id}}" type="checkbox" ng-model="ctrl.checked" ng-change="ctrl.internalOnChange()">\n  <label for="check-{{ctrl.id}}" data-on="Yes" data-off="No"></label>\n</div>\n',$t=function(){function t(t,e){this.$timeout=e,this.show=!0,this.id=t.$id}return t.$inject=["$scope","$timeout"],t.prototype.internalOnChange=function(){var t=this;return this.$timeout(function(){return t.onChange()})},t}();i.c.directive("gfFormSwitch",function(){return{restrict:"E",controller:$t,controllerAs:"ctrl",bindToController:!0,scope:{checked:"=",label:"@",labelClass:"@",tooltip:"@",switchClass:"@",onChange:"&"},template:Pt}});var Dt='\n<select class="gf-form-input" ng-model="ctrl.model" ng-options="f.value as f.text for f in ctrl.options"></select>\n',Ot=function(){function t(t){this.backendSrv=t}return t.$inject=["backendSrv"],t.prototype.$onInit=function(){var t=this;return this.options=[{value:0,text:"Default"}],this.backendSrv.search({starred:!0}).then(function(e){e.forEach(function(e){t.options.push({value:e.id,text:e.title})})})},t}();i.c.directive("dashboardSelector",function(){return{restrict:"E",controller:Ot,bindToController:!0,controllerAs:"ctrl",template:Dt,scope:{model:"="}}});var It='\n<div class="dropdown cascade-open">\n<a ng-click="showActionsMenu()" class="query-part-name pointer dropdown-toggle" data-toggle="dropdown">{{part.def.type}}</a>\n<span>(</span><span class="query-part-parameters"></span><span>)</span>\n<ul class="dropdown-menu">\n  <li ng-repeat="action in partActions">\n    <a ng-click="triggerPartAction(action)">{{action.text}}</a>\n  </li>\n</ul>\n';function Nt(t,e){var r='<input type="text" class="hide input-mini tight-form-func-param"></input>';return{restrict:"E",template:It,scope:{part:"=",handleEvent:"&",debounce:"@"},link:function(t,n){var i=t.part,s=i.def,o=n.find(".query-part-parameters"),c=t.debounce;function u(t){var e=l()(this),r=e.next();r.val(i.params[t]),r.css("width",e.width()+16+"px"),e.hide(),r.show(),r.focus(),r.select();var n=r.data("typeahead");n&&(r.val(""),n.lookup())}function d(r){var n=l()(this),a=n.prev(),s=n.val();(""!==s||i.def.params[r].optional)&&(a.html(e.highlightVariablesAsHtml(s)),i.updateParam(n.val(),r),t.$apply(function(){t.handleEvent({$event:{name:"part-param-changed"}})})),n.hide(),a.show()}function p(t,e){13===e.which&&d.call(this,t)}function h(){this.style.width=8*(3+this.value.length)+"px"}function f(){a.a.each(s.params,function(n,s){if(!(n.optional&&i.params.length<=s)){s>0&&l()("<span>, </span>").appendTo(o);var f=e.highlightVariablesAsHtml(i.params[s]),m=l()('<a class="graphite-func-param-link pointer">'+f+"</a>"),g=l()(r);m.appendTo(o),g.appendTo(o),g.blur(a.a.partial(d,s)),g.keyup(h),g.keypress(a.a.partial(p,s)),m.click(a.a.partial(u,s)),function(e,r,n){if(r.options||r.dynamicLookup){e.attr("data-provide","typeahead"),e.typeahead({source:function(e,n){if(r.options){var i=r.options;return"int"===r.type&&(i=a.a.map(i,function(t){return t.toString()})),i}t.$apply(function(){t.handleEvent({$event:{name:"get-param-options"}}).then(function(t){var e=a.a.map(t,function(t){return a.a.escape(t.value)});n(e)})})},minLength:0,items:1e3,updater:function(t){return t=a.a.unescape(t),setTimeout(function(){d.call(e[0],n)},0),t}});var i=e.data("typeahead");i.lookup=function(){this.query=this.$element.val()||"";var t=this.source(this.query,l.a.proxy(this.process,this));return t?this.process(t):t},c&&(i.lookup=a.a.debounce(i.lookup,500,{leading:!0}))}}(g,n,s)}})}t.partActions=[],t.showActionsMenu=function(){t.handleEvent({$event:{name:"get-part-actions"}}).then(function(e){t.partActions=e})},t.triggerPartAction=function(e){t.handleEvent({$event:{name:"action",action:e}})},o.empty(),f()}}}i.c.directive("queryPartEditor",Nt);var Ft='\n<div class="dropdown cascade-open">\n<a ng-click="showActionsMenu()" class="query-part-name pointer dropdown-toggle" data-toggle="dropdown">{{part.label}}</a>\n<span>{{part.def.wrapOpen}}</span><span class="query-part-parameters"></span><span>{{part.def.wrapClose}}</span>\n<ul class="dropdown-menu">\n  <li ng-repeat="action in partActions">\n    <a ng-click="triggerPartAction(action)">{{action.text}}</a>\n  </li>\n</ul>\n';function qt(t,e){var r='<input type="text" class="hide input-mini"></input>';return{restrict:"E",template:Ft,scope:{part:"=",handleEvent:"&",debounce:"@"},link:function(t,n){var i=t.part,s=i.def,o=n.find(".query-part-parameters"),c=t.debounce,u=null;function d(t){var e=l()(this),r=e.next();r.val(i.params[t]),r.css("width",e.width()+16+"px"),e.hide(),r.show(),r.focus(),r.select();var n=r.data("typeahead");n&&(r.val(""),n.lookup())}function p(t,e){u=setTimeout(function(){h(t,e)},200)}function h(r,n){var a=r.prev(),s=r.val();(""!==s||i.def.params[n].optional)&&(a.html(e.highlightVariablesAsHtml(s)),i.updateParam(r.val(),n),t.$apply(function(){t.handleEvent({$event:{name:"part-param-changed"}})})),r.hide(),a.show()}function f(t,e){13===e.which&&h(l()(this),t)}function m(){this.style.width=8*(3+this.value.length)+"px"}function g(){a.a.each(s.params,function(n,h){if(!(n.optional&&i.params.length<=h)){h>0&&l()("<span>"+s.separator+"</span>").appendTo(o);var g=e.highlightVariablesAsHtml(i.params[h]),v=l()('<a class="graphite-func-param-link pointer">'+g+"</a>"),b=l()(r);v.appendTo(o),b.appendTo(o),b.blur(a.a.partial(p,b,h)),b.keyup(m),b.keypress(a.a.partial(f,h)),v.click(a.a.partial(d,h)),function(e,r,n){if(r.options||r.dynamicLookup){e.attr("data-provide","typeahead"),e.typeahead({source:function(e,s){if(r.options){var o=r.options;return"int"===r.type&&(o=a.a.map(o,function(t){return t.toString()})),o}t.$apply(function(){t.handleEvent({$event:{name:"get-param-options",param:r}}).then(function(t){var e=a.a.map(t,function(t){return a.a.escape(t.value)});-1===a.a.indexOf(e,i.params[n])&&e.unshift(a.a.escape(i.params[n])),s(e)})})},minLength:0,items:1e3,updater:function(t){return(t=a.a.unescape(t))===i.params[n]?(clearTimeout(u),e.focus(),t):t}});var s=e.data("typeahead");s.lookup=function(){this.query=this.$element.val()||"";var t=this.source(this.query,l.a.proxy(this.process,this));return t?this.process(t):t},c&&(s.lookup=a.a.debounce(s.lookup,500,{leading:!0}))}}(b,n,h)}})}t.partActions=[],t.showActionsMenu=function(){t.handleEvent({$event:{name:"get-part-actions"}}).then(function(e){t.partActions=e})},t.triggerPartAction=function(e){t.handleEvent({$event:{name:"action",action:e}})},o.empty(),g()}}}function Lt(t){var e=this.query;return""===e||("/"===e[0]&&(e=e.substring(1)),"/"===e[e.length-1]&&(e=e.substring(0,e.length-1)),t.toLowerCase().match(e.toLowerCase()))}i.c.directive("sqlPartEditor",qt);var Rt=function(){function t(t,e,r,n,i){var s=this;this.$scope=t,this.$sce=r,this.templateSrv=n,this.$q=i,this.inputElement=e.find("input").first(),this.linkElement=e.find("a").first(),this.linkMode=!0,this.cancelBlur=null,t.$watch("ctrl.model",this.modelChanged.bind(this)),this.labelMode?this.cssClasses="gf-form-label "+this.cssClass:this.cssClasses="gf-form-input gf-form-input--dropdown "+this.cssClass,this.placeholder&&this.inputElement.attr("placeholder",this.placeholder),this.inputElement.attr("data-provide","typeahead"),this.inputElement.typeahead({source:this.typeaheadSource.bind(this),minLength:0,items:1e4,updater:this.typeaheadUpdater.bind(this),matcher:Lt});var o=this.inputElement.data("typeahead");o.lookup=function(){this.query=this.$element.val()||"",this.source(this.query,this.process.bind(this))},this.debounce&&(o.lookup=a.a.debounce(o.lookup,500,{leading:!0})),this.linkElement.keydown(function(t){40!==t.keyCode&&13!==t.keyCode||s.linkElement.click()}),this.inputElement.keydown(function(t){13===t.keyCode&&setTimeout(function(){s.inputElement.blur()},300)}),this.inputElement.blur(this.inputBlur.bind(this)),this.startOpen&&setTimeout(this.open.bind(this),0)}return t.$inject=["$scope","$element","$sce","templateSrv","$q"],t.prototype.getOptionsInternal=function(t){var e=this.getOptions({$query:t});return this.isPromiseLike(e)?e:this.$q.when(e)},t.prototype.isPromiseLike=function(t){return t&&"function"==typeof t.then},t.prototype.modelChanged=function(){var t=this;a.a.isObject(this.model)?this.updateDisplay(this.model.text):this.lookupText?this.getOptionsInternal("").then(function(e){var r=a.a.find(e,{value:t.model});t.updateDisplay(r?r.text:t.model)}):this.updateDisplay(this.model)},t.prototype.typeaheadSource=function(t,e){var r=this;this.getOptionsInternal(t).then(function(t){r.optionCache=t;var n=a.a.map(t,function(t){return a.a.escape(t.text)});r.allowCustom&&""!==r.text&&-1===a.a.indexOf(n,r.text)&&n.unshift(r.text),e(n)})},t.prototype.typeaheadUpdater=function(t){return t===this.text?(clearTimeout(this.cancelBlur),this.inputElement.focus(),t):(this.inputElement.val(t),this.switchToLink(!0),t)},t.prototype.switchToLink=function(t){this.linkMode&&!t||(clearTimeout(this.cancelBlur),this.cancelBlur=null,this.linkMode=!0,this.inputElement.hide(),this.linkElement.show(),this.updateValue(this.inputElement.val()))},t.prototype.inputBlur=function(){this.cancelBlur=setTimeout(this.switchToLink.bind(this),200)},t.prototype.updateValue=function(t){var e=this;""!==(t=a.a.unescape(t))&&this.text!==t&&this.$scope.$apply(function(){var r=a.a.find(e.optionCache,{text:t});r?(a.a.isObject(e.model)?e.model=r:e.model=r.value,e.text=r.text):e.allowCustom&&(a.a.isObject(e.model)?e.model.text=e.model.value=t:e.model=t,e.text=t),e.$scope.$$postDigest(function(){e.$scope.$apply(function(){e.onChange({$option:r})})})})},t.prototype.updateDisplay=function(t){this.text=t,this.display=this.$sce.trustAsHtml(this.templateSrv.highlightVariablesAsHtml(t))},t.prototype.open=function(){this.inputElement.css("width",Math.max(this.linkElement.width(),80)+16+"px"),this.inputElement.show(),this.inputElement.focus(),this.linkElement.hide(),this.linkMode=!1;var t=this.inputElement.data("typeahead");t&&(this.inputElement.val(""),t.lookup())},t}(),jt='\n<input type="text"\n  data-provide="typeahead"\n  class="gf-form-input"\n  spellcheck="false"\n  style="display:none">\n</input>\n<a ng-class="ctrl.cssClasses"\n   tabindex="1"\n   ng-click="ctrl.open()"\n   give-focus="ctrl.focus"\n   ng-bind-html="ctrl.display || \'&nbsp;\'">\n</a>\n';i.c.directive("gfFormDropdown",function(){return{restrict:"E",template:jt,controller:Rt,bindToController:!0,controllerAs:"ctrl",scope:{model:"=",getOptions:"&",onChange:"&",cssClass:"@",allowCustom:"@",labelMode:"@",lookupText:"@",placeholder:"@",startOpen:"@",debounce:"@"}}});var Ut=function(){function t(t,e){var r=t.inspector;t.init=function(){t.editor={index:0},r.error&&(a.a.isString(r.error.data)?t.response=l()("<div>"+r.error.data+"</div>").text():r.error.data?r.error.data.response?t.response=e(r.error.data.response):t.response=f.a.toJson(r.error.data,!0):r.error.message&&(t.message=r.error.message),r.error.config&&r.error.config.params&&(t.request_parameters=a.a.map(r.error.config.params,function(t,e){return{key:e,value:t}})),r.error.stack&&(t.editor.index=3,t.stack_trace=r.error.stack,t.message=r.error.message),r.error.config&&r.error.config.data&&(t.editor.index=2,a.a.isString(r.error.config.data)?t.request_parameters=this.getParametersFromQueryString(r.error.config.data):t.request_parameters=a.a.map(r.error.config.data,function(t,e){return{key:e,value:f.a.toJson(t,!0)}})))}}return t.$inject=["$scope","$sanitize"],t.prototype.getParametersFromQueryString=function(t){for(var e=[],r=t.split("&"),n=0;n<r.length;n++){var a=r[n].split("=");a[1].length>0&&e.push({key:a[0],value:window.unescape(a[1])})}return e},t}();i.c.controller("InspectCtrl",Ut);var Vt=function(){function t(t){t.json=f.a.toJson(t.model.object,!0),t.canUpdate=void 0!==t.model.updateHandler&&t.contextSrv.isEditor,t.canCopy=t.model.enableCopy,t.update=function(){var e=f.a.fromJson(t.json);t.model.updateHandler(e,t.model.object)},t.getContentForClipboard=function(){return t.json}}return t.$inject=["$scope"],t}();i.c.controller("JsonEditorCtrl",Vt);var Bt=function(){function t(t,e,r,n){t.formModel={user:"",email:"",password:"",verifyId:"",verifyValue:""},t.identificationNumberPic="1234",t.command={},t.result="",t.loggingIn=!1,r.sidemenu=!1,t.oauth=Q.a.oauth,t.oauthEnabled=a.a.keys(Q.a.oauth).length>0,t.ldapEnabled=Q.a.ldapEnabled,t.authProxyEnabled=Q.a.authProxyEnabled,t.disableLoginForm=Q.a.disableLoginForm,t.disableUserSignUp=Q.a.disableUserSignUp,t.loginHint=Q.a.loginHint,t.verificationCode=Q.a.verificationCode,t.loginMode=!0,t.submitBtnText="登录",t.init=function(){t.$watch("loginMode",t.loginModeChanged),Q.a.loginError&&t.appEvent("alert-warning",["登录失败",Q.a.loginError])},t.submit=function(){t.loginMode?t.login():t.signUp()},t.changeView=function(){var t=document.querySelector("#login-view"),e=document.querySelector("#change-password-view");t.className+=" add",setTimeout(function(){t.className+=" hidden"},250),setTimeout(function(){e.classList.remove("hidden")},251),setTimeout(function(){e.classList.remove("remove")},301),setTimeout(function(){document.getElementById("newPassword").focus()},400)},t.passwordPattern=function(){return{test:function(t){if(t.indexOf(" ")>-1)return!1;var e=0;return function(t){return!!t&&!!/[a-z]/.test(t)}(t)&&e++,function(t){return!!t&&!!/[A-Z]/.test(t)}(t)&&e++,function(t){return!!t&&!!/[0-9]/.test(t)}(t)&&e++,function(t){return""!=t&&new RegExp("[`~!@#$^&*%()_+=|{}':;',\\-\\[\\].<>/?~！@#￥……&*（）——|{}【】‘；：”“'。，、？]").test(t)}(t)&&e++,e>2}}}(),t.changePassword=function(){t.passwordForm.$valid&&(t.command.oldPassword!==t.command.newPassword?t.command.newPassword===t.command.confirmNew?e.put("/api/user/password",t.command).then(function(){t.toGrafana()}):t.appEvent("alert-warning",["新密码不匹配",""]):t.appEvent("alert-warning",["新旧密码不能相同",""]))},t.skip=function(){t.toGrafana()},t.loginModeChanged=function(e){t.submitBtnText=e?"登录":"注册"},t.signUp=function(){t.loginForm.$valid&&e.post("/api/user/signup",t.formModel).then(function(e){"SignUpCreated"===e.status?n.path("/signup").search({email:t.formModel.email}):window.location.href=Q.a.appSubUrl+"/"})},t.login=function(){delete t.loginError,t.loginForm.$valid&&(t.loggingIn=!0,e.post("/login",t.formModel).then(function(e){t.result=e,t.result.helpFlag?"admin"!==t.formModel.password||t.ldapEnabled||t.authProxyEnabled?t.toGrafana():(t.changeView(),t.refreshIdentificationNumberPic(),t.formModel.verifyValue=""):t.changeView()}).catch(function(){t.loggingIn=!1,t.refreshIdentificationNumberPic(),t.formModel.verifyValue=""}))},t.toGrafana=function(){var e=n.search();e.redirect&&"/"===e.redirect[0]?window.location.href=Q.a.appSubUrl+e.redirect:t.result.redirectUrl?window.location.href=t.result.redirectUrl:window.location.href=Q.a.appSubUrl+"/"},t.refreshIdentificationNumberPic=function(){e.get("/api/getCaptcha").then(function(e){e&&e.captchaId&&e.data&&(t.formModel.verifyId=e.captchaId,l()("#identificationNumberPic").attr("src",e.data))}).catch(function(){t.loggingIn=!1})},t.verificationCode&&t.refreshIdentificationNumberPic(),t.init()}return t.$inject=["$scope","backendSrv","contextSrv","$location"],t}();i.c.controller("LoginCtrl",Bt);var Qt=function(){function t(t,e,r,n){r.sidemenu=!1,t.formModel={},t.navModel={main:{icon:"gicon gicon-branding",text:"Invite",subTitle:"Register your Grafana account",breadcrumbs:[{title:"Login",url:"login"}]}},t.init=function(){n.get("/api/user/invite/"+e.code).then(function(r){t.formModel.name=r.name,t.formModel.email=r.email,t.formModel.username=r.email,t.formModel.inviteCode=e.code,t.greeting=r.name||r.email||r.username,t.invitedBy=r.invitedBy})},t.submit=function(){t.inviteForm.$valid&&n.post("/api/user/invite/complete",t.formModel).then(function(){window.location.href=Q.a.appSubUrl+"/"})},t.init()}return t.$inject=["$scope","$routeParams","contextSrv","backendSrv"],t}();i.c.controller("InvitedCtrl",Qt);var Ht=function(){function t(t,e,r,n){this.$scope=t,this.backendSrv=e,n.sidemenu=!1,t.ctrl=this,t.formModel={};var a=r.search();!a.email||a.email.match(/^\S+@\S+$/)?(t.formModel.orgName=a.email,t.formModel.email=a.email,t.formModel.username=a.email,t.formModel.code=a.code,t.verifyEmailEnabled=!1,t.autoAssignOrg=!1,t.navModel={main:{icon:"gicon gicon-branding",text:"注册",subTitle:"注册您的KAM用户",breadcrumbs:[{title:"登录",url:"login"}]}},e.get("/api/user/signup/options").then(function(e){t.verifyEmailEnabled=e.verifyEmailEnabled,t.autoAssignOrg=e.autoAssignOrg})):console.log("invalid email")}return t.$inject=["$scope","backendSrv","$location","contextSrv"],t.prototype.submit=function(){this.$scope.signUpForm.$valid&&this.backendSrv.post("/api/user/signup/step2",this.$scope.formModel).then(function(t){"redirect-to-select-org"===t.code?window.location.href=Q.a.appSubUrl+"/profile/select-org?signup=1":window.location.href=Q.a.appSubUrl+"/"})},t}();i.c.controller("SignUpCtrl",Ht);var zt=function(){function t(t,e,r,n){e.sidemenu=!1,t.formModel={},t.mode="send";var a=n.search();a.code&&(t.mode="reset",t.formModel.code=a.code),t.navModel={main:{icon:"gicon gicon-branding",text:"重置密码",subTitle:"重置你的KAM密码",breadcrumbs:[{title:"登录",url:"login"}]}},t.sendResetEmail=function(){t.sendResetForm.$valid&&r.post("/api/user/password/send-reset-email",t.formModel).then(function(){t.mode="email-sent"})},t.submitReset=function(){t.resetForm.$valid&&(t.formModel.newPassword===t.formModel.confirmPassword?r.post("/api/user/password/reset",t.formModel).then(function(){n.path("login")}):t.appEvent("alert-warning",["New passwords do not match",""]))}}return t.$inject=["$scope","contextSrv","backendSrv","$location"],t}();i.c.controller("ResetPasswordCtrl",zt);var Gt=function(){function t(t,e,r){t.navModel=r.getNotFoundNav(),t.appSubUrl=Q.a.appSubUrl,e.isSignedIn||kt.a.emit("toggle-sidemenu-hidden"),t.$on("destroy",function(){e.isSignedIn||kt.a.emit("toggle-sidemenu-hidden")})}return t.$inject=["$scope","contextSrv","navModelSrv"],t}();i.c.controller("ErrorCtrl",Gt);var Wt=function(){function t(){}return t.prototype.set=function(){console.log("old depricated alert srv being used")},t}();i.c.service("alertSrv",Wt);var Yt=function(){function t(t,e){this.$rootScope=t,this.$modal=e}return t.$inject=["$rootScope","$modal"],t.prototype.init=function(){kt.a.on("show-modal",this.showModal.bind(this),this.$rootScope),kt.a.on("hide-modal",this.hideModal.bind(this),this.$rootScope),kt.a.on("confirm-modal",this.showConfirmModal.bind(this),this.$rootScope)},t.prototype.hideModal=function(){this.modalScope&&this.modalScope.dismiss&&this.modalScope.dismiss()},t.prototype.showModal=function(t){this.modalScope&&this.modalScope.dismiss&&this.modalScope.dismiss(),this.modalScope=t.scope,t.model?(this.modalScope=this.$rootScope.$new(),this.modalScope.model=t.model):this.modalScope||(this.modalScope=this.$rootScope.$new());var e=this.$modal({modalClass:t.modalClass,template:t.src,templateHtml:t.templateHtml,persist:!1,show:!1,scope:this.modalScope,keyboard:!1,backdrop:t.backdrop});Promise.resolve(e).then(function(t){t.modal("show")})},t.prototype.showConfirmModal=function(t){var e=this.$rootScope.$new();e.onConfirm=function(){t.onConfirm(),e.dismiss()},e.updateConfirmText=function(r){e.confirmTextValid=t.confirmText.toLowerCase()===r.toLowerCase()},e.title=t.title,e.text=t.text,e.text2=t.text2,e.confirmText=t.confirmText,e.onConfirm=t.onConfirm,e.onAltAction=t.onAltAction,e.altActionText=t.altActionText,e.icon=t.icon||"fa-check",e.yesText=t.yesText||"同意",e.noText=t.noText||"取消",e.confirmTextValid=!e.confirmText,kt.a.emit("show-modal",{src:"public/app/partials/confirm_modal.html",scope:e,modalClass:"confirm-modal"})},t}();i.c.service("utilSrv",Yt);var Kt=function(){function t(t){this.$timeout=t,this.timers=[]}return t.$inject=["$timeout"],t.prototype.register=function(t){return this.timers.push(t),t},t.prototype.cancel=function(t){this.timers=a.a.without(this.timers,t),this.$timeout.cancel(t)},t.prototype.cancelAll=function(){var t=this;a.a.each(this.timers,function(e){t.$timeout.cancel(e)}),this.timers=[]},t}();i.c.service("timer",Kt);var Jt=function(){function t(t,e){this.$rootScope=t,this.$location=e}return t.$inject=["$rootScope","$location"],t.prototype.gaInit=function(){l.a.ajax({url:"https://www.google-analytics.com/analytics.js",dataType:"script",cache:!0});var t=window.ga=window.ga||function(){(t.q=t.q||[]).push(arguments)};return t.l=+new Date,t("create",Q.a.googleAnalyticsId,"auto"),t("set","anonymizeIp",!0),t},t.prototype.init=function(){var t=this;this.$rootScope.$on("$viewContentLoaded",function(){var e={page:t.$location.url()},r=window.ga||t.gaInit();r("set",e),r("send","pageview")})},t}();function Xt(t){Q.a.googleAnalyticsId&&t.init()}function Zt(t,e,r){var n=null;this.close=function(){n&&n.close()},this.show=function(i){n&&(n.close(),n=null);var s,o=a.a.extend(e.$new(!0),i.model);o.dismiss=function(){s.close()};var l=document.createElement("div");return l.innerHTML=i.template,t(l)(o),r(function(){(s=new lt.a({target:i.element,content:l,position:i.position,classes:i.classNames||"drop-popover",openOn:i.openOn,hoverCloseDelay:200,tetherOptions:{constraints:[{to:"scrollParent",attachment:"together"}]}})).on("close",function(){setTimeout(function(){o.$destroy(),s.tether&&s.destroy(),i.onClose&&i.onClose()}),n=null}),(n=s).open()},100),function(){s&&s.close()}}}function te(t,e){var r=this;function n(r){return"*"===r||"*"===r.value?(this.value="*",this.html=t.trustAsHtml('<i class="fa fa-asterisk"><i>'),this.type=r.type,void(this.expandable=!0)):a.a.isString(r)?(this.value=r,void(this.html=t.trustAsHtml(e.highlightVariablesAsHtml(this.value)))):(this.text=r.value,this.cssClass=r.cssClass,this.custom=r.custom,this.type=r.type,this.fake=r.fake,this.value=r.value,this.selectMode=r.selectMode,this.type=r.type,this.expandable=r.expandable,void(this.html=r.html||t.trustAsHtml(e.highlightVariablesAsHtml(this.value))))}this.getSegmentForValue=function(t,e){return t?this.newSegment(t):this.newSegment({value:e,fake:!0})},this.newSelectMeasurement=function(){return new n({value:"select measurement",fake:!0})},this.newFake=function(t,e,r){return new n({value:t,fake:!0,type:e,cssClass:r})},this.newSegment=function(t){return new n(t)},this.newKey=function(t){return new n({value:t,type:"key",cssClass:"query-segment-key"})},this.newKeyValue=function(t){return new n({value:t,type:"value",cssClass:"query-segment-value"})},this.newCondition=function(t){return new n({value:t,type:"condition",cssClass:"query-keyword"})},this.newOperator=function(t){return new n({value:t,type:"operator",cssClass:"query-segment-operator"})},this.newOperators=function(t){return a.a.map(t,function(t){return new n({value:t,type:"operator",cssClass:"query-segment-operator"})})},this.transformToSegments=function(t,n){return function(i){var s=a.a.map(i,function(t){return r.newSegment({value:t.text,expandable:t.expandable})});return t&&a.a.each(e.variables,function(t){void 0!==n&&n!==t.type||s.unshift(r.newSegment({type:"value",value:"$"+t.name,expandable:!0}))}),s}},this.newSelectMetric=function(){return new n({value:"select metric",fake:!0})},this.newPlusButton=function(){return new n({fake:!0,html:'<i class="fa fa-plus "></i>',type:"plus-button",cssClass:"query-part"})}}i.c.service("googleAnalyticsSrv",Jt).run(Xt),i.c.service("popoverSrv",Zt),i.c.service("uiSegmentSrv",te);r(15);var ee=function(){function t(t){this.$compile=t}return t.$inject=["$compile"],t.prototype.addDirective=function(t,e,r){var n=f.a.element(document.createElement(e));this.$compile(n)(r),t.empty(),t.append(n)},t.prototype.link=function(t,e,r,n){var a=n.directive(t);a&&a.fn?(a.fn.registered||(i.c.directive(r.$normalize(a.name),a.fn),a.fn.registered=!0),this.addDirective(e,a.name,t)):e.empty()},t.prototype.create=function(t){var e=this;return{restrict:"E",scope:t.scope,link:function(r,n,a){if(t.watchPath){var i=null;r.$watch(t.watchPath,function(){i&&i.$destroy(),i=r.$new(),e.link(i,n,a,t)})}else e.link(r,n,a,t)}}},t}();i.c.service("dynamicDirectiveSrv",ee);var re=r(51),ne=r(55),ae=r(44),ie=function(){function t(t,e,r,n,a){this.$location=t,this.$timeout=e,this.$window=r,this.$rootScope=n,this.$route=a,this.fullPageReloadRoutes=["/logout"]}return t.$inject=["$location","$timeout","$window","$rootScope","$route"],t.prototype.init=function(){var t=this;this.$rootScope.$on("$routeUpdate",function(e,r){var n=t.$location.url();re.b.getState().location.url!==n&&re.b.dispatch(Object(ae.c)({path:t.$location.path(),query:t.$location.search(),routeParams:t.$route.current.params}))}),this.$rootScope.$on("$routeChangeSuccess",function(e,r){re.b.dispatch(Object(ae.c)({path:t.$location.path(),query:t.$location.search(),routeParams:t.$route.current.params}))}),re.b.subscribe(function(){var e=re.b.getState(),r=t.$location.url(),n=ne.a.stripBaseFromUrl(e.location.url);r!==n&&(t.$timeout(function(){t.$location.url(n)}),console.log("store updating angular $location.url",n))}),kt.a.on("location-change",function(e){var r=ne.a.stripBaseFromUrl(e.href);t.fullPageReloadRoutes.indexOf(r)>-1?t.$window.location.href=e.href:t.$timeout(function(){t.$location.url(r)})})},t}();i.c.service("bridgeSrv",ie);var se=function(){function t(){this.ALERT_LEVEL={A:{code:"A",name:"正常",grade:1,color:"rgba(14, 147, 24, 0.97)"},B:{code:"B",name:"警告",grade:2,color:"rgba(205, 126, 2, 0.89)"},C:{code:"C",name:"危险",grade:3,color:"rgba(168, 34, 42, 0.9)"}},this.CODE_LEVEL_MAP={1:"A",2:"B",3:"C",4:"C"}}return t.prototype.getLevel=function(t){var e=this.CODE_LEVEL_MAP[t];if(e)return this.ALERT_LEVEL[e]},t.prototype.getLevelName=function(t){var e=this.getLevel(t);return e?e.name:null},t.prototype.getLevelColor=function(t,e){if(!a.a.isEmpty(e)){var r=e[this.CODE_LEVEL_MAP[t]];if(r){if(r.useOrigin)return null;if(r.color)return r.color}}var n=this.getLevel(t);return n?n.color:null},t.prototype.getAllLevels=function(){return this.ALERT_LEVEL},t.prototype.maxLevelOriginCode=function(t){var e=this;return a.a.maxBy(t,function(t){var r=e.CODE_LEVEL_MAP[t];return r?e.ALERT_LEVEL[r].grade:null})},t}();i.c.service("ogeAlertSrv",se);var oe=r(4),le=r.n(oe);function ce(t){var e=function(e,r){var n;return n=r.ctrl?(r.ctrl.panel||r.ctrl.row).scopedVars:r.row.scopedVars,t.replaceWithText(e,n)};return e.$stateful=!0,e}i.c.filter("stringSort",function(){return function(t){return t.sort()}}),i.c.filter("slice",function(){return function(t,e,r){if(!a.a.isUndefined(t))return t.slice(e,r)}}),i.c.filter("stringify",function(){return function(t){return a.a.isObject(t)&&!a.a.isArray(t)?f.a.toJson(t):a.a.isNull(t)?null:t.toString()}}),i.c.filter("moment",function(){return function(t,e){switch(e){case"ago":return le()(t).fromNow()}return le()(t).fromNow()}}),i.c.filter("noXml",function(){var t=function(t){return a.a.isString(t)?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;"):t};return function(e){return a.a.isArray(e)?a.a.map(e,t):t(e)}}),i.c.filter("interpolateTemplateVars",ce);r(31),r(209);var ue=r(353),de=r(258),pe=r.n(de),he=(r(1044),function(){function t(t,e,r,n,a,i){var s=this;this.$rootScope=t,this.$location=e,this.$timeout=r,this.datasourceSrv=n,this.timeSrv=a,this.contextSrv=i,this.modalOpen=!1,this.timepickerOpen=!1,t.$on("$routeChangeSuccess",function(){pe.a.reset(),s.setupGlobal()}),this.setupGlobal(),kt.a.on("show-modal",function(){return s.modalOpen=!0}),kt.a.on("timepickerOpen",function(){return s.timepickerOpen=!0}),kt.a.on("timepickerClosed",function(){return s.timepickerOpen=!1})}return t.$inject=["$rootScope","$location","$timeout","datasourceSrv","timeSrv","contextSrv"],t.prototype.setupGlobal=function(){this.bind(["?","h"],this.showHelpModal),this.bind("g h",this.goToHome),this.bind("g a",this.openAlerting),this.bind("g p",this.goToProfile),this.bind("s s",this.openSearchStarred),this.bind("s o",this.openSearch),this.bind("s t",this.openSearchTags),this.bind("f",this.openSearch),this.bindGlobal("esc",this.exit)},t.prototype.openSearchStarred=function(){kt.a.emit("show-dash-search",{starred:!0})},t.prototype.openSearchTags=function(){kt.a.emit("show-dash-search",{tagsMode:!0})},t.prototype.openSearch=function(){kt.a.emit("show-dash-search")},t.prototype.openAlerting=function(){this.$location.url("/alerting")},t.prototype.goToHome=function(){this.$location.url("/")},t.prototype.goToProfile=function(){this.$location.url("/profile")},t.prototype.showHelpModal=function(){kt.a.emit("show-modal",{templateHtml:"<help-modal></help-modal>"})},t.prototype.exit=function(){if(!(l()(".popover.in").length>0))if(kt.a.emit("hide-modal"),this.modalOpen)this.modalOpen=!1;else{if(this.timepickerOpen)return this.$rootScope.appEvent("closeTimepicker"),void(this.timepickerOpen=!1);var t=this.$location.search();if(t.editview)return delete t.editview,void this.$location.search(t);t.fullscreen?this.$rootScope.appEvent("panel-change-view",{fullscreen:!1,edit:!1}):t.kiosk&&this.$rootScope.appEvent("toggle-kiosk-mode",{exit:!0})}},t.prototype.bind=function(t,e){var r=this;pe.a.bind(t,function(t){return t.preventDefault(),t.stopPropagation(),t.returnValue=!1,r.$rootScope.$apply(e.bind(r))},"keydown")},t.prototype.bindGlobal=function(t,e){var r=this;pe.a.bindGlobal(t,function(t){return t.preventDefault(),t.stopPropagation(),t.returnValue=!1,r.$rootScope.$apply(e.bind(r))},"keydown")},t.prototype.showDashEditView=function(){var t=a.a.extend(this.$location.search(),{editview:"settings"});this.$location.search(t)},t.prototype.setupDashboardBindings=function(t,e){var r=this;this.bind("mod+o",function(){e.graphTooltip=(e.graphTooltip+1)%3,kt.a.emit("graph-hover-clear"),e.startRefresh()}),this.bind("mod+s",function(e){t.appEvent("save-dashboard")}),this.bind("t z",function(){t.appEvent("zoom-out",2)}),this.bind("ctrl+z",function(){t.appEvent("zoom-out",2)}),this.bind("t left",function(){t.appEvent("shift-time-backward")}),this.bind("t right",function(){t.appEvent("shift-time-forward")}),this.bind("e",function(){e.meta.focusPanelId&&e.meta.canEdit&&r.$rootScope.appEvent("panel-change-view",{fullscreen:!0,edit:!0,panelId:e.meta.focusPanelId,toggle:!0})}),this.bind("v",function(){e.meta.focusPanelId&&r.$rootScope.appEvent("panel-change-view",{fullscreen:!0,edit:null,panelId:e.meta.focusPanelId,toggle:!0})}),this.contextSrv.isEditor&&Q.a.exploreEnabled&&this.bind("x",function(){return rt.b(r,void 0,void 0,function(){var t,r,n,a=this;return rt.d(this,function(i){switch(i.label){case 0:return e.meta.focusPanelId?(t=e.getPanelById(e.meta.focusPanelId),[4,this.datasourceSrv.get(t.datasource)]):[3,3];case 1:return r=i.sent(),[4,Object(ue.b)(t,t.targets,r,this.datasourceSrv,this.timeSrv)];case 2:(n=i.sent())&&this.$timeout(function(){return a.$location.url(n)}),i.label=3;case 3:return[2]}})})}),this.bind("p r",function(){e.meta.focusPanelId&&e.meta.canEdit&&(r.$rootScope.appEvent("panel-remove",{panelId:e.meta.focusPanelId}),e.meta.focusPanelId=0)}),this.bind("p d",function(){if(e.meta.focusPanelId&&e.meta.canEdit){var t=e.getPanelInfoById(e.meta.focusPanelId).index;e.duplicatePanel(e.panels[t])}}),this.bind("p s",function(){if(e.meta.focusPanelId){var r=t.$new(),n=e.getPanelInfoById(e.meta.focusPanelId);r.panel=n.panel,r.dashboard=e,kt.a.emit("show-modal",{src:"public/app/features/dashboard/partials/shareModal.html",scope:r})}}),this.bind("p l",function(){if(e.meta.focusPanelId&&e.getPanelInfoById(e.meta.focusPanelId).panel.legend){var t=e.getPanelById(e.meta.focusPanelId);t.legend.show=!t.legend.show,t.refresh()}}),this.bind("d shift+c",function(){e.collapseRows()}),this.bind("d shift+e",function(){e.expandRows()}),this.bind("d n",function(t){r.$location.url("/dashboard/new")}),this.bind("d r",function(){e.startRefresh()}),this.bind("d s",function(){r.showDashEditView()}),this.bind("d k",function(){kt.a.emit("toggle-kiosk-mode")}),this.bind("d v",function(){kt.a.emit("toggle-view-mode")}),this.bind("d a",function(){window.location.href=window.location.href+"&autofitpanels"})},t}());i.c.service("keybindingSrv",he);var fe=function(){function t(){this.tabIndex=0,this.shortcuts={Global:[{keys:["g","h"],description:"跳转主页仪表盘"},{keys:["g","p"],description:"跳转配置页面"},{keys:["s","o"],description:"搜索仪表盘"},{keys:["s","s"],description:"打开标星过滤搜索"},{keys:["s","t"],description:"打开标签页搜索"},{keys:["esc"],description:"退出编辑/设置页面"}],Dashboard:[{keys:["mod+s"],description:"保存仪表盘"},{keys:["d","r"],description:"刷新所有面板"},{keys:["d","s"],description:"仪表盘设置"},{keys:["d","v"],description:"切换 in-active / view 模式"},{keys:["d","k"],description:"切换 kiosk 模式 (隐藏顶部导航)"},{keys:["d","E"],description:"展开所有行"},{keys:["d","C"],description:"折叠所有行"},{keys:["d","a"],description:"切换自动贴合面板(实验功能)"},{keys:["mod+o"],description:"切换共享 graph crosshair"}],"Focused Panel":[{keys:["e"],description:"切换面板编辑视图"},{keys:["v"],description:"切换面板全屏视图"},{keys:["p","s"],description:"开放面板共享模式"},{keys:["p","d"],description:"复制面板"},{keys:["p","r"],description:"删除面板"},{keys:["p","l"],description:"切换面板的说明"}],"Time Range":[{keys:["t","z"],description:"缩小时间范围"},{keys:["t",'<i class="fa fa-long-arrow-left"></i>'],description:"将时间范围向后移动"},{keys:["t",'<i class="fa fa-long-arrow-right"></i>'],description:"将时间范围向前移动"}]}}return t.prototype.dismiss=function(){kt.a.emit("hide-modal")},t}();i.c.directive("helpModal",function(){return{restrict:"E",templateUrl:"public/app/core/components/help/help.html",controller:fe,bindToController:!0,transclude:!0,controllerAs:"ctrl",scope:{}}});var me=function(){return function(){this.breadcrumbs=[]}}(),ge=function(){function t(){this.navItems=Q.a.bootData.navTree}return t.prototype.getCfgNode=function(){return a.a.find(this.navItems,{id:"cfg"})},t.prototype.getNav=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=this.navItems,n=new me,i=0,s=t;i<s.length;i++){var o=s[i];if(a.a.isNumber(o)){n.main=n.breadcrumbs[o];break}var l=a.a.find(r,{id:o});n.breadcrumbs.push(l),n.node=l,n.main=l,r=l.children}if(n.main.children)for(var c=0,u=n.main.children;c<u.length;c++){var d=u[c];d.active=!1,d.url===n.node.url&&(d.active=!0)}return n},t.prototype.getNotFoundNav=function(){var t={text:"未发现页面",icon:"fa fa-fw fa-warning",subTitle:"404 错误"};return{breadcrumbs:[t],node:t,main:t}},t}();i.c.service("navModelSrv",ge);var ve=r(170),be=r.n(ve),ye='\n<div class="baron__track">\n  <div class="baron__bar"></div>\n</div>\n',we="baron baron__root",xe="baron__scroller";i.c.directive("grafanaScrollbar",function(){return{restrict:"A",link:function(t,e,r){var n=e.parent(),a=e;console.log("scroll"),r.grafanaScrollbar&&"scrollonroot"===r.grafanaScrollbar&&(n=a),n.addClass(we),l()(ye).appendTo(n),e.addClass(xe);var i={root:n[0],scroller:a[0],bar:".baron__bar",barOnCls:"_scrollbar",scrollingCls:"_scrolling",track:".baron__track",direction:"v"},s=be()(i);t.$on("$destroy",function(){s.dispose()})}}}),i.c.directive("pageScrollbar",function(){return{restrict:"A",link:function(t,e,r){var n=0;kt.a.on("dash-scroll",function(t){t.restore?e[0].scrollTop=n:(n=e[0].scrollTop,t.animate?e.animate({scrollTop:t.pos},500):e[0].scrollTop=t.pos)},t),t.$on("$routeChangeSuccess",function(){n=0,e[0].scrollTop=0,e[0].focus({preventScroll:!0})}),e[0].tabIndex=-1,e[0].focus({preventScroll:!0})}}});var Se='\n<div class="scroll-canvas">\n  <navbar model="model"></navbar>\n   <div class="page-container">\n\t\t<div class="page-header">\n      <h1>\n         <i class="{{::model.node.icon}}" ng-if="::model.node.icon"></i>\n         <img ng-src="{{::model.node.img}}" ng-if="::model.node.img"></i>\n         {{::model.node.text}}\n       </h1>\n\n      <div class="page-header__actions" ng-transclude="header"></div>\n\t\t</div>\n\n    <div class="page-body" ng-transclude="body">\n    </div>\n  </div>\n</div>\n';i.c.directive("gfPage",function(){return{restrict:"E",template:Se,scope:{model:"="},transclude:{header:"?gfPageHeader",body:"gfPageBody"},link:function(t,e,r){console.log(t)}}});var ke='\n<div class="modal-body">\n\t<div class="modal-header">\n\t\t<h2 class="modal-header-title">\n\t\t\t<i class="fa fa-random"></i>\n\t\t\t<span class="p-l-1">切换组织</span>\n\t\t</h2>\n\n\t\t<a class="modal-header-close" ng-click="ctrl.dismiss();">\n\t\t\t<i class="fa fa-remove"></i>\n\t\t</a>\n\t</div>\n\n  <div class="modal-content modal-content--has-scroll" grafana-scrollbar>\n    <table class="filter-table form-inline">\n\t\t\t<thead>\n\t\t\t\t<tr>\n\t\t\t\t\t<th>名称</th>\n\t\t\t\t\t<th>角色</th>\n\t\t\t\t\t<th></th>\n\t\t\t\t</tr>\n\t\t\t</thead>\n\t\t\t<tbody>\n\t\t\t\t<tr ng-repeat="org in ctrl.orgs">\n\t\t\t\t\t<td>{{org.name}}</td>\n\t\t\t\t\t<td>{{org.role}}</td>\n\t\t\t\t\t<td class="text-right">\n\t\t\t\t\t\t<span class="btn btn-primary btn-mini" ng-show="org.orgId === ctrl.currentOrgId">\n\t\t\t\t\t\t\t现在\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<a ng-click="ctrl.setUsingOrg(org)" class="btn btn-inverse btn-mini" ng-show="org.orgId !== ctrl.currentOrgId">\n\t\t\t\t\t\t\t切换到\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</tbody>\n\t\t</table>\n\t</div>\n</div>',Ce=function(){function t(t){this.backendSrv=t,this.currentOrgId=ft.a.user.orgId,this.getUserOrgs()}return t.$inject=["backendSrv"],t.prototype.getUserOrgs=function(){var t=this;this.backendSrv.get("/api/user/orgs").then(function(e){t.orgs=e})},t.prototype.setUsingOrg=function(t){var e=this;return this.backendSrv.post("/api/user/using/"+t.orgId).then(function(){e.setWindowLocation(Q.a.appSubUrl+(Q.a.appSubUrl.endsWith("/")?"":"/")+"?orgId="+t.orgId)})},t.prototype.setWindowLocation=function(t){window.location.href=t},t}();i.c.directive("orgSwitcher",function(){return{restrict:"E",template:ke,controller:Ce,bindToController:!0,controllerAs:"ctrl",scope:{dismiss:"&"}}});var Te=r(236),Ee=function(t){function e(e){return t.call(this,e)||this}return rt.c(e,t),e.prototype.render=function(){var t=this.props.password,e="strength: strong like a bull.",r="password-strength-good";return t?(t.length<=8&&(e="strength: you can do better.",r="password-strength-ok"),t.length<4&&(e="strength: weak sauce.",r="password-strength-bad"),at.a.createElement("div",{className:"password-strength small "+r},at.a.createElement("em",null,e))):null},e}(at.a.Component),_e=r(32),Me=r(117),Ae=r(16),Pe=r.n(Ae),$e=function(t){function e(e){var r=t.call(this,e)||this;return r.state={search:""},r}return rt.c(e,t),e.prototype.render=function(){return this.state.search.sections.map(function(t){return at.a.createElement(De,{section:t,key:t.id})})},e}(at.a.Component),De=function(t){function e(e){var r=t.call(this,e)||this;return r.toggleSection=function(){r.props.section.toggle()},r}return rt.c(e,t),e.prototype.renderItem=function(t){return at.a.createElement("a",{className:"search-item",href:t.url,key:t.id},at.a.createElement("span",{className:"search-item__icon"},at.a.createElement("i",{className:"fa fa-th-large"})),at.a.createElement("span",{className:"search-item__body"},at.a.createElement("div",{className:"search-item__body-title"},t.title)))},e.prototype.render=function(){var t=Pe()({fa:!0,"fa-plus":!this.props.section.expanded,"fa-minus":this.props.section.expanded,"search-section__header__toggle":!0});return at.a.createElement("div",{className:"search-section",key:this.props.section.id},at.a.createElement("div",{className:"search-section__header"},at.a.createElement("i",{className:Pe()("search-section__header__icon",this.props.section.icon)}),at.a.createElement("span",{className:"search-section__header__text"},this.props.section.title),at.a.createElement("i",{className:t,onClick:this.toggleSection})),this.props.section.expanded&&at.a.createElement("div",{className:"search-section__items"},this.props.section.items.map(this.renderItem)))},e}(at.a.Component),Oe=r(171),Ie=r.n(Oe),Ne=r(61),Fe=r(172),qe=function(t){var e=t.data,r=t.className,n=t.label;return at.a.createElement(Ne.a.Option,rt.a({},t),at.a.createElement("div",{className:"tag-filter-option btn btn-link "+(r||"")},at.a.createElement(Fe.a,{label:n,removeIcon:!1,count:e.count})))},Le=r(112),Re=r(113),je=r(97),Ue=function(t){function e(e){var r=t.call(this,e)||this;return r.onLoadOptions=function(t){return r.props.tagOptions().then(function(t){return t.map(function(t){return{value:t.term,label:t.term,count:t.count}})})},r.onChange=function(t){r.props.onChange(t.map(function(t){return t.value}))},r}return rt.c(e,t),e.prototype.render=function(){var t=this.props.tags.map(function(t){return{value:t,label:t,count:0}}),e={classNamePrefix:"gf-form-select-box",isMulti:!0,defaultOptions:!0,loadOptions:this.onLoadOptions,onChange:this.onChange,className:"gf-form-input gf-form-input--form-dropdown",placeholder:"标签",loadingMessage:function(){return"加载中..."},noOptionsMessage:function(){return"没有发现标签"},getOptionValue:function(t){return t.value},getOptionLabel:function(t){return t.label},value:t,styles:je.a,filterOption:function(t,e){return RegExp(e,"i").test(t.value)},components:{Option:qe,IndicatorsContainer:Le.a,NoOptionsMessage:Re.a,MultiValueLabel:function(){return null},MultiValueRemove:function(t){var e=t.data;return at.a.createElement(Ne.a.MultiValueRemove,rt.a({},t),at.a.createElement(Fe.a,{key:e.label,label:e.label,removeIcon:!0,count:e.count}))}}};return at.a.createElement("div",{className:"gf-form gf-form--has-input-icon gf-form--grow"},at.a.createElement("div",{className:"tag-filter"},at.a.createElement(Ie.a,rt.a({},e))),at.a.createElement("i",{className:"gf-form-input-icon fa fa-tag"}))},e}(at.a.Component),Ve=function(t){var e=t.child,r=e.divider?"divider":"";return at.a.createElement("li",{className:r},at.a.createElement("a",{href:e.url},e.icon&&at.a.createElement("i",{className:e.icon}),e.text))},Be=function(t){var e=t.link;return at.a.createElement("ul",{className:"dropdown-menu dropdown-menu--sidemenu",role:"menu"},at.a.createElement("li",{className:"side-menu-header"},at.a.createElement("span",{className:"sidemenu-item-text"},e.text)),e.children&&e.children.map(function(t,e){return at.a.createElement(Ve,{child:t,key:t.url+"-"+e})}))},Qe=function(t){var e=t.link;return at.a.createElement("div",{className:"sidemenu-item dropdown"},at.a.createElement("a",{className:"sidemenu-link",href:e.url,target:e.target},at.a.createElement("span",{className:"icon-circle sidemenu-icon"},at.a.createElement("i",{className:e.icon}),e.img&&at.a.createElement("img",{src:e.img}))),e.children&&at.a.createElement(Be,{link:e}))},He=function(){var t=a.a.cloneDeep(Q.a.bootData.navTree),e=a.a.filter(t,function(t){return!t.hideFromMenu});return at.a.createElement("div",{className:"sidemenu__top"},e.map(function(t,e){return at.a.createElement(Qe,{link:t,key:t.id+"-"+e})}))},ze=function(){var t="login?redirect="+encodeURIComponent(window.location.pathname);return at.a.createElement("div",{className:"sidemenu-item"},at.a.createElement("a",{href:t,className:"sidemenu-link",target:"_self"},at.a.createElement("span",{className:"icon-circle sidemenu-icon"},at.a.createElement("i",{className:"fa fa-fw fa-sign-in"}))),at.a.createElement("a",{href:t,target:"_self"},at.a.createElement("ul",{className:"dropdown-menu dropdown-menu--sidemenu",role:"menu"},at.a.createElement("li",{className:"side-menu-header"},at.a.createElement("span",{className:"sidemenu-item-text"},"Sign In")))))},Ge=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemClicked=function(t,e){"/shortcuts"===e.url&&(t.preventDefault(),kt.a.emit("show-modal",{templateHtml:"<help-modal></help-modal>"}))},e.switchOrg=function(){kt.a.emit("show-modal",{templateHtml:'<org-switcher dismiss="dismiss()"></org-switcher>'})},e}return rt.c(e,t),e.prototype.render=function(){var t=this,e=this.props,r=e.link,n=e.user;return at.a.createElement("div",{className:"sidemenu-item dropdown dropup"},at.a.createElement("a",{href:r.url,className:"sidemenu-link",target:r.target},at.a.createElement("span",{className:"icon-circle sidemenu-icon"},r.icon&&at.a.createElement("i",{className:r.icon}),r.img&&at.a.createElement("img",{src:r.img}))),at.a.createElement("ul",{className:"dropdown-menu dropdown-menu--sidemenu",role:"menu"},r.subTitle&&at.a.createElement("li",{className:"sidemenu-subtitle"},at.a.createElement("span",{className:"sidemenu-item-text"},r.subTitle)),r.showOrgSwitcher&&at.a.createElement("li",{className:"sidemenu-org-switcher"},at.a.createElement("a",{onClick:this.switchOrg},at.a.createElement("div",null,at.a.createElement("div",{className:"sidemenu-org-switcher__org-name"},n.orgName),at.a.createElement("div",{className:"sidemenu-org-switcher__org-current"},"现在组织:")),at.a.createElement("div",{className:"sidemenu-org-switcher__switch"},at.a.createElement("i",{className:"fa fa-fw fa-random"}),"切换"))),r.children&&r.children.map(function(e,r){return e.hideFromMenu?null:at.a.createElement("li",{className:e.divider,key:e.text+"-"+r},at.a.createElement("a",{href:e.url,target:e.target,onClick:function(r){return t.itemClicked(r,e)}},e.icon&&at.a.createElement("i",{className:e.icon}),e.text))}),at.a.createElement("li",{className:"side-menu-header"},at.a.createElement("span",{className:"sidemenu-item-text"},r.text))))},e}(nt.PureComponent);function We(){var t=a.a.cloneDeep(Q.a.bootData.navTree),e=a.a.filter(t,function(t){return t.hideFromMenu}),r=ft.a.isSignedIn,n=ft.a.user;if(n&&n.orgCount>1){var i=a.a.find(e,{id:"profile"});i&&(i.showOrgSwitcher=!0)}return at.a.createElement("div",{className:"sidemenu__bottom"},!r&&at.a.createElement(ze,null),e.map(function(t,e){return at.a.createElement(Ge,{link:t,user:n,key:t.url+"-"+e})}))}var Ye=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.toggleSideMenu=function(){ft.a.toggleSideMenu(),kt.a.emit("toggle-sidemenu")},e.toggleSideMenuSmallBreakpoint=function(){kt.a.emit("toggle-sidemenu-mobile")},e}return rt.c(e,t),e.prototype.render=function(){return[at.a.createElement("div",{className:"sidemenu__logo",onClick:this.toggleSideMenu,key:"logo"},at.a.createElement("img",{src:"public/img/grafana_icon.svg",alt:"Grafana"})),at.a.createElement("div",{className:"sidemenu__logo_small_breakpoint",onClick:this.toggleSideMenuSmallBreakpoint,key:"hamburger"},at.a.createElement("i",{className:"fa fa-bars"}),at.a.createElement("span",{className:"sidemenu__close"},at.a.createElement("i",{className:"fa fa-times"})," 关闭")),at.a.createElement(He,{key:"topsection"}),at.a.createElement(We,{key:"bottomsection"})]},e}(nt.PureComponent),Ke=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return rt.c(e,t),e.prototype.shouldComponentUpdate=function(t){return this.props.appNotification.id!==t.appNotification.id},e.prototype.componentDidMount=function(){var t=this.props,e=t.appNotification,r=t.onClearNotification;setTimeout(function(){r(e.id)},e.timeout)},e.prototype.render=function(){var t=this.props,e=t.appNotification,r=t.onClearNotification;return at.a.createElement("div",{className:"alert-"+e.severity+" alert"},at.a.createElement("div",{className:"alert-icon"},at.a.createElement("i",{className:e.icon})),at.a.createElement("div",{className:"alert-body"},at.a.createElement("div",{className:"alert-title"},e.title),at.a.createElement("div",{className:"alert-text"},e.text)),at.a.createElement("button",{type:"button",className:"alert-close",onClick:function(){return r(e.id)}},at.a.createElement("i",{className:"fa fa fa-remove"})))},e}(nt.Component),Je=r(245),Xe=r(36),Ze={title:"",text:"",severity:Xe.a.Success,icon:"fa fa-check",timeout:Xe.b.Success},tr={title:"",text:"",severity:Xe.a.Warning,icon:"fa fa-exclamation",timeout:Xe.b.Warning},er={title:"",text:"",severity:Xe.a.Error,icon:"fa fa-exclamation-triangle",timeout:Xe.b.Error},rr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onClearAppNotification=function(t){e.props.clearAppNotification(t)},e}return rt.c(e,t),e.prototype.componentDidMount=function(){var t=this.props.notifyApp;kt.a.on("alert-warning",function(e){return t(function(t,e){return rt.a({},tr,{title:t,text:e,id:Date.now()})}(e[0],e[1]))}),kt.a.on("alert-success",function(e){return t(function(t,e){return rt.a({},Ze,{title:t,text:e,id:Date.now()})}(e[0],e[1]))}),kt.a.on("alert-error",function(e){return t(function(t,e){return rt.a({},er,{title:t,text:e,id:Date.now()})}(e[0],e[1]))})},e.prototype.render=function(){var t=this,e=this.props.appNotifications;return at.a.createElement("div",null,e.map(function(e,r){return at.a.createElement(Ke,{key:e.id+"-"+r,appNotification:e,onClearNotification:function(e){return t.onClearAppNotification(e)}})}))},e}(nt.PureComponent),nr={notifyApp:ae.b,clearAppNotification:ae.a},ar=Object(Je.a)(rr,function(t){return{appNotifications:t.appNotifications.appNotifications}},nr);function ir(){Object(ut.a)("passwordStrength",Ee,["password"]),Object(ut.a)("sidemenu",Ye,[]),Object(ut.a)("appNotificationsList",ar,[]),Object(ut.a)("pageHeader",_e.a,["model","noTabs"]),Object(ut.a)("emptyListCta",Me.a,["model"]),Object(ut.a)("searchResult",$e,[]),Object(ut.a)("tagFilter",Ue,["tags",["onChange",{watchDepth:"reference"}],["tagOptions",{watchDepth:"reference"}]])}var sr=r(63),or=function(){function t(t){this.$location=t}return t.$inject=["$location"],t.prototype.toggleFolderExpand=function(t){var e=this;t.toggle&&(!t.expanded&&this.onFolderExpanding&&this.onFolderExpanding(),t.toggle(t).then(function(t){e.editable&&t.expanded&&t.items&&(a.a.each(t.items,function(e){e.checked=t.checked}),e.onSelectionChanged&&e.onSelectionChanged())}))},t.prototype.navigateToFolder=function(t,e){this.$location.path(t.url),e&&(e.stopPropagation(),e.preventDefault())},t.prototype.toggleSelection=function(t,e){t.checked=!t.checked,t.items&&a.a.each(t.items,function(e){e.checked=t.checked}),this.onSelectionChanged&&this.onSelectionChanged(),e&&(e.stopPropagation(),e.preventDefault())},t.prototype.onItemClick=function(t){(this.$location.path().indexOf(t.url)>-1||t.url.indexOf(this.$location.path())>-1)&&kt.a.emit("hide-dash-search")},t.prototype.selectTag=function(t,e){this.onTagSelected&&this.onTagSelected({$tag:t}),e&&(e.stopPropagation(),e.preventDefault())},t}();i.c.directive("dashboardSearchResults",function(){return{restrict:"E",templateUrl:"public/app/core/components/search/search_results.html",controller:or,bindToController:!0,controllerAs:"ctrl",scope:{editable:"@",results:"=",onSelectionChanged:"&",onTagSelected:"&",onFolderExpanding:"&"}}});var lr=function(){function t(t,e,r,n){var a=this;this.backendSrv=t,this.searchSrv=r,this.contextSrv=n,this.selectAllChecked=!1,this.canDelete=!1,this.canMove=!1,this.hasFilters=!1,this.starredFilterOptions=[{text:"过滤标星仪表盘",disabled:!0},{text:"是"},{text:"否"}],this.canSave=!1,this.isEditor=this.contextSrv.isEditor,this.hasEditPermissionInFolders=this.contextSrv.hasEditPermissionInFolders,this.query={query:"",mode:"tree",tag:[],starred:!1,skipRecent:!0,skipStarred:!0,folderIds:[]},this.folderId&&(this.query.folderIds=[this.folderId]),this.selectedStarredFilter=this.starredFilterOptions[0],this.refreshList().then(function(){a.initTagFilter()})}return t.$inject=["backendSrv","navModelSrv","searchSrv","contextSrv"],t.prototype.refreshList=function(){var t=this;return this.searchSrv.search(this.query).then(function(e){return t.initDashboardList(e)}).then(function(){if(t.folderUid)return t.backendSrv.getFolderByUid(t.folderUid).then(function(e){t.canSave=e.canSave,t.canSave||(t.hasEditPermissionInFolders=!1)})})},t.prototype.initDashboardList=function(t){if(this.canMove=!1,this.canDelete=!1,this.selectAllChecked=!1,this.hasFilters=this.query.query.length>0||this.query.tag.length>0||this.query.starred,t){this.sections=t;for(var e=0,r=this.sections;e<r.length;e++){var n=r[e];n.checked=!1;for(var a=0,i=n.items;a<i.length;a++){i[a].checked=!1}}this.folderId&&this.sections.length>0&&(this.sections[0].hideHeader=!0)}else this.sections=[]},t.prototype.selectionChanged=function(){for(var t=0,e=0,r=this.sections;e<r.length;e++){var n=r[e];t+=a.a.filter(n.items,{checked:!0}).length}var i=a.a.filter(this.sections,{checked:!0}).length;this.canMove=t>0,this.canDelete=t>0||i>0},t.prototype.getFoldersAndDashboardsToDelete=function(){for(var t,e={folders:[],dashboards:[]},r=0,n=this.sections;r<n.length;r++){var i=n[r];if(i.checked&&0!==i.id)e.folders.push(i.uid);else{var s=a.a.filter(i.items,{checked:!0});(t=e.dashboards).push.apply(t,a.a.map(s,"uid"))}}return e},t.prototype.getFolderIds=function(t){for(var e=[],r=0,n=t;r<n.length;r++){var a=n[r];a.checked&&e.push(a.id)}return e},t.prototype.delete=function(){var t,e=this,r=this.getFoldersAndDashboardsToDelete(),n=r.folders.length,a=r.dashboards.length,i="你想删除 ";n>0&&a>0?(i+="已选择的文件夹"+(1===n?"":"s")+" 和仪表盘"+(1===a?"":"s")+"?",t="在文件夹"+(1===n?"":"s")+" 下的所有仪表盘也将会被删除"):i+=n>0?"已选择的文件夹"+(1===n?"":"s")+" 和所有文件夹下的仪表盘?":"已选择的仪表盘"+(1===a?"":"s")+"?",kt.a.emit("confirm-modal",{title:"删除",text:i,text2:t,icon:"fa-trash",yesText:"删除",onConfirm:function(){e.deleteFoldersAndDashboards(r.folders,r.dashboards)}})},t.prototype.deleteFoldersAndDashboards=function(t,e){var r=this;this.backendSrv.deleteFoldersAndDashboards(t,e).then(function(){r.refreshList()})},t.prototype.getDashboardsToMove=function(){for(var t=[],e=0,r=this.sections;e<r.length;e++){var n=r[e],i=a.a.filter(n.items,{checked:!0});t.push.apply(t,a.a.map(i,"uid"))}return t},t.prototype.moveTo=function(){var t=this.getDashboardsToMove();kt.a.emit("show-modal",{templateHtml:'<move-to-folder-modal dismiss="dismiss()" dashboards="model.dashboards" after-save="model.afterSave()"></move-to-folder-modal>',modalClass:"modal--narrow",model:{dashboards:t,afterSave:this.refreshList.bind(this)}})},t.prototype.initTagFilter=function(){var t=this;return this.searchSrv.getDashboardTags().then(function(e){t.tagFilterOptions=[{term:"通过标签过滤",disabled:!0}].concat(e),t.selectedTagFilter=t.tagFilterOptions[0]})},t.prototype.filterByTag=function(t){return-1===a.a.indexOf(this.query.tag,t)&&this.query.tag.push(t),this.refreshList()},t.prototype.onQueryChange=function(){return this.refreshList()},t.prototype.onTagFilterChange=function(){var t=this.filterByTag(this.selectedTagFilter.term);return this.selectedTagFilter=this.tagFilterOptions[0],t},t.prototype.removeTag=function(t,e){this.query.tag=a.a.without(this.query.tag,t),this.refreshList(),e&&(e.stopPropagation(),e.preventDefault())},t.prototype.removeStarred=function(){return this.query.starred=!1,this.refreshList()},t.prototype.onStarredFilterChange=function(){return this.query.starred="是"===this.selectedStarredFilter.text,this.selectedStarredFilter=this.starredFilterOptions[0],this.refreshList()},t.prototype.onSelectAllChanged=function(){for(var t=this,e=0,r=this.sections;e<r.length;e++){var n=r[e];n.hideHeader||(n.checked=this.selectAllChecked),n.items=a.a.map(n.items,function(e){return e.checked=t.selectAllChecked,e})}this.selectionChanged()},t.prototype.clearFilters=function(){this.query.query="",this.query.tag=[],this.query.starred=!1,this.refreshList()},t.prototype.createDashboardUrl=function(){var t="dashboard/new";return this.folderId&&(t+="?folderId="+this.folderId),t},t.prototype.importDashboardUrl=function(){var t="dashboard/import";return this.folderId&&(t+="?folderId="+this.folderId),t},t}();i.c.directive("manageDashboards",function(){return{restrict:"E",templateUrl:"public/app/core/components/manage_dashboards/manage_dashboards.html",controller:lr,bindToController:!0,controllerAs:"ctrl",scope:{folderId:"=",folderUid:"="}}}),r.d(e,"f",function(){return Te.a}),r.d(e,"g",function(){return ir}),r.d(e,"e",function(){return i.c}),r.d(e,"c",function(){return kt.a}),r.d(e,"d",function(){return ft.a}),r.d(e,"a",function(){return B}),r.d(e,"b",function(){return sr.a}),r.d(e,"h",function(){return sr.b})},,function(t,e,r){"use strict";r.d(e,"b",function(){return u}),r.d(e,"a",function(){return d});var n,a=r(1),i=r.n(a),s=r(5),o=r(9),l=r(176),c=function(){function t(t,e,r,n){this.$http=t,this.$q=e,this.$timeout=r,this.contextSrv=n,this.inFlightRequests={},this.HTTP_REQUEST_CANCELLED=-1}return t.$inject=["$http","$q","$timeout","contextSrv"],t.prototype.get=function(t,e){return this.request({method:"GET",url:t,params:e})},t.prototype.delete=function(t){return this.request({method:"DELETE",url:t})},t.prototype.post=function(t,e){return this.request({method:"POST",url:t,data:e})},t.prototype.patch=function(t,e){return this.request({method:"PATCH",url:t,data:e})},t.prototype.put=function(t,e){return this.request({method:"PUT",url:t,data:e})},t.prototype.withNoBackendCache=function(t){var e=this;return this.noBackendCache=!0,t().finally(function(){e.noBackendCache=!1})},t.prototype.requestErrorHandler=function(t){if(!t.isHandled){var e=t.data||{message:"意外错误"};if(i.a.isString(e)&&(e={message:e}),422===t.status)throw o.a.emit("alert-warning",["验证失败",e.message]),e;var r="error";if(t.status<500&&(r="warning"),e.message){var n="",a=e.message;a.length>80&&(n=a,a="错误"),o.a.emit("alert-"+r,[a,n])}throw e}},t.prototype.request=function(t){var e=this;t.retry=t.retry||0;var r=!t.url.match(/^http/),n=0===t.retry;return r&&(this.contextSrv.user&&this.contextSrv.user.orgId&&(t.headers=t.headers||{},t.headers["X-Grafana-Org-Id"]=this.contextSrv.user.orgId),0===t.url.indexOf("/")&&(t.url=t.url.substring(1))),this.$http(t).then(function(e){return"GET"!==t.method&&e&&e.data.message&&!1!==t.showSuccessAlert&&o.a.emit("alert-success",[e.data.message]),e.data},function(r){if(401===r.status&&e.contextSrv.user.isSignedIn&&n)return e.loginPing().then(function(){return t.retry=1,e.request(t)});throw e.$timeout(e.requestErrorHandler.bind(e,r),50),r})},t.prototype.addCanceler=function(t,e){t in this.inFlightRequests?this.inFlightRequests[t].push(e):this.inFlightRequests[t]=[e]},t.prototype.resolveCancelerIfExists=function(t){var e=this.inFlightRequests[t];!i.a.isUndefined(e)&&e.length&&e[0].resolve()},t.prototype.datasourceRequest=function(t){var e=this,r=null;t.retry=t.retry||0;var n=t.requestId;n&&(this.resolveCancelerIfExists(n),r=this.$q.defer(),t.timeout=r.promise,this.addCanceler(n,r));var a=!t.url.match(/^http/),s=0===t.retry;return a&&(this.contextSrv.user&&this.contextSrv.user.orgId&&(t.headers=t.headers||{},t.headers["X-Grafana-Org-Id"]=this.contextSrv.user.orgId),0===t.url.indexOf("/")&&(t.url=t.url.substring(1)),t.headers&&t.headers.Authorization&&(t.headers["X-DS-Authorization"]=t.headers.Authorization,delete t.headers.Authorization),this.noBackendCache&&(t.headers["X-Grafana-NoCache"]="true")),this.$http(t).then(function(e){return t.silent||o.a.emit("ds-request-response",e),e}).catch(function(n){if(n.status===e.HTTP_REQUEST_CANCELLED)throw{err:n,cancelled:!0};if(a&&s&&401===n.status)return e.loginPing().then(function(){return t.retry=1,r&&r.resolve(),e.datasourceRequest(t)});throw i.a.isString(n.data)&&500===n.status&&(n.data={error:n.statusText,response:n.data}),n.data&&!n.data.message&&i.a.isString(n.data.error)&&(n.data.message=n.data.error),t.silent||o.a.emit("ds-request-error",n),n}).finally(function(){t.requestId&&e.inFlightRequests[t.requestId].shift()})},t.prototype.loginPing=function(){return this.request({url:"/api/login/ping",method:"GET",retry:1})},t.prototype.search=function(t){return this.get("/api/search",t)},t.prototype.getDashboardBySlug=function(t){return this.get("/api/dashboards/db/"+t)},t.prototype.getDashboardByUid=function(t){return this.get("/api/dashboards/uid/"+t)},t.prototype.getFolderByUid=function(t){return this.get("/api/folders/"+t)},t.prototype.saveDashboard=function(t,e){return e=e||{},this.post("/api/dashboards/db/",{dashboard:t,folderId:e.folderId,overwrite:!0===e.overwrite,message:e.message||""})},t.prototype.createFolder=function(t){return this.post("/api/folders",t)},t.prototype.deleteFolder=function(t,e){return this.request({method:"DELETE",url:"/api/folders/"+t,showSuccessAlert:!0===e})},t.prototype.deleteDashboard=function(t,e){return this.request({method:"DELETE",url:"/api/dashboards/uid/"+t,showSuccessAlert:!0===e})},t.prototype.deleteFoldersAndDashboards=function(t,e){for(var r=[],n=0,a=t;n<a.length;n++){var i=a[n];r.push(this.createTask(this.deleteFolder.bind(this),!0,i,!0))}for(var s=0,o=e;s<o.length;s++){var l=o[s];r.push(this.createTask(this.deleteDashboard.bind(this),!0,l,!0))}return this.executeInOrder(r,[])},t.prototype.moveDashboards=function(t,e){for(var r=[],n=0,a=t;n<a.length;n++){var s=a[n];r.push(this.createTask(this.moveDashboard.bind(this),!0,s,e))}return this.executeInOrder(r,[]).then(function(t){return{totalCount:t.length,successCount:i.a.filter(t,{succeeded:!0}).length,alreadyInFolderCount:i.a.filter(t,{alreadyInFolder:!0}).length}})},t.prototype.moveDashboard=function(t,e){var r=this,n=this.$q.defer();return this.getDashboardByUid(t).then(function(t){var a=new l.a(t.dashboard,t.meta);if(!t.meta.folderId&&0===e.id||t.meta.folderId===e.id)n.resolve({alreadyInFolder:!0});else{var i=a.getSaveModelClone(),s={folderId:e.id,overwrite:!1};r.saveDashboard(i,s).then(function(){n.resolve({succeeded:!0})}).catch(function(t){t.data&&"plugin-dashboard"===t.data.status?(t.isHandled=!0,s.overwrite=!0,r.saveDashboard(i,s).then(function(){n.resolve({succeeded:!0})}).catch(function(t){n.resolve({succeeded:!1})})):n.resolve({succeeded:!1})})}}),n.promise},t.prototype.createTask=function(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return function(n){return t.apply(null,r).then(function(t){return Array.prototype.concat(n,[t])}).catch(function(t){if(e)return n;throw t})}},t.prototype.executeInOrder=function(t,e){return t.reduce(this.$q.when,e)},t}();function u(t){n=t}function d(){return n}s.c.service("backendSrv",c)},,,,,,,function(t,e,r){"use strict";r.d(e,"b",function(){return i}),r.d(e,"a",function(){return s}),r.d(e,"c",function(){return o}),r.d(e,"d",function(){return l});var n=r(1),a=r.n(n),i=function(){return function(t){this.type=t.type,this.params=t.params,this.defaultParams=t.defaultParams,this.renderer=t.renderer,this.category=t.category,this.addStrategy=t.addStrategy}}(),s=function(){function t(t,e){if(this.part=t,this.def=e,!this.def)throw{message:"找不到查询部分 "+t.type};t.params=t.params||a.a.clone(this.def.defaultParams),this.params=t.params,this.updateText()}return t.prototype.render=function(t){return this.def.renderer(this,t)},t.prototype.hasMultipleParamsInString=function(t,e){return-1!==t.indexOf(",")&&(this.def.params[e+1]&&this.def.params[e+1].optional)},t.prototype.updateParam=function(t,e){var r=this;this.hasMultipleParamsInString(t,e)?a.a.each(t.split(","),function(t,e){r.updateParam(t.trim(),e)}):(""===t&&this.def.params[e].optional?this.params.splice(e,1):this.params[e]=t,this.part.params=this.params,this.updateText())},t.prototype.updateText=function(){if(0!==this.params.length){var t=this.def.type+"(";t+=this.params.join(", "),t+=")",this.text=t}else this.text=this.def.type+"()"},t}();function o(t,e){var r=t.def.type+"(",n=a.a.map(t.params,function(e,r){var n=t.def.params[r];return"time"===n.type&&"auto"===e&&(e="$__interval"),"single"===n.quote?"'"+e+"'":"double"===n.quote?'"'+e+'"':e});return e&&n.unshift(e),r+n.join(", ")+")"}function l(t,e){return e+" "+t.params[0]}},,,,function(t,e,r){"use strict";r.d(e,"c",function(){return n}),r.d(e,"d",function(){return a}),r.d(e,"e",function(){return i}),r.d(e,"h",function(){return s}),r.d(e,"a",function(){return o}),r.d(e,"b",function(){return l}),r.d(e,"g",function(){return c}),r.d(e,"f",function(){return u});var n=30,a=10,i=24,s="v",o=4,l=250,c=3*n,u="panel-copy"},function(t,e,r){"use strict";r.r(e),r.d(e,"parse",function(){return l}),r.d(e,"isValid",function(){return c}),r.d(e,"parseDateMath",function(){return u});var n=r(1),a=r.n(n),i=r(4),s=r.n(i),o=["y","M","w","d","h","m","s"];function l(t,e,r){if(t){if(s.a.isMoment(t))return t;if(a.a.isDate(t))return s()(t);var n,i,o,l="";return"now"===t.substring(0,3)?(n="utc"===r?s.a.utc():s()(),l=t.substring("now".length)):(-1===(i=t.indexOf("||"))?(o=t,l=""):(o=t.substring(0,i),l=t.substring(i+2)),n=s()(o,s.a.ISO_8601)),l.length?u(l,n,e):n}}function c(t){var e=l(t);return!!e&&(!!s.a.isMoment(e)&&e.isValid())}function u(t,e,r){for(var n=e,i=0,s=t.length;i<s;){var l,c=t.charAt(i++),u=void 0,d=void 0;if("/"===c)u=0;else if("+"===c)u=1;else{if("-"!==c)return;u=2}if(isNaN(t.charAt(i)))d=1;else if(2===t.length)d=t.charAt(i);else{for(var p=i;!isNaN(t.charAt(i));)if(++i>10)return;d=parseInt(t.substring(p,i),10)}if(0===u&&1!==d)return;if(l=t.charAt(i++),!a.a.includes(o,l))return;0===u?r?n.endOf(l):n.startOf(l):1===u?n.add(d,l):2===u&&n.subtract(d,l)}return n}},,,,function(t,e,r){"use strict";r.d(e,"b",function(){return l}),r.d(e,"d",function(){return c}),r.d(e,"a",function(){return u}),r.d(e,"c",function(){return d}),r.d(e,"e",function(){return p}),r.d(e,"f",function(){return h}),r.d(e,"h",function(){return v});var n=r(1),a=r.n(n),i=r(120),s=r.n(i),o=4,l="rgba(0, 211, 255, 1)",c="rgba(11, 237, 50, 1)",u="rgba(237, 46, 24, 1)",d="rgba(150, 150, 150, 1)",p="rgba(247, 149, 32, 1)",h=.09,f=["#7EB26D","#EAB839","#6ED0E0","#EF843C","#E24D42","#1F78C1","#BA43A9","#705DA0","#508642","#CCA300","#447EBC","#C15C17","#890F02","#0A437C","#6D1F62","#584477","#B7DBAB","#F4D598","#70DBED","#F9BA8F","#F29191","#82B5D8","#E5A8E2","#AEA2E0","#629E51","#E5AC0E","#64B0C8","#E0752D","#BF1B00","#0A50A1","#962D82","#614D93","#9AC48A","#F2C96D","#65C5DB","#F9934E","#EA6460","#5195CE","#D683CE","#806EB7","#3F6833","#967302","#2F575E","#99440A","#58140C","#052B51","#511749","#3F2B5B","#E0F9D7","#FCEACA","#CFFAFF","#F9E2D2","#FCE2DE","#BADFF4","#F9D9F9","#DEDAF7"];function m(t){return s()(t).toHsl()}function g(t){return s()(t).toHexString()}var v=function(t){var e=a.a.map(t,m),r=a.a.sortBy(e,["h"]);return r=a.a.chunk(r,o),r=a.a.map(r,function(t){return a.a.sortBy(t,"l")}),r=a.a.flattenDeep(a.a.zip.apply(a.a,r)),a.a.map(r,g)}(f);e.g=f},function(t,e,r){"use strict";var n=r(2),a=r(0),i=r.n(a),s=r(16),o=r.n(s),l=r(9),c=function(t){var e=t.main,r=t.customCss,n=e.children.find(function(t){return!0===t.active});return i.a.createElement("div",{className:"gf-form-select-wrapper width-20 "+r},i.a.createElement("label",{className:"gf-form-select-icon "+n.icon,htmlFor:"page-header-select-nav"}),i.a.createElement("select",{className:"gf-select-nav gf-form-input",value:n.url,onChange:function(t){var e=t.target,r=e.options[e.selectedIndex].value;l.a.emit("location-change",{href:r})},id:"page-header-select-nav"},e.children.map(function(t){return t.hideFromTabs?null:i.a.createElement("option",{key:t.url,value:t.url},t.text)})))},u=function(t){var e=t.main,r=t.customCss;return i.a.createElement("ul",{className:"gf-tabs "+r},e.children.map(function(t,e){if(t.hideFromTabs)return null;var r=o()({"gf-tabs-link":!0,active:t.active});return i.a.createElement("li",{className:"gf-tabs-item",key:t.url},i.a.createElement("a",{className:r,target:t.target,href:t.url},i.a.createElement("i",{className:t.icon}),t.text))}))},d=function(t){var e=t.main;return i.a.createElement("nav",null,i.a.createElement(c,{customCss:"page-header__select-nav",main:e}),i.a.createElement(u,{customCss:"page-header__tabs",main:e}))},p=function(t){function e(e){return t.call(this,e)||this}return n.c(e,t),e.prototype.shouldComponentUpdate=function(){return!0},e.prototype.renderTitle=function(t,e){if(!(t||e&&0!==e.length))return null;if(!e||0===e.length)return i.a.createElement("h1",{className:"page-header__title"},t);for(var r=[],n=0;n<e.length;n++){var a=e[n];a.url?r.push(i.a.createElement("a",{className:"text-link",key:n,href:a.url},a.title)):r.push(i.a.createElement("span",{key:n}," / ",a.title))}return r.push(i.a.createElement("span",{key:e.length+1}," / ",t)),i.a.createElement("h1",{className:"page-header__title"},r)},e.prototype.renderHeaderTitle=function(t){return i.a.createElement("div",{className:"page-header__inner"},i.a.createElement("span",{className:"page-header__logo"},t.icon&&i.a.createElement("i",{className:"page-header__icon "+t.icon}),t.img&&i.a.createElement("img",{className:"page-header__img",src:t.img})),i.a.createElement("div",{className:"page-header__info-block"},this.renderTitle(t.text,t.breadcrumbs),t.subTitle&&i.a.createElement("div",{className:"page-header__sub-title"},t.subTitle),t.subType&&i.a.createElement("div",{className:"page-header__stamps"},i.a.createElement("i",{className:t.subType.icon}),t.subType.text)))},e.prototype.render=function(){var t=this.props.model;if(!t)return null;var e=t.main;return i.a.createElement("div",{className:"page-header-canvas"},i.a.createElement("div",{className:"page-container"},i.a.createElement("div",{className:"page-header"},this.renderHeaderTitle(e),e.children&&i.a.createElement(d,{main:e}))))},e}(i.a.Component);e.a=p},,function(t,e,r){"use strict";r.d(e,"a",function(){return a});var n=r(2);function a(t,e,r){if(t[e]){var a=t[e],i=n.a({},a.parentItem);return i.children=i.children.map(function(t){return n.a({},t,{active:t.url===a.url})}),{node:a,main:i}}return r||function(){var t={id:"not-found",text:"未发现页面",icon:"fa fa-fw fa-warning",subTitle:"404 错误",url:"not-found"};return{node:t,main:t}}()}},,function(t,e,r){"use strict";r(154),r(211),r(184),r(212),r(213),r(527);var n,a,i=r(41);r(214),r(155),r(298);!function(t){t.NotStarted="NotStarted",t.Loading="Loading",t.Done="Done",t.Error="Error"}(n||(n={})),function(t){t.Null="null",t.Ignore="connected",t.AsZero="null as zero"}(a||(a={}));var s,o;r(299),r(185),r(300);!function(t){t.Success="success",t.Warning="warning",t.Error="error",t.Info="info"}(s||(s={})),function(t){t[t.Warning=5e3]="Warning",t[t.Success=3e3]="Success",t[t.Error=7e3]="Error"}(o||(o={}));r(528);r.d(e,"e",function(){return i.b}),r.d(e,"c",function(){return n}),r.d(e,"d",function(){return a}),r.d(e,"a",function(){return s}),r.d(e,"b",function(){return o})},,function(t,e,r){"use strict";r.d(e,"a",function(){return n}),r.d(e,"k",function(){return p}),r.d(e,"l",function(){return h}),r.d(e,"h",function(){return f}),r.d(e,"e",function(){return m}),r.d(e,"g",function(){return g}),r.d(e,"c",function(){return v}),r.d(e,"j",function(){return b}),r.d(e,"m",function(){return y}),r.d(e,"f",function(){return w}),r.d(e,"b",function(){return x}),r.d(e,"i",function(){return S}),r.d(e,"d",function(){return k});var n,a=r(2),i=r(15),s=r(44),o=r(243);!function(t){t.LoadTeams="LOAD_TEAMS",t.LoadTeam="LOAD_TEAM",t.SetSearchQuery="SET_TEAM_SEARCH_QUERY",t.SetSearchMemberQuery="SET_TEAM_MEMBER_SEARCH_QUERY",t.LoadTeamMembers="TEAM_MEMBERS_LOADED",t.LoadTeamGroups="TEAM_GROUPS_LOADED"}(n||(n={}));var l=function(t){return{type:n.LoadTeams,payload:t}},c=function(t){return{type:n.LoadTeam,payload:t}},u=function(t){return{type:n.LoadTeamMembers,payload:t}},d=function(t){return{type:n.LoadTeamGroups,payload:t}},p=function(t){return{type:n.SetSearchMemberQuery,payload:t}},h=function(t){return{type:n.SetSearchQuery,payload:t}};function f(){var t=this;return function(e){return a.b(t,void 0,void 0,function(){var t;return a.d(this,function(r){switch(r.label){case 0:return[4,Object(i.a)().get("/api/teams/search",{perpage:1e3,page:1})];case 1:return t=r.sent(),e(l(t.teams)),[2]}})})}}function m(t){var e=this;return function(r){return a.b(e,void 0,void 0,function(){var e;return a.d(this,function(n){switch(n.label){case 0:return[4,Object(i.a)().get("/api/teams/"+t)];case 1:return e=n.sent(),r(c(e)),r(Object(s.d)(Object(o.a)(e))),[2]}})})}}function g(){var t=this;return function(e,r){return a.b(t,void 0,void 0,function(){var t,n;return a.d(this,function(a){switch(a.label){case 0:return t=r().team.team,[4,Object(i.a)().get("/api/teams/"+t.id+"/members")];case 1:return n=a.sent(),e(u(n)),[2]}})})}}function v(t){var e=this;return function(r,n){return a.b(e,void 0,void 0,function(){var e;return a.d(this,function(a){switch(a.label){case 0:return e=n().team.team,[4,Object(i.a)().post("/api/teams/"+e.id+"/members",{userId:t})];case 1:return a.sent(),r(g()),[2]}})})}}function b(t){var e=this;return function(r,n){return a.b(e,void 0,void 0,function(){var e;return a.d(this,function(a){switch(a.label){case 0:return e=n().team.team,[4,Object(i.a)().delete("/api/teams/"+e.id+"/members/"+t)];case 1:return a.sent(),r(g()),[2]}})})}}function y(t,e){var r=this;return function(n,s){return a.b(r,void 0,void 0,function(){var r;return a.d(this,function(a){switch(a.label){case 0:return r=s().team.team,[4,Object(i.a)().put("/api/teams/"+r.id,{name:t,email:e})];case 1:return a.sent(),n(m(r.id)),[2]}})})}}function w(){var t=this;return function(e,r){return a.b(t,void 0,void 0,function(){var t,n;return a.d(this,function(a){switch(a.label){case 0:return t=r().team.team,[4,Object(i.a)().get("/api/teams/"+t.id+"/groups")];case 1:return n=a.sent(),e(d(n)),[2]}})})}}function x(t){var e=this;return function(r,n){return a.b(e,void 0,void 0,function(){var e;return a.d(this,function(a){switch(a.label){case 0:return e=n().team.team,[4,Object(i.a)().post("/api/teams/"+e.id+"/groups",{groupId:t})];case 1:return a.sent(),r(w()),[2]}})})}}function S(t){var e=this;return function(r,n){return a.b(e,void 0,void 0,function(){var e;return a.d(this,function(a){switch(a.label){case 0:return e=n().team.team,[4,Object(i.a)().delete("/api/teams/"+e.id+"/groups/"+t)];case 1:return a.sent(),r(w()),[2]}})})}}function k(t){var e=this;return function(r){return a.b(e,void 0,void 0,function(){return a.d(this,function(e){switch(e.label){case 0:return[4,Object(i.a)().delete("/api/teams/"+t)];case 1:return e.sent(),r(f()),[2]}})})}}},,function(t,e,r){"use strict";var n=new(function(){function t(){}return t.prototype.get=function(t){return window.localStorage[t]},t.prototype.set=function(t,e){window.localStorage[t]=e},t.prototype.getBool=function(t,e){return void 0===e||this.exists(t)?"true"===window.localStorage[t]:e},t.prototype.getObject=function(t,e){var r=e;if(this.exists(t)){var n=window.localStorage[t];try{r=JSON.parse(n)}catch(r){console.error("Error parsing store object: "+t+". Returning default: "+e+". ["+r+"]")}}return r},t.prototype.setObject=function(t,e){var r;try{r=JSON.stringify(e)}catch(e){return console.error("Could not stringify object: "+t+". ["+e+"]"),!1}try{this.set(t,r)}catch(e){return console.error("Could not save item in localStorage: "+t+". ["+e+"]"),!1}return!0},t.prototype.exists=function(t){return void 0!==window.localStorage[t]},t.prototype.delete=function(t){window.localStorage.removeItem(t)},t}());e.a=n},function(t,e,r){"use strict";var n,a,i,s;r.d(e,"b",function(){return n}),r.d(e,"c",function(){return a}),r.d(e,"a",function(){return s}),r.d(e,"d",function(){return o}),r.d(e,"e",function(){return l}),function(t){t.Viewer="Viewer",t.Editor="Editor",t.Admin="Admin"}(n||(n={})),function(t){t[t.View=1]="View",t[t.Edit=2]="Edit",t[t.Admin=4]="Admin"}(a||(a={})),function(t){t[t.Query=1]="Query",t[t.Admin=2]="Admin"}(i||(i={})),function(t){t.Team="Team",t.User="User",t.Viewer="Viewer",t.Editor="Editor"}(s||(s={}));i.Query;var o=[{value:s.Team,text:"团队"},{value:s.User,text:"用户"},{value:s.Viewer,text:"所有查看角色"},{value:s.Editor,text:"所有编辑角色"}],l=[{value:a.View,label:"查看",description:"可以查看仪表盘"},{value:a.Edit,label:"编辑",description:"可以添加编辑删除仪表盘"},{value:a.Admin,label:"管理员",description:"可以添加/删除权限，可以添加，编辑和删除仪表板。"}]},function(t,e,r){"use strict";function n(t,e,r){var n=Math.sqrt(50),a=Math.sqrt(10),i=Math.sqrt(2),s=Math.abs(e-t)/Math.max(0,r),o=Math.pow(10,Math.floor(Math.log(s)/Math.LN10)),l=s/o;return l>=n?o*=10:l>=a?o*=5:l>=i&&(o*=2),e<t?-o:o}function a(t,e){return t-Math.floor(Math.log(e)/Math.LN10)}function i(t,e,r,n){var a,i=(e-t)/r,s=-Math.floor(Math.log(i)/Math.LN10),o=n,l=Math.pow(10,-s),c=i/l;return c<1.5?a=1:c<3?(a=2,c>2.25&&(null==o||s+1<=o)&&(a=2.5,++s)):a=c<7.5?5:10,a*=l}function s(t,e,r,n){var a=+(null!=t?t:r),i=+(null!=e?e:n),s=i-a;if(0===s){var o=Math.abs(0===i?1:.25*i);null===t&&(a-=o),null!=e&&null==t||(i+=o)}else{null==t&&(a-=.02*s)<0&&null!=r&&r>=0&&(a=0),null==e&&(i+=.02*s)>0&&null!=n&&n<=0&&(i=0)}return{min:a,max:i}}function o(t,e,r,n){var a,i=s(r.min,r.max,t,e),o=i.min,l=(i.max-o)/(.3*Math.sqrt(n)),c=-Math.floor(Math.log(l)/Math.LN10),u=Math.pow(10,-c),d=l/u;d<1.5?a=1:d<3?(a=2,d>2.25&&(a=2.5)):a=d<7.5?5:10,a*=u;var p=Math.max(0,1-Math.floor(Math.log(l)/Math.LN10));return{tickDecimals:p,scaledDecimals:p-Math.floor(Math.log(a)/Math.LN10)}}function l(t,e,r){if(e&&r&&t){var n=r-e,a=n/t/1e3;return a<=45?"%H:%M:%S":a<=7200||n<=864e5?"%H:%M":a<=8e4?"%m/%d %H:%M":a<=2419200||n<=31536e6?"%m/%d":"%Y-%m"}return"%H:%M"}function c(t,e){return Math.log(t)/Math.log(e)}function u(t){return d(t.toString())}function d(t){var e=t.indexOf(".");return-1===e?0:t.length-e-1}r.r(e),r.d(e,"tickStep",function(){return n}),r.d(e,"getScaledDecimals",function(){return a}),r.d(e,"getFlotTickSize",function(){return i}),r.d(e,"getFlotRange",function(){return s}),r.d(e,"getFlotTickDecimals",function(){return o}),r.d(e,"grafanaTimeFormat",function(){return l}),r.d(e,"logp",function(){return c}),r.d(e,"getPrecision",function(){return u}),r.d(e,"getStringPrecision",function(){return d})},,function(t,e,r){"use strict";var n=function(t){return{type:"UPDATE_LOCATION",payload:t}},a=r(190),i=r(165);r.d(e,"c",function(){return n}),r.d(e,"d",function(){return a.b}),r.d(e,"b",function(){return i.c}),r.d(e,"a",function(){return i.b})},function(t,e,r){"use strict";var n=r(1),a=r.n(n),i=r(22),s=new i.b({type:"query",params:[{name:"queryRefId",type:"string",dynamicLookup:!0},{name:"from",type:"string",options:["10s","1m","5m","10m","15m","1h","24h","48h"]},{name:"to",type:"string",options:["now","now-1m","now-5m","now-10m","now-1h"]}],defaultParams:["#A","15m","now","avg"]});function o(t,e){return a.a.reduce(t,function(t,e){return void 0!==e.metric&&void 0!==e.value&&t.push(e.metric+"="+e.value),void 0!==e.Metric&&void 0!==e.Value&&t.push(e.Metric+"="+e.Value),t},[]).join(e)}e.a={alertQueryDef:s,getStateDisplayModel:function(t){switch(t){case"ok":return{text:"OK",iconClass:"icon-gf icon-gf-online",stateClass:"alert-state-ok"};case"alerting":return{text:"ALERTING",iconClass:"icon-gf icon-gf-critical",stateClass:"alert-state-critical"};case"no_data":return{text:"NO DATA",iconClass:"fa fa-question",stateClass:"alert-state-warning"};case"paused":return{text:"PAUSED",iconClass:"fa fa-pause",stateClass:"alert-state-paused"};case"pending":return{text:"PENDING",iconClass:"fa fa-exclamation",stateClass:"alert-state-warning"};case"unknown":return{text:"UNKNOWN",iconClass:"fa fa-question",stateClass:"alert-state-paused"}}throw{message:"Unknown alert state"}},conditionTypes:[{text:"Query",value:"query"}],evalFunctions:[{text:"IS ABOVE",value:"gt"},{text:"IS BELOW",value:"lt"},{text:"IS OUTSIDE RANGE",value:"outside_range"},{text:"IS WITHIN RANGE",value:"within_range"},{text:"HAS NO VALUE",value:"no_value"}],evalOperators:[{text:"OR",value:"or"},{text:"AND",value:"and"}],noDataModes:[{text:"Alerting",value:"alerting"},{text:"No Data",value:"no_data"},{text:"Keep Last State",value:"keep_state"},{text:"Ok",value:"ok"}],executionErrorModes:[{text:"Alerting",value:"alerting"},{text:"Keep Last State",value:"keep_state"}],reducerTypes:[{text:"avg()",value:"avg"},{text:"min()",value:"min"},{text:"max()",value:"max"},{text:"sum()",value:"sum"},{text:"count()",value:"count"},{text:"last()",value:"last"},{text:"median()",value:"median"},{text:"diff()",value:"diff"},{text:"percent_diff()",value:"percent_diff"},{text:"count_non_null()",value:"count_non_null"}],createReducerPart:function(t){var e=new i.b({type:t.type,defaultParams:[]});return new i.a(t,e)},getAlertAnnotationInfo:function(t){return a.a.isArray(t.data)?o(t.data,", "):a.a.isArray(t.data.evalMatches)?o(t.data.evalMatches,", "):t.data.error?"Error: "+t.data.error:""},alertStateSortScore:{alerting:1,no_data:2,pending:3,ok:4,paused:5}}},,,,,,function(t,e,r){"use strict";var n=r(2),a=r(145),i=r(595),s=(r(1043),r(190)),o=r(8);var l=function(){var t={};return function t(e,r,a){for(var i=0,s=r;i<s.length;i++){var o=s[i];e[o.id]=n.a({},o,{parentItem:a}),o.children&&t(e,o.children,o)}}(t,o.a.bootData.navTree),t}(),c=r(168),u=r(1),d=r.n(u),p={url:"",path:"",query:{},routeParams:{}},h=r(165),f={appNotifications:[]},m={navIndex:function(t,e){switch(void 0===t&&(t=l),e.type){case s.a.UpdateNavIndex:for(var r={},a=e.payload,i=0,o=a.children;i<o.length;i++){var c=o[i];r[c.id]=n.a({},c,{parentItem:a})}return n.a({},t,r)}return t},location:function(t,e){switch(void 0===t&&(t=p),e.type){case"UPDATE_LOCATION":var r=e.payload,a=r.path,i=r.routeParams,s=e.payload.query||t.query;return e.payload.partial&&(s=d.a.defaults(s,t.query)),{url:Object(c.a)(a||t.path,s),path:a||t.path,query:n.a({},s),routeParams:i||t.routeParams}}return t},appNotifications:function(t,e){switch(void 0===t&&(t=f),e.type){case h.a.AddAppNotification:return n.a({},t,{appNotifications:t.appNotifications.concat([e.payload])});case h.a.ClearAppNotification:return n.a({},t,{appNotifications:t.appNotifications.filter(function(t){return t.id!==e.payload})})}return t}},g=r(4),v=r.n(g),b=r(143),y=r(45),w={items:[],searchQuery:""};var x={alertRules:function(t,e){switch(void 0===t&&(t=w),e.type){case b.a.LoadAlertRules:return{items:e.payload.map(function(t){return function(t,e){var r=y.a.getStateDisplayModel(e);return t.stateText=r.text,t.stateIcon=r.iconClass,t.stateClass=r.stateClass,t.stateAge=v()(t.newStateDate).fromNow().replace(" ago",""),"paused"!==t.state&&(t.executionError&&(t.info="Execution Error: "+t.executionError),t.evalData&&t.evalData.noData&&(t.info="Query returned no data")),t}(t,t.state)}),searchQuery:t.searchQuery};case b.a.SetSearchQuery:return{items:t.items,searchQuery:e.payload}}return t}},S=r(38),k={teams:[],searchQuery:"",hasFetched:!1},C={team:{},members:[],groups:[],searchMemberQuery:""},T={teams:function(t,e){switch(void 0===t&&(t=k),e.type){case S.a.LoadTeams:return n.a({},t,{hasFetched:!0,teams:e.payload});case S.a.SetSearchQuery:return n.a({},t,{searchQuery:e.payload})}return t},team:function(t,e){switch(void 0===t&&(t=C),e.type){case S.a.LoadTeam:return n.a({},t,{team:e.payload});case S.a.LoadTeamMembers:return n.a({},t,{members:e.payload});case S.a.SetSearchMemberQuery:return n.a({},t,{searchMemberQuery:e.payload});case S.a.LoadTeamGroups:return n.a({},t,{groups:e.payload})}return t}},E=r(121),_={keys:[],searchQuery:"",hasFetched:!1},M={apiKeys:function(t,e){switch(void 0===t&&(t=_),e.type){case E.a.LoadApiKeys:return n.a({},t,{hasFetched:!0,keys:e.payload});case E.a.SetApiKeysSearchQuery:return n.a({},t,{searchQuery:e.payload})}return t}},A=r(64);function P(t){return t.map($).sort(function(t,e){return e.sortRank-t.sortRank||t.name.localeCompare(e.name)})}function $(t){var e=t;return e.sortRank=0,e.userId>0?(e.name=e.userLogin,e.sortRank=10):e.teamId>0?(e.name=e.team,e.sortRank=20):e.role&&(e.icon="fa fa-fw fa-street-view",e.name=e.role,e.sortRank=30,"Editor"===e.role&&(e.sortRank+=1)),e.inherited&&(e.sortRank+=100),e}var D={id:0,uid:"loading",title:"loading",url:"",canSave:!1,hasChanged:!1,version:1,permissions:[]},O={folder:function(t,e){switch(void 0===t&&(t=D),e.type){case A.a.LoadFolder:return n.a({},t,e.payload,{hasChanged:!1});case A.a.SetFolderTitle:return n.a({},t,{title:e.payload,hasChanged:e.payload.trim().length>0});case A.a.LoadFolderPermissions:return n.a({},t,{permissions:P(e.payload)})}return t}},I=r(101),N={permissions:[]},F={dashboard:function(t,e){switch(void 0===t&&(t=N),e.type){case I.a.LoadDashboardPermissions:return n.a({},t,{permissions:P(e.payload)})}return t}},q=r(68),L=r(82),R={plugins:[],searchQuery:"",layoutMode:L.a.Grid,hasFetched:!1,dashboards:[]},j={plugins:function(t,e){switch(void 0===t&&(t=R),e.type){case q.a.LoadPlugins:return n.a({},t,{hasFetched:!0,plugins:e.payload});case q.a.SetPluginsSearchQuery:return n.a({},t,{searchQuery:e.payload});case q.a.SetLayoutMode:return n.a({},t,{layoutMode:e.payload});case q.a.LoadPluginDashboards:return n.a({},t,{dashboards:e.payload})}return t}},U=r(58),V={dataSources:[],dataSource:{},layoutMode:L.a.Grid,searchQuery:"",dataSourcesCount:0,dataSourceTypes:[],dataSourceTypeSearchQuery:"",dataSourceMeta:{},hasFetched:!1},B={dataSources:function(t,e){switch(void 0===t&&(t=V),e.type){case U.a.LoadDataSources:return n.a({},t,{hasFetched:!0,dataSources:e.payload,dataSourcesCount:e.payload.length});case U.a.LoadDataSource:return n.a({},t,{dataSource:e.payload});case U.a.SetDataSourcesSearchQuery:return n.a({},t,{searchQuery:e.payload});case U.a.SetDataSourcesLayoutMode:return n.a({},t,{layoutMode:e.payload});case U.a.LoadDataSourceTypes:return n.a({},t,{dataSourceTypes:e.payload});case U.a.SetDataSourceTypeSearchQuery:return n.a({},t,{dataSourceTypeSearchQuery:e.payload});case U.a.LoadDataSourceMeta:return n.a({},t,{dataSourceMeta:e.payload})}return t}},Q=r(75),H={invitees:[],users:[],searchQuery:"",canInvite:!o.a.disableLoginForm&&!o.a.externalUserMngLinkName,externalUserMngInfo:o.a.externalUserMngInfo,externalUserMngLinkName:o.a.externalUserMngLinkName,externalUserMngLinkUrl:o.a.externalUserMngLinkUrl,hasFetched:!1},z={users:function(t,e){switch(void 0===t&&(t=H),e.type){case Q.a.LoadUsers:return n.a({},t,{hasFetched:!0,users:e.payload});case Q.a.LoadInvitees:return n.a({},t,{hasFetched:!0,invitees:e.payload});case Q.a.SetUsersSearchQuery:return n.a({},t,{searchQuery:e.payload})}return t}},G=r(144),W={organization:{}},Y={organization:function(t,e){switch(void 0===t&&(t=W),e.type){case G.a.LoadOrganization:return n.a({},t,{organization:e.payload});case G.a.SetOrganizationName:return n.a({},t,{organization:n.a({},t.organization,{name:e.payload})})}return t}};r.d(e,"b",function(){return K}),r.d(e,"a",function(){return X});var K,J=n.a({},m,x,T,M,O,F,j,B,z,Y);function X(){var t=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||a.d,e=Object(a.c)(J);K=Object(a.e)(e,{},t(Object(a.a)(i.a)))}},,,,function(t,e,r){"use strict";var n=r(8);e.a={stripBaseFromUrl:function(t){var e=n.a.appSubUrl,r=e.endsWith("/")?1:0;return t.length>0&&0===t.indexOf(e)?t.slice(e.length-r):t}}},,function(t,e,r){"use strict";r.d(e,"a",function(){return a});var n=r(5);function a(t,e,r){n.c.directive(t,["reactDirective",function(t){return t(e,r)}])}},function(t,e,r){"use strict";var n,a=r(2),i=r(15),s=r(44),o=r(8);function l(t,e){var r={img:e.info.logos.large,id:"datasource-"+t.id,subTitle:"Type: "+e.name,url:"",text:t.name,breadcrumbs:[{title:"Data Sources",url:"datasources"}],children:[{active:!1,icon:"fa fa-fw fa-sliders",id:"datasource-settings-"+t.id,text:"Settings",url:"datasources/edit/"+t.id}]};return e.includes&&function(t){return t.filter(function(t){return"dashboard"===t.type}).length>0}(e.includes)&&r.children.push({active:!1,icon:"fa fa-fw fa-th-large",id:"datasource-dashboards-"+t.id,text:"Dashboards",url:"datasources/edit/"+t.id+"/dashboards"}),o.a.buildInfo.isEnterprise&&r.children.push({active:!1,icon:"fa fa-fw fa-lock",id:"datasource-permissions-"+t.id,text:"Permissions",url:"datasources/edit/"+t.id+"/permissions"}),r}r.d(e,"a",function(){return n}),r.d(e,"h",function(){return h}),r.d(e,"g",function(){return f}),r.d(e,"f",function(){return m}),r.d(e,"e",function(){return g}),r.d(e,"c",function(){return v}),r.d(e,"b",function(){return b}),r.d(e,"d",function(){return y}),function(t){t.LoadDataSources="LOAD_DATA_SOURCES",t.LoadDataSourceTypes="LOAD_DATA_SOURCE_TYPES",t.LoadDataSource="LOAD_DATA_SOURCE",t.LoadDataSourceMeta="LOAD_DATA_SOURCE_META",t.SetDataSourcesSearchQuery="SET_DATA_SOURCES_SEARCH_QUERY",t.SetDataSourcesLayoutMode="SET_DATA_SOURCES_LAYOUT_MODE",t.SetDataSourceTypeSearchQuery="SET_DATA_SOURCE_TYPE_SEARCH_QUERY"}(n||(n={}));var c=function(t){return{type:n.LoadDataSources,payload:t}},u=function(t){return{type:n.LoadDataSource,payload:t}},d=function(t){return{type:n.LoadDataSourceMeta,payload:t}},p=function(t){return{type:n.LoadDataSourceTypes,payload:t}},h=function(t){return{type:n.SetDataSourcesSearchQuery,payload:t}},f=function(t){return{type:n.SetDataSourcesLayoutMode,payload:t}},m=function(t){return{type:n.SetDataSourceTypeSearchQuery,payload:t}};function g(){var t=this;return function(e){return a.b(t,void 0,void 0,function(){var t;return a.d(this,function(r){switch(r.label){case 0:return[4,Object(i.a)().get("/api/datasources")];case 1:return t=r.sent(),e(c(t)),[2]}})})}}function v(t){var e=this;return function(r){return a.b(e,void 0,void 0,function(){var e,n;return a.d(this,function(a){switch(a.label){case 0:return[4,Object(i.a)().get("/api/datasources/"+t)];case 1:return e=a.sent(),[4,Object(i.a)().get("/api/plugins/"+e.type+"/settings")];case 2:return n=a.sent(),r(u(e)),r(d(n)),r(Object(s.d)(l(e,n))),[2]}})})}}function b(t){var e=this;return function(r,n){return a.b(e,void 0,void 0,function(){var e,o,l;return a.d(this,function(a){switch(a.label){case 0:return[4,r(g())];case 1:return a.sent(),e=n().dataSources.dataSources,o={name:t.name,type:t.id,access:"proxy",isDefault:0===e.length},w(e,o.name)&&(o.name=function(t,e){for(;w(t,e);)x(e)?e=""+C(e)+k(S(e)):e+="-1";return e}(e,o.name)),[4,Object(i.a)().post("/api/datasources",o)];case 2:return l=a.sent(),r(Object(s.c)({path:"/datasources/edit/"+l.id})),[2]}})})}}function y(){var t=this;return function(e){return a.b(t,void 0,void 0,function(){var t;return a.d(this,function(r){switch(r.label){case 0:return[4,Object(i.a)().get("/api/plugins",{enabled:1,type:"datasource"})];case 1:return t=r.sent(),e(p(t)),[2]}})})}}function w(t,e){return t.filter(function(t){return t.name.toLowerCase()===e.toLowerCase()}).length>0}function x(t){return t.endsWith("-",t.length-1)}function S(t){return parseInt(t.slice(-1),10)}function k(t){return isNaN(t)?1:t+1}function C(t){return t.slice(0,t.length-1)}},function(t,e,r){"use strict";r.d(e,"a",function(){return c});var n=r(8),a=r(1),i=r.n(a),s=r(5),o=r(40),l=function(){return function(){n.a.bootData.user&&i.a.extend(this,n.a.bootData.user)}}(),c=new(function(){function t(){this.sidemenuSmallBreakpoint=!1,this.sidemenu=o.a.getBool("grafana.sidemenu",!0),n.a.bootData||(n.a.bootData={user:{},settings:{}}),this.user=new l,this.isSignedIn=this.user.isSignedIn,this.isGrafanaAdmin=this.user.isGrafanaAdmin,this.isEditor=this.hasRole("Editor")||this.hasRole("Admin"),this.hasEditPermissionInFolders=this.user.hasEditPermissionInFolders}return t.prototype.hasRole=function(t){return this.user.orgRole===t},t.prototype.isGrafanaVisible=function(){return!(void 0!==document.visibilityState&&"visible"!==document.visibilityState)},t.prototype.toggleSideMenu=function(){this.sidemenu=!this.sidemenu,o.a.set("grafana.sidemenu",this.sidemenu)},t}());s.c.factory("contextSrv",function(){return c})},,,,function(t,e,r){"use strict";r.d(e,"b",function(){return c});var n=r(12),a=r(42),i=r(1),s=r.n(i);function o(t,e){if(!t)return!1;if("/"===t[0]){var r=n.a.stringToJsRegex(t);return null!=e.match(r)}return t===e}function l(t){return 0===t?.001:t/10}function c(t,e,r){for(var i=0;i<t.length;i++){var o=t[i],l=e.yaxes[(o.yaxis||1)-1],c=n.a.valueFormats[l.format];if(s.a.isNumber(e.decimals))o.updateLegendValues(c,e.decimals,null);else if(s.a.isNumber(l.decimals))o.updateLegendValues(c,l.decimals+1,null);else{var d=u(t),p=d.datamin,h=d.datamax,f=Object(a.getFlotTickDecimals)(p,h,l,r),m=f.tickDecimals,g=f.scaledDecimals,v=(m||-1)+1;o.updateLegendValues(c,v,g+2)}}}function u(t){for(var e=null,r=null,n=0,a=t;n<a.length;n++){var i=a[n];(null===r||r<i.stats.max)&&(r=i.stats.max),(null===e||e>i.stats.min)&&(e=i.stats.min)}return{datamin:e,datamax:r}}var d=function(){function t(t){this.datapoints=t.datapoints,this.label=t.alias,this.id=t.alias,this.alias=t.alias,this.aliasEscaped=s.a.escape(t.alias),this.color=t.color,this.bars={fillColor:t.color},this.valueFormater=n.a.valueFormats.none,this.stats={},this.legend=!0,this.unit=t.unit,this.hasMsResolution=this.isMsResolutionNeeded()}return t.prototype.applySeriesOverrides=function(t){this.lines={},this.dashes={dashLength:[]},this.points={},this.yaxis=1,this.zindex=0,this.nullPointMode=null,delete this.stack,delete this.bars.show;for(var e=0;e<t.length;e++){var r=t[e];o(r.alias,this.alias)&&(void 0!==r.lines&&(this.lines.show=r.lines),void 0!==r.dashes&&(this.dashes.show=r.dashes,this.lines.lineWidth=0),void 0!==r.points&&(this.points.show=r.points),void 0!==r.bars&&(this.bars.show=r.bars),void 0!==r.fill&&(this.lines.fill=l(r.fill)),void 0!==r.stack&&(this.stack=r.stack),void 0!==r.linewidth&&(this.lines.lineWidth=this.dashes.show?0:r.linewidth,this.dashes.lineWidth=r.linewidth),void 0!==r.dashLength&&(this.dashes.dashLength[0]=r.dashLength),void 0!==r.spaceLength&&(this.dashes.dashLength[1]=r.spaceLength),void 0!==r.nullPointMode&&(this.nullPointMode=r.nullPointMode),void 0!==r.pointradius&&(this.points.radius=r.pointradius),void 0!==r.steppedLine&&(this.lines.steps=r.steppedLine),void 0!==r.zindex&&(this.zindex=r.zindex),void 0!==r.fillBelowTo&&(this.fillBelowTo=r.fillBelowTo),void 0!==r.color&&this.setColor(r.color),void 0!==r.transform&&(this.transform=r.transform),void 0!==r.legend&&(this.legend=r.legend),void 0!==r.hideTooltip&&(this.hideTooltip=r.hideTooltip),void 0!==r.yaxis&&(this.yaxis=r.yaxis))}},t.prototype.getFlotPairs=function(t){var e=[];this.stats.total=0,this.stats.max=-Number.MAX_VALUE,this.stats.min=Number.MAX_VALUE,this.stats.logmin=Number.MAX_VALUE,this.stats.avg=null,this.stats.current=null,this.stats.first=null,this.stats.delta=0,this.stats.diff=null,this.stats.range=null,this.stats.timeStep=Number.MAX_VALUE,this.allIsNull=!0,this.allIsZero=!0;for(var r,n,a,i="connected"===t,o="null as zero"===t,l=0,c=0,u=!0,d=0;d<this.datapoints.length;d++){if(n=this.datapoints[d][0],r=this.datapoints[d][1],void 0!==a){var p=r-a;p<this.stats.timeStep&&(this.stats.timeStep=p)}if(a=r,null===n){if(i)continue;o&&(n=0)}null!==n&&(s.a.isNumber(n)&&(this.stats.total+=n,this.allIsNull=!1,l++),n>this.stats.max&&(this.stats.max=n),n<this.stats.min&&(this.stats.min=n),null===this.stats.first?this.stats.first=n:c>n?(u=!1,d===this.datapoints.length-1&&(this.stats.delta+=n)):(this.stats.delta+=u?n-c:n,u=!0),c=n,n<this.stats.logmin&&n>0&&(this.stats.logmin=n),0!==n&&(this.allIsZero=!1)),e.push([r,n])}return this.stats.max===-Number.MAX_VALUE&&(this.stats.max=null),this.stats.min===Number.MAX_VALUE&&(this.stats.min=null),e.length&&!this.allIsNull&&(this.stats.avg=this.stats.total/l,this.stats.current=e[e.length-1][1],null===this.stats.current&&e.length>1&&(this.stats.current=e[e.length-2][1])),null!==this.stats.max&&null!==this.stats.min&&(this.stats.range=this.stats.max-this.stats.min),null!==this.stats.current&&null!==this.stats.first&&(this.stats.diff=this.stats.current-this.stats.first),this.stats.count=e.length,e},t.prototype.updateLegendValues=function(t,e,r){this.valueFormater=t,this.decimals=e,this.scaledDecimals=r},t.prototype.formatValue=function(t){return s.a.isFinite(t)||(t=null),this.valueFormater(t,this.decimals,this.scaledDecimals)},t.prototype.isMsResolutionNeeded=function(){for(var t=0;t<this.datapoints.length;t++)if(null!==this.datapoints[t][1]){var e=this.datapoints[t][1].toString();if(13===e.length&&e%1e3!=0)return!0}return!1},t.prototype.hideFromLegend=function(t){return!(!t.hideEmpty||!this.allIsNull)||(!this.legend||!(!t.hideZero||!this.allIsZero))},t.prototype.setColor=function(t){this.color=t,this.bars.fillColor=t},t}();e.a=d},function(t,e,r){"use strict";r.d(e,"a",function(){return n}),r.d(e,"h",function(){return u}),r.d(e,"d",function(){return p}),r.d(e,"g",function(){return h}),r.d(e,"c",function(){return f}),r.d(e,"e",function(){return m}),r.d(e,"i",function(){return v}),r.d(e,"f",function(){return b}),r.d(e,"b",function(){return y});var n,a=r(2),i=r(15),s=r(44),o=r(169),l=r(9);!function(t){t.LoadFolder="LOAD_FOLDER",t.SetFolderTitle="SET_FOLDER_TITLE",t.SaveFolder="SAVE_FOLDER",t.LoadFolderPermissions="LOAD_FOLDER_PERMISSONS"}(n||(n={}));var c=function(t){return{type:n.LoadFolder,payload:t}},u=function(t){return{type:n.SetFolderTitle,payload:t}},d=function(t){return{type:n.LoadFolderPermissions,payload:t}};function p(t){var e=this;return function(r){return a.b(e,void 0,void 0,function(){var e;return a.d(this,function(n){switch(n.label){case 0:return[4,Object(i.a)().getFolderByUid(t)];case 1:return e=n.sent(),r(c(e)),r(Object(s.d)(Object(o.a)(e))),[2]}})})}}function h(t){var e=this;return function(r){return a.b(e,void 0,void 0,function(){var e;return a.d(this,function(n){switch(n.label){case 0:return[4,Object(i.a)().put("/api/folders/"+t.uid,{title:t.title,version:t.version})];case 1:return e=n.sent(),l.a.emit("alert-success",["文件夹已保存"]),r(Object(s.c)({path:e.url+"/settings"})),[2]}})})}}function f(t){var e=this;return function(r){return a.b(e,void 0,void 0,function(){return a.d(this,function(e){switch(e.label){case 0:return[4,Object(i.a)().deleteFolder(t,!0)];case 1:return e.sent(),r(Object(s.c)({path:"dashboards"})),[2]}})})}}function m(t){var e=this;return function(r){return a.b(e,void 0,void 0,function(){var e;return a.d(this,function(n){switch(n.label){case 0:return[4,Object(i.a)().get("/api/folders/"+t+"/permissions")];case 1:return e=n.sent(),r(d(e)),[2]}})})}}function g(t){return{userId:t.userId,teamId:t.teamId,role:t.role,permission:t.permission}}function v(t,e){var r=this;return function(n,s){return a.b(r,void 0,void 0,function(){var r,o,l,c,u,d;return a.d(this,function(a){switch(a.label){case 0:for(r=s().folder,o=[],l=0,c=r.permissions;l<c.length;l++)(u=c[l]).inherited||(d=g(u),t===u&&(d.permission=e),o.push(d));return[4,Object(i.a)().post("/api/folders/"+r.uid+"/permissions",{items:o})];case 1:return a.sent(),[4,n(m(r.uid))];case 2:return a.sent(),[2]}})})}}function b(t){var e=this;return function(r,n){return a.b(e,void 0,void 0,function(){var e,s,o,l,c;return a.d(this,function(a){switch(a.label){case 0:for(e=n().folder,s=[],o=0,l=e.permissions;o<l.length;o++)(c=l[o]).inherited||c===t||s.push(g(c));return[4,Object(i.a)().post("/api/folders/"+e.uid+"/permissions",{items:s})];case 1:return a.sent(),[4,r(m(e.uid))];case 2:return a.sent(),[2]}})})}}function y(t){var e=this;return function(r,n){return a.b(e,void 0,void 0,function(){var e,s,o,l,c;return a.d(this,function(a){switch(a.label){case 0:for(e=n().folder,s=[],o=0,l=e.permissions;o<l.length;o++)(c=l[o]).inherited||s.push(g(c));return s.push({userId:t.userId,teamId:t.teamId,role:t.role,permission:t.permission}),[4,Object(i.a)().post("/api/folders/"+e.uid+"/permissions",{items:s})];case 1:return a.sent(),[4,r(m(e.uid))];case 2:return a.sent(),[2]}})})}}},,,,function(t,e,r){"use strict";r.d(e,"a",function(){return n}),r.d(e,"d",function(){return s}),r.d(e,"e",function(){return o}),r.d(e,"c",function(){return u}),r.d(e,"b",function(){return d});var n,a=r(2),i=r(15);!function(t){t.LoadPlugins="LOAD_PLUGINS",t.LoadPluginDashboards="LOAD_PLUGIN_DASHBOARDS",t.SetPluginsSearchQuery="SET_PLUGIN_SEARCH_QUERY",t.SetLayoutMode="SET_LAYOUT_MODE"}(n||(n={}));var s=function(t){return{type:n.SetLayoutMode,payload:t}},o=function(t){return{type:n.SetPluginsSearchQuery,payload:t}},l=function(t){return{type:n.LoadPlugins,payload:t}},c=function(t){return{type:n.LoadPluginDashboards,payload:t}};function u(){var t=this;return function(e){return a.b(t,void 0,void 0,function(){var t;return a.d(this,function(r){switch(r.label){case 0:return[4,Object(i.a)().get("api/plugins",{embedded:0})];case 1:return t=r.sent(),e(l(t)),[2]}})})}}function d(){var t=this;return function(e,r){return a.b(t,void 0,void 0,function(){var t,n;return a.d(this,function(a){switch(a.label){case 0:return t=r().dataSources.dataSource.type,[4,Object(i.a)().get("api/plugins/"+t+"/dashboards")];case 1:return n=a.sent(),e(c(n)),[2]}})})}}},,,,,function(t,e,r){"use strict";r.d(e,"b",function(){return o});var n=r(1),a=r.n(n),i=function(){function t(t){var e=this;this.columns=[],this.columnMap={},this.rows=[],this.type="table",t&&(t.columns&&t.columns.forEach(function(t){return e.addColumn(t)}),t.rows&&t.rows.forEach(function(t){return e.addRow(t)}))}return t.prototype.sort=function(t){null===t.col||this.columns.length<=t.col||(this.rows.sort(function(e,r){return+(null==(e=e[t.col]))-+(null==(r=r[t.col]))||+(e>r)||-(e<r)}),t.desc&&this.rows.reverse(),this.columns[t.col].sort=!0,this.columns[t.col].desc=t.desc)},t.prototype.addColumn=function(t){this.columnMap[t.text]||(this.columns.push(t),this.columnMap[t.text]=t)},t.prototype.addRow=function(t){this.rows.push(t)},t}();function s(t,e,r){for(var n=!1,a=0;a<t.length;a++)if(void 0!==e[a]&&void 0!==r[a]){if(e[a]!==r[a])return!1}else void 0!==e[a]&&void 0!==r[a]||(n=!0);return n}function o(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=t||new i;if(1===arguments.length)return n;if(2===arguments.length)return n.columns=e[0].columns.slice(),n.rows=e[0].rows.slice(),n;var o={},l=e.slice().reduce(function(t,e){return e.columns.forEach(function(e){var r=e.text;void 0===o[r]&&(o[r]=t.length,t.push(e))}),t},[]),c=e.map(function(t){return t.columns.map(function(t){return o[t.text]})}),u=e.reduce(function(t,e,r){var n=c[r];return e.rows.forEach(function(e){var r=[];n.forEach(function(t,n){r[t]=e[n]}),t.push(r)}),t},[]),d={},p=u.reduce(function(t,e,r){if(!d[r]){for(var n=r+1;n<u.length;){var i=a.a.findIndex(u,function(t){return s(l,e,t)},n);if(!(i>-1))break;for(var o=u[i],c=0;c<l.length;c++)void 0===e[c]&&void 0!==o[c]&&(e[c]=o[c]);d[i]=o,n=i+1}t.push(e)}return t},[]);return n.columns=l,n.rows=p,n}e.a=i},function(t,e,r){"use strict";r.d(e,"b",function(){return n}),r.d(e,"a",function(){return a}),r.d(e,"d",function(){return i}),r.d(e,"g",function(){return s}),r.d(e,"c",function(){return o}),r.d(e,"f",function(){return l}),r.d(e,"e",function(){return c});var n=function(t){return t.searchQuery},a=function(t){return t.searchMemberQuery},i=function(t){return t.groups},s=function(t){return t.teams.length},o=function(t,e){return t.team.id===parseInt(e,10)?t.team:null},l=function(t){var e=RegExp(t.searchQuery,"i");return t.teams.filter(function(t){return e.test(t.name)})},c=function(t){var e=RegExp(t.searchMemberQuery,"i");return t.members.filter(function(t){return e.test(t.login)||e.test(t.email)})}},function(t,e,r){"use strict";r.d(e,"a",function(){return n}),r.d(e,"f",function(){return l}),r.d(e,"c",function(){return c}),r.d(e,"b",function(){return u}),r.d(e,"g",function(){return d}),r.d(e,"d",function(){return p}),r.d(e,"e",function(){return h});var n,a=r(2),i=r(15);!function(t){t.LoadUsers="LOAD_USERS",t.LoadInvitees="LOAD_INVITEES",t.SetUsersSearchQuery="SET_USERS_SEARCH_QUERY"}(n||(n={}));var s=function(t){return{type:n.LoadUsers,payload:t}},o=function(t){return{type:n.LoadInvitees,payload:t}},l=function(t){return{type:n.SetUsersSearchQuery,payload:t}};function c(){var t=this;return function(e){return a.b(t,void 0,void 0,function(){var t;return a.d(this,function(r){switch(r.label){case 0:return[4,Object(i.a)().get("/api/org/users")];case 1:return t=r.sent(),e(s(t)),[2]}})})}}function u(){var t=this;return function(e){return a.b(t,void 0,void 0,function(){var t;return a.d(this,function(r){switch(r.label){case 0:return[4,Object(i.a)().get("/api/org/invites")];case 1:return t=r.sent(),e(o(t)),[2]}})})}}function d(t){var e=this;return function(r){return a.b(e,void 0,void 0,function(){return a.d(this,function(e){switch(e.label){case 0:return[4,Object(i.a)().patch("/api/org/users/"+t.userId,{role:t.role})];case 1:return e.sent(),r(c()),[2]}})})}}function p(t){var e=this;return function(r){return a.b(e,void 0,void 0,function(){return a.d(this,function(e){switch(e.label){case 0:return[4,Object(i.a)().delete("/api/org/users/"+t)];case 1:return e.sent(),r(c()),[2]}})})}}function h(t){var e=this;return function(r){return a.b(e,void 0,void 0,function(){return a.d(this,function(e){switch(e.label){case 0:return[4,Object(i.a)().patch("/api/org/invites/"+t+"/revoke",{})];case 1:return e.sent(),r(u()),[2]}})})}}},,,,,,function(t,e,r){"use strict";var n=r(0),a=r.n(n);e.a=function(t){var e="Loading "+t.pageName+"...";return a.a.createElement("div",{className:"page-loader-wrapper"},a.a.createElement("i",{className:"page-loader-wrapper__spinner fa fa-spinner fa-spin"}),a.a.createElement("div",{className:"page-loader-wrapper__text"},e))}},function(t,e,r){"use strict";r.d(e,"a",function(){return n});var n,a=r(0),i=r.n(a);!function(t){t.Grid="grid",t.List="list"}(n||(n={}));e.b=function(t){var e=t.mode,r=t.onLayoutModeChanged;return i.a.createElement("div",{className:"layout-selector"},i.a.createElement("button",{onClick:function(){r(n.List)},className:e===n.List?"active":""},i.a.createElement("i",{className:"fa fa-list"})),i.a.createElement("button",{onClick:function(){r(n.Grid)},className:e===n.Grid?"active":""},i.a.createElement("i",{className:"fa fa-th"})))}},,function(t,e,r){"use strict";r.d(e,"a",function(){return l});var n=r(111),a=r(1),i=r.n(a),s={events:!0,fullscreen:!0,isEditing:!0,hasRefreshed:!0},o={gridPos:{x:0,y:0,h:3,w:6},datasource:null,targets:[{}]},l=function(){function t(t){for(var e in this.events=new n.a,t)this[e]=t[e];i.a.defaultsDeep(this,i.a.cloneDeep(o))}return t.prototype.getOptions=function(){return this[this.getOptionsKey()]||{}},t.prototype.updateOptions=function(t){var e={};e[this.getOptionsKey()]=t,Object.assign(this,e),this.render()},t.prototype.getOptionsKey=function(){return this.type+"Options"},t.prototype.getSaveModel=function(){var t={};for(var e in this)!s[e]&&this.hasOwnProperty(e)&&(i.a.isEqual(this[e],o[e])||(t[e]=i.a.cloneDeep(this[e])));return t},t.prototype.setViewMode=function(t,e){this.fullscreen=t,this.isEditing=e,this.events.emit("view-mode-changed")},t.prototype.updateGridPos=function(t){var e=!1;this.gridPos.w===t.w&&this.gridPos.h===t.h||(e=!0),this.gridPos.x=t.x,this.gridPos.y=t.y,this.gridPos.w=t.w,this.gridPos.h=t.h,e&&this.events.emit("panel-size-changed")},t.prototype.resizeDone=function(){this.events.emit("panel-size-changed")},t.prototype.refresh=function(){this.hasRefreshed=!0,this.events.emit("refresh")},t.prototype.render=function(){this.hasRefreshed?this.events.emit("render"):this.refresh()},t.prototype.initialized=function(){this.events.emit("panel-initialized")},t.prototype.changeType=function(t){this.type=t,delete this.thresholds,delete this.alert},t.prototype.destroy=function(){this.events.emit("panel-teardown"),this.events.removeAllListeners()},t}()},,,,,,,,,,,,,function(t,e,r){"use strict";e.a={clearIndicator:function(){return{}},container:function(){return{}},control:function(){return{}},dropdownIndicator:function(){return{}},group:function(){return{}},groupHeading:function(){return{}},indicatorsContainer:function(){return{}},indicatorSeparator:function(){return{}},input:function(){return{}},loadingIndicator:function(){return{}},loadingMessage:function(){return{}},menu:function(){return{}},menuList:function(){return{}},multiValue:function(){return{}},multiValueLabel:function(){return{}},multiValueRemove:function(){return{}},noOptionsMessage:function(){return{}},option:function(){return{}},placeholder:function(){return{}},singleValue:function(){return{}},valueContainer:function(){return{}}}},function(t,e,r){"use strict";var n=r(2),a=r(0),i=r.n(a),s=r(237),o=r.n(s),l={transition:"max-height 200ms ease-in-out",overflow:"hidden"};e.a=function(t){var e=t.children,r=t.in,a=t.maxHeight,s=void 0===a?"200px":a,c=t.style,u=void 0===c?l:c,d={exited:{maxHeight:0},entering:{maxHeight:s},entered:{maxHeight:s,overflow:"visible"},exiting:{maxHeight:0}};return i.a.createElement(o.a,{in:r,timeout:200},function(t){return i.a.createElement("div",{style:n.a({},u,d[t])},e)})}},,,function(t,e,r){"use strict";r.d(e,"a",function(){return n}),r.d(e,"c",function(){return c}),r.d(e,"g",function(){return d}),r.d(e,"f",function(){return p}),r.d(e,"b",function(){return h}),r.d(e,"d",function(){return f}),r.d(e,"e",function(){return m});var n,a=r(2),i=r(15),s=r(9),o=r(68);!function(t){t.LoadDashboardPermissions="LOAD_DASHBOARD_PERMISSIONS",t.LoadStarredDashboards="LOAD_STARRED_DASHBOARDS"}(n||(n={}));var l=function(t){return{type:n.LoadDashboardPermissions,payload:t}};function c(t){var e=this;return function(r){return a.b(e,void 0,void 0,function(){var e;return a.d(this,function(n){switch(n.label){case 0:return[4,Object(i.a)().get("/api/dashboards/id/"+t+"/permissions")];case 1:return e=n.sent(),r(l(e)),[2]}})})}}function u(t){return{userId:t.userId,teamId:t.teamId,role:t.role,permission:t.permission}}function d(t,e,r){var n=this;return function(s,o){return a.b(n,void 0,void 0,function(){var n,l,d,p,h,f;return a.d(this,function(a){switch(a.label){case 0:for(n=o().dashboard,l=[],d=0,p=n.permissions;d<p.length;d++)(h=p[d]).inherited||(f=u(h),e===h&&(f.permission=r),l.push(f));return[4,Object(i.a)().post("/api/dashboards/id/"+t+"/permissions",{items:l})];case 1:return a.sent(),[4,s(c(t))];case 2:return a.sent(),[2]}})})}}function p(t,e){var r=this;return function(n,s){return a.b(r,void 0,void 0,function(){var r,o,l,d,p;return a.d(this,function(a){switch(a.label){case 0:for(r=s().dashboard,o=[],l=0,d=r.permissions;l<d.length;l++)(p=d[l]).inherited||p===e||o.push(u(p));return[4,Object(i.a)().post("/api/dashboards/id/"+t+"/permissions",{items:o})];case 1:return a.sent(),[4,n(c(t))];case 2:return a.sent(),[2]}})})}}function h(t,e){var r=this;return function(n,s){return a.b(r,void 0,void 0,function(){var r,o,l,d,p;return a.d(this,function(a){switch(a.label){case 0:for(r=s().dashboard,o=[],l=0,d=r.permissions;l<d.length;l++)(p=d[l]).inherited||o.push(u(p));return o.push({userId:e.userId,teamId:e.teamId,role:e.role,permission:e.permission}),[4,Object(i.a)().post("/api/dashboards/id/"+t+"/permissions",{items:o})];case 1:return a.sent(),[4,n(c(t))];case 2:return a.sent(),[2]}})})}}function f(t,e){var r=this;return function(n){return a.b(r,void 0,void 0,function(){return a.d(this,function(r){switch(r.label){case 0:return[4,Object(i.a)().post("/api/dashboards/import",t)];case 1:return r.sent(),s.a.emit("alert-success",["仪表盘已导入",e]),n(Object(o.b)()),[2]}})})}}function m(t){var e=this;return function(r){return a.b(e,void 0,void 0,function(){return a.d(this,function(e){switch(e.label){case 0:return[4,Object(i.a)().delete("/api/dashboards/"+t)];case 1:return e.sent(),r(Object(o.b)()),[2]}})})}}},,,,function(t,e,r){"use strict";r.d(e,"c",function(){return n}),r.d(e,"b",function(){return a}),r.d(e,"a",function(){return i}),r.d(e,"f",function(){return s}),r.d(e,"e",function(){return o}),r.d(e,"d",function(){return l});var n=function(t){var e=new RegExp(t.searchQuery,"i");return t.dataSources.filter(function(t){return e.test(t.name)||e.test(t.database)})},a=function(t){var e=new RegExp(t.dataSourceTypeSearchQuery,"i");return t.dataSourceTypes.filter(function(t){return e.test(t.name)})},i=function(t,e){return t.dataSource.id===parseInt(e,10)?t.dataSource:null},s=function(t){return t.searchQuery},o=function(t){return t.layoutMode},l=function(t){return t.dataSourcesCount}},,,,,,function(t,e,r){"use strict";r.d(e,"a",function(){return a});var n=r(594),a=function(){function t(){this.emitter=new n.EventEmitter}return t.prototype.emit=function(t,e){this.emitter.emit(t,e)},t.prototype.on=function(t,e,r){var n=this;if(this.emitter.on(t,e),r)var a=r.$on("$destroy",function(){n.emitter.off(t,e),a()})},t.prototype.removeAllListeners=function(t){this.emitter.removeAllListeners(t)},t.prototype.off=function(t,e){this.emitter.off(t,e)},t}()},function(t,e,r){"use strict";var n=r(2),a=r(0),i=r.n(a),s=r(61);e.a=function(t){var e=t.selectProps.menuIsOpen;return i.a.createElement(s.a.IndicatorsContainer,n.a({},t),i.a.createElement("span",{className:"gf-form-select-box__select-arrow "+(e?"gf-form-select-box__select-arrow--reversed":"")}))}},function(t,e,r){"use strict";var n=r(2),a=r(0),i=r.n(a),s=r(61);e.a=function(t){var e=t.children,r=t.className;return i.a.createElement(s.a.Option,n.a({},t),i.a.createElement("div",{className:"description-picker-option__button btn btn-link "+r},e))}},,function(t,e,r){"use strict";r.d(e,"c",function(){return p}),r.d(e,"a",function(){return f}),r.d(e,"b",function(){return m});var n=r(1),a=r.n(n),i=r(4),s=r.n(i),o=r(27),l={s:{display:"秒"},m:{display:"分"},h:{display:"小时"},d:{display:"天"},w:{display:"周"},M:{display:"月"},y:{display:"年"}},c=[{from:"now/d",to:"now/d",display:"今天",section:2},{from:"now/d",to:"now",display:"今天到目前",section:2},{from:"now/w",to:"now/w",display:"本周",section:2},{from:"now/w",to:"now",display:"本周到目前",section:2},{from:"now/M",to:"now/M",display:"本月",section:2},{from:"now/M",to:"now",display:"本月到目前",section:2},{from:"now/y",to:"now/y",display:"今年",section:2},{from:"now/y",to:"now",display:"今年到目前",section:2},{from:"now-1d/d",to:"now-1d/d",display:"昨天",section:1},{from:"now-2d/d",to:"now-2d/d",display:"前天",section:1},{from:"now-7d/d",to:"now-7d/d",display:"上周的今天",section:1},{from:"now-1w/w",to:"now-1w/w",display:"上周",section:1},{from:"now-1M/M",to:"now-1M/M",display:"上月",section:1},{from:"now-5m",to:"now",display:"过去5分钟",section:3},{from:"now-15m",to:"now",display:"过去15分钟",section:3},{from:"now-30m",to:"now",display:"过去30分钟",section:3},{from:"now-1h",to:"now",display:"过去1小时",section:3},{from:"now-3h",to:"now",display:"过去3小时",section:3},{from:"now-6h",to:"now",display:"过去6小时",section:3},{from:"now-12h",to:"now",display:"过去12小时",section:3},{from:"now-24h",to:"now",display:"过去24小时",section:3},{from:"now-2d",to:"now",display:"过去2天",section:0},{from:"now-7d",to:"now",display:"过去7天",section:0},{from:"now-30d",to:"now",display:"过去30天",section:0}],u="YYYY-MM-DD HH:mm:ss",d={};function p(t,e){return a.a.groupBy(c,function(t){return t.active=t.display===e,t.section})}function h(t){return t.format(u)}function f(t){var e=0!==t.indexOf("+");-1===t.indexOf("now")&&(t=(e?"now-":"now")+t);var r=d[t+" 至 now"];if(r)return r;r=e?{from:t,to:"now"}:{from:"now",to:t};var n=/^now([-+])(\d+)(\w)/.exec(t);if(n){var a=n[3],i=parseInt(n[2],10),s=l[a];s&&(r.display=e?"过去":"未来",r.display+=i+""+s.display,r.section=s.section)}else r.display=r.from+" 至 "+r.to,r.invalid=!0;return r}function m(t){var e=d[t.from.toString()+" 至 "+t.to.toString()];if(e)return e.display;if(s.a.isMoment(t.from)&&s.a.isMoment(t.to))return h(t.from)+" 至 "+h(t.to);if(s.a.isMoment(t.from)){var r=o.parse(t.to,!0);return h(t.from)+" 至 "+r.fromNow()}return s.a.isMoment(t.to)?o.parse(t.from,!1).fromNow()+" 至 "+h(t.to):"now"===t.to.toString()?f(t.from).display:t.from.toString()+" 至 "+t.to.toString()}a.a.each(c,function(t){d[t.from+" 至 "+t.to]=t})},function(t,e,r){"use strict";var n=r(40),a=r(1),i=r.n(a),s=r(8),o=new(function(){function t(){}return t.prototype.addDashboardImpression=function(t){var e=this.impressionKey(s.a),r=[];n.a.exists(e)&&(r=JSON.parse(n.a.get(e)),i.a.isArray(r)||(r=[])),(r=r.filter(function(e){return t!==e})).unshift(t),r.length>50&&r.pop(),n.a.set(e,JSON.stringify(r))},t.prototype.getDashboardOpened=function(){var t=n.a.get(this.impressionKey(s.a))||"[]";return t=JSON.parse(t),t=i.a.filter(t,function(t){return i.a.isNumber(t)})},t.prototype.impressionKey=function(t){return"dashboard_impressions-"+t.bootData.user.orgId},t}());e.a=o},function(t,e,r){"use strict";var n=r(2),a=r(0),i=r.n(a),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.c(e,t),e.prototype.render=function(){var t=this.props.model,e=t.title,r=t.buttonIcon,n=t.buttonLink,a=t.buttonTitle,s=t.onClick,o=t.proTip,l=t.proTipLink,c=t.proTipLinkTitle,u=t.proTipTarget;return i.a.createElement("div",{className:"empty-list-cta"},i.a.createElement("div",{className:"empty-list-cta__title"},e),i.a.createElement("a",{onClick:s,href:n,className:"empty-list-cta__button btn btn-xlarge btn-success"},i.a.createElement("i",{className:r}),a),i.a.createElement("div",{className:"empty-list-cta__pro-tip"},i.a.createElement("i",{className:"fa fa-rocket"})," ProTip: ",o,i.a.createElement("a",{className:"text-link empty-list-cta__pro-tip-link",href:l,target:u},c)))},e}(a.Component);e.a=s},,function(t,e,r){"use strict";var n=r(2),a=r(0),i=r.n(a),s=r(179);var o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.showTooltip=function(){(0,e.props.tooltipSetState)(function(t){return n.a({},t,{show:!0})})},e.hideTooltip=function(){(0,e.props.tooltipSetState)(function(t){return n.a({},t,{show:!1})})},e}return n.c(e,t),e.prototype.render=function(){return i.a.createElement(s.Target,{className:"popper__target",onMouseOver:this.showTooltip,onMouseOut:this.hideTooltip},this.props.children)},e}(a.PureComponent);e.a=function(t){return function(e){function r(t){var r=e.call(this,t)||this;return r.setState=r.setState.bind(r),r.state={placement:r.props.placement||"auto",show:!1},r}return n.c(r,e),r.prototype.componentWillReceiveProps=function(t){t.placement&&t.placement!==this.state.placement&&this.setState(function(e){return n.a({},e,{placement:t.placement})})},r.prototype.renderContent=function(t){if("function"==typeof t){var e=t;return i.a.createElement(e,null)}return t},r.prototype.render=function(){var e=this.props,r=e.content,a=e.className;return i.a.createElement(s.Manager,{className:"popper__manager "+(a||"")},i.a.createElement(t,n.a({},this.props,{tooltipSetState:this.setState})),this.state.show?i.a.createElement(s.Popper,{placement:this.state.placement,className:"popper"},this.renderContent(r),i.a.createElement(s.Arrow,{className:"popper__arrow"})):null)},r}(i.a.Component)}(o)},,function(t,e,r){"use strict";r.d(e,"a",function(){return n}),r.d(e,"b",function(){return o}),r.d(e,"d",function(){return l}),r.d(e,"c",function(){return c}),r.d(e,"e",function(){return u});var n,a=r(2),i=r(15);!function(t){t.LoadApiKeys="LOAD_API_KEYS",t.SetApiKeysSearchQuery="SET_API_KEYS_SEARCH_QUERY"}(n||(n={}));var s=function(t){return{type:n.LoadApiKeys,payload:t}};function o(t,e){var r=this;return function(n){return a.b(r,void 0,void 0,function(){var r;return a.d(this,function(a){switch(a.label){case 0:return[4,Object(i.a)().post("/api/auth/keys",t)];case 1:return r=a.sent(),n(u("")),n(l()),e(r.key),[2]}})})}}function l(){var t=this;return function(e){return a.b(t,void 0,void 0,function(){var t;return a.d(this,function(r){switch(r.label){case 0:return[4,Object(i.a)().get("/api/auth/keys")];case 1:return t=r.sent(),e(s(t)),[2]}})})}}function c(t){var e=this;return function(r){return a.b(e,void 0,void 0,function(){return a.d(this,function(e){return Object(i.a)().delete("/api/auth/keys/"+t).then(r(l())),[2]})})}}var u=function(t){return{type:n.SetApiKeysSearchQuery,payload:t}}},,,,,,,,,,,,,,,,,,,,function(t,e,r){"use strict";r.d(e,"a",function(){return n}),r.d(e,"b",function(){return a});var n=function(t){return t.routeParams.id},a=function(t){return t.routeParams.page}},function(t,e,r){"use strict";r.d(e,"a",function(){return a}),r.d(e,"b",function(){return l}),r.d(e,"c",function(){return d}),r.d(e,"d",function(){return p});var n,a,i=r(2),s=r(13),o=r(31);!function(t){t.crit="crit",t.warn="warn",t.err="error",t.error="error",t.info="info",t.debug="debug",t.trace="trace",t.none="none"}(a||(a={}));var l,c=((n={})[a.crit]=o.g[7],n[a.warn]=o.g[1],n[a.err]=o.g[4],n[a.error]=o.g[4],n[a.info]=o.g[0],n[a.debug]=o.g[3],n[a.trace]=o.g[3],n[a.none]="#eee",n);!function(t){t.none="none",t.exact="exact",t.numbers="numbers",t.signature="signature"}(l||(l={}));var u=/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-6]\d[,\.]\d+([+-][0-2]\d:[0-5]\d|Z)/g;function d(t,e){if(e===l.none)return t;var r=t.rows.reduce(function(t,r,n,a){var i=t[t.length-1];return n>0&&function(t,e,r){switch(r){case l.exact:return t.entry.replace(u,"")===e.entry.replace(u,"");case l.numbers:return t.entry.replace(/\d/g,"")===e.entry.replace(/\d/g,"");case l.signature:return t.entry.replace(/\w/g,"")===e.entry.replace(/\w/g,"");default:return!1}}(r,i,e)?i.duplicates++:(r.duplicates=0,t.push(r)),t},[]);return i.a({},t,{rows:r})}function p(t,e){var r={};return t.forEach(function(t){r[t.logLevel]||(r[t.logLevel]={lastTs:null,datapoints:[],alias:t.logLevel});var n=r[t.logLevel],a=Math.round(t.timeEpochMs/e/10)*e*10;a===n.lastTs?n.datapoints[n.datapoints.length-1][0]++:(n.datapoints.push([1,a]),n.lastTs=a)}),Object.keys(r).reduce(function(t,e){if(r[e]){var n=new s.b(r[e]);n.setColor(c[e]),t.push(n)}return t},[])}},function(t,e,r){"use strict";r.d(e,"a",function(){return n}),r.d(e,"c",function(){return o}),r.d(e,"b",function(){return l}),r.d(e,"d",function(){return c});var n,a=r(2),i=r(15);!function(t){t.LoadAlertRules="LOAD_ALERT_RULES",t.SetSearchQuery="SET_ALERT_SEARCH_QUERY"}(n||(n={}));var s=function(t){return{type:n.LoadAlertRules,payload:t}},o=function(t){return{type:n.SetSearchQuery,payload:t}};function l(t){var e=this;return function(r){return a.b(e,void 0,void 0,function(){var e;return a.d(this,function(n){switch(n.label){case 0:return[4,Object(i.a)().get("/api/alerts",t)];case 1:return e=n.sent(),r(s(e)),[2]}})})}}function c(t,e){var r=this;return function(n,s){return a.b(r,void 0,void 0,function(){var r;return a.d(this,function(a){switch(a.label){case 0:return[4,Object(i.a)().post("/api/alerts/"+t+"/pause",e)];case 1:return a.sent(),r=s().location.query.state||"all",n(l({state:r.toString()})),[2]}})})}}},function(t,e,r){"use strict";r.d(e,"a",function(){return n}),r.d(e,"c",function(){return o}),r.d(e,"b",function(){return l}),r.d(e,"d",function(){return c});var n,a=r(2),i=r(15);!function(t){t.LoadOrganization="LOAD_ORGANISATION",t.SetOrganizationName="SET_ORGANIZATION_NAME"}(n||(n={}));var s=function(t){return{type:n.LoadOrganization,payload:t}},o=function(t){return{type:n.SetOrganizationName,payload:t}};function l(){var t=this;return function(e){return a.b(t,void 0,void 0,function(){var t;return a.d(this,function(r){switch(r.label){case 0:return[4,Object(i.a)().get("/api/org")];case 1:return t=r.sent(),e(s(t)),[2,t]}})})}}function c(){var t=this;return function(e,r){return a.b(t,void 0,void 0,function(){var t;return a.d(this,function(n){switch(n.label){case 0:return t=r().organization.organization,[4,Object(i.a)().put("/api/org",{name:t.name})];case 1:return n.sent(),e(l()),[2]}})})}}},,function(t,e,r){"use strict";r.d(e,"c",function(){return n}),r.d(e,"a",function(){return a}),r.d(e,"b",function(){return i}),r.d(e,"d",function(){return s});var n=function(t){var e=new RegExp(t.searchQuery,"i");return t.users.filter(function(t){return e.test(t.login)||e.test(t.email)})},a=function(t){var e=new RegExp(t.searchQuery,"i");return t.invitees.filter(function(t){return e.test(t.name)||e.test(t.email)})},i=function(t){return t.invitees.length},s=function(t){return t.searchQuery}},,function(t,e){!function(t){t.color={},t.color.make=function(e,r,n,a){var i={};return i.r=e||0,i.g=r||0,i.b=n||0,i.a=null!=a?a:1,i.add=function(t,e){for(var r=0;r<t.length;++r)i[t.charAt(r)]+=e;return i.normalize()},i.scale=function(t,e){for(var r=0;r<t.length;++r)i[t.charAt(r)]*=e;return i.normalize()},i.toString=function(){return i.a>=1?"rgb("+[i.r,i.g,i.b].join(",")+")":"rgba("+[i.r,i.g,i.b,i.a].join(",")+")"},i.normalize=function(){function t(t,e,r){return e<t?t:e>r?r:e}return i.r=t(0,parseInt(i.r),255),i.g=t(0,parseInt(i.g),255),i.b=t(0,parseInt(i.b),255),i.a=t(0,i.a,1),i},i.clone=function(){return t.color.make(i.r,i.b,i.g,i.a)},i.normalize()},t.color.extract=function(e,r){var n;do{if(""!=(n=e.css(r).toLowerCase())&&"transparent"!=n)break;e=e.parent()}while(e.length&&!t.nodeName(e.get(0),"body"));return"rgba(0, 0, 0, 0)"==n&&(n="transparent"),t.color.parse(n)},t.color.parse=function(r){var n,a=t.color.make;if(n=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(r))return a(parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10));if(n=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(r))return a(parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10),parseFloat(n[4]));if(n=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(r))return a(2.55*parseFloat(n[1]),2.55*parseFloat(n[2]),2.55*parseFloat(n[3]));if(n=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(r))return a(2.55*parseFloat(n[1]),2.55*parseFloat(n[2]),2.55*parseFloat(n[3]),parseFloat(n[4]));if(n=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(r))return a(parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16));if(n=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(r))return a(parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16),parseInt(n[3]+n[3],16));var i=t.trim(r).toLowerCase();return"transparent"==i?a(255,255,255,0):a((n=e[i]||[0,0,0])[0],n[1],n[2])};var e={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}}(jQuery),function(t){var e=Object.prototype.hasOwnProperty;function r(e,r){var n=r.children("."+e)[0];if(null==n&&((n=document.createElement("canvas")).className=e,t(n).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(r),!n.getContext)){if(!window.G_vmlCanvasManager)throw new Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.");n=window.G_vmlCanvasManager.initElement(n)}this.element=n;var a=this.context=n.getContext("2d"),i=window.devicePixelRatio||1,s=a.webkitBackingStorePixelRatio||a.mozBackingStorePixelRatio||a.msBackingStorePixelRatio||a.oBackingStorePixelRatio||a.backingStorePixelRatio||1;this.pixelRatio=i/s,this.resize(r.width(),r.height()),this.textContainer=null,this.text={},this._textCache={},this._textSizeCache=window.flotTextSizeCache=window.flotTextSizeCache||{}}function n(e,n,a,i){var s=[],o={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1,zero:!0},shadowSize:3,highlightColor:null},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,margin:0,labelMargin:5,eventSectionHeight:0,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},interaction:{redrawOverlayInterval:1e3/60},hooks:{}},l=null,c=null,u=null,d=null,p=null,h=[],f=[],m={left:0,right:0,top:0,bottom:0},g=0,v=0,b={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],processRange:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},y=this;function w(t,e){e=[y].concat(e);for(var r=0;r<t.length;++r)t[r].apply(this,e)}function x(e){s=function(e){for(var r=[],n=0;n<e.length;++n){var a=t.extend(!0,{},o.series);null!=e[n].data?(a.data=e[n].data,delete e[n].data,t.extend(!0,a,e[n]),e[n].data=a.data):a.data=e[n],r.push(a)}return r}(e),function(){var e,r=s.length,n=-1;for(e=0;e<s.length;++e){var a=s[e].color;null!=a&&(r--,"number"==typeof a&&a>n&&(n=a))}r<=n&&(r=n+1);var i,l=[],c=o.colors,u=c.length,d=0;for(e=0;e<r;e++)i=t.color.parse(c[e%u]||"#666"),e%u==0&&e&&(d=d>=0?d<.5?-d-.2:0:-d),l[e]=i.scale("rgb",1+d);var p,m=0;for(e=0;e<s.length;++e){if(null==(p=s[e]).color?(p.color=l[m].toString(),++m):"number"==typeof p.color&&(p.color=l[p.color].toString()),null==p.lines.show){var g,v=!0;for(g in p)if(p[g]&&p[g].show){v=!1;break}v&&(p.lines.show=!0)}null==p.lines.zero&&(p.lines.zero=!!p.lines.fill),p.xaxis=T(h,S(p,"x")),p.yaxis=T(f,S(p,"y"))}}(),function(){var e,r,n,a,i,o,l,c,u,d,p,h,f=Number.POSITIVE_INFINITY,m=Number.NEGATIVE_INFINITY,g=Number.MAX_VALUE;function v(t,e,r){e<t.datamin&&e!=-g&&(t.datamin=e),r>t.datamax&&r!=g&&(t.datamax=r)}for(t.each(k(),function(t,e){e.datamin=f,e.datamax=m,e.used=!1}),e=0;e<s.length;++e)(i=s[e]).datapoints={points:[]},w(b.processRawData,[i,i.data,i.datapoints]);for(e=0;e<s.length;++e){if(i=s[e],p=i.data,!(h=i.datapoints.format)){if((h=[]).push({x:!0,number:!0,required:!0}),h.push({y:!0,number:!0,required:!0}),i.stack||i.bars.show||i.lines.show&&i.lines.fill){var y=!!(i.bars.show&&i.bars.zero||i.lines.show&&i.lines.zero);h.push({y:!0,number:!0,required:!1,defaultValue:0,autoscale:y}),i.bars.horizontal&&(delete h[h.length-1].y,h[h.length-1].x=!0)}i.datapoints.format=h}if(null==i.datapoints.pointsize){i.datapoints.pointsize=h.length,l=i.datapoints.pointsize,o=i.datapoints.points;var x=i.lines.show&&i.lines.steps;for(i.xaxis.used=i.yaxis.used=!0,r=n=0;r<p.length;++r,n+=l){var S=null==(d=p[r]);if(!S)for(a=0;a<l;++a)c=d[a],(u=h[a])&&(u.number&&null!=c&&(c=+c,isNaN(c)?c=null:c==1/0?c=g:c==-1/0&&(c=-g)),null==c&&(u.required&&(S=!0),null!=u.defaultValue&&(c=u.defaultValue))),o[n+a]=c;if(S)for(a=0;a<l;++a)null!=(c=o[n+a])&&!1!==(u=h[a]).autoscale&&(u.x&&v(i.xaxis,c,c),u.y&&v(i.yaxis,c,c)),o[n+a]=null;if(x&&n>0&&(!S||null!=o[n-l])){for(a=0;a<l;++a)o[n+l+a]=o[n+a];o[n+1]=o[n-l+1]||0,S&&(o[n]=d[0]),n+=l}}}}for(e=0;e<s.length;++e){if(i=s[e],o=i.datapoints.points,l=i.datapoints.pointsize,"negative-Y"===i.transform)for(r=0;r<o.length;r+=l)null!=o[r]&&(c=o[r+1],o[r+1]=-c);w(b.processDatapoints,[i,i.datapoints])}for(e=0;e<s.length;++e){i=s[e],o=i.datapoints.points,l=i.datapoints.pointsize,h=i.datapoints.format;var C=f,T=f,E=m,_=m;for(r=0;r<o.length;r+=l)if(null!=o[r])for(a=0;a<l;++a)c=o[r+a],(u=h[a])&&!1!==u.autoscale&&c!=g&&c!=-g&&(u.x&&(c<C&&(C=c),c>E&&(E=c)),u.y&&(c<T&&(T=c),c>_&&(_=c)));if(i.bars.show){var M;switch(i.bars.align){case"left":M=0;break;case"right":M=-i.bars.barWidth;break;default:M=-i.bars.barWidth/2}i.bars.horizontal?(T+=M,_+=M+i.bars.barWidth):(C+=M,E+=M+i.bars.barWidth)}v(i.xaxis,C,E),v(i.yaxis,T,_)}t.each(k(),function(t,e){e.datamin==f&&(e.datamin=null),e.datamax==m&&(e.datamax=null)})}()}function S(t,e){var r=t[e+"axis"];return"object"==typeof r&&(r=r.n),"number"!=typeof r&&(r=1),r}function k(){return t.grep(h.concat(f),function(t){return t})}function C(t){var e,r,n={};for(e=0;e<h.length;++e)(r=h[e])&&r.used&&(n["x"+r.n]=r.c2p(t.left));for(e=0;e<f.length;++e)(r=f[e])&&r.used&&(n["y"+r.n]=r.c2p(t.top));return void 0!==n.x1&&(n.x=n.x1),void 0!==n.y1&&(n.y=n.y1),n}function T(e,r){return e[r-1]||(e[r-1]={n:r,direction:e==h?"x":"y",options:t.extend(!0,{},e==h?o.xaxis:o.yaxis)}),e[r-1]}function E(){U&&clearTimeout(U),u.unbind("mousemove",V),u.unbind("mouseleave",B),u.unbind("click",Q),w(b.shutdown,[u])}function _(t){for(var e=t.options,r=t.ticks||[],n=e.labelWidth||0,a=e.labelHeight||0,i=n||("x"==t.direction?Math.floor(l.width/(r.length||1)):null),s=t.direction+"Axis "+t.direction+t.n+"Axis",o="flot-"+t.direction+"-axis flot-"+t.direction+t.n+"-axis "+s,c=e.font||"flot-tick-label tickLabel",u=0;u<r.length;++u){var d=r[u];if(d.label){var p=l.getTextInfo(o,d.label,c,null,i);n=Math.max(n,p.width+1),a=Math.max(a,p.height)}}t.labelWidth=e.labelWidth||n,t.labelHeight=e.labelHeight||a}function M(e){var r=e.labelWidth,n=e.labelHeight,a=e.options.position,i="x"===e.direction,s=e.options.tickLength,c=o.grid.axisMargin,u=o.grid.labelMargin,d=o.grid.eventSectionHeight,p=!0,g=!0,v=!0,b=!1;t.each(i?h:f,function(t,r){r&&(r.show||r.reserveSpace)&&(r===e?b=!0:r.options.position===a&&(b?g=!1:p=!1),b||(v=!1))}),g&&(c=0),null==s&&(s=v?"full":5),isNaN(+s)||(u+=+s),i?(n+=u,n+=d,"bottom"==a?(m.bottom+=n+c,e.box={top:l.height-m.bottom,height:n}):(e.box={top:m.top+c,height:n},m.top+=n+c)):(r+=u,"left"==a?(e.box={left:m.left+c,width:r},m.left+=r+c):(m.right+=r+c,e.box={left:l.width-m.right,width:r})),e.position=a,e.tickLength=s,e.box.padding=u,e.box.eventSectionPadding=d,e.innermost=p}function A(){var r=k(),n=o.grid.show;for(var a in m){var i=o.grid.margin||0;m[a]="number"==typeof i?i:i[a]||0}for(var a in w(b.processOffset,[m]),m)"object"==typeof o.grid.borderWidth?m[a]+=n?o.grid.borderWidth[a]:0:m[a]+=n?o.grid.borderWidth:0;if(t.each(r,function(t,e){var r=e.options;e.show=null==r.show?e.used:r.show,e.reserveSpace=null==r.reserveSpace?e.show:r.reserveSpace,function(t){var e=t.options,r=+(null!=e.min?e.min:t.datamin),n=+(null!=e.max?e.max:t.datamax),a=n-r;if(0==a){var i=Math.abs(0==n?1:.25*n);null==e.min&&(r-=i),null!=e.max&&null==e.min||(n+=i)}else{var s=e.autoscaleMargin;null!=s&&(null==e.min&&(r-=a*s)<0&&null!=t.datamin&&t.datamin>=0&&(r=0),null==e.max&&(n+=a*s)>0&&null!=t.datamax&&t.datamax<=0&&(n=0))}t.min=r,t.max=n}(e)}),w(b.processRange,[]),n){for(var c=t.grep(r,function(t){return t.show||t.reserveSpace}),u=!1,d=0;d<2&&(t.each(c,function(t,e){P(e),$(e),u=D(e,e.ticks)||u,_(e)}),u&&b.processRange.length>0);d++)w(b.processRange,[]),u=!1;for(d=c.length-1;d>=0;--d)M(c[d]);!function(){var e,r=o.grid.minBorderMargin;if(null==r)for(r=0,e=0;e<s.length;++e)r=Math.max(r,2*(s[e].points.radius+s[e].points.lineWidth/2));var n={left:r,right:r,top:r,bottom:r};t.each(k(),function(t,e){e.reserveSpace&&e.ticks&&e.ticks.length&&("x"===e.direction?(n.left=Math.max(n.left,e.labelWidth/2),n.right=Math.max(n.right,e.labelWidth/2)):(n.bottom=Math.max(n.bottom,e.labelHeight/2),n.top=Math.max(n.top,e.labelHeight/2)))}),m.left=Math.ceil(Math.max(n.left,m.left)),m.right=Math.ceil(Math.max(n.right,m.right)),m.top=Math.ceil(Math.max(n.top,m.top)),m.bottom=Math.ceil(Math.max(n.bottom,m.bottom))}(),t.each(c,function(t,e){!function(t){"x"==t.direction?(t.box.left=m.left-t.labelWidth/2,t.box.width=l.width-m.left-m.right+t.labelWidth):(t.box.top=m.top-t.labelHeight/2,t.box.height=l.height-m.bottom-m.top+t.labelHeight)}(e)})}g=l.width-m.left-m.right,v=l.height-m.bottom-m.top,t.each(r,function(t,e){!function(t){function e(t){return t}var r,n,a=t.options.transform||e,i=t.options.inverseTransform;"x"==t.direction?(r=t.scale=g/Math.abs(a(t.max)-a(t.min)),n=Math.min(a(t.max),a(t.min))):(r=-(r=t.scale=v/Math.abs(a(t.max)-a(t.min))),n=Math.max(a(t.max),a(t.min))),t.p2c=a==e?function(t){return(t-n)*r}:function(t){return(a(t)-n)*r},t.c2p=i?function(t){return i(n+t/r)}:function(t){return n+t/r}}(e)}),n&&t.each(k(),function(t,e){var r,n,a,i,s,o=e.box,c=e.direction+"Axis "+e.direction+e.n+"Axis",u="flot-"+e.direction+"-axis flot-"+e.direction+e.n+"-axis "+c,d=e.options.font||"flot-tick-label tickLabel";if(l.removeText(u),e.show&&0!=e.ticks.length)for(var p=0;p<e.ticks.length;++p)!(r=e.ticks[p]).label||r.v<e.min||r.v>e.max||("x"==e.direction?(i="center",n=m.left+e.p2c(r.v),"bottom"==e.position?a=o.top+o.padding+o.eventSectionPadding:(a=o.top+o.height-o.padding,s="bottom")):(s="middle",a=m.top+e.p2c(r.v),"left"==e.position?(n=o.left+o.width-o.padding,i="right"):n=o.left+o.padding),l.addText(u,n,a,r.label,d,null,null,i,s))}),function(){null!=o.legend.container?t(o.legend.container).html(""):e.find(".legend").remove();if(!o.legend.show)return;for(var r,n,a=[],i=[],l=!1,c=o.legend.labelFormatter,u=0;u<s.length;++u)(r=s[u]).label&&(n=c?c(r.label,r):r.label)&&i.push({label:n,color:r.color});if(o.legend.sorted)if(t.isFunction(o.legend.sorted))i.sort(o.legend.sorted);else if("reverse"==o.legend.sorted)i.reverse();else{var d="descending"!=o.legend.sorted;i.sort(function(t,e){return t.label==e.label?0:t.label<e.label!=d?1:-1})}for(var u=0;u<i.length;++u){var p=i[u];u%o.legend.noColumns==0&&(l&&a.push("</tr>"),a.push("<tr>"),l=!0),a.push('<td class="legendColorBox"><div style="border:1px solid '+o.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+p.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+p.label+"</td>")}l&&a.push("</tr>");if(0==a.length)return;var h='<table style="font-size:smaller;color:'+o.grid.color+'">'+a.join("")+"</table>";if(null!=o.legend.container)t(o.legend.container).html(h);else{var f="",g=o.legend.position,v=o.legend.margin;null==v[0]&&(v=[v,v]),"n"==g.charAt(0)?f+="top:"+(v[1]+m.top)+"px;":"s"==g.charAt(0)&&(f+="bottom:"+(v[1]+m.bottom)+"px;"),"e"==g.charAt(1)?f+="right:"+(v[0]+m.right)+"px;":"w"==g.charAt(1)&&(f+="left:"+(v[0]+m.left)+"px;");var b=t('<div class="legend">'+h.replace('style="','style="position:absolute;'+f+";")+"</div>").appendTo(e);if(0!=o.legend.backgroundOpacity){var y=o.legend.backgroundColor;null==y&&((y=(y=o.grid.backgroundColor)&&"string"==typeof y?t.color.parse(y):t.color.extract(b,"background-color")).a=1,y=y.toString());var w=b.children();t('<div style="position:absolute;width:'+w.width()+"px;height:"+w.height()+"px;"+f+"background-color:"+y+';"> </div>').prependTo(b).css("opacity",o.legend.backgroundOpacity)}}}()}function P(e){var r,n=e.options;r="number"==typeof n.ticks&&n.ticks>0?n.ticks:.3*Math.sqrt("x"==e.direction?l.width:l.height);var a=(e.max-e.min)/r,i=-Math.floor(Math.log(a)/Math.LN10),s=n.tickDecimals;null!=s&&i>s&&(i=s);var o,c=Math.pow(10,-i),u=a/c;if(u<1.5?o=1:u<3?(o=2,u>2.25&&(null==s||i+1<=s)&&(o=2.5,++i)):o=u<7.5?5:10,o*=c,null!=n.minTickSize&&o<n.minTickSize&&(o=n.minTickSize),e.delta=a,e.tickDecimals=Math.max(0,null!=s?s:i),e.tickSize=n.tickSize||o,e.scaledDecimals=e.tickDecimals-Math.floor(Math.log(e.tickSize)/Math.LN10),"time"==n.mode&&!e.tickGenerator)throw new Error("Time mode requires the flot.time plugin.");if(e.tickGenerator||(e.tickGenerator=function(t){var e,r=[],n=function(t,e){return e*Math.floor(t/e)}(t.min,t.tickSize),a=0,i=Number.NaN;do{e=i,i=n+a*t.tickSize,r.push(i),++a}while(i<t.max&&i!=e);return r},e.tickFormatter=function(t,e){var r=e.tickDecimals?Math.pow(10,e.tickDecimals):1,n=""+Math.round(t*r)/r;if(null!=e.tickDecimals){var a=n.indexOf("."),i=-1==a?0:n.length-a-1;if(i<e.tickDecimals)return(i?n:n+".")+(""+r).substr(1,e.tickDecimals-i)}return n}),t.isFunction(n.tickFormatter)&&(e.tickFormatter=function(t,e){return""+n.tickFormatter(t,e)}),null!=n.alignTicksWithAxis){var d=("x"==e.direction?h:f)[n.alignTicksWithAxis-1];if(d&&d.used&&d!=e){var p=e.tickGenerator(e);if(p.length>0&&(null==n.min&&(e.min=Math.min(e.min,p[0])),null==n.max&&p.length>1&&(e.max=Math.max(e.max,p[p.length-1]))),e.tickGenerator=function(t){var e,r,n=[];for(r=0;r<d.ticks.length;++r)e=(d.ticks[r].v-d.min)/(d.max-d.min),e=t.min+e*(t.max-t.min),n.push(e);return n},!e.mode&&null==n.tickDecimals){var m=Math.max(0,1-Math.floor(Math.log(e.delta)/Math.LN10)),g=e.tickGenerator(e);g.length>1&&/\..*0$/.test((g[1]-g[0]).toFixed(m))||(e.tickDecimals=m)}}}}function $(e){var r,n,a=e.options.ticks,i=[];for(null==a||"number"==typeof a&&a>0?i=e.tickGenerator(e):a&&(i=t.isFunction(a)?a(e):a),e.ticks=[],r=0;r<i.length;++r){var s=null,o=i[r];"object"==typeof o?(n=+o[0],o.length>1&&(s=o[1])):n=+o,null==s&&(s=e.tickFormatter(n,e)),isNaN(n)||e.ticks.push({v:n,label:s})}}function D(t,e){var r=!1;return t.options.autoscaleMargin&&e.length>0&&(null==t.options.min&&(t.min=Math.min(t.min,e[0].v),r=!0),null==t.options.max&&e.length>1&&(t.max=Math.max(t.max,e[e.length-1].v),r=!0)),r}function O(){l.clear(),w(b.drawBackground,[d]);var t=o.grid;t.show&&t.backgroundColor&&(d.save(),d.translate(m.left,m.top),d.fillStyle=Z(o.grid.backgroundColor,v,0,"rgba(255, 255, 255, 0)"),d.fillRect(0,0,g,v),d.restore()),t.show&&!t.aboveData&&N();for(var e=0;e<s.length;++e)w(b.drawSeries,[d,s[e]]),F(s[e]);w(b.draw,[d]),t.show&&t.aboveData&&N(),l.render(),z()}function I(t,e){for(var r,n,a,i,s=k(),o=0;o<s.length;++o)if((r=s[o]).direction==e&&(t[i=e+r.n+"axis"]||1!=r.n||(i=e+"axis"),t[i])){n=t[i].from,a=t[i].to;break}if(t[i]||(r="x"==e?h[0]:f[0],n=t[e+"1"],a=t[e+"2"]),null!=n&&null!=a&&n>a){var l=n;n=a,a=l}return{from:n,to:a,axis:r}}function N(){var e,r,n,a;d.save(),d.translate(m.left,m.top);var i=o.grid.markings;if(i)for(t.isFunction(i)&&((r=y.getAxes()).xmin=r.xaxis.min,r.xmax=r.xaxis.max,r.ymin=r.yaxis.min,r.ymax=r.yaxis.max,i=i(r)),e=0;e<i.length;++e){var s=i[e],l=I(s,"x"),c=I(s,"y");if(null==l.from&&(l.from=l.axis.min),null==l.to&&(l.to=l.axis.max),null==c.from&&(c.from=c.axis.min),null==c.to&&(c.to=c.axis.max),!(l.to<l.axis.min||l.from>l.axis.max||c.to<c.axis.min||c.from>c.axis.max)){l.from=Math.max(l.from,l.axis.min),l.to=Math.min(l.to,l.axis.max),c.from=Math.max(c.from,c.axis.min),c.to=Math.min(c.to,c.axis.max);var u=l.from===l.to,p=c.from===c.to;if(!u||!p)if(l.from=Math.floor(l.axis.p2c(l.from)),l.to=Math.floor(l.axis.p2c(l.to)),c.from=Math.floor(c.axis.p2c(c.from)),c.to=Math.floor(c.axis.p2c(c.to)),u||p){var h=s.lineWidth||o.grid.markingsLineWidth,f=h%2?.5:0;d.beginPath(),d.strokeStyle=s.color||o.grid.markingsColor,d.lineWidth=h,u?(d.moveTo(l.to+f,c.from),d.lineTo(l.to+f,c.to)):(d.moveTo(l.from,c.to+f),d.lineTo(l.to,c.to+f)),d.stroke()}else d.fillStyle=s.color||o.grid.markingsColor,d.fillRect(l.from,c.to,l.to-l.from,c.from-c.to)}}r=k(),n=o.grid.borderWidth;for(var b=0;b<r.length;++b){var w,x,S,C,T=r[b],E=T.box,_=T.tickLength;if(T.show&&0!=T.ticks.length){for(d.lineWidth=1,"x"==T.direction?(w=0,x="full"==_?"top"==T.position?0:v:E.top-m.top+("top"==T.position?E.height:0)):(x=0,w="full"==_?"left"==T.position?0:g:E.left-m.left+("left"==T.position?E.width:0)),T.innermost||(d.strokeStyle=T.options.color,d.beginPath(),S=C=0,"x"==T.direction?S=g+1:C=v+1,1==d.lineWidth&&("x"==T.direction?x=Math.floor(x)+.5:w=Math.floor(w)+.5),d.moveTo(w,x),d.lineTo(w+S,x+C),d.stroke()),d.strokeStyle=T.options.tickColor,d.beginPath(),e=0;e<T.ticks.length;++e){var M=T.ticks[e].v;S=C=0,isNaN(M)||M<T.min||M>T.max||"full"==_&&("object"==typeof n&&n[T.position]>0||n>0)&&(M==T.min||M==T.max)||("x"==T.direction?(w=T.p2c(M),C="full"==_?-v:_,"top"==T.position&&(C=-C)):(x=T.p2c(M),S="full"==_?-g:_,"left"==T.position&&(S=-S)),1==d.lineWidth&&("x"==T.direction?w=Math.floor(w)+.5:x=Math.floor(x)+.5),d.moveTo(w,x),d.lineTo(w+S,x+C))}d.stroke()}}n&&(a=o.grid.borderColor,"object"==typeof n||"object"==typeof a?("object"!=typeof n&&(n={top:n,right:n,bottom:n,left:n}),"object"!=typeof a&&(a={top:a,right:a,bottom:a,left:a}),n.top>0&&(d.strokeStyle=a.top,d.lineWidth=n.top,d.beginPath(),d.moveTo(0-n.left,0-n.top/2),d.lineTo(g,0-n.top/2),d.stroke()),n.right>0&&(d.strokeStyle=a.right,d.lineWidth=n.right,d.beginPath(),d.moveTo(g+n.right/2,0-n.top),d.lineTo(g+n.right/2,v),d.stroke()),n.bottom>0&&(d.strokeStyle=a.bottom,d.lineWidth=n.bottom,d.beginPath(),d.moveTo(g+n.right,v+n.bottom/2),d.lineTo(0,v+n.bottom/2),d.stroke()),n.left>0&&(d.strokeStyle=a.left,d.lineWidth=n.left,d.beginPath(),d.moveTo(0-n.left/2,v+n.bottom),d.lineTo(0-n.left/2,0),d.stroke())):(d.lineWidth=n,d.strokeStyle=o.grid.borderColor,d.strokeRect(-n/2,-n/2,g+n,v+n))),d.restore()}function F(t){t.lines.show&&(function(t){function e(t,e,r,n,a){var i=t.points,s=t.pointsize,o=null,l=null;d.beginPath();for(var c=s;c<i.length;c+=s){var u=i[c-s],p=i[c-s+1],h=i[c],f=i[c+1];if(null!=u&&null!=h){if(p<=f&&p<a.min){if(f<a.min)continue;u=(a.min-p)/(f-p)*(h-u)+u,p=a.min}else if(f<=p&&f<a.min){if(p<a.min)continue;h=(a.min-p)/(f-p)*(h-u)+u,f=a.min}if(p>=f&&p>a.max){if(f>a.max)continue;u=(a.max-p)/(f-p)*(h-u)+u,p=a.max}else if(f>=p&&f>a.max){if(p>a.max)continue;h=(a.max-p)/(f-p)*(h-u)+u,f=a.max}if(u<=h&&u<n.min){if(h<n.min)continue;p=(n.min-u)/(h-u)*(f-p)+p,u=n.min}else if(h<=u&&h<n.min){if(u<n.min)continue;f=(n.min-u)/(h-u)*(f-p)+p,h=n.min}if(u>=h&&u>n.max){if(h>n.max)continue;p=(n.max-u)/(h-u)*(f-p)+p,u=n.max}else if(h>=u&&h>n.max){if(u>n.max)continue;f=(n.max-u)/(h-u)*(f-p)+p,h=n.max}u==o&&p==l||d.moveTo(n.p2c(u)+e,a.p2c(p)+r),o=h,l=f,d.lineTo(n.p2c(h)+e,a.p2c(f)+r)}}d.stroke()}d.save(),d.translate(m.left,m.top),d.lineJoin="round";var r=t.lines.lineWidth,n=t.shadowSize;if(r>0&&n>0){d.lineWidth=n,d.strokeStyle="rgba(0,0,0,0.1)";var a=Math.PI/18;e(t.datapoints,Math.sin(a)*(r/2+n/2),Math.cos(a)*(r/2+n/2),t.xaxis,t.yaxis),d.lineWidth=n/2,e(t.datapoints,Math.sin(a)*(r/2+n/4),Math.cos(a)*(r/2+n/4),t.xaxis,t.yaxis)}d.lineWidth=r,d.strokeStyle=t.color;var i=R(t.lines,t.color,0,v);i&&(d.fillStyle=i,function(t,e,r){var n=t.points,a=t.pointsize,i=Math.min(Math.max(0,r.min),r.max),s=0,o=!1,l=1,c=0,u=0;for(;!(a>0&&s>n.length+a);){var p=n[(s+=a)-a],h=n[s-a+l],f=n[s],m=n[s+l];if(o){if(a>0&&null!=p&&null==f){u=s,a=-a,l=2;continue}if(a<0&&s==c+a){d.fill(),o=!1,l=1,s=c=u+(a=-a);continue}}if(null!=p&&null!=f){if(p<=f&&p<e.min){if(f<e.min)continue;h=(e.min-p)/(f-p)*(m-h)+h,p=e.min}else if(f<=p&&f<e.min){if(p<e.min)continue;m=(e.min-p)/(f-p)*(m-h)+h,f=e.min}if(p>=f&&p>e.max){if(f>e.max)continue;h=(e.max-p)/(f-p)*(m-h)+h,p=e.max}else if(f>=p&&f>e.max){if(p>e.max)continue;m=(e.max-p)/(f-p)*(m-h)+h,f=e.max}if(o||(d.beginPath(),d.moveTo(e.p2c(p),r.p2c(i)),o=!0),h>=r.max&&m>=r.max)d.lineTo(e.p2c(p),r.p2c(r.max)),d.lineTo(e.p2c(f),r.p2c(r.max));else if(h<=r.min&&m<=r.min)d.lineTo(e.p2c(p),r.p2c(r.min)),d.lineTo(e.p2c(f),r.p2c(r.min));else{var g=p,v=f;h<=m&&h<r.min&&m>=r.min?(p=(r.min-h)/(m-h)*(f-p)+p,h=r.min):m<=h&&m<r.min&&h>=r.min&&(f=(r.min-h)/(m-h)*(f-p)+p,m=r.min),h>=m&&h>r.max&&m<=r.max?(p=(r.max-h)/(m-h)*(f-p)+p,h=r.max):m>=h&&m>r.max&&h<=r.max&&(f=(r.max-h)/(m-h)*(f-p)+p,m=r.max),p!=g&&d.lineTo(e.p2c(g),r.p2c(h)),d.lineTo(e.p2c(p),r.p2c(h)),d.lineTo(e.p2c(f),r.p2c(m)),f!=v&&(d.lineTo(e.p2c(f),r.p2c(m)),d.lineTo(e.p2c(v),r.p2c(m)))}}}}(t.datapoints,t.xaxis,t.yaxis));r>0&&e(t.datapoints,0,0,t.xaxis,t.yaxis);d.restore()}(t),t.points.show||t.bars.show||function(t){for(var e=[],r=null,n=null,a=t.datapoints,i=[],s=0;s<a.pointsize-2;s++)i.push(0);for(var o=0;o<a.points.length;o+=a.pointsize){var l=a.points[o],c=a.points[o+1];n=o===a.points.length-a.pointsize?null:a.points[o+a.pointsize],null!==l&&null!==c&&null===r&&null===n&&(e.push(l),e.push(c),e.push.apply(e,i)),r=l}var u=a.points;a.points=e,t.points.radius=t.lines.lineWidth/2,q(t),a.points=u}(t)),t.bars.show&&function(t){var e;switch(d.save(),d.translate(m.left,m.top),d.lineWidth=t.bars.lineWidth,d.strokeStyle=t.color,t.bars.align){case"left":e=0;break;case"right":e=-t.bars.barWidth;break;default:e=-t.bars.barWidth/2}var r=t.bars.fill?function(e,r){return R(t.bars,t.color,e,r)}:null;(function(e,r,n,a,i,s){for(var o=e.points,l=e.pointsize,c=0;c<o.length;c+=l)null!=o[c]&&L(o[c],o[c+1],o[c+2],r,n,a,i,s,d,t.bars.horizontal,t.bars.lineWidth)})(t.datapoints,e,e+t.bars.barWidth,r,t.xaxis,t.yaxis),d.restore()}(t),t.points.show&&q(t)}function q(t){function e(t,e,r,n,a,i,s,o){for(var l=t.points,c=t.pointsize,u=0;u<l.length;u+=c){var p=l[u],h=l[u+1];null==p||p<i.min||p>i.max||h<s.min||h>s.max||(d.beginPath(),p=i.p2c(p),h=s.p2c(h)+n,"circle"==o?d.arc(p,h,e,0,a?Math.PI:2*Math.PI,!1):o(d,p,h,e,a),d.closePath(),r&&(d.fillStyle=r,d.fill()),d.stroke())}}d.save(),d.translate(m.left,m.top);var r=t.points.lineWidth,n=t.shadowSize,a=t.points.radius,i=t.points.symbol;if(0==r&&(r=1e-4),r>0&&n>0){var s=n/2;d.lineWidth=s,d.strokeStyle="rgba(0,0,0,0.1)",e(t.datapoints,a,null,s+s/2,!0,t.xaxis,t.yaxis,i),d.strokeStyle="rgba(0,0,0,0.2)",e(t.datapoints,a,null,s/2,!0,t.xaxis,t.yaxis,i)}d.lineWidth=r,d.strokeStyle=t.color,e(t.datapoints,a,R(t.points,t.color),0,!1,t.xaxis,t.yaxis,i),d.restore()}function L(t,e,r,n,a,i,s,o,l,c,u){var d,p,h,f,m,g,v,b,y;c?(b=g=v=!0,m=!1,f=e+n,h=e+a,(p=t)<(d=r)&&(y=p,p=d,d=y,m=!0,g=!1)):(m=g=v=!0,b=!1,d=t+n,p=t+a,(f=e)<(h=r)&&(y=f,f=h,h=y,b=!0,v=!1)),p<s.min||d>s.max||f<o.min||h>o.max||(d<s.min&&(d=s.min,m=!1),p>s.max&&(p=s.max,g=!1),h<o.min&&(h=o.min,b=!1),f>o.max&&(f=o.max,v=!1),d=s.p2c(d),h=o.p2c(h),p=s.p2c(p),f=o.p2c(f),i&&(l.fillStyle=i(h,f),l.fillRect(d,f,p-d,h-f)),u>0&&(m||g||v||b)&&(l.beginPath(),l.moveTo(d,h),m?l.lineTo(d,f):l.moveTo(d,f),v?l.lineTo(p,f):l.moveTo(p,f),g?l.lineTo(p,h):l.moveTo(p,h),b?l.lineTo(d,h):l.moveTo(d,h),l.stroke()))}function R(e,r,n,a){var i=e.fill;if(!i)return null;if(e.fillColor)return Z(e.fillColor,n,a,r);var s=t.color.parse(r);return s.a="number"==typeof i?i:.4,s.normalize(),s.toString()}y.setData=x,y.setupGrid=A,y.draw=O,y.getPlaceholder=function(){return e},y.getCanvas=function(){return l.element},y.getPlotOffset=function(){return m},y.width=function(){return g},y.height=function(){return v},y.offset=function(){var t=u.offset();return t.left+=m.left,t.top+=m.top,t},y.getData=function(){return s},y.getAxes=function(){var e={};return t.each(h.concat(f),function(t,r){r&&(e[r.direction+(1!=r.n?r.n:"")+"axis"]=r)}),e},y.getXAxes=function(){return h},y.getYAxes=function(){return f},y.c2p=C,y.p2c=function(t){var e,r,n,a={};for(e=0;e<h.length;++e)if((r=h[e])&&r.used&&(n="x"+r.n,null==t[n]&&1==r.n&&(n="x"),null!=t[n])){a.left=r.p2c(t[n]);break}for(e=0;e<f.length;++e)if((r=f[e])&&r.used&&(n="y"+r.n,null==t[n]&&1==r.n&&(n="y"),null!=t[n])){a.top=r.p2c(t[n]);break}return a},y.getOptions=function(){return o},y.highlight=W,y.unhighlight=Y,y.triggerRedrawOverlay=z,y.pointOffset=function(t){return{left:parseInt(h[S(t,"x")-1].p2c(+t.x)+m.left,10),top:parseInt(f[S(t,"y")-1].p2c(+t.y)+m.top,10)}},y.shutdown=E,y.destroy=function(){E(),e.removeData("plot").empty(),s=[],o=null,l=null,c=null,u=null,d=null,p=null,h=[],f=[],b=null,j=[],y=null},y.resize=function(){var t=e.width(),r=e.height();l.resize(t,r),c.resize(t,r)},y.hooks=b,function(){for(var e={Canvas:r},n=0;n<i.length;++n){var a=i[n];a.init(y,e),a.options&&t.extend(!0,o,a.options)}}(),function(r){t.extend(!0,o,r),r&&r.colors&&(o.colors=r.colors);null==o.xaxis.color&&(o.xaxis.color=t.color.parse(o.grid.color).scale("a",.22).toString());null==o.yaxis.color&&(o.yaxis.color=t.color.parse(o.grid.color).scale("a",.22).toString());null==o.xaxis.tickColor&&(o.xaxis.tickColor=o.grid.tickColor||o.xaxis.color);null==o.yaxis.tickColor&&(o.yaxis.tickColor=o.grid.tickColor||o.yaxis.color);null==o.grid.borderColor&&(o.grid.borderColor=o.grid.color);null==o.grid.tickColor&&(o.grid.tickColor=t.color.parse(o.grid.color).scale("a",.22).toString());var n,a,i,s=e.css("font-size"),l=s?+s.replace("px",""):13,c={style:e.css("font-style"),size:Math.round(.8*l),variant:e.css("font-variant"),weight:e.css("font-weight"),family:e.css("font-family")};for(i=o.xaxes.length||1,n=0;n<i;++n)(a=o.xaxes[n])&&!a.tickColor&&(a.tickColor=a.color),a=t.extend(!0,{},o.xaxis,a),o.xaxes[n]=a,a.font&&(a.font=t.extend({},c,a.font),a.font.color||(a.font.color=a.color),a.font.lineHeight||(a.font.lineHeight=Math.round(1.15*a.font.size)));for(i=o.yaxes.length||1,n=0;n<i;++n)(a=o.yaxes[n])&&!a.tickColor&&(a.tickColor=a.color),a=t.extend(!0,{},o.yaxis,a),o.yaxes[n]=a,a.font&&(a.font=t.extend({},c,a.font),a.font.color||(a.font.color=a.color),a.font.lineHeight||(a.font.lineHeight=Math.round(1.15*a.font.size)));o.xaxis.noTicks&&null==o.xaxis.ticks&&(o.xaxis.ticks=o.xaxis.noTicks);o.yaxis.noTicks&&null==o.yaxis.ticks&&(o.yaxis.ticks=o.yaxis.noTicks);o.x2axis&&(o.xaxes[1]=t.extend(!0,{},o.xaxis,o.x2axis),o.xaxes[1].position="top",null==o.x2axis.min&&(o.xaxes[1].min=null),null==o.x2axis.max&&(o.xaxes[1].max=null));o.y2axis&&(o.yaxes[1]=t.extend(!0,{},o.yaxis,o.y2axis),o.yaxes[1].position="right",null==o.y2axis.min&&(o.yaxes[1].min=null),null==o.y2axis.max&&(o.yaxes[1].max=null));o.grid.coloredAreas&&(o.grid.markings=o.grid.coloredAreas);o.grid.coloredAreasColor&&(o.grid.markingsColor=o.grid.coloredAreasColor);o.lines&&t.extend(!0,o.series.lines,o.lines);o.points&&t.extend(!0,o.series.points,o.points);o.bars&&t.extend(!0,o.series.bars,o.bars);null!=o.shadowSize&&(o.series.shadowSize=o.shadowSize);null!=o.highlightColor&&(o.series.highlightColor=o.highlightColor);for(n=0;n<o.xaxes.length;++n)T(h,n+1).options=o.xaxes[n];for(n=0;n<o.yaxes.length;++n)T(f,n+1).options=o.yaxes[n];for(var u in b)o.hooks[u]&&o.hooks[u].length&&(b[u]=b[u].concat(o.hooks[u]));w(b.processOptions,[o])}(a),function(){e.find(".flot-temp-elem").remove(),"static"==e.css("position")&&e.css("position","relative");l=new r("flot-base",e),c=new r("flot-overlay",e),d=l.context,p=c.context,u=t(c.element).unbind();var n=e.data("plot");n&&(n.shutdown(),c.clear());e.data("plot",y)}(),x(n),A(),O(),function(){o.grid.hoverable&&(u.mousemove(V),u.bind("mouseleave",B));o.grid.clickable&&u.click(Q);w(b.bindEvents,[u])}();var j=[],U=null;function V(t){o.grid.hoverable&&H("plothover",t,function(t){return 0!=t.hoverable})}function B(t){o.grid.hoverable&&H("plothover",t,function(t){return!1})}function Q(t){y.isSelecting||H("plotclick",t,function(t){return 0!=t.clickable})}function H(t,r,n){var a=u.offset(),i=r.pageX-a.left-m.left,l=r.pageY-a.top-m.top,c=C({left:i,top:l});c.pageX=r.pageX,c.pageY=r.pageY,c.ctrlKey=r.ctrlKey,c.metaKey=r.metaKey;var d=function(t,e,r){var n,a,i,l=o.grid.mouseActiveRadius,c=l*l+1,u=null;for(n=s.length-1;n>=0;--n)if(r(s[n])){var d=s[n],p=d.xaxis,h=d.yaxis,f=d.datapoints.points,m=p.c2p(t),g=h.c2p(e),v=l/p.scale,b=l/h.scale;if(i=d.datapoints.pointsize,p.options.inverseTransform&&(v=Number.MAX_VALUE),h.options.inverseTransform&&(b=Number.MAX_VALUE),d.lines.show||d.points.show)for(a=0;a<f.length;a+=i){var y=f[a],w=f[a+1];if(null!=y&&!(y-m>v||y-m<-v||w-g>b||w-g<-b)){var x=Math.abs(p.p2c(y)-t),S=Math.abs(h.p2c(w)-e),k=x*x+S*S;k<c&&(c=k,u=[n,a/i])}}if(d.bars.show&&!u){var C,T;switch(d.bars.align){case"left":C=0;break;case"right":C=-d.bars.barWidth;break;default:C=-d.bars.barWidth/2}for(T=C+d.bars.barWidth,a=0;a<f.length;a+=i){y=f[a],w=f[a+1];var E=f[a+2];null!=y&&(s[n].bars.horizontal?m<=Math.max(E,y)&&m>=Math.min(E,y)&&g>=w+C&&g<=w+T:m>=y+C&&m<=y+T&&g>=Math.min(E,w)&&g<=Math.max(E,w))&&(u=[n,a/i])}}}return u?(n=u[0],a=u[1],i=s[n].datapoints.pointsize,{datapoint:s[n].datapoints.points.slice(a*i,(a+1)*i),dataIndex:a,series:s[n],seriesIndex:n}):null}(i,l,n);if(d&&(d.pageX=parseInt(d.series.xaxis.p2c(d.datapoint[0])+a.left+m.left,10),d.pageY=parseInt(d.series.yaxis.p2c(d.datapoint[1])+a.top+m.top,10)),o.grid.autoHighlight){for(var p=0;p<j.length;++p){var h=j[p];h.auto!=t||d&&h.series==d.series&&h.point[0]==d.datapoint[0]&&h.point[1]==d.datapoint[1]||Y(h.series,h.point)}d&&W(d.series,d.datapoint,t)}e.trigger(t,[c,d])}function z(){var t=o.interaction.redrawOverlayInterval;-1!=t?U||(U=setTimeout(G,t)):G()}function G(){var t,e;for(U=null,p.save(),c.clear(),p.translate(m.left,m.top),t=0;t<j.length;++t)(e=j[t]).series.bars.show?X(e.series,e.point):J(e.series,e.point);p.restore(),w(b.drawOverlay,[p])}function W(t,e,r){if("number"==typeof t&&(t=s[t]),"number"==typeof e){var n=t.datapoints.pointsize;e=t.datapoints.points.slice(n*e,n*(e+1))}var a=K(t,e);-1==a?(j.push({series:t,point:e,auto:r}),z()):r||(j[a].auto=!1)}function Y(t,e){if(null==t&&null==e)return j=[],void z();if("number"==typeof t&&(t=s[t]),"number"==typeof e){var r=t.datapoints.pointsize;e=t.datapoints.points.slice(r*e,r*(e+1))}var n=K(t,e);-1!=n&&(j.splice(n,1),z())}function K(t,e){for(var r=0;r<j.length;++r){var n=j[r];if(n.series==t&&n.point[0]==e[0]&&n.point[1]==e[1])return r}return-1}function J(e,r){var n=r[0],a=r[1],i=e.xaxis,s=e.yaxis,o="string"==typeof e.highlightColor?e.highlightColor:t.color.parse(e.color).scale("a",.5).toString();if(!(n<i.min||n>i.max||a<s.min||a>s.max)){var l=e.points.radius+e.points.lineWidth/2;p.lineWidth=l,p.strokeStyle=o;var c=1.5*l;n=i.p2c(n),a=s.p2c(a),p.beginPath(),"circle"==e.points.symbol?p.arc(n,a,c,0,2*Math.PI,!1):e.points.symbol(p,n,a,c,!1),p.closePath(),p.stroke()}}function X(e,r){var n,a="string"==typeof e.highlightColor?e.highlightColor:t.color.parse(e.color).scale("a",.5).toString(),i=a;switch(e.bars.align){case"left":n=0;break;case"right":n=-e.bars.barWidth;break;default:n=-e.bars.barWidth/2}p.lineWidth=e.bars.lineWidth,p.strokeStyle=a,L(r[0],r[1],r[2]||0,n,n+e.bars.barWidth,function(){return i},e.xaxis,e.yaxis,p,e.bars.horizontal,e.bars.lineWidth)}function Z(e,r,n,a){if("string"==typeof e)return e;for(var i=d.createLinearGradient(0,n,0,r),s=0,o=e.colors.length;s<o;++s){var l=e.colors[s];if("string"!=typeof l){var c=t.color.parse(a);null!=l.brightness&&(c=c.scale("rgb",l.brightness)),null!=l.opacity&&(c.a*=l.opacity),l=c.toString()}i.addColorStop(s/(o-1),l)}return i}}t.fn.detach||(t.fn.detach=function(){return this.each(function(){this.parentNode&&this.parentNode.removeChild(this)})}),r.prototype.resize=function(t,e){if(t<=0||e<=0)throw new Error("Invalid dimensions for plot, width = "+t+", height = "+e);var r=this.element,n=this.context,a=this.pixelRatio;this.width!=t&&(r.width=t*a,r.style.width=t+"px",this.width=t),this.height!=e&&(r.height=e*a,r.style.height=e+"px",this.height=e),n.restore(),n.save(),n.scale(a,a)},r.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},r.prototype.render=function(){var t=this._textCache;for(var r in t)if(e.call(t,r)){var n=this.getTextLayer(r),a=t[r];for(var i in n.hide(),a)if(e.call(a,i)){var s=a[i];for(var o in s)if(e.call(s,o)){for(var l,c=s[o].positions,u=0;l=c[u];u++)l.active?l.rendered||(n.append(l.element),l.rendered=!0):(c.splice(u--,1),l.rendered&&l.element.detach());0==c.length&&delete s[o]}}n.show()}},r.prototype.getTextLayer=function(e){var r=this.text[e];return null==r&&(null==this.textContainer&&(this.textContainer=t("<div class='flot-text flot-temp-elem'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)),r=this.text[e]=t("<div></div>").addClass(e).css({position:"absolute",top:0,left:0,bottom:0,right:0}).appendTo(this.textContainer)),r},r.prototype.getTextInfo=function(e,r,n,a,i){var s,o,l,c;if(r=""+r,s="object"==typeof n?n.style+" "+n.variant+" "+n.weight+" "+n.size+"px/"+n.lineHeight+"px "+n.family:n,null==(o=this._textCache[e])&&(o=this._textCache[e]={}),null==(l=o[s])&&(l=o[s]={}),null==(c=l[r])){var u=t("<div></div>").html(r).css({position:"absolute","max-width":i,top:-9999}).appendTo(this.getTextLayer(e));"object"==typeof n?u.css({font:s,color:n.color}):"string"==typeof n&&u.addClass(n),c=l[r]={element:u,positions:[]};var d=this._textSizeCache[r];d?(c.width=d.width,c.height=d.height):(c.width=u.outerWidth(!0),c.height=u.outerHeight(!0),this._textSizeCache[r]={width:c.width,height:c.height}),u.detach()}return c},r.prototype.addText=function(t,e,r,n,a,i,s,o,l){var c=this.getTextInfo(t,n,a,i,s),u=c.positions;"center"==o?e-=c.width/2:"right"==o&&(e-=c.width),"middle"==l?r-=c.height/2:"bottom"==l&&(r-=c.height);for(var d,p=0;d=u[p];p++)if(d.x==e&&d.y==r)return void(d.active=!0);d={active:!0,rendered:!1,element:u.length?c.element.clone():c.element,x:e,y:r},u.push(d),d.element.css({top:Math.round(r),left:Math.round(e),"text-align":o})},r.prototype.removeText=function(t,r,n,a,i,s){if(null==a){var o=this._textCache[t];if(null!=o)for(var l in o)if(e.call(o,l)){var c=o[l];for(var u in c)if(e.call(c,u))for(var d=c[u].positions,p=0;h=d[p];p++)h.active=!1}}else{var h;for(d=this.getTextInfo(t,a,i,s).positions,p=0;h=d[p];p++)h.x==r&&h.y==n&&(h.active=!1)}},t.plot=function(e,r,a){return new n(t(e),r,a,t.plot.plugins)},t.plot.version="0.8.3",t.plot.plugins=[],t.fn.plot=function(e,r){return this.each(function(){t.plot(this,e,r)})}}(jQuery)},,,,,,function(t,e){},function(t,e){},,,,,,,,,,function(t,e,r){"use strict";var n;r.d(e,"a",function(){return n}),r.d(e,"b",function(){return a}),r.d(e,"c",function(){return i}),function(t){t.AddAppNotification="ADD_APP_NOTIFICATION",t.ClearAppNotification="CLEAR_APP_NOTIFICATION"}(n||(n={}));var a=function(t){return{type:n.ClearAppNotification,payload:t}},i=function(t){return{type:n.AddAppNotification,payload:t}}},,,function(t,e,r){"use strict";
/**
 * @preserve jquery-param (c) 2015 KNOWLEDGECODE | MIT
 */
function n(t,e){return e&&Object.keys(e).length>0&&(t+="?"+a(e)),t}function a(t){var e=[],r=/\[\]$/,n=function(t){return"[object Array]"===Object.prototype.toString.call(t)},a=function(t,r){r="function"==typeof r?r():null===r?"":void 0===r?"":r,e[e.length]="boolean"!=typeof r?encodeURIComponent(t)+"="+encodeURIComponent(r):encodeURIComponent(t)},i=function(t,s){var o,l,c;if(t)if(n(s))for(o=0,l=s.length;o<l;o++)r.test(t)?a(t,s[o]):i(t,s[o]);else if(s&&"[object Object]"===String(s))for(c in s)i(t+"["+c+"]",s[c]);else a(t,s);else if(n(s))for(o=0,l=s.length;o<l;o++)a(s[o].name,s[o].value);else for(c in s)i(c,s[c]);return e};return i("",t).join("&")}r.d(e,"a",function(){return n}),r.d(e,"b",function(){return a})},function(t,e,r){"use strict";function n(t){return{icon:"fa fa-folder-open",id:"manage-folder",subTitle:"管理文件夹仪表板和权限",url:"",text:t.title,breadcrumbs:[{title:"仪表盘",url:"dashboards"}],children:[{active:!1,icon:"fa fa-fw fa-th-large",id:"folder-dashboards-"+t.uid,text:"仪表盘",url:t.url},{active:!1,icon:"fa fa-fw fa-lock",id:"folder-permissions-"+t.uid,text:"权限",url:t.url+"/permissions"},{active:!1,icon:"fa fa-fw fa-cog",id:"folder-settings-"+t.uid,text:"设置",url:t.url+"/settings"}]}}function a(t){var e=n({id:1,uid:"loading",title:"加载中",url:"url",canSave:!1,version:0});return e.children[t].active=!0,{main:e,node:e.children[t]}}r.d(e,"a",function(){return n}),r.d(e,"b",function(){return a})},,,function(t,e,r){"use strict";r.d(e,"a",function(){return o});var n=r(2),a=r(0),i=r.n(a),s=r(242),o=function(t){function e(e){return t.call(this,e)||this}return n.c(e,t),e.prototype.render=function(){var t=this.props,e=t.label,r=t.removeIcon,n=t.count,a=s.a.getTagColorsFromName(e),o={backgroundColor:a.color,borderColor:a.borderColor},l=0!==n&&i.a.createElement("span",{className:"tag-count-label"},"("+n+")");return i.a.createElement("span",{className:"label label-tag",style:o},r&&i.a.createElement("i",{className:"fa fa-remove"}),e," ",l)},e}(i.a.Component)},function(t,e,r){"use strict";var n=r(2),a=r(0),i=r.n(a),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={showConfirm:!1},e.onClickDelete=function(t){t&&t.preventDefault(),e.setState({showConfirm:!0})},e.onClickCancel=function(t){t&&t.preventDefault(),e.setState({showConfirm:!1})},e}return n.c(e,t),e.prototype.render=function(){var t,e,r=this.props.onConfirmDelete;return this.state.showConfirm?(t="show",e="hide"):(t="hide",e="show"),i.a.createElement("span",{className:"delete-button-container"},i.a.createElement("a",{className:"delete-button "+e+" btn btn-danger btn-small",onClick:this.onClickDelete},i.a.createElement("i",{className:"fa fa-remove"})),i.a.createElement("span",{className:"confirm-delete-container"},i.a.createElement("span",{className:"confirm-delete "+t},i.a.createElement("a",{className:"btn btn-small",onClick:this.onClickCancel},"取消"),i.a.createElement("a",{className:"btn btn-danger btn-small",onClick:r},"确认删除"))))},e}(a.PureComponent);e.a=s},function(t,e,r){"use strict";var n=r(2),a=r(0),i=r.n(a),s=r(61),o=r(247),l=r(112),c=r(97),u=r(113),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.c(e,t),e.prototype.render=function(){var t=this.props,e=t.optionsWithDesc,r=t.onSelected,n=t.disabled,a=t.className,d=function(t,e){return t.find(function(t){return t.value===e})}(e,t.value);return i.a.createElement("div",{className:"permissions-picker"},i.a.createElement(s.b,{placeholder:"Choose",classNamePrefix:"gf-form-select-box",className:"width-7 gf-form-input gf-form-input--form-dropdown "+(a||""),options:e,components:{Option:o.a,IndicatorsContainer:l.a,NoOptionsMessage:u.a},styles:c.a,isDisabled:n,onChange:r,getOptionValue:function(t){return t.value},getOptionLabel:function(t){return t.label},value:d}))},e}(a.Component);e.a=d},,function(t,e,r){"use strict";var n=r(4),a=r.n(n),i=r(1),s=r.n(i),o=r(26),l=r(31),c=r(111),u=r(59);function d(t){if(s.a.isArray(t))return t.map(d);if(s.a.isPlainObject(t)){for(var e={},r=0,n=s.a.keys(t).sort();r<n.length;r++){var a=n[r];e[a]=d(t[a])}return e}return t}var p=r(84),h=function(){function t(t){this.dashboard=t}return t.prototype.updateSchema=function(t){var e,r,n,a,i=this,o=this.dashboard.schemaVersion,l=[];if(this.dashboard.schemaVersion=16,o!==this.dashboard.schemaVersion){if(o<2&&(t.services&&t.services.filter&&(this.dashboard.time=t.services.filter.time,this.dashboard.templating.list=t.services.filter.list||[]),l.push(function(t){"graphite"===t.type&&(t.type="graph"),"graph"===t.type&&(s.a.isBoolean(t.legend)&&(t.legend={show:t.legend}),t.grid&&(t.grid.min&&(t.grid.leftMin=t.grid.min,delete t.grid.min),t.grid.max&&(t.grid.leftMax=t.grid.max,delete t.grid.max)),t.y_format&&(t.y_formats||(t.y_formats=[]),t.y_formats[0]=t.y_format,delete t.y_format),t.y2_format&&(t.y_formats||(t.y_formats=[]),t.y_formats[1]=t.y2_format,delete t.y2_format))})),o<3){var c=this.dashboard.getNextPanelId();l.push(function(t){t.id||(t.id=c,c+=1)})}if(o<4&&l.push(function(t){"graph"===t.type&&(s.a.each(t.aliasYAxis,function(e,r){t.seriesOverrides=[{alias:r,yaxis:e}]}),delete t.aliasYAxis)}),o<6){var u=s.a.find(t.pulldowns,{type:"annotations"});for(u&&(this.dashboard.annotations={list:u.annotations||[]}),e=0;e<this.dashboard.templating.list.length;e++){var d=this.dashboard.templating.list[e];void 0===d.datasource&&(d.datasource=null),"filter"===d.type&&(d.type="query"),void 0===d.type&&(d.type="query"),void 0===d.allFormat&&(d.allFormat="glob")}}if(o<7&&(t.nav&&t.nav.length&&(this.dashboard.timepicker=t.nav[0]),l.push(function(t){s.a.each(t.targets,function(e){e.refId||(e.refId=i.dashboard.getNextQueryLetter(t))})})),o<8&&l.push(function(t){s.a.each(t.targets,function(t){t.fields&&t.tags&&t.groupBy&&(t.rawQuery?(delete t.fields,delete t.fill):(t.select=s.a.map(t.fields,function(t){var e=[];return e.push({type:"field",params:[t.name]}),e.push({type:t.func,params:[]}),t.mathExpr&&e.push({type:"math",params:[t.mathExpr]}),t.asExpr&&e.push({type:"alias",params:[t.asExpr]}),e}),delete t.fields,s.a.each(t.groupBy,function(t){"time"===t.type&&t.interval&&(t.params=[t.interval],delete t.interval),"tag"===t.type&&t.key&&(t.params=[t.key],delete t.key)}),t.fill&&(t.groupBy.push({type:"fill",params:[t.fill]}),delete t.fill)))})}),o<9&&l.push(function(t){if(("singlestat"===t.type||""===t.thresholds)&&t.thresholds){var e=t.thresholds.split(",");e.length>=3&&(e.shift(),t.thresholds=e.join(","))}}),o<10&&l.push(function(t){"table"===t.type&&s.a.each(t.styles,function(t){if(t.thresholds&&t.thresholds.length>=3){var e=t.thresholds;e.shift(),t.thresholds=e}})}),o<12&&s.a.each(this.dashboard.templating.list,function(t){t.refresh&&(t.refresh=1),t.refresh||(t.refresh=0),t.hideVariable?t.hide=2:t.hideLabel&&(t.hide=1)}),o<12&&l.push(function(t){"graph"===t.type&&t.grid&&(t.yaxes||(t.yaxes=[{show:t["y-axis"],min:t.grid.leftMin,max:t.grid.leftMax,logBase:t.grid.leftLogBase,format:t.y_formats[0],label:t.leftYAxisLabel},{show:t["y-axis"],min:t.grid.rightMin,max:t.grid.rightMax,logBase:t.grid.rightLogBase,format:t.y_formats[1],label:t.rightYAxisLabel}],t.xaxis={show:t["x-axis"]},delete t.grid.leftMin,delete t.grid.leftMax,delete t.grid.leftLogBase,delete t.grid.rightMin,delete t.grid.rightMax,delete t.grid.rightLogBase,delete t.y_formats,delete t.leftYAxisLabel,delete t.rightYAxisLabel,delete t["y-axis"],delete t["x-axis"]))}),o<13&&l.push(function(t){if("graph"===t.type&&t.grid){t.thresholds=[];var e={},r={};null!==t.grid.threshold1&&(e.value=t.grid.threshold1,t.grid.thresholdLine?(e.line=!0,e.lineColor=t.grid.threshold1Color,e.colorMode="custom"):(e.fill=!0,e.fillColor=t.grid.threshold1Color,e.colorMode="custom")),null!==t.grid.threshold2&&(r.value=t.grid.threshold2,t.grid.thresholdLine?(r.line=!0,r.lineColor=t.grid.threshold2Color,r.colorMode="custom"):(r.fill=!0,r.fillColor=t.grid.threshold2Color,r.colorMode="custom")),s.a.isNumber(e.value)&&(s.a.isNumber(r.value)?e.value>r.value?(e.op=r.op="lt",t.thresholds.push(e),t.thresholds.push(r)):(e.op=r.op="gt",t.thresholds.push(e),t.thresholds.push(r)):(e.op="gt",t.thresholds.push(e))),delete t.grid.threshold1,delete t.grid.threshold1Color,delete t.grid.threshold2,delete t.grid.threshold2Color,delete t.grid.thresholdLine}}),o<14&&(this.dashboard.graphTooltip=t.sharedCrosshair?1:0),o<16&&this.upgradeToGridLayout(t),0!==l.length)for(r=0;r<this.dashboard.panels.length;r++)for(n=0;n<l.length;n++)if(l[n].call(this,this.dashboard.panels[r]),this.dashboard.panels[r].panels)for(a=0;a<this.dashboard.panels[r].panels.length;a++)l[n].call(this,this.dashboard.panels[r].panels[a])}},t.prototype.upgradeToGridLayout=function(t){var e=0,r=o.e/12,n=s.a.max(s.a.flattenDeep(s.a.map(t.rows,function(t){return s.a.map(t.panels,"id")})))+1;if(t.rows)for(var a=s.a.some(t.rows,function(t){return t.collapse||t.showTitle||t.repeat}),i=0,l=t.rows;i<l.length;i++){var c=l[i];if(!c.repeatIteration){var u=f(c.height||o.b),d={},h=void 0;a&&(d.id=n,d.type="row",d.title=c.title,d.collapsed=c.collapse,d.repeat=c.repeat,d.panels=[],d.gridPos={x:0,y:e,w:o.e,h:u},h=new p.a(d),n++,e++);for(var g=new m(u,o.e,e),v=0,b=c.panels;v<b.length;v++){var y=b[v];y.span=y.span||o.a,y.minSpan&&(y.minSpan=Math.min(o.e,o.e/12*y.minSpan));var w=Math.floor(y.span)*r,x=y.height?f(y.height):u,S=g.getPanelPosition(x,w);e=g.yPos,y.gridPos={x:S.x,y:e+S.y,w:w,h:x},g.addPanel(y.gridPos),delete y.span,h&&d.collapsed?h.panels.push(y):this.dashboard.panels.push(new p.a(y))}h&&this.dashboard.panels.push(h),h&&d.collapsed||(e+=u)}}},t}();function f(t){return s.a.isString(t)&&(t=parseInt(t.replace("px",""),10)),t<o.g&&(t=o.g),Math.ceil(t/(o.c+o.d))}var m=function(){function t(t,e,r){void 0===e&&(e=o.e),void 0===r&&(r=0),this.area=new Array(e).fill(0),this.yPos=r,this.height=t}return t.prototype.reset=function(){this.area.fill(0)},t.prototype.addPanel=function(t){for(var e=t.x;e<t.x+t.w;e++)(!this.area[e]||t.y+t.h-this.yPos>this.area[e])&&(this.area[e]=t.y+t.h-this.yPos);return this.area},t.prototype.getPanelPosition=function(t,e,r){var n,a;void 0===r&&(r=!1);for(var i=this.area.length-1;i>=0&&this.height-this.area[i]>0;i--)if(void 0===a)a=i;else{if(!(i<this.area.length-1&&this.area[i]<=this.area[i+1]))break;n=i}return void 0!==n&&void 0!==a&&a-n>=e-1?{x:n,y:s.a.max(this.area.slice(n))}:r?null:(this.yPos+=this.height,this.reset(),this.getPanelPosition(t,e,!0))},t}();r.d(e,"a",function(){return g});var g=function(){function t(t,e){t||(t={}),this.events=new c.a,this.id=t.id||null,this.uid=t.uid||null,this.revision=t.revision,this.title=t.title||"没有标题",this.autoUpdate=t.autoUpdate,this.description=t.description,this.tags=t.tags||[],this.style=t.style||"dark",this.timezone=t.timezone||"",this.editable=!1!==t.editable,this.graphTooltip=t.graphTooltip||0,this.time=t.time||{from:"now-6h",to:"now"},this.timepicker=t.timepicker||{},this.templating=this.ensureListExist(t.templating),this.annotations=this.ensureListExist(t.annotations),this.refresh=t.refresh,this.snapshot=t.snapshot,this.schemaVersion=t.schemaVersion||0,this.version=t.version||0,this.links=t.links||[],this.gnetId=t.gnetId||null,this.bgColor=t.bgColor||"#003366",this.panels=s.a.map(t.panels||[],function(t){return new p.a(t)}),this.resetOriginalVariables(),this.resetOriginalTime(),this.initMeta(e),this.updateSchema(t),this.addBuiltInAnnotationQuery(),this.sortPanelsByGridPos()}return t.prototype.addBuiltInAnnotationQuery=function(){for(var t=!1,e=0,r=this.annotations.list;e<r.length;e++){if(1===r[e].builtIn){t=!0;break}}t||this.annotations.list.unshift({datasource:"-- Grafana --",name:"注释和报警",type:"dashboard",iconColor:l.b,enable:!0,hide:!0,builtIn:1})},t.prototype.initMeta=function(t){(t=t||{}).canShare=!1!==t.canShare,t.canSave=!1!==t.canSave,t.canStar=!1!==t.canStar,t.canEdit=!1!==t.canEdit,t.showSettings=t.canEdit,t.canMakeEditable=t.canSave&&!this.editable,this.editable||(t.canEdit=!1,t.canDelete=!1,t.canSave=!1),this.meta=t},t.prototype.getSaveModelClone=function(e){var r=s.a.defaults(e||{},{saveVariables:!0,saveTimerange:!0}),n={};for(var a in this)!t.nonPersistedProperties[a]&&this.hasOwnProperty(a)&&(n[a]=s.a.cloneDeep(this[a]));if(n.templating={list:s.a.map(this.templating.list,function(t){return t.getSaveModel?t.getSaveModel():t})},!r.saveVariables)for(var i=0;i<n.templating.list.length;i++){var o=n.templating.list[i],l=s.a.find(this.originalTemplating,{name:o.name,type:o.type});l&&("adhoc"===o.type?n.templating.list[i].filters=l.filters:n.templating.list[i].current=l.current)}return r.saveTimerange||(n.time=this.originalTime),n.panels=s.a.chain(this.panels).filter(function(t){return"add-panel"!==t.type}).map(function(t){return t.getSaveModel()}).value(),n=d(n)},t.prototype.setViewMode=function(t,e,r){this.meta.fullscreen=e,this.meta.isEditing=r&&this.meta.canEdit,t.setViewMode(e,this.meta.isEditing),this.events.emit("view-mode-changed",t)},t.prototype.timeRangeUpdated=function(){this.events.emit("time-range-updated")},t.prototype.startRefresh=function(){this.events.emit("refresh");for(var t=0,e=this.panels;t<e.length;t++){var r=e[t];this.otherPanelInFullscreen(r)||r.refresh()}},t.prototype.render=function(){this.events.emit("render");for(var t=0,e=this.panels;t<e.length;t++){e[t].render()}},t.prototype.panelInitialized=function(t){t.initialized(),this.otherPanelInFullscreen(t)||t.refresh()},t.prototype.otherPanelInFullscreen=function(t){return this.meta.fullscreen&&!t.fullscreen},t.prototype.ensureListExist=function(t){return t||(t={}),t.list||(t.list=[]),t},t.prototype.getNextPanelId=function(){for(var t=0,e=0,r=this.panels;e<r.length;e++){var n=r[e];if(n.id>t&&(t=n.id),n.collapsed)for(var a=0,i=n.panels;a<i.length;a++){var s=i[a];s.id>t&&(t=s.id)}}return t+1},t.prototype.forEachPanel=function(t){for(var e=0;e<this.panels.length;e++)t(this.panels[e],e)},t.prototype.getPanelById=function(t){for(var e=0,r=this.panels;e<r.length;e++){var n=r[e];if(n.id===t)return n}return null},t.prototype.addPanel=function(t){t.id=this.getNextPanelId();var e=new p.a(t);this.panels.unshift(e),this.sortPanelsByGridPos(),this.events.emit("panel-added",e)},t.prototype.sortPanelsByGridPos=function(){this.panels.sort(function(t,e){return t.gridPos.y===e.gridPos.y?t.gridPos.x-e.gridPos.x:t.gridPos.y-e.gridPos.y})},t.prototype.cleanUpRepeats=function(){if(!this.snapshot&&0!==this.templating.list.length){this.iteration=(this.iteration||(new Date).getTime())+1;for(var t=[],e=0,r=this.panels;e<r.length;e++){delete(a=r[e]).scopedVars}for(var n=0;n<this.panels.length;n++){var a;(a=this.panels[n]).repeat&&!a.repeatedByRow||!a.repeatPanelId||a.repeatIteration===this.iteration||t.push(a)}s.a.pull.apply(s.a,[this.panels].concat(t)),this.sortPanelsByGridPos(),this.events.emit("repeats-processed")}},t.prototype.processRepeats=function(){if(!this.snapshot&&0!==this.templating.list.length){this.cleanUpRepeats(),this.iteration=(this.iteration||(new Date).getTime())+1;for(var t=0;t<this.panels.length;t++){var e=this.panels[t];e.repeat&&this.repeatPanel(e,t)}this.sortPanelsByGridPos(),this.events.emit("repeats-processed")}},t.prototype.cleanUpRowRepeats=function(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];!n.repeat&&n.repeatPanelId&&e.push(n)}s.a.pull.apply(s.a,[t].concat(e)),s.a.pull.apply(s.a,[this.panels].concat(e))},t.prototype.processRowRepeats=function(t){if(!this.snapshot&&0!==this.templating.list.length){var e=t.panels;if(!t.collapsed){var r=s.a.findIndex(this.panels,function(e){return e.id===t.id});e=this.getRowPanels(r)}this.cleanUpRowRepeats(e);for(var n=function(t){var r=e[t];if(r.repeat){var n=s.a.findIndex(a.panels,function(t){return t.id===r.id});a.repeatPanel(r,n)}},a=this,i=0;i<e.length;i++)n(i)}},t.prototype.getPanelRepeatClone=function(t,e,r){if(0===e)return t;var n=new p.a(t.getSaveModel());return n.id=this.getNextPanelId(),this.panels.splice(r+e,0,n),n.repeatIteration=this.iteration,n.repeatPanelId=t.id,n.repeat=null,n},t.prototype.getRowRepeatClone=function(t,e,r){if(0===e){if(!t.collapsed){var n=this.getRowPanels(r);t.panels=n}return t}var a,i,o=new p.a(t.getSaveModel());return t.collapsed?(a=s.a.cloneDeep(t.panels),o.panels=a,i=r+e):(a=this.getRowPanels(r),o.panels=s.a.map(a,function(t){return t.getSaveModel()}),i=r+(a.length+1)*e),this.panels.splice(i,0,o),this.updateRepeatedPanelIds(o),o},t.prototype.repeatPanel=function(t,e){var r=s.a.find(this.templating.list,{name:t.repeat});if(r)if("row"!==t.type){for(var n=this.getSelectedVariableOptions(r),a=t.minSpan||6,i=0,l=t.gridPos.y,c=0;c<n.length;c++){var u=n[c],d=void 0;(d=this.getPanelRepeatClone(t,c,e)).scopedVars=d.scopedVars||{},d.scopedVars[r.name]=u,t.repeatDirection===o.h?(c>0&&(l+=d.gridPos.h),d.gridPos.y=l):(d.gridPos.w=Math.max(o.e/n.length,a),d.gridPos.x=i,d.gridPos.y=l,(i+=d.gridPos.w)+d.gridPos.w>o.e&&(i=0,l+=d.gridPos.h))}var p=l-t.gridPos.y;if(p>0)for(var h=e+n.length;h<this.panels.length;h++)this.panels[h].gridPos.y+=p}else this.repeatRow(t,e,r)},t.prototype.repeatRow=function(t,e,r){var n=this,a=this.getSelectedVariableOptions(r),i=t.gridPos.y;function o(t,e){t.scopedVars=t.scopedVars||{},t.scopedVars[r.name]=e}for(var l=function(r){var l=a[r],u=c.getRowRepeatClone(t,r,e);o(u,l);var d=c.getRowHeight(u),h=u.panels||[],f=void 0;if(t.collapsed)s.a.each(h,function(t,e){o(t,l),r>0&&n.updateRepeatedPanelIds(t,!0)}),u.gridPos.y+=r,i+=r,f=e+r+1;else{var m=e+(h.length+1)*r+1;s.a.each(h,function(t,e){if(o(t,l),r>0){var a=new p.a(t);n.updateRepeatedPanelIds(a,!0),a.gridPos.y+=d*r,n.panels.splice(m+e,0,a)}}),u.panels=[],u.gridPos.y+=d*r,i+=d,f=m+h.length}for(var g=f;g<c.panels.length;g++)c.panels[g].gridPos.y+=i},c=this,u=0;u<a.length;u++)l(u)},t.prototype.updateRepeatedPanelIds=function(t,e){return t.repeatPanelId=t.id,t.id=this.getNextPanelId(),t.repeatIteration=this.iteration,e?t.repeatedByRow=!0:t.repeat=null,t},t.prototype.getSelectedVariableOptions=function(t){return"All"===t.current.text?t.options.slice(1,t.options.length):s.a.filter(t.options,{selected:!0})},t.prototype.getRowHeight=function(t){if(!t.panels||0===t.panels.length)return 0;var e=t.gridPos.y,r=s.a.map(t.panels,"gridPos"),n=s.a.maxBy(r,function(t){return t.y+t.h});return n.y+n.h-e},t.prototype.removePanel=function(t){var e=s.a.indexOf(this.panels,t);this.panels.splice(e,1),this.events.emit("panel-removed",t)},t.prototype.removeRow=function(t,e){(!e&&t.collapsed||e&&!t.collapsed)&&this.toggleRow(t),this.removePanel(t)},t.prototype.expandRows=function(){for(var t=0;t<this.panels.length;t++){var e=this.panels[t];"row"===e.type&&(e.collapsed&&this.toggleRow(e))}},t.prototype.collapseRows=function(){for(var t=0;t<this.panels.length;t++){var e=this.panels[t];"row"===e.type&&(e.collapsed||this.toggleRow(e))}},t.prototype.setPanelFocus=function(t){this.meta.focusPanelId=t},t.prototype.updateSubmenuVisibility=function(){var t=this;this.meta.submenuEnabled=t.links.length>0||s.a.filter(t.templating.list,function(t){return 2!==t.hide}).length>0||s.a.filter(t.annotations.list,function(t){return!0!==t.hide}).length>0||!!(t.description&&t.description.length>0)},t.prototype.getPanelInfoById=function(t){for(var e=0;e<this.panels.length;e++)if(this.panels[e].id===t)return{panel:this.panels[e],index:e};return null},t.prototype.duplicatePanel=function(t){var e=t.getSaveModel();return e.id=this.getNextPanelId(),delete e.repeat,delete e.repeatIteration,delete e.repeatPanelId,delete e.scopedVars,e.alert&&delete e.thresholds,delete e.alert,t.gridPos.x+2*t.gridPos.w<=o.e?e.gridPos.x+=t.gridPos.w:e.gridPos.y+=t.gridPos.h,this.addPanel(e),e},t.prototype.formatDate=function(t,e){return t=a.a.isMoment(t)?t:a()(t),e=e||"YYYY-MM-DD HH:mm:ss","browser"===this.getTimezone()?a()(t).format(e):a.a.utc(t).format(e)},t.prototype.destroy=function(){this.events.removeAllListeners();for(var t=0,e=this.panels;t<e.length;t++){e[t].destroy()}},t.prototype.toggleRow=function(t){var e=s.a.indexOf(this.panels,t);if(t.collapsed){t.collapsed=!1;var r=s.a.some(t.panels,function(t){return t.repeat});if(t.panels.length>0){for(var n=t.panels[0].gridPos.y-(t.gridPos.y+t.gridPos.h),a=e+1,i=t.gridPos.y,o=0,l=t.panels;o<l.length;o++){var c=l[o];c.gridPos.y-=n,this.panels.splice(a,0,new p.a(c)),a+=1,i=Math.max(i,c.gridPos.y+c.gridPos.h)}for(var u=i-t.gridPos.y-1,d=a;d<this.panels.length;d++)this.panels[d].gridPos.y+=u;t.panels=[],r&&this.processRowRepeats(t)}return this.sortPanelsByGridPos(),void this.events.emit("row-expanded")}var h=this.getRowPanels(e);s.a.pull.apply(s.a,[this.panels].concat(h)),t.panels=s.a.map(h,function(t){return t.getSaveModel()}),t.collapsed=!0,this.events.emit("row-collapsed")},t.prototype.getRowPanels=function(t){for(var e=[],r=t+1;r<this.panels.length;r++){var n=this.panels[r];if("row"===n.type)break;e.push(n)}return e},t.prototype.on=function(t,e){this.events.on(t,e)},t.prototype.off=function(t,e){this.events.off(t,e)},t.prototype.cycleGraphTooltip=function(){this.graphTooltip=(this.graphTooltip+1)%3},t.prototype.sharedTooltipModeEnabled=function(){return this.graphTooltip>0},t.prototype.sharedCrosshairModeOnly=function(){return 1===this.graphTooltip},t.prototype.getRelativeTime=function(t){return t=a.a.isMoment(t)?t:a()(t),"browser"===this.timezone?a()(t).fromNow():a.a.utc(t).fromNow()},t.prototype.getNextQueryLetter=function(t){var e=s.a.find("ABCDEFGHIJKLMNOPQRSTUVWXYZ",function(e){return s.a.every(t.targets,function(t){return t.refId!==e})});return t.targets.length>=26&&void 0===e&&(e=""+t.targets.length),e},t.prototype.isTimezoneUtc=function(){return"utc"===this.getTimezone()},t.prototype.getTimezone=function(){return this.timezone?this.timezone:u.a.user.timezone},t.prototype.updateSchema=function(t){new h(this).updateSchema(t)},t.prototype.resetOriginalTime=function(){this.originalTime=s.a.cloneDeep(this.time)},t.prototype.hasTimeChanged=function(){return!s.a.isEqual(this.time,this.originalTime)},t.prototype.resetOriginalVariables=function(){this.originalTemplating=s.a.map(this.templating.list,function(t){return{name:t.name,type:t.type,current:s.a.cloneDeep(t.current),filters:s.a.cloneDeep(t.filters)}})},t.prototype.hasVariableValuesChanged=function(){if(this.templating.list.length!==this.originalTemplating.length)return!1;var t=s.a.map(this.templating.list,function(t){return{name:t.name,type:t.type,current:s.a.cloneDeep(t.current),filters:s.a.cloneDeep(t.filters)}});return!s.a.isEqual(t,this.originalTemplating)},t.prototype.autoFitPanels=function(t){if(this.meta.autofitpanels){var e=Math.max.apply(Math,this.panels.map(function(t){return t.gridPos.h+t.gridPos.y})),r=t-55-20;this.meta.submenuEnabled&&!this.meta.kiosk&&(r-=50),"b"===this.meta.kiosk&&(r+=55);var n=e/Math.floor(r/(o.c+o.d));this.panels.forEach(function(t,e){t.gridPos.y=Math.round(t.gridPos.y/n)||1,t.gridPos.h=Math.round(t.gridPos.h/n)||1})}},t.nonPersistedProperties={events:!0,meta:!0,panels:!0,templating:!0,originalTime:!0,originalTemplating:!0},t}()},function(t,e,r){"use strict";var n=r(2),a=r(0),i=r.n(a),s=r(178),o=r(61),l=r(247),c=r(97),u=function(t){var e=t.className,r=t.defaultValue,n=t.getOptionLabel,a=t.getOptionValue,s=t.onSelected,u=t.options,d=t.placeholder,p=t.width,h=t.value;return i.a.createElement(o.b,{classNamePrefix:"gf-form-select-box",className:"width-"+p+" gf-form-input gf-form-input--form-dropdown "+(e||""),components:{Option:l.a},defaultValue:r,value:h,getOptionLabel:n,getOptionValue:a,isSearchable:!1,onChange:s,options:u,placeholder:d||"Choose",styles:c.a})},d=r(15);r.d(e,"a",function(){return f});var p=[{value:"",text:"默认"},{value:"dark",text:"暗"},{value:"light",text:"亮"}],h=[{value:"",text:"默认"},{value:"browser",text:"本地浏览器时间"},{value:"utc",text:"UTC"}],f=function(t){function e(e){var r=t.call(this,e)||this;return r.backendSrv=Object(d.a)(),r.onSubmitForm=function(t){return n.b(r,void 0,void 0,function(){var e,r,a,i,s;return n.d(this,function(n){switch(n.label){case 0:return t.preventDefault(),e=this.state,r=e.homeDashboardId,a=e.theme,i=e.timezone,s=e.backgroundUrl,[4,this.backendSrv.put("/api/"+this.props.resourceUri+"/preferences",{homeDashboardId:r,theme:a,timezone:i,backgroundUrl:s})];case 1:return n.sent(),window.location.reload(),[2]}})})},r.onThemeChanged=function(t){r.setState({theme:t})},r.onTimeZoneChanged=function(t){r.setState({timezone:t})},r.onHomeDashboardChanged=function(t){r.setState({homeDashboardId:t})},r.onHomeBgUrlChanged=function(t){r.setState({backgroundUrl:t})},r.state={homeDashboardId:0,theme:"",timezone:"",backgroundUrl:"",dashboards:[]},r}return n.c(e,t),e.prototype.componentDidMount=function(){return n.b(this,void 0,void 0,function(){var t,e,r;return n.d(this,function(n){switch(n.label){case 0:return[4,this.backendSrv.get("/api/"+this.props.resourceUri+"/preferences")];case 1:return t=n.sent(),[4,this.backendSrv.search({starred:!0})];case 2:return e=n.sent(),t.homeDashboardId>0&&!e.find(function(e){return e.id===t.homeDashboardId})?[4,this.backendSrv.search({dashboardIds:[t.homeDashboardId]})]:[3,4];case 3:(r=n.sent())&&r.length>0&&e.push(r[0]),n.label=4;case 4:return this.setState({homeDashboardId:t.homeDashboardId,theme:t.theme,timezone:t.timezone,backgroundUrl:t.backgroundUrl,dashboards:[{id:0,title:"默认",tags:[],type:"",uid:"",uri:"",url:""}].concat(e)}),[2]}})})},e.prototype.render=function(){var t=this,e=this.state,r=e.theme,n=e.timezone,a=e.homeDashboardId,o=e.backgroundUrl,l=e.dashboards;return i.a.createElement("form",{className:"section gf-form-group",onSubmit:this.onSubmitForm},i.a.createElement("h3",{className:"page-heading"},"偏好"),i.a.createElement("div",{className:"gf-form"},i.a.createElement("span",{className:"gf-form-label width-11"},"UI主题"),i.a.createElement(u,{value:p.find(function(t){return t.value===r}),options:p,getOptionValue:function(t){return t.value},getOptionLabel:function(t){return t.text},onSelected:function(e){return t.onThemeChanged(e.value)},width:20})),i.a.createElement("div",{className:"gf-form"},i.a.createElement(s.a,{width:11,tooltip:"找不到你想要的仪表盘?先用星号标记它，然后它会出现在这个选择框中。"},"主页仪表盘"),i.a.createElement(u,{value:l.find(function(t){return t.id===a}),getOptionValue:function(t){return t.id},getOptionLabel:function(t){return t.title},onSelected:function(e){return t.onHomeDashboardChanged(e.id)},options:l,placeholder:"选择默认仪表盘",width:20})),i.a.createElement("div",{className:"gf-form"},i.a.createElement("label",{className:"gf-form-label width-11"},"时区"),i.a.createElement(u,{value:h.find(function(t){return t.value===n}),getOptionValue:function(t){return t.value},getOptionLabel:function(t){return t.text},onSelected:function(e){return t.onTimeZoneChanged(e.value)},options:h,width:20})),i.a.createElement("div",{className:"gf-form",style:{display:"user"==this.props.resourceUri?"block":"none"}},i.a.createElement(s.a,{width:11,tooltip:"请先将背景图片放置public/img目录下，输入框中填写图片名称及格式即可,例如 grafana_icon.svg"},"更改背景图片"),i.a.createElement("input",{className:"gf-form-input width-20",type:"text",value:o,onChange:function(e){t.onHomeBgUrlChanged(e.target.value)},style:{display:"inline-block",position:"absolute",top:"0",right:"0"}})),i.a.createElement("div",{className:"gf-form-button-row"},i.a.createElement("button",{type:"submit",className:"btn btn-success"},"保存")))},e}(a.PureComponent);e.b=f},function(t,e,r){"use strict";r.d(e,"a",function(){return s});var n=r(0),a=r.n(n),i=r(119),s=function(t){return a.a.createElement("span",{className:"gf-form-label width-"+(t.width?t.width:"10")},a.a.createElement("span",null,t.children),t.tooltip&&a.a.createElement(i.a,{className:"gf-form-help-icon--right-normal",placement:"auto",content:t.tooltip},a.a.createElement("i",{className:"gicon gicon-question gicon--has-hover"})))}},,,,,,function(t,e){},function(t,e){},,,,,function(t,e,r){"use strict";var n;r.d(e,"a",function(){return n}),r.d(e,"b",function(){return a}),function(t){t.UpdateNavIndex="UPDATE_NAV_INDEX"}(n||(n={}));var a=function(t){return{type:n.UpdateNavIndex,payload:t}}},,,,,,,,,,,,,,,,,,,function(t,e,r){"use strict";function n(t,e,r,n){for(var a in r)r.hasOwnProperty(a)&&(t[a]=void 0===e[a]?r[a]:e[a])}r.d(e,"a",function(){return n})},,function(t,e){},function(t,e){},function(t,e){},function(t,e){},,,,,,,,,,,,,,,,,,,,,,function(t,e,r){"use strict";r.d(e,"a",function(){return o});var n=r(7),a=r.n(n),i=r(6),s=r.n(i),o=new(function(){function t(){}return t.prototype.init=function(t,e){var r=this;this.enabled="development"===t.buildInfo.env,this.timings={},this.timings.appStart={loadStart:(new Date).getTime()},this.$rootScope=e,this.window=window,this.enabled&&(e.$watch(function(){return r.digestCounter++,!1},function(){}),e.onAppEvent("refresh",this.refresh.bind(this),e),e.onAppEvent("dashboard-fetch-end",this.dashboardFetched.bind(this),e),e.onAppEvent("dashboard-initialized",this.dashboardInitialized.bind(this),e),e.onAppEvent("panel-initialized",this.panelInitialized.bind(this),e))},t.prototype.refresh=function(){var t=this;this.timings.query=0,this.timings.render=0,setTimeout(function(){console.log("panel count: "+t.panelsInitCount),console.log("total query: "+t.timings.query),console.log("total render: "+t.timings.render),console.log("avg render: "+t.timings.render/t.panelsInitCount)},5e3)},t.prototype.dashboardFetched=function(){this.timings.dashboardLoadStart=(new Date).getTime(),this.panelsInitCount=0,this.digestCounter=0,this.panelsInitCount=0,this.panelsRendered=0,this.timings.query=0,this.timings.render=0},t.prototype.dashboardInitialized=function(){var t=this;setTimeout(function(){console.log("Dashboard::Performance Total Digests: "+t.digestCounter),console.log("Dashboard::Performance Total Watchers: "+t.getTotalWatcherCount()),console.log("Dashboard::Performance Total ScopeCount: "+t.scopeCount);var e=t.timings.lastPanelInitializedAt-t.timings.dashboardLoadStart;console.log("Dashboard::Performance All panels initialized in "+e+" ms");for(var r=window.performance.now(),n=0;n<30;n++)t.$rootScope.$apply();console.log("Dashboard::Performance Root Digest "+(window.performance.now()-r)/30)},3e3)},t.prototype.getTotalWatcherCount=function(){var t=0,e=0,r=a()(document.getElementsByTagName("body")),n=function(r){r.data().hasOwnProperty("$scope")&&(e++,s.a.forEach(r.data().$scope.$$watchers,function(){t++})),s.a.forEach(r.children(),function(t){n(a()(t))})};return n(r),this.scopeCount=e,t},t.prototype.renderingCompleted=function(t,e){this.panelsRendered=(this.panelsRendered||0)+1,this.window.panelsRendered=this.panelsRendered,this.enabled&&(e.renderEnd=(new Date).getTime(),this.timings.query+=e.queryEnd-e.queryStart,this.timings.render+=e.renderEnd-e.renderStart)},t.prototype.panelInitialized=function(){this.enabled&&(this.panelsInitCount++,this.timings.lastPanelInitializedAt=(new Date).getTime())},t}())},,,function(t,e,r){"use strict";var n=r(2),a=r(0),i=r.n(a),s=r(61);e.a=function(t){var e=t.children,r=t.data,a=t.className;return i.a.createElement(s.a.Option,n.a({},t),i.a.createElement("div",{className:"description-picker-option__button btn btn-link "+a},r.avatarUrl&&i.a.createElement("img",{src:r.avatarUrl,alt:r.label,className:"user-picker-option__avatar"}),e))}},,function(t,e,r){"use strict";var n=r(2),a=r(1),i=r.n(a),s=r(0),o=r.n(s),l=r(14),c=r.n(l),u=r(254),d=r(175);var p=r(166),h=r.n(p);var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.getRef=function(t){e.el=t},e.onClick=function(){e.props.onClickItem(e.props.item)},e}return n.c(e,t),e.prototype.componentDidUpdate=function(t){var e=this;this.props.isSelected&&!t.isSelected&&requestAnimationFrame(function(){!function(t){if(t&&t.offsetParent){var e=t.offsetParent;(t.offsetTop>e.scrollTop+e.offsetHeight||t.offsetTop<e.scrollTop)&&(e.scrollTop=t.offsetTop-e.offsetTop)}}(e.el)})},e.prototype.render=function(){var t=this.props,e=t.isSelected,r=t.item,n=t.prefix,a=e?"typeahead-item typeahead-item__selected":"typeahead-item",i=r.label;return o.a.createElement("li",{ref:this.getRef,className:a,onClick:this.onClick},o.a.createElement(h.a,{textToHighlight:i,searchWords:[n],highlightClassName:"typeahead-match"}),r.documentation&&e?o.a.createElement("div",{className:"typeahead-item-hint"},r.documentation):null)},e}(o.a.PureComponent),m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.c(e,t),e.prototype.render=function(){var t=this.props,e=t.items,r=t.label,n=t.selected,a=t.onClickItem,i=t.prefix;return o.a.createElement("li",{className:"typeahead-group"},o.a.createElement("div",{className:"typeahead-group__title"},r),o.a.createElement("ul",{className:"typeahead-group__list"},e.map(function(t){return o.a.createElement(f,{key:t.label,onClickItem:a,isSelected:n===t,item:t,prefix:i})})))},e}(o.a.PureComponent),g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.c(e,t),e.prototype.render=function(){var t=this.props,e=t.groupedItems,r=t.menuRef,a=t.selectedItem,i=t.onClickItem,s=t.prefix;return o.a.createElement("ul",{className:"typeahead",ref:r},e.map(function(t){return o.a.createElement(m,n.a({key:t.label,onClickItem:i,prefix:s,selected:a},t))}))},e}(o.a.PureComponent),v=r(17),b={blocks:{paragraph:"paragraph",codeblock:"code_block",codeline:"code_line"},inlines:{},marks:{}},y=function(t,e){var r=t.split("\n").map(function(t){return v.Block.create({type:"code_line",nodes:[v.Text.create(t)]})}),n=v.Block.create({data:{syntax:e},type:"code_block",nodes:r});return v.Document.create({nodes:[n]})},w=function(t,e){var r=y(t,e);return v.Value.create({document:r,SCHEMA:b})},x=function(){function t(t){var e=this.parse(t),r=e.orders.length?e.orders[0]:0;this.nextMoveOffset=this.getOffsetBetween(e.parts,0,r),this.orders=e.orders,this.parts=e.parts}return t.prototype.clearPlaceholders=function(){this.nextMoveOffset=0,this.orders=[]},t.prototype.getNextMoveOffset=function(){return this.nextMoveOffset},t.prototype.hasPlaceholders=function(){return this.orders.length>0},t.prototype.setNextPlaceholderValue=function(t){if(0!==this.orders.length){var e=this.orders[0];if(this.parts[e]=t,this.orders=this.orders.slice(1),0!==this.orders.length){var r=this.orders[0];if(e!==r){var n=e>r,a=n?{start:r+1,end:e+1}:{start:e+1,end:r};this.nextMoveOffset=(n?-1:1)*this.getOffsetBetween(this.parts,a.start,a.end)}else this.nextMoveOffset=0}else this.nextMoveOffset=0}},t.prototype.toString=function(){return this.parts.join("")},t.prototype.getOffsetBetween=function(t,e,r){return t.slice(e,r).reduce(function(t,e){return t+e.length},0)},t.prototype.parse=function(t){for(var e=/\$(\d+)/g,r=[],n=[],a=0;;){var i=e.exec(t);if(!i)break;var s=t.slice(a,i.index);r.push(s),""!==s&&r.push("");var o=parseInt(i[1],10);n.push({index:r.length-1,order:o}),a+=s.length+i.length}return r.push(t.slice(a)),{orders:n.sort(function(t,e){return t.order-e.order}).map(function(t){return t.index}),parts:r}},t}(),S=100;function k(t,e){var r=t.reduce(function(t,e){return t.concat(e.items)},[]);return r[Math.max(e,0)%r.length]}function C(t){return t&&t.length>0}var T=function(t){function e(e,r){var a=t.call(this,e,r)||this;return a.onChange=function(t){var e=t.value,r=e.document!==a.state.value.document;a.setState({value:e},function(){r&&a.handleChangeValue()}),r&&e.selection.isCollapsed?window.requestAnimationFrame(a.handleTypeahead):a.resetTimer||a.resetTypeahead()},a.handleChangeValue=function(){var t=a.props.onValueChanged;t&&t(d.a.serialize(a.state.value))},a.handleTypeahead=i.a.debounce(function(){return n.b(a,void 0,void 0,function(){var t,e,r,a,s,o,l,c,u,d,p,h,f,m,g,v,b,y=this;return n.d(this,function(n){if(t=window.getSelection(),e=this.props,r=e.cleanText,a=e.onTypeahead,s=this.state.value,a&&t.anchorNode){if(o=t.anchorNode.parentElement,!(l=o.closest(".slate-query-field"))||this.state.value.isBlurred)return[2];c=t.getRangeAt(0),u=c.startOffset,d=t.anchorNode.textContent,p=d.substr(0,u),(h=p.match(/(?:!?=~?"?|")(.*)/))?p=h[1]:r&&(p=r(p)),f=a({editorNode:l,prefix:p,selection:t,text:d,value:s,wrapperNode:o}),m=f.suggestions,g=f.context,v=f.refresher,b=m.map(function(t){return t.items&&(p&&(t.skipFilter||(t.items=t.items.filter(function(t){return(t.filterText||t.label).length>=p.length}),t.prefixMatch?t.items=t.items.filter(function(t){return 0===(t.filterText||t.label).indexOf(p)}):t.items=t.items.filter(function(t){return(t.filterText||t.label).indexOf(p)>-1})),t.items=t.items.filter(function(t){return t.insertText||(t.filterText||t.label)!==p})),t.skipSort||(t.items=i.a.sortBy(t.items,function(t){return t.sortText||t.label}))),t}).filter(function(t){return t.items&&t.items.length>0}),i.a.isEqual(b,this.state.suggestions)&&(b=this.state.suggestions),this.setState({suggestions:b,typeaheadPrefix:p,typeaheadContext:g,typeaheadText:d},function(){v&&v.then(y.handleTypeahead).catch(function(t){return console.error(t)})})}return[2]})})},S),a.onKeyDown=function(t,e){var r=a.state,n=r.typeaheadIndex,i=r.suggestions;switch(t.key){case"Escape":if(a.menuEl)return t.preventDefault(),t.stopPropagation(),a.resetTypeahead(),!0;break;case" ":if(t.ctrlKey)return t.preventDefault(),a.handleTypeahead(),!0;break;case"Enter":case"Tab":if(a.menuEl){if(t.preventDefault(),!i||0===i.length)return;var s=k(i,n),o=a.applyTypeahead(e,s),l=o.operations.find(function(t){return"insert_text"===t.type});if(l){var c=l.text;a.placeholdersBuffer.setNextPlaceholderValue(c),a.placeholdersBuffer.hasPlaceholders()&&o.move(a.placeholdersBuffer.getNextMoveOffset()).focus()}return!0}break;case"ArrowDown":a.menuEl&&(t.preventDefault(),a.setState({typeaheadIndex:n+1}));break;case"ArrowUp":a.menuEl&&(t.preventDefault(),a.setState({typeaheadIndex:Math.max(0,n-1)}))}},a.resetTypeahead=function(){a.setState({suggestions:[],typeaheadIndex:0,typeaheadPrefix:"",typeaheadContext:null}),a.resetTimer=null},a.handleBlur=function(){var t=a.props.onBlur;a.resetTimer=setTimeout(a.resetTypeahead,100),a.placeholdersBuffer.clearPlaceholders(),t&&t()},a.handleFocus=function(){var t=a.props.onFocus;t&&t()},a.onClickMenu=function(t){var e=a.applyTypeahead(a.state.value.change(),t);a.onChange(e)},a.updateMenu=function(){var t=a.state.suggestions,e=a.menuEl,r=window.getSelection().anchorNode;if(e)if(C(t)){if(r){var n=r.parentElement.getBoundingClientRect(),i=window.scrollX,s=window.scrollY;requestAnimationFrame(function(){e.style.opacity="1",e.style.top=n.top+s+n.height+4+"px",e.style.left=n.left+i-2+"px"})}}else e.removeAttribute("style")},a.menuRef=function(t){a.menuEl=t},a.renderMenu=function(){var t=a.props.portalOrigin,e=a.state,r=e.suggestions,n=e.typeaheadIndex,i=e.typeaheadPrefix;if(!C(r))return null;var s=k(r,n);return o.a.createElement(E,{origin:t},o.a.createElement(g,{menuRef:a.menuRef,selectedItem:s,onClickItem:a.onClickMenu,prefix:i,groupedItems:r}))},a.placeholdersBuffer=new x(e.initialValue||""),a.plugins=[{onKeyDown:function(t,e){var r=e.value;if(r.isCollapsed&&"k"===t.key&&t.ctrlKey){t.preventDefault();var n=r.anchorText.text,a=r.anchorOffset,i=n.length-a;return e.deleteForward(i),!0}}},{onKeyDown:function(t,e){var r=e.value;if(r.isCollapsed&&"Enter"===t.key&&t.shiftKey){t.preventDefault();var n=function(t){var e=t.length-t.trimLeft().length;if(e){for(var r=t[0];--e;)r+=t[0];return r}return""}(r.startBlock.text);return e.splitBlock().insertText(n).focus()}}}].concat(e.additionalPlugins).filter(function(t){return t}),a.state={suggestions:[],typeaheadContext:null,typeaheadIndex:0,typeaheadPrefix:"",typeaheadText:"",value:w(a.placeholdersBuffer.toString(),e.syntax)},a}return n.c(e,t),e.prototype.componentDidMount=function(){this.updateMenu()},e.prototype.componentWillUnmount=function(){clearTimeout(this.resetTimer)},e.prototype.componentDidUpdate=function(t,e){this.state.value===e.value&&C(this.state.suggestions)===C(e.suggestions)||this.updateMenu()},e.prototype.componentWillReceiveProps=function(t){if(t.syntaxLoaded&&!this.props.syntaxLoaded){var e=this.state.value.change().insertText(" ").deleteBackward();this.placeholdersBuffer.hasPlaceholders()&&e.move(this.placeholdersBuffer.getNextMoveOffset()).focus(),this.onChange(e)}},e.prototype.applyTypeahead=function(t,e){var r=this.props,a=r.cleanText,i=r.onWillApplySuggestion,s=r.syntax,o=this.state,l=o.typeaheadPrefix,c=o.typeaheadText,u=e.insertText||e.label,d="function"===e.kind,p=e.move||0;i&&(u=i(u,n.a({},this.state))),this.resetTypeahead();var h=e.deleteBackwards||l.length,f=(a?a(c):c).length-l.length,m=c.indexOf(l),g=l&&(f>0&&m>-1||u===c)&&!d?f+m:0;if(u.match(/\n/)){var v=y(u,s);return t.deleteBackward(h).deleteForward(g).insertFragment(v).focus()}return t.deleteBackward(h).deleteForward(g).insertText(u).move(p).focus()},e.prototype.render=function(){return o.a.createElement("div",{className:"slate-query-field-wrapper"},o.a.createElement("div",{className:"slate-query-field"},this.renderMenu(),o.a.createElement(u.a,{autoCorrect:!1,onBlur:this.handleBlur,onKeyDown:this.onKeyDown,onChange:this.onChange,onFocus:this.handleFocus,placeholder:this.props.placeholder,plugins:this.plugins,spellCheck:!1,value:this.state.value})))},e}(o.a.PureComponent),E=function(t){function e(e){var r=t.call(this,e)||this,n=e.index,a=void 0===n?0:n,i=e.origin,s=void 0===i?"query":i;return r.node=document.createElement("div"),r.node.classList.add("slate-typeahead","slate-typeahead-"+s+"-"+a),document.body.appendChild(r.node),r}return n.c(e,t),e.prototype.componentWillUnmount=function(){document.body.removeChild(this.node)},e.prototype.render=function(){return c.a.createPortal(this.props.children,this.node)},e}(o.a.PureComponent);e.a=T},function(t,e,r){"use strict";var n=["#E24D42","#1F78C1","#BA43A9","#705DA0","#466803","#508642","#447EBC","#C15C17","#890F02","#757575","#0A437C","#6D1F62","#584477","#629E51","#2F4F4F","#BF1B00","#806EB7","#8a2eb8","#699e00","#000000","#3F6833","#2F575E","#99440A","#E0752D","#0E4AB4","#58140C","#052B51","#511749","#3F2B5B"],a=["#FF7368","#459EE7","#E069CF","#9683C6","#6C8E29","#76AC68","#6AA4E2","#E7823D","#AF3528","#9B9B9B","#3069A2","#934588","#7E6A9D","#88C477","#557575","#E54126","#A694DD","#B054DE","#8FC426","#262626","#658E59","#557D84","#BF6A30","#FF9B53","#3470DA","#7E3A32","#2B5177","#773D6F","#655181"];e.a={getTagColorsFromName:function(t){var e=function(t){for(var e=5381,r=0;r<t.length;r++)e=(e<<5)+e+t.charCodeAt(r);return e}(t.toLowerCase());return{color:n[Math.abs(e%n.length)],borderColor:a[Math.abs(e%a.length)]}}}},function(t,e,r){"use strict";r.d(e,"a",function(){return a}),r.d(e,"b",function(){return i});var n=r(8);function a(t){var e={img:t.avatarUrl,id:"team-"+t.id,subTitle:"Manage members & settings",url:"",text:t.name,breadcrumbs:[{title:"Teams",url:"org/teams"}],children:[{active:!1,icon:"gicon gicon-team",id:"team-members-"+t.id,text:"Members",url:"org/teams/edit/"+t.id+"/members"},{active:!1,icon:"fa fa-fw fa-sliders",id:"team-settings-"+t.id,text:"Settings",url:"org/teams/edit/"+t.id+"/settings"}]};return n.a.buildInfo.isEnterprise&&e.children.push({active:!1,icon:"fa fa-fw fa-refresh",id:"team-groupsync-"+t.id,text:"External group sync",url:"org/teams/edit/"+t.id+"/groupsync"}),e}function i(t){for(var e,r=a({avatarUrl:"public/img/user_profile.png",id:1,name:"Loading",email:"loading",memberCount:0}),n=0,i=r.children;n<i.length;n++){var s=i[n];if(s.id.indexOf(t)>0){s.active=!0,e=s;break}}return{main:r,node:e}}},,function(t,e,r){"use strict";r.d(e,"a",function(){return l});var n=r(2),a=r(0),i=r.n(a),s=r(21),o=r(51);function l(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var a=s.b.apply(void 0,e)(t);return function(t){return i.a.createElement(a,n.a({},t,{store:o.b}))}}},function(t,e,r){"use strict";r.d(e,"a",function(){return f});var n=r(2),a=r(0),i=r.n(a),s=r(171),o=r.n(s),l=r(239),c=r(1),u=r(15),d=r(97),p=r(112),h=r(113),f=function(t){function e(e){var r=t.call(this,e)||this;return r.state={isLoading:!1},r.search=r.search.bind(r),r.debouncedSearch=Object(c.debounce)(r.search,300,{leading:!0,trailing:!0}),r}return n.c(e,t),e.prototype.search=function(t){var e=this,r=Object(u.a)();return this.setState({isLoading:!0}),r.get("/api/org/users?query="+t+"&limit=10").then(function(t){return t.map(function(t){return{id:t.userId,label:t.login===t.email?t.login:t.login+" - "+t.email,avatarUrl:t.avatarUrl,login:t.login}})}).finally(function(){e.setState({isLoading:!1})})},e.prototype.render=function(){var t=this.props,e=t.className,r=t.onSelected,n=this.state.isLoading;return i.a.createElement("div",{className:"user-picker"},i.a.createElement(o.a,{classNamePrefix:"gf-form-select-box",isMulti:!1,isLoading:n,defaultOptions:!0,loadOptions:this.debouncedSearch,onChange:r,className:"gf-form-input gf-form-input--form-dropdown "+(e||""),styles:d.a,components:{Option:l.a,IndicatorsContainer:p.a,NoOptionsMessage:h.a},placeholder:"选择用户",loadingMessage:function(){return"加载中..."},noOptionsMessage:function(){return"未发现用户"},getOptionValue:function(t){return t.id},getOptionLabel:function(t){return t.label}}))},e}(a.Component)},function(t,e,r){"use strict";var n=r(2),a=r(0),i=r.n(a),s=r(61);e.a=function(t){var e=t.children,r=t.isSelected,a=t.data,o=t.className;return i.a.createElement(s.a.Option,n.a({},t),i.a.createElement("div",{className:"description-picker-option__button btn btn-link "+o},r&&i.a.createElement("i",{className:"fa fa-check pull-right","aria-hidden":"true"}),i.a.createElement("div",{className:"gf-form"},e),i.a.createElement("div",{className:"gf-form"},i.a.createElement("div",{className:"muted width-17"},a.description))))}},function(t,e,r){"use strict";var n=r(2),a=r(0),i=r.n(a),s=r(82),o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.c(e,t),e.prototype.render=function(){var t=this.props,e=t.searchQuery,r=t.layoutMode,a=t.onSetLayoutMode,o=t.linkButton,l=t.setSearchQuery,c=t.target,u={href:o.href,target:void 0};return c&&(u.target=c),i.a.createElement("div",{className:"page-action-bar"},i.a.createElement("div",{className:"gf-form gf-form--grow"},i.a.createElement("label",{className:"gf-form--has-input-icon"},i.a.createElement("input",{type:"text",className:"gf-form-input width-20",value:e,onChange:function(t){return l(t.target.value)},placeholder:"通过名称或类型过滤"}),i.a.createElement("i",{className:"gf-form-input-icon fa fa-search"})),i.a.createElement(s.b,{mode:r,onLayoutModeChanged:function(t){return a(t)}})),i.a.createElement("div",{className:"page-action-bar__spacer"}),i.a.createElement("a",n.a({className:"btn btn-success"},u),o.title))},e}(a.PureComponent);e.a=o},function(t,e,r){"use strict";var n=r(0),a=r.n(n);e.a=function(){return a.a.createElement("div",{className:""},a.a.createElement("h5",null,"权限是什么?"),a.a.createElement("p",null,"使用访问控制列表(ACL)模型来限制对仪表板文件夹的访问。可以为用户或团队分配一个文件夹或单个仪表盘的权限。"))}},,,function(t,e,r){"use strict";r.d(e,"a",function(){return l});var n=r(2),a=r(0),i=r.n(a),s=r(1),o=r.n(s),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={id:o.a.uniqueId()},e.internalOnChange=function(t){t.stopPropagation(),e.props.onChange(t)},e}return n.c(e,t),e.prototype.render=function(){var t=this.props,e=t.labelClass,r=void 0===e?"":e,n=t.switchClass,a=void 0===n?"":n,s=t.label,o=t.checked,l=t.small,c="check-"+this.state.id,u="gf-form-label "+r+" pointer",d="gf-form-switch "+a;return l&&(u+=" gf-form-label--small",d+=" gf-form-switch--small"),i.a.createElement("div",{className:"gf-form"},s&&i.a.createElement("label",{htmlFor:c,className:u},s),i.a.createElement("div",{className:d},i.a.createElement("input",{id:c,type:"checkbox",checked:o,onChange:this.internalOnChange}),i.a.createElement("label",{htmlFor:c})))},e}(a.PureComponent)},,,function(t,e,r){"use strict";var n=r(2),a=r(0),i=r.n(a),s=r(174),o=r(41);function l(t){var e=t.item;return e.userAvatarUrl?i.a.createElement("img",{className:"filter-table__avatar",src:e.userAvatarUrl}):e.teamAvatarUrl?i.a.createElement("img",{className:"filter-table__avatar",src:e.teamAvatarUrl}):"Editor"===e.role?i.a.createElement("i",{style:{width:"25px",height:"25px"},className:"gicon gicon-editor"}):i.a.createElement("i",{style:{width:"25px",height:"25px"},className:"gicon gicon-viewer"})}function c(t){var e=t.item;return e.userId?i.a.createElement("span",{className:"filter-table__weak-italic"},"(User)"):e.teamId?i.a.createElement("span",{className:"filter-table__weak-italic"},"(Team)"):i.a.createElement("span",{className:"filter-table__weak-italic"},"(Role)")}var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onPermissionChanged=function(t){e.props.onPermissionChanged(e.props.item,t.value)},e.onRemoveItem=function(){e.props.onRemoveItem(e.props.item)},e}return n.c(e,t),e.prototype.render=function(){var t=this.props,e=t.item,r=t.folderInfo,n=-1===e.dashboardId&&!e.inherited;return i.a.createElement("tr",{className:function(t){return t?"gf-form-disabled":""}(e.inherited)},i.a.createElement("td",{style:{width:"1%"}},i.a.createElement(l,{item:e})),i.a.createElement("td",{style:{width:"90%"}},e.name," ",i.a.createElement(c,{item:e})),i.a.createElement("td",null,e.inherited&&r&&i.a.createElement("em",{className:"muted no-wrap"},"Inherited from folder"," ",i.a.createElement("a",{className:"text-link",href:r.url+"/permissions"},r.title)," "),n&&i.a.createElement("em",{className:"muted no-wrap"},"Default Permission")),i.a.createElement("td",{className:"query-keyword"},"Can"),i.a.createElement("td",null,i.a.createElement("div",{className:"gf-form"},i.a.createElement(s.a,{optionsWithDesc:o.e,onSelected:this.onPermissionChanged,disabled:e.inherited,className:"gf-form-select-box__control--menu-right",value:e.permission}))),i.a.createElement("td",null,e.inherited?i.a.createElement("button",{className:"btn btn-inverse btn-small"},i.a.createElement("i",{className:"fa fa-lock"})):i.a.createElement("a",{className:"btn btn-danger btn-small",onClick:this.onRemoveItem},i.a.createElement("i",{className:"fa fa-remove"}))))},e}(a.PureComponent),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.c(e,t),e.prototype.render=function(){var t=this.props.item;return i.a.createElement("tr",{className:"gf-form-disabled"},i.a.createElement("td",{style:{width:"1%"}},i.a.createElement("i",{style:{width:"25px",height:"25px"},className:"gicon gicon-shield"})),i.a.createElement("td",{style:{width:"90%"}},t.name,i.a.createElement("span",{className:"filter-table__weak-italic"}," (Role)")),i.a.createElement("td",null),i.a.createElement("td",{className:"query-keyword"},"Can"),i.a.createElement("td",null,i.a.createElement("div",{className:"gf-form"},i.a.createElement(s.a,{optionsWithDesc:o.e,onSelected:function(){},disabled:!0,className:"gf-form-select-box__control--menu-right",value:t.permission}))),i.a.createElement("td",null,i.a.createElement("button",{className:"btn btn-inverse btn-small"},i.a.createElement("i",{className:"fa fa-lock"}))))},e}(a.Component),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.c(e,t),e.prototype.render=function(){var t=this.props,e=t.items,r=t.onRemoveItem,n=t.onPermissionChanged,a=t.isFetching,s=t.folderInfo;return i.a.createElement("table",{className:"filter-table gf-form-group"},i.a.createElement("tbody",null,i.a.createElement(d,{key:0,item:{name:"Admin",permission:4,icon:"fa fa-fw fa-street-view"}}),e.map(function(t,e){return i.a.createElement(u,{key:e+1,item:t,onRemoveItem:r,onPermissionChanged:n,folderInfo:s})}),!0===a&&e.length<1?i.a.createElement("tr",null,i.a.createElement("td",{colSpan:4},i.a.createElement("em",null,"加载权限中..."))):null,!1===a&&e.length<1?i.a.createElement("tr",null,i.a.createElement("td",{colSpan:4},i.a.createElement("em",null,"没有设置权限。只有管理员才能访问。"))):null))},e}(a.PureComponent);e.a=p},function(t,e,r){"use strict";var n=r(2),a=r(0),i=r.n(a),s=r(7),o=r.n(s),l=r(120),c=r.n(l),u=r(31),d=function(t){function e(e){var r=t.call(this,e)||this;return r.paletteColors=u.h,r.onColorSelect=r.onColorSelect.bind(r),r}return n.c(e,t),e.prototype.onColorSelect=function(t){var e=this;return function(){e.props.onColorSelect(t)}},e.prototype.render=function(){var t=this,e=this.paletteColors.map(function(e){var r=e.toLowerCase()===t.props.color.toLowerCase()?"fa-circle-o":"fa-circle";return i.a.createElement("i",{key:e,className:"pointer fa "+r,style:{color:e},onClick:t.onColorSelect(e)}," ")});return i.a.createElement("div",{className:"graph-legend-popover"},i.a.createElement("p",{className:"m-b-0"},e))},e}(i.a.Component),p=r(1),h=r.n(p),f=(r(1037),function(t){function e(e){var r=t.call(this,e)||this;return r.onSpectrumMove=r.onSpectrumMove.bind(r),r.setComponentElem=r.setComponentElem.bind(r),r}return n.c(e,t),e.prototype.setComponentElem=function(t){this.elem=o()(t)},e.prototype.onSpectrumMove=function(t){this.isMoving=!0,this.props.onColorSelect(t)},e.prototype.componentDidMount=function(){var t=h.a.assignIn({flat:!0,showAlpha:!0,showButtons:!1,color:this.props.color,appendTo:this.elem,move:this.onSpectrumMove},this.props.options);this.elem.spectrum(t),this.elem.spectrum("show"),this.elem.spectrum("set",this.props.color)},e.prototype.componentWillUpdate=function(t){this.isMoving||this.elem.spectrum("set",t.color)},e.prototype.componentDidUpdate=function(){this.isMoving&&(this.isMoving=!1)},e.prototype.componentWillUnmount=function(){this.elem.spectrum("destroy")},e.prototype.render=function(){return i.a.createElement("div",{className:"spectrum-container",ref:this.setComponentElem})},e}(i.a.Component));r.d(e,"a",function(){return g});var m="#000000",g=function(t){function e(e){var r=t.call(this,e)||this;return r.state={tab:"palette",color:r.props.color||m,colorString:r.props.color||m},r}return n.c(e,t),e.prototype.setPickerNavElem=function(t){this.pickerNavElem=o()(t)},e.prototype.setColor=function(t){var e=c()(t);e.isValid()&&(this.setState({color:e.toString(),colorString:e.toString()}),this.props.onColorSelect(t))},e.prototype.sampleColorSelected=function(t){this.setColor(t)},e.prototype.spectrumColorSelected=function(t){var e=t.toRgbString();this.setColor(e)},e.prototype.onColorStringChange=function(t){var e=t.target.value;this.setState({colorString:e});var r=c()(e);if(r.isValid()){var n=r.toString();this.setState({color:n}),this.props.onColorSelect(n)}},e.prototype.onColorStringBlur=function(t){var e=t.target.value;this.setColor(e)},e.prototype.componentDidMount=function(){var t=this;this.pickerNavElem.find("li:first").addClass("active"),this.pickerNavElem.on("show",function(e){var r=e.target.hash.slice(1);t.setState({tab:r})})},e.prototype.render=function(){var t=i.a.createElement("div",{id:"palette"},i.a.createElement(d,{color:this.state.color,onColorSelect:this.sampleColorSelected.bind(this)})),e=i.a.createElement("div",{id:"spectrum"},i.a.createElement(f,{color:this.state.color,onColorSelect:this.spectrumColorSelected.bind(this),options:{}})),r="palette"===this.state.tab?t:e;return i.a.createElement("div",{className:"gf-color-picker"},i.a.createElement("ul",{className:"nav nav-tabs",id:"colorpickernav",ref:this.setPickerNavElem.bind(this)},i.a.createElement("li",{className:"gf-tabs-item-colorpicker"},i.a.createElement("a",{href:"#palette","data-toggle":"tab"},"Colors")),i.a.createElement("li",{className:"gf-tabs-item-colorpicker"},i.a.createElement("a",{href:"#spectrum","data-toggle":"tab"},"Custom"))),i.a.createElement("div",{className:"gf-color-picker__body"},r),i.a.createElement("div",null,i.a.createElement("input",{className:"gf-form-input gf-form-input--small",value:this.state.colorString,onChange:this.onColorStringChange.bind(this),onBlur:this.onColorStringBlur.bind(this)})))},e}(i.a.Component)},function(t,e,r){"use strict";var n=r(2),a=r(0),i=r.n(a),s=r(246),o=r(171),l=r.n(o),c=r(239),u=r(1),d=r(15),p=r(97),h=r(112),f=r(113),m=function(t){function e(e){var r=t.call(this,e)||this;return r.state={isLoading:!1},r.search=r.search.bind(r),r.debouncedSearch=Object(u.debounce)(r.search,300,{leading:!0,trailing:!0}),r}return n.c(e,t),e.prototype.search=function(t){var e=this,r=Object(d.a)();return this.setState({isLoading:!0}),r.get("/api/teams/search?perpage=10&page=1&query="+t).then(function(t){var r=t.teams.map(function(t){return{id:t.id,label:t.name,name:t.name,avatarUrl:t.avatarUrl}});return e.setState({isLoading:!1}),r})},e.prototype.render=function(){var t=this.props,e=t.onSelected,r=t.className,n=this.state.isLoading;return i.a.createElement("div",{className:"user-picker"},i.a.createElement(l.a,{classNamePrefix:"gf-form-select-box",isMulti:!1,isLoading:n,defaultOptions:!0,loadOptions:this.debouncedSearch,onChange:e,className:"gf-form-input gf-form-input--form-dropdown "+(r||""),styles:p.a,components:{Option:c.a,IndicatorsContainer:h.a,NoOptionsMessage:f.a},placeholder:"现在一个团队",loadingMessage:function(){return"加载中..."},noOptionsMessage:function(){return"没有发现团队"},getOptionValue:function(t){return t.id},getOptionLabel:function(t){return t.label}}))},e}(a.Component),g=r(174),v=r(41),b=function(t){function e(e){var r=t.call(this,e)||this;return r.onTypeChanged=function(t){var e=t.target.value;switch(e){case v.a.User:case v.a.Team:r.setState({type:e,userId:0,teamId:0,role:void 0});break;case v.a.Editor:r.setState({type:e,userId:0,teamId:0,role:v.b.Editor});break;case v.a.Viewer:r.setState({type:e,userId:0,teamId:0,role:v.b.Viewer})}},r.onUserSelected=function(t){r.setState({userId:t&&!Array.isArray(t)?t.id:0})},r.onTeamSelected=function(t){r.setState({teamId:t&&!Array.isArray(t)?t.id:0})},r.onPermissionChanged=function(t){r.setState({permission:t.value})},r.onSubmit=function(t){return n.b(r,void 0,void 0,function(){return n.d(this,function(e){switch(e.label){case 0:return t.preventDefault(),[4,this.props.onAddPermission(this.state)];case 1:return e.sent(),this.setState(this.getCleanState()),[2]}})})},r.state=r.getCleanState(),r}return n.c(e,t),e.prototype.getCleanState=function(){return{userId:0,teamId:0,type:v.a.Team,permission:v.c.View}},e.prototype.isValid=function(){switch(this.state.type){case v.a.Team:return this.state.teamId>0;case v.a.User:return this.state.userId>0}return!0},e.prototype.render=function(){var t=this.props.onCancel,e=this.state,r=this.isValid();return i.a.createElement("div",{className:"gf-form-inline cta-form"},i.a.createElement("button",{className:"cta-form__close btn btn-transparent",onClick:t},i.a.createElement("i",{className:"fa fa-close"})),i.a.createElement("form",{name:"addPermission",onSubmit:this.onSubmit},i.a.createElement("h5",null,"添加权限"),i.a.createElement("div",{className:"gf-form-inline"},i.a.createElement("div",{className:"gf-form"},i.a.createElement("div",{className:"gf-form-select-wrapper"},i.a.createElement("select",{className:"gf-form-input gf-size-auto",value:e.type,onChange:this.onTypeChanged},v.d.map(function(t,e){return i.a.createElement("option",{key:e,value:t.value},t.text)})))),e.type===v.a.User?i.a.createElement("div",{className:"gf-form"},i.a.createElement(s.a,{onSelected:this.onUserSelected,className:"min-width-20"})):null,e.type===v.a.Team?i.a.createElement("div",{className:"gf-form"},i.a.createElement(m,{onSelected:this.onTeamSelected,className:"min-width-20"})):null,i.a.createElement("div",{className:"gf-form"},i.a.createElement(g.a,{optionsWithDesc:v.e,onSelected:this.onPermissionChanged,disabled:!1,className:"gf-form-select-box__control--menu-right"})),i.a.createElement("div",{className:"gf-form"},i.a.createElement("button",{"data-save-permission":!0,className:"btn btn-success",type:"submit",disabled:!r},"保存")))))},e.defaultProps={showPermissionLevels:!0},e}(a.Component);e.a=b},,,function(t,e,r){"use strict";r.d(e,"b",function(){return n}),r.d(e,"c",function(){return a}),r.d(e,"a",function(){return i});var n=function(t){var e=new RegExp(t.searchQuery,"i");return t.plugins.filter(function(t){return e.test(t.name)||e.test(t.info.author.name)||e.test(t.info.description)})},a=function(t){return t.searchQuery},i=function(t){return t.layoutMode}},,function(t,e){!function(t){function e(t,e){return e*Math.floor(t/e)}function r(t,e,r,n){if("function"==typeof t.strftime)return t.strftime(e);var a,i=function(t,e){return t=""+t,e=""+(null==e?"0":e),1==t.length?e+t:t},s=[],o=!1,l=t.getHours(),c=l<12;null==r&&(r=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]),null==n&&(n=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]),a=l>12?l-12:0==l?12:l;for(var u=0;u<e.length;++u){var d=e.charAt(u);if(o){switch(d){case"a":d=""+n[t.getDay()];break;case"b":d=""+r[t.getMonth()];break;case"d":d=i(t.getDate(),"");break;case"e":d=i(t.getDate()," ");break;case"h":case"H":d=i(l);break;case"I":d=i(a);break;case"l":d=i(a," ");break;case"m":d=i(t.getMonth()+1,"");break;case"M":d=i(t.getMinutes());break;case"q":d=""+(Math.floor(t.getMonth()/3)+1);break;case"S":d=i(t.getSeconds());break;case"y":d=i(t.getFullYear()%100);break;case"Y":d=""+t.getFullYear();break;case"p":d=c?"am":"pm";break;case"P":d=c?"AM":"PM";break;case"w":d=""+t.getDay()}s.push(d),o=!1}else"%"==d?o=!0:s.push(d)}return s.join("")}function n(t){function e(t,e,r,n){t[e]=function(){return r[n].apply(r,arguments)}}var r={date:t};void 0!=t.strftime&&e(r,"strftime",t,"strftime"),e(r,"getTime",t,"getTime"),e(r,"setTime",t,"setTime");for(var n=["Date","Day","FullYear","Hours","Milliseconds","Minutes","Month","Seconds"],a=0;a<n.length;a++)e(r,"get"+n[a],t,"getUTC"+n[a]),e(r,"set"+n[a],t,"setUTC"+n[a]);return r}function a(t,e){if("browser"==e.timezone)return new Date(t);if(e.timezone&&"utc"!=e.timezone){if("undefined"!=typeof timezoneJS&&void 0!==timezoneJS.Date){var r=new timezoneJS.Date;return r.setTimezone(e.timezone),r.setTime(t),r}return n(new Date(t))}return n(new Date(t))}var i={second:1e3,minute:6e4,hour:36e5,day:864e5,month:2592e6,quarter:7776e6,year:525949.2*60*1e3},s=[[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[.25,"month"],[.5,"month"],[1,"month"],[2,"month"]],o=s.concat([[3,"month"],[6,"month"],[1,"year"]]),l=s.concat([[1,"quarter"],[2,"quarter"],[1,"year"]]);t.plot.plugins.push({init:function(n){n.hooks.processOptions.push(function(n,s){t.each(n.getAxes(),function(t,n){var s=n.options;"time"==s.mode&&(n.tickGenerator=function(t){var r=[],n=a(t.min,s),c=0,u=s.tickSize&&"quarter"===s.tickSize[1]||s.minTickSize&&"quarter"===s.minTickSize[1]?l:o;null!=s.minTickSize&&(c="number"==typeof s.tickSize?s.tickSize:s.minTickSize[0]*i[s.minTickSize[1]]);for(var d=0;d<u.length-1&&!(t.delta<(u[d][0]*i[u[d][1]]+u[d+1][0]*i[u[d+1][1]])/2&&u[d][0]*i[u[d][1]]>=c);++d);var p=u[d][0],h=u[d][1];if("year"==h){if(null!=s.minTickSize&&"year"==s.minTickSize[1])p=Math.floor(s.minTickSize[0]);else{var f=Math.pow(10,Math.floor(Math.log(t.delta/i.year)/Math.LN10)),m=t.delta/i.year/f;p=m<1.5?1:m<3?2:m<7.5?5:10,p*=f}p<1&&(p=1)}t.tickSize=s.tickSize||[p,h];var g=t.tickSize[0];h=t.tickSize[1];var v=g*i[h];"second"==h?n.setSeconds(e(n.getSeconds(),g)):"minute"==h?n.setMinutes(e(n.getMinutes(),g)):"hour"==h?n.setHours(e(n.getHours(),g)):"month"==h?n.setMonth(e(n.getMonth(),g)):"quarter"==h?n.setMonth(3*e(n.getMonth()/3,g)):"year"==h&&n.setFullYear(e(n.getFullYear(),g)),n.setMilliseconds(0),v>=i.minute&&n.setSeconds(0),v>=i.hour&&n.setMinutes(0),v>=i.day&&n.setHours(0),v>=4*i.day&&n.setDate(1),v>=2*i.month&&n.setMonth(e(n.getMonth(),3)),v>=2*i.quarter&&n.setMonth(e(n.getMonth(),6)),v>=i.year&&n.setMonth(0);var b,y=0,w=Number.NaN;do{if(b=w,w=n.getTime(),r.push(w),"month"==h||"quarter"==h)if(g<1){n.setDate(1);var x=n.getTime();n.setMonth(n.getMonth()+("quarter"==h?3:1));var S=n.getTime();n.setTime(w+y*i.hour+(S-x)*g),y=n.getHours(),n.setHours(0)}else n.setMonth(n.getMonth()+g*("quarter"==h?3:1));else"year"==h?n.setFullYear(n.getFullYear()+g):n.setTime(w+v)}while(w<t.max&&w!=b);return r},n.tickFormatter=function(t,e){var n=a(t,e.options);if(null!=s.timeformat)return r(n,s.timeformat,s.monthNames,s.dayNames);var o=e.options.tickSize&&"quarter"==e.options.tickSize[1]||e.options.minTickSize&&"quarter"==e.options.minTickSize[1],l=e.tickSize[0]*i[e.tickSize[1]],c=e.max-e.min,u=s.twelveHourClock?" %p":"",d=s.twelveHourClock?"%I":"%H";return r(n,l<i.minute?d+":%M:%S"+u:l<i.day?c<2*i.day?d+":%M"+u:"%b %d "+d+":%M"+u:l<i.month?"%b %d":o&&l<i.quarter||!o&&l<i.year?c<i.year?"%b":"%b %Y":o&&l<i.year?c<i.year?"Q%q":"Q%q %Y":"%Y",s.monthNames,s.dayNames)})})})},options:{xaxis:{timezone:null,timeformat:null,twelveHourClock:!1,monthNames:null}},name:"time",version:"1.0"}),t.plot.formatDate=r}(jQuery)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e){},function(t,e){},function(t,e){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,r){"use strict";r.d(e,"a",function(){return l});var n=r(2),a=r(0),i=r.n(a),s=r(256),o=r(57),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.c(e,t),e.prototype.render=function(){return i.a.createElement("div",{className:"graph-legend-popover"},this.props.yaxis&&i.a.createElement(c,{yaxis:this.props.yaxis,onToggleAxis:this.props.onToggleAxis}),i.a.createElement(s.a,{color:this.props.color,onColorSelect:this.props.onColorChange}))},e}(i.a.PureComponent),c=function(t){function e(e){var r=t.call(this,e)||this;return r.state={yaxis:r.props.yaxis},r.onToggleAxis=r.onToggleAxis.bind(r),r}return n.c(e,t),e.prototype.onToggleAxis=function(){this.setState({yaxis:2===this.state.yaxis?1:2}),this.props.onToggleAxis()},e.prototype.render=function(){var t=1===this.state.yaxis?"btn-success":"btn-inverse",e=2===this.state.yaxis?"btn-success":"btn-inverse";return i.a.createElement("div",{className:"p-b-1"},i.a.createElement("label",{className:"small p-r-1"},"Y Axis:"),i.a.createElement("button",{onClick:this.onToggleAxis,className:"btn btn-small "+t},"Left"),i.a.createElement("button",{onClick:this.onToggleAxis,className:"btn btn-small "+e},"Right"))},e}(i.a.PureComponent);Object(o.a)("seriesColorPickerPopover",l,["series","onColorChange","onToggleAxis"])},,,,function(t,e,r){"use strict";r.d(e,"b",function(){return n}),r.d(e,"a",function(){return a});var n=function(t){return t.searchQuery},a=function(t){var e=new RegExp(t.searchQuery,"i");return t.items.filter(function(t){return e.test(t.name)||e.test(t.stateText)||e.test(t.info)})}},function(t,e,r){"use strict";r.d(e,"b",function(){return n}),r.d(e,"a",function(){return a});var n=function(t){return t.keys.length},a=function(t){var e=RegExp(t.searchQuery,"i");return t.keys.filter(function(t){return e.test(t.name)||e.test(t.role)})}},,,,,,,,function(t,e,r){"use strict";r.d(e,"a",function(){return i}),r.d(e,"b",function(){return s}),r.d(e,"c",function(){return o}),r.d(e,"d",function(){return l});var n=r(2),a=r(168),i={from:"now-6h",to:"now"};function s(t,e,r,i,s){return n.b(this,void 0,void 0,function(){var o,l,c,u,d,p,h,f,m,g,v;return n.d(this,function(b){switch(b.label){case 0:if(o=r,l=e,"mixed"!==r.meta.id||!e)return[3,5];d=0,p=t.targets,b.label=1;case 1:return d<p.length?(h=p[d],[4,i.get(h.datasource)]):[3,4];case 2:if((f=b.sent())&&f.meta.explore)return u=f,[3,4];b.label=3;case 3:return d++,[3,1];case 4:u&&(o=u,l=e.filter(function(t){return t.datasource===u.name})),b.label=5;case 5:return o&&o.meta.explore&&(m=s.timeRangeForUrl(),g=n.a({},o.getExploreState(l),{range:m}),v=JSON.stringify(g),c=Object(a.a)("/explore",{state:v})),[2,c]}})})}function o(t){if(t)try{var e=JSON.parse(decodeURI(t));if(Array.isArray(e)){if(e.length<=3)throw new Error("Error parsing compact URL state for Explore.");var r={from:e[0],to:e[1]};return{datasource:e[2],queries:e.slice(3).map(function(t){return{query:t}}),range:r}}return e}catch(t){console.error(t)}return{datasource:null,queries:[],range:i}}function l(t,e){var r={datasource:t.datasourceName,queries:t.queries.map(function(t){return{query:t.query}}),range:t.range};return e?JSON.stringify([r.range.from,r.range.to,r.datasource].concat(r.queries.map(function(t){return t.query}))):JSON.stringify(r)}},function(t,e){!function(t){t.plot.plugins.push({init:function(e){var r={first:{x:-1,y:-1},second:{x:-1,y:-1},show:!1,active:!1},n={},a=null;function i(t){r.active&&(d(t),e.getPlaceholder().trigger("plotselecting",[o()]))}function s(i){1==i.which&&(document.body.focus(),void 0!==document.onselectstart&&null==n.onselectstart&&(n.onselectstart=document.onselectstart,document.onselectstart=function(){return!1}),void 0!==document.ondrag&&null==n.ondrag&&(n.ondrag=document.ondrag,document.ondrag=function(){return!1}),u(r.first,i),r.active=!0,a=function(t){!function(t){a=null,void 0!==document.onselectstart&&(document.onselectstart=n.onselectstart),void 0!==document.ondrag&&(document.ondrag=n.ondrag),r.active=!1,d(t),f()?l(t):(e.getPlaceholder().trigger("plotunselected",[]),e.getPlaceholder().trigger("plotselecting",[null])),setTimeout(function(){e.isSelecting=!1},10)}(t)},t(document).one("mouseup",a))}function o(){if(!f())return null;if(!r.show)return null;var n={},a=r.first,i=r.second,s=e.getAxes();return t.each(s,function(t,e){e.used&&(anyUsed=!1)}),t.each(s,function(t,e){e.used;var r=e.c2p(a[e.direction]),s=e.c2p(i[e.direction]);n[t]={from:Math.min(r,s),to:Math.max(r,s)}}),n}function l(t){var r=o();r.ctrlKey=t.ctrlKey,r.metaKey=t.metaKey,e.getPlaceholder().trigger("plotselected",[r]),r.xaxis&&r.yaxis&&e.getPlaceholder().trigger("selected",[{x1:r.xaxis.from,y1:r.yaxis.from,x2:r.xaxis.to,y2:r.yaxis.to}])}function c(t,e,r){return e<t?t:e>r?r:e}function u(t,n){var a=e.getOptions(),i=e.getPlaceholder().offset(),s=e.getPlotOffset();t.x=c(0,n.pageX-i.left-s.left,e.width()),t.y=c(0,n.pageY-i.top-s.top,e.height()),"y"==a.selection.mode&&(t.x=t==r.first?0:e.width()),"x"==a.selection.mode&&(t.y=t==r.first?0:e.height())}function d(t){null!=t.pageX&&(u(r.second,t),f()?(e.isSelecting=!0,r.show=!0,e.triggerRedrawOverlay()):p(!0))}function p(t){r.show&&(r.show=!1,e.triggerRedrawOverlay(),t||e.getPlaceholder().trigger("plotunselected",[]))}function h(t,r){var n,a,i,s,o=e.getAxes();for(var l in o)if((n=o[l]).direction==r&&(t[s=r+n.n+"axis"]||1!=n.n||(s=r+"axis"),t[s])){a=t[s].from,i=t[s].to;break}if(t[s]||(n="x"==r?e.getXAxes()[0]:e.getYAxes()[0],a=t[r+"1"],i=t[r+"2"]),null!=a&&null!=i&&a>i){var c=a;a=i,i=c}return{from:a,to:i,axis:n}}function f(){var t=e.getOptions().selection.minSize;return Math.abs(r.second.x-r.first.x)>=t&&Math.abs(r.second.y-r.first.y)>=t}e.clearSelection=p,e.setSelection=function(t,n){var a,i=e.getOptions();"y"==i.selection.mode?(r.first.x=0,r.second.x=e.width()):(a=h(t,"x"),r.first.x=a.axis.p2c(a.from),r.second.x=a.axis.p2c(a.to)),"x"==i.selection.mode?(r.first.y=0,r.second.y=e.height()):(a=h(t,"y"),r.first.y=a.axis.p2c(a.from),r.second.y=a.axis.p2c(a.to)),r.show=!0,e.triggerRedrawOverlay(),!n&&f()&&l()},e.getSelection=o,e.hooks.bindEvents.push(function(t,e){null!=t.getOptions().selection.mode&&(e.mousemove(i),e.mousedown(s))}),e.hooks.drawOverlay.push(function(e,n){if(r.show&&f()){var a=e.getPlotOffset(),i=e.getOptions();n.save(),n.translate(a.left,a.top);var s=t.color.parse(i.selection.color);n.strokeStyle=s.scale("a",.8).toString(),n.lineWidth=1,n.lineJoin=i.selection.shape,n.fillStyle=s.scale("a",.4).toString();var o=Math.min(r.first.x,r.second.x)+.5,l=Math.min(r.first.y,r.second.y)+.5,c=Math.abs(r.second.x-r.first.x)-1,u=Math.abs(r.second.y-r.first.y)-1;n.fillRect(o,l,c,u),n.strokeRect(o,l,c,u),n.restore()}}),e.hooks.shutdown.push(function(e,r){r.unbind("mousemove",i),r.unbind("mousedown",s),a&&t(document).unbind("mouseup",a)})},options:{selection:{mode:null,color:"#e8cfac",shape:"round",minSize:5}},name:"selection",version:"1.1"})}(jQuery)},function(t,e){!function(t){jQuery.plot.plugins.push({init:function(t){t.hooks.processDatapoints.push(function(t,e,r){if(null!=e.stack&&!1!==e.stack){var n=function(t,e){for(var r=null,n=0;n<e.length&&t!=e[n];++n)e[n].stack==t.stack&&(r=e[n]);return r}(e,t.getData());if(n){for(var a,i,s,o,l,c,u,d,p=r.pointsize,h=r.points,f=n.datapoints.pointsize,m=n.datapoints.points,g=[],v=e.lines.show,b=e.bars.horizontal,y=p>2&&(b?r.format[2].x:r.format[2].y),w=v&&e.lines.steps,x=b?1:0,S=b?0:1,k=0,C=0;!(k>=h.length&&C>=m.length);){if(u=g.length,k<h.length&&null==h[k]){for(d=0;d<p;++d)g.push(h[k+d]);k+=p}else if(k>=h.length){for(d=0;d<p;++d)g.push(m[C+d]);y&&(g[u+2]=m[C+S]),C+=f}else if(C>=m.length){for(d=0;d<p;++d)g.push(h[k+d]);k+=p}else if(C<m.length&&null==m[C])C+=f;else{if(a=h[k+x],i=h[k+S],o=m[C+x],l=m[C+S],c=0,a==o){for(d=0;d<p;++d)g.push(h[k+d]);g[u+S]+=l,c=l,k+=p,C+=f}else if(a>o){if(0==k){for(d=0;d<p;++d)g.push(m[C+d]);c=l}if(k>0&&null!=h[k-p]){for(s=i+(h[k-p+S]-i)*(o-a)/(h[k-p+x]-a),g.push(o),g.push(s+l),d=2;d<p;++d)g.push(h[k+d]);c=l}C+=f}else{for(d=0;d<p;++d)g.push(h[k+d]);C>0&&null!=m[C-f]&&(c=l+(m[C-f+S]-l)*(a-o)/(m[C-f+x]-o)),g[u+S]+=c,k+=p}fromgap=!1,u!=g.length&&y&&(g[u+2]=c)}if(w&&u!=g.length&&u>0&&null!=g[u]&&g[u]!=g[u-p]&&g[u+1]!=g[u-p+1]){for(d=0;d<p;++d)g[u+p+d]=g[u+d];g[u+1]=g[u-p+1]}}r.points=g}}})},options:{series:{stack:null}},name:"stack",version:"1.2"})}()},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e){},function(t,e){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e){!function(t){jQuery.plot.plugins.push({init:function(t){var e={},r=!1,n={};function a(t){var e=t.length,r={};if(e>0)for(var n=0;n<e;n++)if(t[n].stackpercent){var a=0,i=1;t[n].bars&&t[n].bars.horizontal&&!0===t[n].bars.horizontal&&(a=1,i=0);for(var s=t[n].data.length,o=0;o<s;o++){var l=0;null!=t[n].data[o][1]&&(l=t[n].data[o][i]),r[t[n].data[o][a]+""]?r[t[n].data[o][a]+""]+=l:r[t[n].data[o][a]+""]=l}}return r}t.hooks.processRawData.push(function(t,e,i,s){if(r||(r=!0,n=a(t.getData())),1==e.stackpercent){var o=i.length;e.percents=[];var l=0,c=1;e.bars&&e.bars.horizontal&&!0===e.bars.horizontal&&(l=1,c=0);for(var u=0;u<o;u++){var d=n[i[u][l]+""];d>0?e.percents.push(100*i[u][c]/d):e.percents.push(0)}}}),t.hooks.processDatapoints.push(function(t,i,s){if(i.stackpercent){r||(n=a(t.getData()));var o=[],l=0,c=1;i.bars&&i.bars.horizontal&&!0===i.bars.horizontal&&(l=1,c=0);for(var u=0;u<s.points.length;u+=3)e[s.points[u+l]]||(e[s.points[u+l]]=0),o[u+l]=s.points[u+l],o[u+c]=s.points[u+c]+e[s.points[u+l]],o[u+2]=e[s.points[u+l]],e[s.points[u+l]]+=s.points[u+c],n[o[u+l]+""]>0?(o[u+c]=100*o[u+c]/n[o[u+l]+""],o[u+2]=100*o[u+2]/n[o[u+l]+""]):(o[u+c]=0,o[u+2]=0);s.points=o}})},options:{series:{stackpercent:null}},name:"stackpercent",version:"0.1"})}()},function(t,e){!function(t){"use strict";t.plot.plugins.push({init:function(e){function r(t,e,r,n,a,i,s,o){var l,c,u,d,p,h;return h=((u=s-a)*(e-i)-(d=o-i)*(t-a))/(-u*(c=n-e)+(l=r-t)*d),(p=(-c*(t-a)+l*(e-i))/(-u*c+l*d))>=0&&p<=1&&h>=0&&h<=1?[t+h*l,e+h*c]:null}e.hooks.drawSeries.push(function(e,n,a){var i,s,o,l,c,u,d;function p(t,e){n.beginPath(),n.moveTo(a.xaxis.p2c(t)+u.left,a.yaxis.p2c(e)+u.top)}function h(t,e){console.assert(e>t,"expects the end index to be greater than the start index");var r,n,a=0===t||null===o[t-1]||null===c[t-1],i=!1;for(r=t;r<e;r++)if(null===o[r*s+1]||null===c[r*s+1])i=!1,a=!0;else if(o[r*s+1]===c[r*l+1])i=!0,a=!1;else{if(o[r*s+1]>c[r*l+1])return a?p(o[r*s],o[r*s+1]):i?p(o[(r-1)*s],o[(r-1)*s+1]):p((n=f(r))[0],n[1]),void g(r,e);a=!1,i=!1}}function f(t){var e,n;for(console.assert(t>0,"expects the second point in the series line segment"),e=1;e<c.length/l;e++)if(null!==(n=r(o[(t-1)*s],o[(t-1)*s+1],o[t*s],o[t*s+1],c[(e-1)*l],c[(e-1)*l+1],c[e*l],c[e*l+1])))return n;console.error("intersectionPoint() should only be called when an intersection happens")}function m(t,e){var r;for(console.assert(t>=e,"the start should be the rightmost point, and the end should be the leftmost (excluding the equal or intersecting point)"),r=t;r>=e;r--)n.lineTo(i.xaxis.p2c(c[r*l])+u.left,i.yaxis.p2c(c[r*l+1])+u.top);n.closePath(),n.fill()}function g(t,e){var r,i;for(console.assert(t<=e,"the start should be the rightmost point, and the end should be the leftmost (excluding the equal or intersecting point)"),r=t;r<e;r++){if(null===o[r*s+1]&&r>t)return m(r-1,t),void h(r,e);if(o[r*s+1]===c[r*l+1])return m(r,t),void h(r,e);if(o[r*s+1]<c[r*l+1])return i=f(r),n.lineTo(a.xaxis.p2c(i[0])+u.left,a.yaxis.p2c(i[1])+u.top),m(r,t),void h(r,e);n.lineTo(a.xaxis.p2c(o[r*s])+u.left,a.yaxis.p2c(o[r*s+1])+u.top)}m(e,t)}null!==a.fillBelowTo&&(i=function(t,e){var r;for(r=0;r<e.length;++r)if(e[r].id===t.fillBelowTo)return e[r];return null}(a,e.getData()))&&(s=a.datapoints.pointsize,o=a.datapoints.points,l=i.datapoints.pointsize,c=i.datapoints.points,u=e.getPlotOffset(),function(){if(o.length/s!=c.length/l)return console.error("Refusing to graph inconsistent number of points"),!1;var t;for(t=0;t<o.length/s;t++)if(null!==o[t*s]&&null!==c[t*l]&&o[t*s]!==c[t*l])return console.error("Refusing to graph points without matching value"),!1;return!0}()&&((d=t.color.parse(a.color)).a=.4,d.normalize(),n.fillStyle=d.toString(),h(0,o.length/s)))})},options:{series:{fillBelowTo:null}},name:"fillbelow",version:"0.1.0"})}(jQuery)},function(t,e){!function(t){jQuery.plot.plugins.push({init:function(t){var e={x:-1,y:-1,locked:!1};function r(r){e.locked||-1!=e.x&&(e.x=-1,t.triggerRedrawOverlay())}function n(r){if(!e.locked)if(t.getSelection&&t.getSelection())e.x=-1;else{var n=t.offset();e.x=Math.max(0,Math.min(r.pageX-n.left,t.width())),e.y=Math.max(0,Math.min(r.pageY-n.top,t.height())),t.triggerRedrawOverlay()}}t.setCrosshair=function(r){if(r){var n=t.p2c(r);e.x=Math.max(0,Math.min(n.left,t.width())),e.y=Math.max(0,Math.min(n.top,t.height()))}else e.x=-1;t.triggerRedrawOverlay()},t.clearCrosshair=t.setCrosshair,t.lockCrosshair=function(r){r&&t.setCrosshair(r),e.locked=!0},t.unlockCrosshair=function(){e.locked=!1},t.hooks.bindEvents.push(function(t,e){t.getOptions().crosshair.mode&&(e.mouseout(r),e.mousemove(n))}),t.hooks.drawOverlay.push(function(t,r){var n=t.getOptions().crosshair;if(n.mode){var a=t.getPlotOffset();if(r.save(),r.translate(a.left,a.top),-1!=e.x){var i=t.getOptions().crosshair.lineWidth%2?.5:0;if(r.strokeStyle=n.color,r.lineWidth=n.lineWidth,r.lineJoin="round",r.beginPath(),-1!=n.mode.indexOf("x")){var s=Math.floor(e.x)+i;r.moveTo(s,0),r.lineTo(s,t.height())}if(-1!=n.mode.indexOf("y")){var o=Math.floor(e.y)+i;r.moveTo(0,o),r.lineTo(t.width(),o)}r.stroke()}r.restore()}}),t.hooks.shutdown.push(function(t,e){e.unbind("mouseout",r),e.unbind("mousemove",n)})},options:{crosshair:{mode:null,color:"rgba(170, 0, 0, 0.80)",lineWidth:1}},name:"crosshair",version:"1.0"})}()},function(t,e){!function(t){jQuery.plot.plugins.push({init:function(t){t.hooks.processDatapoints.push(function(t,e,r){e.dashes.show&&t.hooks.draw.push(function(t,n){var a=t.getPlotOffset(),i=e.xaxis,s=e.yaxis;function o(t,a){var o,l,c=r.points,u=r.pointsize,d=null,p=null,h=0,f=!0;e.dashes.dashLength[0]?(o=e.dashes.dashLength[0],l=e.dashes.dashLength[1]?e.dashes.dashLength[1]:o):l=o=e.dashes.dashLength,n.beginPath();for(var m=u;m<c.length;m+=u){var g=c[m-u],v=c[m-u+1],b=c[m],y=c[m+1];if(null!=g&&null!=b){if(v<=y&&v<s.min){if(y<s.min)continue;g=(s.min-v)/(y-v)*(b-g)+g,v=s.min}else if(y<=v&&y<s.min){if(v<s.min)continue;b=(s.min-v)/(y-v)*(b-g)+g,y=s.min}if(v>=y&&v>s.max){if(y>s.max)continue;g=(s.max-v)/(y-v)*(b-g)+g,v=s.max}else if(y>=v&&y>s.max){if(v>s.max)continue;b=(s.max-v)/(y-v)*(b-g)+g,y=s.max}if(g<=b&&g<i.min){if(b<i.min)continue;v=(i.min-g)/(b-g)*(y-v)+v,g=i.min}else if(b<=g&&b<i.min){if(g<i.min)continue;y=(i.min-g)/(b-g)*(y-v)+v,b=i.min}if(g>=b&&g>i.max){if(b>i.max)continue;v=(i.max-g)/(b-g)*(y-v)+v,g=i.max}else if(b>=g&&b>i.max){if(g>i.max)continue;y=(i.max-g)/(b-g)*(y-v)+v,b=i.max}g==d&&v==p||n.moveTo(i.p2c(g)+t,s.p2c(v)+a);var w,x=i.p2c(g)+t,S=s.p2c(v)+a,k=i.p2c(b)+t,C=s.p2c(y)+a;do{0==(w=T(h>0?h:f?o:l)).deltaX&&0==w.deltaY||(f?n.lineTo(x+w.deltaX,S+w.deltaY):n.moveTo(x+w.deltaX,S+w.deltaY)),f=!f,h=w.remainder,x+=w.deltaX,S+=w.deltaY}while(w.distance>0);d=b,p=y}function T(t){var e=Math.sqrt(Math.pow(k-x,2)+Math.pow(C-S,2));if(e<=t)return{deltaX:k-x,deltaY:C-S,distance:e,remainder:t-e};var r=C>S?1:-1;return{deltaX:(k>x?1:-1)*Math.sqrt(Math.pow(t,2)/(1+Math.pow((C-S)/(k-x),2))),deltaY:r*Math.sqrt(Math.pow(t,2)-Math.pow(t,2)/(1+Math.pow((C-S)/(k-x),2))),distance:t,remainder:0}}}n.stroke()}n.save(),n.translate(a.left,a.top),n.lineJoin="round";var l=e.dashes.lineWidth,c=e.shadowSize;if(l>0&&c>0){n.lineWidth=c,n.strokeStyle="rgba(0,0,0,0.1)";var u=Math.PI/18;o(Math.sin(u)*(l/2+c/2),Math.cos(u)*(l/2+c/2)),n.lineWidth=c/2,o(Math.sin(u)*(l/2+c/4),Math.cos(u)*(l/2+c/4))}n.lineWidth=l,n.strokeStyle=e.color,l>0&&o(0,0),n.restore()})})},options:{series:{dashes:{show:!1,lineWidth:2,dashLength:10}}},name:"dashes",version:"0.1"})}()},,function(t,e){
/*!
 * jquery.flot.gauge v1.1.0 *
 *
 * Flot plugin for rendering gauge charts.
 *
 * Copyright (c) 2015 @toyoty99.
 * Licensed under the MIT license.
 */
!function(t){var e=function(){var e,i,s,o,l,c=function(t,n){e=n,i=t.getPlaceholder(),s=t.getOptions(),o=s.series.gauges,l=t.getData(),r(o.debug)};function u(t,e){"auto"===t.gauge.width&&(t.gauge.width=Math.max(5,e/8)),"auto"===t.label.margin&&(t.label.margin=Math.max(1,e/20)),"auto"===t.label.font.size&&(t.label.font.size=Math.max(5,e/8)),"auto"===t.value.margin&&(t.value.margin=Math.max(1,e/30)),"auto"===t.value.font.size&&(t.value.font.size=Math.max(5,e/9)),"auto"===t.threshold.width&&(t.threshold.width=Math.max(3,e/100)),"auto"===t.threshold.label.margin&&(t.threshold.label.margin=Math.max(3,e/40)),"auto"===t.threshold.label.font.size&&(t.threshold.label.font.size=Math.max(5,e/15))}function d(t,e,r){var n=t.gauge.startAngle+(t.gauge.endAngle-t.gauge.startAngle)*((r-t.gauge.min)/(t.gauge.max-t.gauge.min));return n<t.gauge.startAngle?n=t.gauge.startAngle:n>t.gauge.endAngle&&(n=t.gauge.endAngle),n}function p(t,r,n,i,s,o,l,c,u,d){s!==o&&(e.save(),a(e,t,r,n,i,s,o,l,c,u),d&&(a(e,t,r,n,i,s,o),e.clip(),e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=10,e.shadowColor="gray",a(e,t,r,n+1,i+2,s,o,l,1)),e.restore())}function h(t,e,r,a,i,s){f(r.cx+(e.thresholdLabelMargin+e.thresholdLabelFontSize/2+e.radius)*Math.cos(n(s)),r.cy+(e.thresholdLabelMargin+e.thresholdLabelFontSize/2+e.radius)*Math.sin(n(s)),"flotGagueThresholdValue"+a,t.threshold.label.formatter?t.threshold.label.formatter(i):i,t.threshold.label,s)}function f(e,r,n,a,s,o){var l=t(i).find("#"+n),c=l.length;c||((l=t("<span></span>")).attr("id",n),i.append(l)),l.css("position","absolute"),l.css("top",r+"px"),s.font.size&&l.css("font-size",s.font.size+"px"),s.font.family&&l.css("font-family",s.font.family),s.color&&l.css("color",s.color),s.background.color&&l.css("background-color",s.background.color),s.background.opacity&&l.css("opacity",s.background.opacity),l.text(a),l.css("left",e+"px"),l.css("left",parseInt(l.css("left"))-l.width()/2+"px"),!c&&o&&(l.css("top",parseInt(l.css("top"))-l.height()/2+"px"),l.css("transform","rotate("+(180*o+90)+"deg)"))}return c.prototype.calculateLayout=function(){var t=i.width(),e=i.height(),r=Math.min(l.length,o.layout.columns),a=Math.ceil(l.length/r),s=o.layout.margin,c=o.layout.hMargin,d=o.layout.vMargin,p=(t-2*s-c*(r-1))/r,h=(e-2*s-d*(a-1))/a;if(o.layout.square){var f=Math.min(p,h);p=f,h=f}u(o,p);var m=o.cell.margin,g=0,v=0;o.label.show&&(g=o.label.margin,v=o.label.font.size);var b=0,y=0;o.value.show&&(b=o.value.margin,y=o.value.font.size);var w=0;o.threshold.show&&(w=o.threshold.width);var x=0,S=0;o.threshold.label.show&&(x=o.threshold.label.margin,S=o.threshold.label.font.size);for(var k=p/2-m-w-2*x-S,C=o.gauge.startAngle,T=o.gauge.endAngle,E=(T-C)/100,_=-1,M=C;M<T;M+=E)_=Math.max(_,Math.sin(n(M)));var A=(h-2*m-2*g-v)/(1+(_=Math.max(_,Math.sin(n(T)))));A*_<b+y/2&&(A=h-2*m-2*g-v-b-y/2);var P=A-2*x-S-w,$=Math.min(k,P),D=o.gauge.width;D>=$&&(D=Math.max(3,$/3));var O=2*x+S+w+$;return{canvasWidth:t,canvasHeight:e,margin:s,hMargin:c,vMargin:d,columns:r,rows:a,cellWidth:p,cellHeight:h,cellMargin:m,labelMargin:g,labelFontSize:v,valueMargin:b,valueFontSize:y,width:D,radius:$,thresholdWidth:w,thresholdLabelMargin:x,thresholdLabelFontSize:S,gaugeOuterHeight:Math.max(O*(1+_),O+b+y/2)}},c.prototype.calculateAutoValues=u,c.prototype.calculateCellLayout=function(t,e,r){var n=function(t,e){return e%t}(e.columns,r),a=function(t,e){return Math.floor(e/t)}(e.columns,r),i=e.margin+(e.cellWidth+e.hMargin)*n,s=e.margin+(e.cellHeight+e.vMargin)*a,o=i+e.cellWidth/2,l=s+e.cellMargin+2*e.labelMargin+e.labelFontSize+e.thresholdWidth+e.thresholdLabelFontSize+2*e.thresholdLabelMargin+e.radius,c=e.cellHeight-2*e.cellMargin-2*e.labelMargin-e.labelFontSize-e.gaugeOuterHeight,u=0;return"middle"===t.cell.vAlign?u=c/2:"bottom"===t.cell.vAlign&&(u=c),l+=u,{col:n,row:a,x:i,y:s,offsetY:u,cellWidth:e.cellWidth,cellHeight:e.cellHeight,cellMargin:e.cellMargin,cx:o,cy:l}},c.prototype.drawBackground=function(t){o.frame.show&&(e.save(),e.strokeStyle=s.grid.borderColor,e.lineWidth=s.grid.borderWidth,e.strokeRect(0,0,t.canvasWidth,t.canvasHeight),s.grid.backgroundColor&&(e.fillStyle=s.grid.backgroundColor,e.fillRect(0,0,t.canvasWidth,t.canvasHeight)),e.restore())},c.prototype.drawCellBackground=function(t,r){e.save(),t.cell.border&&t.cell.border.show&&t.cell.border.color&&t.cell.border.width&&(e.strokeStyle=t.cell.border.color,e.lineWidth=t.cell.border.width,e.strokeRect(r.x,r.y,r.cellWidth,r.cellHeight)),t.cell.background&&t.cell.background.color&&(e.fillStyle=t.cell.background.color,e.fillRect(r.x,r.y,r.cellWidth,r.cellHeight)),e.restore()},c.prototype.drawGauge=function(t,e,r,a,i){var s=t.gauge.shadow.show?t.gauge.shadow.blur:0;p(r.cx,r.cy,e.radius,e.width,n(t.gauge.startAngle),n(t.gauge.endAngle),t.gauge.border.color,t.gauge.border.width,t.gauge.background.color,s);var o=function(t,e){for(var r,n=0;n<t.threshold.values.length;n++){var a=t.threshold.values[n];if(r=a.color,e<a.value)break}return r}(t,i),l=d(t,e,i);p(r.cx,r.cy,e.radius-1,e.width-2,n(t.gauge.startAngle),n(l),o,1,o,s)},c.prototype.drawThreshold=function(t,r,i){for(var s=t.gauge.startAngle,o=0;o<t.threshold.values.length;o++){var l=t.threshold.values[o];c1=l.color,a2=d(t,0,l.value),a(e,i.cx,i.cy,r.radius+r.thresholdWidth,r.thresholdWidth-2,n(s),n(a2),c1,1,c1),s=a2}},c.prototype.drawLable=function(t,e,r,n,a){f(r.cx,r.y+r.cellMargin+e.labelMargin+r.offsetY,"flotGagueLabel"+n,t.label.formatter?t.label.formatter(a.label,a.data[0][1]):text,t.label)},c.prototype.drawValue=function(t,e,r,n,a){f(r.cx,r.cy-t.value.font.size/2,"flotGagueValue"+n,t.value.formatter?t.value.formatter(a.label,a.data[0][1]):text,t.value)},c.prototype.drawThresholdValues=function(t,e,r,n){h(t,e,r,"Min"+n,t.gauge.min,t.gauge.startAngle),h(t,e,r,"Max"+n,t.gauge.max,t.gauge.endAngle);for(var a=0;a<t.threshold.values.length;a++){var i=t.threshold.values[a];if(i.value>t.gauge.min&&i.value<t.gauge.max){var s=d(t,0,i.value);h(t,e,r,n+"_"+a,i.value,s)}}},c}();function r(t){return"undefined"!=typeof Logger?new Logger(t):null}function n(t){return t*Math.PI}function a(t,e,r,n,a,i,s,o,l,c){if(i!==s){t.save(),t.beginPath(),t.arc(e,r,n,i,s,!1),t.lineTo(e+(n-a)*Math.cos(s),r+(n-a)*Math.sin(s)),t.arc(e,r,n-a,s,i,!0),t.closePath(),l&&(t.lineWidth=l),o&&(t.strokeStyle=o,t.stroke()),c&&(t.fillStyle=c,t.fill()),t.restore()}}var i={series:{gauges:{debug:{log:!1,layout:!1,alert:!1},show:!1,layout:{margin:5,columns:3,hMargin:5,vMargin:5,square:!1},frame:{show:!0},cell:{background:{color:null},border:{show:!0,color:"black",width:1},margin:5,vAlign:"middle"},gauge:{width:"auto",startAngle:.9,endAngle:2.1,min:0,max:100,background:{color:"white"},border:{color:"lightgray",width:2},shadow:{show:!0,blur:5}},label:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:"sans-serif"},color:null,formatter:function(t,e){return t}},value:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:"sans-serif"},color:null,formatter:function(t,e){return parseInt(e)}},threshold:{show:!0,width:"auto",label:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:",sans-serif"},color:null,formatter:function(t){return t}},values:[{value:50,color:"lightgreen"},{value:80,color:"yellow"},{value:100,color:"red"}]}}}};t.plot.plugins.push({init:function(n){n.hooks.processOptions.push(function(t,e){r(e.series.gauges.debug),e.series.gauges.show&&(e.grid.show=!1,e.legend.show=!1),e.series.gauges.threshold.values.sort(function(t,e){return t.value<e.value?-1:t.value>e.value?1:0})}),n.hooks.draw.push(function(n,a){var i=n.getOptions().series.gauges;if(r(i.debug),i.show){var s=n.getData();if(s&&s.length){var o=new e(n,a),l=o.calculateLayout();i.debug.layout,o.drawBackground(l);for(var c=0;c<s.length;c++){var u=s[c],d=t.extend({},i,u.gauges);u.gauges&&o.calculateAutoValues(d,l.cellWidth);var p=o.calculateCellLayout(d,l,c);o.drawCellBackground(d,p),d.debug.layout,d.label.show&&o.drawLable(d,l,p,c,u),o.drawGauge(d,l,p,u.label,u.data[0][1]),d.threshold.show&&o.drawThreshold(d,l,p),d.threshold.label.show&&o.drawThresholdValues(d,l,p,c),d.value.show&&o.drawValue(d,l,p,c,u)}}}})},options:i,name:"gauge",version:"1.1.0"})}(jQuery)},,,,,,,,,,,,,,,,function(t,e,r){"use strict";(function(t){var n=r(2),a=r(0),i=r.n(a),s=r(35),o=r(21),l=r(34),c=r(601),u=r(32),d=function(t){function e(e){var r=t.call(this,e)||this;return r.state={stats:[]},r}return n.c(e,t),e.prototype.componentDidMount=function(){return n.b(this,void 0,void 0,function(){var t,e;return n.d(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.props.getServerStats()];case 1:return t=r.sent(),this.setState({stats:t}),[3,3];case 2:return e=r.sent(),console.error(e),[3,3];case 3:return[2]}})})},e.prototype.render=function(){var t=this.props.navModel,e=this.state.stats;return i.a.createElement("div",null,i.a.createElement(u.a,{model:t}),i.a.createElement("div",{className:"page-container page-body"},i.a.createElement("table",{className:"filter-table form-inline"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,"名称"),i.a.createElement("th",null,"值"))),i.a.createElement("tbody",null,e.map(p)))))},e}(a.PureComponent);function p(t){return i.a.createElement("tr",{key:t.name},i.a.createElement("td",null,t.name),i.a.createElement("td",null,t.value))}e.a=Object(s.hot)(t)(Object(o.b)(function(t){return{navModel:Object(l.a)(t.navIndex,"server-stats"),getServerStats:c.a}})(d))}).call(this,r(66)(t))},function(t,e,r){"use strict";r.d(e,"a",function(){return i});var n=r(2),a=r(15),i=function(){return n.b(void 0,void 0,Promise,function(){var t,e;return n.d(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Object(a.a)().get("api/admin/stats")];case 1:return[2,[{name:"用户总数",value:(t=r.sent()).users},{name:"仪表盘总数",value:t.dashboards},{name:"活跃用户 (30天之内有过活动)",value:t.activeUsers},{name:"组织总数",value:t.orgs},{name:"播放列表总数",value:t.playlists},{name:"快照总数",value:t.snapshots},{name:"仪表盘标签总数",value:t.tags},{name:"标星仪表盘总数",value:t.stars},{name:"报警总数",value:t.alerts}]];case 2:throw e=r.sent(),console.error(e),e;case 3:return[2]}})})}},function(t,e,r){"use strict";(function(t){var n=r(2),a=r(0),i=r.n(a),s=r(35),o=r(21),l=r(32),c=r(603),u=r(9),d=r(44),p=r(34),h=r(143),f=r(344),m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.stateFilters=[{text:"所有",value:"all"},{text:"是",value:"ok"},{text:"否",value:"not_ok"},{text:"报警",value:"alerting"},{text:"无数据",value:"no_data"},{text:"已暂停",value:"paused"},{text:"挂起",value:"pending"}],e.onStateFilterChanged=function(t){e.props.updateLocation({query:{state:t.target.value}})},e.onOpenHowTo=function(){u.a.emit("show-modal",{src:"public/app/features/alerting/partials/alert_howto.html",modalClass:"confirm-modal",model:{}})},e.onSearchQueryChange=function(t){var r=t.target.value;e.props.setSearchQuery(r)},e.onTogglePause=function(t){e.props.togglePauseAlertRule(t.id,{paused:"paused"!==t.state})},e.alertStateFilterOption=function(t){var e=t.text,r=t.value;return i.a.createElement("option",{key:r,value:r},e)},e}return n.c(e,t),e.prototype.componentDidMount=function(){this.fetchRules()},e.prototype.componentDidUpdate=function(t){t.stateFilter!==this.props.stateFilter&&this.fetchRules()},e.prototype.fetchRules=function(){return n.b(this,void 0,void 0,function(){return n.d(this,function(t){switch(t.label){case 0:return[4,this.props.getAlertRulesAsync({state:this.getStateFilter()})];case 1:return t.sent(),[2]}})})},e.prototype.getStateFilter=function(){var t=this.props.stateFilter;return t?t.toString():"all"},e.prototype.render=function(){var t=this,e=this.props,r=e.navModel,n=e.alertRules,a=e.search;return i.a.createElement("div",null,i.a.createElement(l.a,{model:r}),i.a.createElement("div",{className:"page-container page-body"},i.a.createElement("div",{className:"page-action-bar"},i.a.createElement("div",{className:"gf-form gf-form--grow"},i.a.createElement("label",{className:"gf-form--has-input-icon gf-form--grow"},i.a.createElement("input",{type:"text",className:"gf-form-input",placeholder:"搜索报警",value:a,onChange:this.onSearchQueryChange}),i.a.createElement("i",{className:"gf-form-input-icon fa fa-search"}))),i.a.createElement("div",{className:"gf-form"},i.a.createElement("label",{className:"gf-form-label"},"状态"),i.a.createElement("div",{className:"gf-form-select-wrapper width-13"},i.a.createElement("select",{className:"gf-form-input",onChange:this.onStateFilterChanged,value:this.getStateFilter()},this.stateFilters.map(this.alertStateFilterOption)))),i.a.createElement("div",{className:"page-action-bar__spacer"}),i.a.createElement("a",{className:"btn btn-secondary",onClick:this.onOpenHowTo},i.a.createElement("i",{className:"fa fa-info-circle"})," 如何添加一个报警")),i.a.createElement("section",null,i.a.createElement("ol",{className:"alert-rule-list"},n.map(function(e){return i.a.createElement(c.a,{rule:e,key:e.id,search:a,onTogglePause:function(){return t.onTogglePause(e)}})})))))},e}(a.PureComponent),g={updateLocation:d.c,getAlertRulesAsync:h.b,setSearchQuery:h.c,togglePauseAlertRule:h.d};e.a=Object(s.hot)(t)(Object(o.b)(function(t){return{navModel:Object(p.a)(t.navIndex,"alert-list"),alertRules:Object(f.a)(t.alertRules),stateFilter:t.location.query.state,search:Object(f.b)(t.alertRules)}},g)(m))}).call(this,r(66)(t))},function(t,e,r){"use strict";var n=r(2),a=r(0),i=r.n(a),s=r(166),o=r.n(s),l=r(104),c=r.n(l),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.c(e,t),e.prototype.renderText=function(t){return i.a.createElement(o.a,{highlightClassName:"highlight-search-match",textToHighlight:t,searchWords:[this.props.search]})},e.prototype.render=function(){var t=this.props,e=t.rule,r=t.onTogglePause,n=c()({fa:!0,"fa-play":"paused"===e.state,"fa-pause":"paused"!==e.state}),a=e.url+"?panelId="+e.panelId+"&fullscreen=true&edit=true&tab=alert";return i.a.createElement("li",{className:"alert-rule-item"},i.a.createElement("span",{className:"alert-rule-item__icon "+e.stateClass},i.a.createElement("i",{className:e.stateIcon})),i.a.createElement("div",{className:"alert-rule-item__body"},i.a.createElement("div",{className:"alert-rule-item__header"},i.a.createElement("div",{className:"alert-rule-item__name"},i.a.createElement("a",{href:a},this.renderText(e.name))),i.a.createElement("div",{className:"alert-rule-item__text"},i.a.createElement("span",{className:""+e.stateClass},this.renderText(e.stateText)),i.a.createElement("span",{className:"alert-rule-item__time"}," for ",e.stateAge))),e.info&&i.a.createElement("div",{className:"small muted alert-rule-item__info"},this.renderText(e.info))),i.a.createElement("div",{className:"alert-rule-item__actions"},i.a.createElement("button",{className:"btn btn-small btn-inverse alert-list__btn width-2",title:"Pausing an alert rule prevents it from executing",onClick:r},i.a.createElement("i",{className:n})),i.a.createElement("a",{className:"btn btn-small btn-inverse alert-list__btn width-2",href:a,title:"Edit alert rule"},i.a.createElement("i",{className:"icon-gf icon-gf-settings"}))))},e}(a.PureComponent);e.a=u},function(t,e,r){"use strict";(function(t){var n,a=r(2),i=r(0),s=r.n(i),o=r(21),l=r(1),c=r.n(l),u=r(35),d=r(8),p=r(32),h=r(605),f=r(606),m=r(607),g=r(38),v=r(74),b=r(243),y=r(34),w=r(141);!function(t){t.Members="members",t.Settings="settings",t.GroupSync="groupsync"}(n||(n={}));var x=function(t){function e(e){var r=t.call(this,e)||this;return r.state={isSyncEnabled:d.a.buildInfo.isEnterprise},r}return a.c(e,t),e.prototype.componentDidMount=function(){return a.b(this,void 0,void 0,function(){return a.d(this,function(t){switch(t.label){case 0:return[4,this.fetchTeam()];case 1:return t.sent(),[2]}})})},e.prototype.fetchTeam=function(){return a.b(this,void 0,void 0,function(){var t,e,r;return a.d(this,function(n){switch(n.label){case 0:return t=this.props,e=t.loadTeam,r=t.teamId,[4,e(r)];case 1:return[2,n.sent()]}})})},e.prototype.getCurrentPage=function(){var t=["members","settings","groupsync"],e=this.props.pageName;return c.a.includes(t,e)?e:t[0]},e.prototype.renderPage=function(){var t=this.state.isSyncEnabled;switch(this.getCurrentPage()){case n.Members:return s.a.createElement(h.a,{syncEnabled:t});case n.Settings:return s.a.createElement(f.a,null);case n.GroupSync:return t&&s.a.createElement(m.a,null)}return null},e.prototype.render=function(){var t=this.props,e=t.team,r=t.navModel;return s.a.createElement("div",null,s.a.createElement(p.a,{model:r}),e&&0!==Object.keys(e).length&&s.a.createElement("div",{className:"page-container page-body"},this.renderPage()))},e}(i.PureComponent);var S={loadTeam:g.e};e.a=Object(u.hot)(t)(Object(o.b)(function(t){var e=Object(w.a)(t.location),r=Object(w.b)(t.location)||"members",n=Object(b.b)(r);return{navModel:Object(y.a)(t.navIndex,"team-"+r+"-"+e,n),teamId:e,pageName:r,team:Object(v.c)(t.team,e)}},S)(x))}).call(this,r(66)(t))},function(t,e,r){"use strict";var n=r(2),a=r(0),i=r.n(a),s=r(21),o=r(98),l=r(246),c=r(173),u=r(172),d=r(38),p=r(74),h=function(t){function e(e){var r=t.call(this,e)||this;return r.onSearchQueryChange=function(t){r.props.setSearchMemberQuery(t.target.value)},r.onToggleAdding=function(){r.setState({isAdding:!r.state.isAdding})},r.onUserSelected=function(t){r.setState({newTeamMember:t})},r.onAddUserToTeam=function(){return n.b(r,void 0,void 0,function(){return n.d(this,function(t){return this.props.addTeamMember(this.state.newTeamMember.id),this.setState({newTeamMember:null}),[2]})})},r.state={isAdding:!1,newTeamMember:null},r}return n.c(e,t),e.prototype.componentDidMount=function(){this.props.loadTeamMembers()},e.prototype.onRemoveMember=function(t){this.props.removeTeamMember(t.userId)},e.prototype.renderLabels=function(t){return t?i.a.createElement("td",null,t.map(function(t){return i.a.createElement(u.a,{key:t,label:t,removeIcon:!1,count:0,onClick:function(){}})})):i.a.createElement("td",null)},e.prototype.renderMember=function(t,e){var r=this;return i.a.createElement("tr",{key:t.userId},i.a.createElement("td",{className:"width-4 text-center"},i.a.createElement("img",{className:"filter-table__avatar",src:t.avatarUrl})),i.a.createElement("td",null,t.login),i.a.createElement("td",null,t.email),e&&this.renderLabels(t.labels),i.a.createElement("td",{className:"text-right"},i.a.createElement(c.a,{onConfirmDelete:function(){return r.onRemoveMember(t)}})))},e.prototype.render=function(){var t=this,e=this.state.isAdding,r=this.props,n=r.searchMemberQuery,a=r.members,s=r.syncEnabled;return i.a.createElement("div",null,i.a.createElement("div",{className:"page-action-bar"},i.a.createElement("div",{className:"gf-form gf-form--grow"},i.a.createElement("label",{className:"gf-form--has-input-icon gf-form--grow"},i.a.createElement("input",{type:"text",className:"gf-form-input",placeholder:"Search members",value:n,onChange:this.onSearchQueryChange}),i.a.createElement("i",{className:"gf-form-input-icon fa fa-search"}))),i.a.createElement("div",{className:"page-action-bar__spacer"}),i.a.createElement("button",{className:"btn btn-success pull-right",onClick:this.onToggleAdding,disabled:e},i.a.createElement("i",{className:"fa fa-plus"})," Add a member")),i.a.createElement(o.a,{in:e},i.a.createElement("div",{className:"cta-form"},i.a.createElement("button",{className:"cta-form__close btn btn-transparent",onClick:this.onToggleAdding},i.a.createElement("i",{className:"fa fa-close"})),i.a.createElement("h5",null,"Add Team Member"),i.a.createElement("div",{className:"gf-form-inline"},i.a.createElement(l.a,{onSelected:this.onUserSelected,className:"min-width-30"}),this.state.newTeamMember&&i.a.createElement("button",{className:"btn btn-success gf-form-btn",type:"submit",onClick:this.onAddUserToTeam},"Add to team")))),i.a.createElement("div",{className:"admin-list-table"},i.a.createElement("table",{className:"filter-table filter-table--hover form-inline"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null),i.a.createElement("th",null,"Name"),i.a.createElement("th",null,"Email"),s&&i.a.createElement("th",null),i.a.createElement("th",{style:{width:"1%"}}))),i.a.createElement("tbody",null,a&&a.map(function(e){return t.renderMember(e,s)})))))},e}(a.PureComponent);var f={loadTeamMembers:d.g,addTeamMember:d.c,removeTeamMember:d.j,setSearchMemberQuery:d.k};e.a=Object(s.b)(function(t){return{members:Object(p.e)(t.team),searchMemberQuery:Object(p.a)(t.team)}},f)(h)},function(t,e,r){"use strict";var n=r(2),a=r(0),i=r.n(a),s=r(21),o=r(178),l=r(177),c=r(38),u=r(141),d=r(74),p=function(t){function e(e){var r=t.call(this,e)||this;return r.onChangeName=function(t){r.setState({name:t.target.value})},r.onChangeEmail=function(t){r.setState({email:t.target.value})},r.onUpdate=function(t){var e=r.state,n=e.name,a=e.email;t.preventDefault(),r.props.updateTeam(n,a)},r.state={name:e.team.name,email:e.team.email},r}return n.c(e,t),e.prototype.render=function(){var t=this.props.team,e=this.state,r=e.name,n=e.email;return i.a.createElement("div",null,i.a.createElement("h3",{className:"page-sub-heading"},"Team Settings"),i.a.createElement("form",{name:"teamDetailsForm",className:"gf-form-group",onSubmit:this.onUpdate},i.a.createElement("div",{className:"gf-form max-width-30"},i.a.createElement(o.a,null,"Name"),i.a.createElement("input",{type:"text",required:!0,value:r,className:"gf-form-input max-width-22",onChange:this.onChangeName})),i.a.createElement("div",{className:"gf-form max-width-30"},i.a.createElement(o.a,{tooltip:"This is optional and is primarily used to set the team profile avatar (via gravatar service)"},"Email"),i.a.createElement("input",{type:"email",className:"gf-form-input max-width-22",value:n,placeholder:"team@email.com",onChange:this.onChangeEmail})),i.a.createElement("div",{className:"gf-form-button-row"},i.a.createElement("button",{type:"submit",className:"btn btn-success"},"Update"))),i.a.createElement(l.a,{resourceUri:"teams/"+t.id}))},e}(i.a.Component);var h={updateTeam:c.m};e.a=Object(s.b)(function(t){var e=Object(u.a)(t.location);return{team:Object(d.c)(t.team,e)}},h)(p)},function(t,e,r){"use strict";var n=r(2),a=r(0),i=r.n(a),s=r(21),o=r(98),l=r(119),c=r(38),u=r(74),d="Sync LDAP or OAuth groups with your Grafana teams.",p=function(t){function e(e){var r=t.call(this,e)||this;return r.onToggleAdding=function(){r.setState({isAdding:!r.state.isAdding})},r.onNewGroupIdChanged=function(t){r.setState({newGroupId:t.target.value})},r.onAddGroup=function(t){t.preventDefault(),r.props.addTeamGroup(r.state.newGroupId),r.setState({isAdding:!1,newGroupId:""})},r.onRemoveGroup=function(t){r.props.removeTeamGroup(t.groupId)},r.state={isAdding:!1,newGroupId:""},r}return n.c(e,t),e.prototype.componentDidMount=function(){this.fetchTeamGroups()},e.prototype.fetchTeamGroups=function(){return n.b(this,void 0,void 0,function(){return n.d(this,function(t){switch(t.label){case 0:return[4,this.props.loadTeamGroups()];case 1:return t.sent(),[2]}})})},e.prototype.isNewGroupValid=function(){return this.state.newGroupId.length>1},e.prototype.renderGroup=function(t){var e=this;return i.a.createElement("tr",{key:t.groupId},i.a.createElement("td",null,t.groupId),i.a.createElement("td",{style:{width:"1%"}},i.a.createElement("a",{className:"btn btn-danger btn-mini",onClick:function(){return e.onRemoveGroup(t)}},i.a.createElement("i",{className:"fa fa-remove"}))))},e.prototype.render=function(){var t=this,e=this.state,r=e.isAdding,n=e.newGroupId,a=this.props.groups;return i.a.createElement("div",null,i.a.createElement("div",{className:"page-action-bar"},i.a.createElement("h3",{className:"page-sub-heading"},"External group sync"),i.a.createElement(l.a,{className:"page-sub-heading-icon",placement:"auto",content:d},i.a.createElement("i",{className:"gicon gicon-question gicon--has-hover"})),i.a.createElement("div",{className:"page-action-bar__spacer"}),a.length>0&&i.a.createElement("button",{className:"btn btn-success pull-right",onClick:this.onToggleAdding},i.a.createElement("i",{className:"fa fa-plus"})," Add group")),i.a.createElement(o.a,{in:r},i.a.createElement("div",{className:"cta-form"},i.a.createElement("button",{className:"cta-form__close btn btn-transparent",onClick:this.onToggleAdding},i.a.createElement("i",{className:"fa fa-close"})),i.a.createElement("h5",null,"Add External Group"),i.a.createElement("form",{className:"gf-form-inline",onSubmit:this.onAddGroup},i.a.createElement("div",{className:"gf-form"},i.a.createElement("input",{type:"text",className:"gf-form-input width-30",value:n,onChange:this.onNewGroupIdChanged,placeholder:"cn=ops,ou=groups,dc=grafana,dc=org"})),i.a.createElement("div",{className:"gf-form"},i.a.createElement("button",{className:"btn btn-success gf-form-btn",type:"submit",disabled:!this.isNewGroupValid()},"Add group"))))),0===a.length&&!r&&i.a.createElement("div",{className:"empty-list-cta"},i.a.createElement("div",{className:"empty-list-cta__title"},"There are no external groups to sync with"),i.a.createElement("button",{onClick:this.onToggleAdding,className:"empty-list-cta__button btn btn-xlarge btn-success"},i.a.createElement("i",{className:"gicon gicon-add-team"}),"Add Group"),i.a.createElement("div",{className:"empty-list-cta__pro-tip"},i.a.createElement("i",{className:"fa fa-rocket"})," ",d,i.a.createElement("a",{className:"text-link empty-list-cta__pro-tip-link",href:"http://docs.grafana.org/auth/enhanced_ldap/",target:"_blank"},"Learn more"))),a.length>0&&i.a.createElement("div",{className:"admin-list-table"},i.a.createElement("table",{className:"filter-table filter-table--hover form-inline"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,"External Group ID"),i.a.createElement("th",{style:{width:"1%"}}))),i.a.createElement("tbody",null,a.map(function(e){return t.renderGroup(e)})))))},e}(a.PureComponent);var h={loadTeamGroups:c.f,addTeamGroup:c.b,removeTeamGroup:c.i};e.a=Object(s.b)(function(t){return{groups:Object(u.d)(t.team)}},h)(p)},function(t,e,r){"use strict";(function(t){var n=r(2),a=r(0),i=r.n(a),s=r(21),o=r(35),l=r(32),c=r(173),u=r(117),d=r(81),p=r(38),h=r(74),f=r(34),m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.deleteTeam=function(t){e.props.deleteTeam(t.id)},e.onSearchQueryChange=function(t){e.props.setSearchQuery(t.target.value)},e}return n.c(e,t),e.prototype.componentDidMount=function(){this.fetchTeams()},e.prototype.fetchTeams=function(){return n.b(this,void 0,void 0,function(){return n.d(this,function(t){switch(t.label){case 0:return[4,this.props.loadTeams()];case 1:return t.sent(),[2]}})})},e.prototype.renderTeam=function(t){var e=this,r="org/teams/edit/"+t.id;return i.a.createElement("tr",{key:t.id},i.a.createElement("td",{className:"width-4 text-center link-td"},i.a.createElement("a",{href:r},i.a.createElement("img",{className:"filter-table__avatar",src:t.avatarUrl}))),i.a.createElement("td",{className:"link-td"},i.a.createElement("a",{href:r},t.name)),i.a.createElement("td",{className:"link-td"},i.a.createElement("a",{href:r},t.email)),i.a.createElement("td",{className:"link-td"},i.a.createElement("a",{href:r},t.memberCount)),i.a.createElement("td",{className:"text-right"},i.a.createElement(c.a,{onConfirmDelete:function(){return e.deleteTeam(t)}})))},e.prototype.renderEmptyList=function(){return i.a.createElement("div",{className:"page-container page-body"},i.a.createElement(u.a,{model:{title:"您还没有创建任何团队。",buttonIcon:"fa fa-plus",buttonLink:"org/teams/new",buttonTitle:" 新团队",proTip:"将文件夹和仪表盘权限分配给团队，而不是用户，以简化管理。",proTipLink:"",proTipLinkTitle:"",proTipTarget:"_blank"}}))},e.prototype.renderTeamList=function(){var t=this,e=this.props,r=e.teams,n=e.searchQuery;return i.a.createElement("div",{className:"page-container page-body"},i.a.createElement("div",{className:"page-action-bar"},i.a.createElement("div",{className:"gf-form gf-form--grow"},i.a.createElement("label",{className:"gf-form--has-input-icon gf-form--grow"},i.a.createElement("input",{type:"text",className:"gf-form-input",placeholder:"Search teams",value:n,onChange:this.onSearchQueryChange}),i.a.createElement("i",{className:"gf-form-input-icon fa fa-search"}))),i.a.createElement("div",{className:"page-action-bar__spacer"}),i.a.createElement("a",{className:"btn btn-success",href:"org/teams/new"},"新团队")),i.a.createElement("div",{className:"admin-list-table"},i.a.createElement("table",{className:"filter-table filter-table--hover form-inline"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null),i.a.createElement("th",null,"名称"),i.a.createElement("th",null,"邮箱"),i.a.createElement("th",null,"成员"),i.a.createElement("th",{style:{width:"1%"}}))),i.a.createElement("tbody",null,r.map(function(e){return t.renderTeam(e)})))))},e.prototype.renderList=function(){return this.props.teamsCount>0?this.renderTeamList():this.renderEmptyList()},e.prototype.render=function(){var t=this.props,e=t.hasFetched,r=t.navModel;return i.a.createElement("div",null,i.a.createElement(l.a,{model:r}),e?this.renderList():i.a.createElement(d.a,{pageName:"Teams"}))},e}(a.PureComponent);var g={loadTeams:p.h,deleteTeam:p.d,setSearchQuery:p.l};e.a=Object(o.hot)(t)(Object(s.b)(function(t){return{navModel:Object(f.a)(t.navIndex,"teams"),teams:Object(h.f)(t.teams),searchQuery:Object(h.b)(t.teams),teamsCount:Object(h.g)(t.teams),hasFetched:t.teams.hasFetched}},g)(m))}).call(this,r(66)(t))},function(t,e,r){"use strict";(function(t){var n,a=r(2),i=r(0),s=r.n(i),o=r(610),l=r.n(o),c=r(21),u=r(35),d=r(36),p=r(34),h=r(345),f=r(121),m=r(32),g=r(81),v=r(98),b=r(611),y=r(8),w=r(9),x=r(117),S=r(173);!function(t){t.Name="name",t.Role="role"}(n||(n={}));var k={name:"",role:d.e.Viewer},C=function(t){function e(e){var r=t.call(this,e)||this;return r.onSearchQueryChange=function(t){r.props.setSearchQuery(t.target.value)},r.onToggleAdding=function(){r.setState({isAdding:!r.state.isAdding})},r.onAddApiKey=function(t){return a.b(r,void 0,void 0,function(){var e;return a.d(this,function(r){return t.preventDefault(),e=function(t){var e=window.location.origin+y.a.appSubUrl,r=l.a.renderToString(s.a.createElement(b.a,{apiKey:t,rootPath:e}));w.a.emit("show-modal",{templateHtml:r})},this.props.addApiKey(this.state.newApiKey,e),this.setState(function(t){return a.a({},t,{newApiKey:k,isAdding:!1})}),[2]})})},r.onApiKeyStateUpdate=function(t,e){var n=t.currentTarget.value;r.setState(function(t){var r=a.a({},t.newApiKey);return r[e]=n,a.a({},t,{newApiKey:r})})},r.state={isAdding:!1,newApiKey:k},r}return a.c(e,t),e.prototype.componentDidMount=function(){this.fetchApiKeys()},e.prototype.fetchApiKeys=function(){return a.b(this,void 0,void 0,function(){return a.d(this,function(t){switch(t.label){case 0:return[4,this.props.loadApiKeys()];case 1:return t.sent(),[2]}})})},e.prototype.onDeleteApiKey=function(t){this.props.deleteApiKey(t.id)},e.prototype.renderEmptyList=function(){var t=this.state.isAdding;return s.a.createElement("div",{className:"page-container page-body"},!t&&s.a.createElement(x.a,{model:{title:"您还没有添加任何API Keys。",buttonIcon:"fa fa-plus",buttonLink:"#",onClick:this.onToggleAdding,buttonTitle:" 新API Key",proTip:"请记住，您可以为其他应用程序提供仅视图的API访问。",proTipLink:"",proTipLinkTitle:"",proTipTarget:"_blank"}}),this.renderAddApiKeyForm())},e.prototype.renderAddApiKeyForm=function(){var t=this,e=this.state,r=e.newApiKey,a=e.isAdding;return s.a.createElement(v.a,{in:a},s.a.createElement("div",{className:"cta-form"},s.a.createElement("button",{className:"cta-form__close btn btn-transparent",onClick:this.onToggleAdding},s.a.createElement("i",{className:"fa fa-close"})),s.a.createElement("h5",null,"添加API Key"),s.a.createElement("form",{className:"gf-form-group",onSubmit:this.onAddApiKey},s.a.createElement("div",{className:"gf-form-inline"},s.a.createElement("div",{className:"gf-form max-width-21"},s.a.createElement("span",{className:"gf-form-label"},"Key名称"),s.a.createElement("input",{type:"text",className:"gf-form-input",value:r.name,placeholder:"名称",onChange:function(e){return t.onApiKeyStateUpdate(e,n.Name)}})),s.a.createElement("div",{className:"gf-form"},s.a.createElement("span",{className:"gf-form-label"},"角色"),s.a.createElement("span",{className:"gf-form-select-wrapper"},s.a.createElement("select",{className:"gf-form-input gf-size-auto",value:r.role,onChange:function(e){return t.onApiKeyStateUpdate(e,n.Role)}},Object.keys(d.e).map(function(t){return s.a.createElement("option",{key:t,label:t,value:t},t)})))),s.a.createElement("div",{className:"gf-form"},s.a.createElement("button",{className:"btn gf-form-btn btn-success"},"添加"))))))},e.prototype.renderApiKeyList=function(){var t=this,e=this.state.isAdding,r=this.props,n=r.apiKeys,a=r.searchQuery;return s.a.createElement("div",{className:"page-container page-body"},s.a.createElement("div",{className:"page-action-bar"},s.a.createElement("div",{className:"gf-form gf-form--grow"},s.a.createElement("label",{className:"gf-form--has-input-icon gf-form--grow"},s.a.createElement("input",{type:"text",className:"gf-form-input",placeholder:"搜索keys",value:a,onChange:this.onSearchQueryChange}),s.a.createElement("i",{className:"gf-form-input-icon fa fa-search"}))),s.a.createElement("div",{className:"page-action-bar__spacer"}),s.a.createElement("button",{className:"btn btn-success pull-right",onClick:this.onToggleAdding,disabled:e},s.a.createElement("i",{className:"fa fa-plus"})," 添加API Key")),this.renderAddApiKeyForm(),s.a.createElement("h3",{className:"page-heading"},"现有的Keys"),s.a.createElement("table",{className:"filter-table"},s.a.createElement("thead",null,s.a.createElement("tr",null,s.a.createElement("th",null,"名称"),s.a.createElement("th",null,"角色"),s.a.createElement("th",{style:{width:"34px"}}))),n.length>0?s.a.createElement("tbody",null,n.map(function(e){return s.a.createElement("tr",{key:e.id},s.a.createElement("td",null,e.name),s.a.createElement("td",null,e.role),s.a.createElement("td",null,s.a.createElement(S.a,{onConfirmDelete:function(){return t.onDeleteApiKey(e)}})))})):null))},e.prototype.render=function(){var t=this.props,e=t.hasFetched,r=t.navModel,n=t.apiKeysCount;return s.a.createElement("div",null,s.a.createElement(m.a,{model:r}),e?n>0?this.renderApiKeyList():this.renderEmptyList():s.a.createElement(g.a,{pageName:"Api keys"}))},e}(i.PureComponent);var T={loadApiKeys:f.d,deleteApiKey:f.c,setSearchQuery:f.e,addApiKey:f.b};e.a=Object(u.hot)(t)(Object(c.b)(function(t){return{navModel:Object(p.a)(t.navIndex,"apikeys"),apiKeys:Object(h.a)(t.apiKeys),searchQuery:t.apiKeys.searchQuery,apiKeysCount:Object(h.b)(t.apiKeys),hasFetched:t.apiKeys.hasFetched}},T)(C))}).call(this,r(66)(t))},,function(t,e,r){"use strict";var n=r(0),a=r.n(n);e.a=function(t){return a.a.createElement("div",{className:"modal-body"},a.a.createElement("div",{className:"modal-header"},a.a.createElement("h2",{className:"modal-header-title"},a.a.createElement("i",{className:"fa fa-key"}),a.a.createElement("span",{className:"p-l-1"},"API Key已创建")),a.a.createElement("a",{className:"modal-header-close","ng-click":"dismiss();"},a.a.createElement("i",{className:"fa fa-remove"}))),a.a.createElement("div",{className:"modal-content"},a.a.createElement("div",{className:"gf-form-group"},a.a.createElement("div",{className:"gf-form"},a.a.createElement("span",{className:"gf-form-label"},"Key"),a.a.createElement("span",{className:"gf-form-label"},t.apiKey))),a.a.createElement("div",{className:"grafana-info-box",style:{border:0}},"您只能在这里查看此密钥一次!它不存储在此表单中。所以一定要复制下来。",a.a.createElement("br",null),a.a.createElement("br",null),"您可以使用授权HTTP Header验证请求，示例:",a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement("pre",{className:"small"},'curl -H "Authorization: Bearer ',t.apiKey,'" ',t.rootPath,"/api/dashboards/home"))))}},function(t,e,r){"use strict";(function(t){var n=r(2),a=r(0),i=r.n(a),s=r(35),o=r(21),l=r(32),c=r(248),u=r(81),d=r(641),p=r(68),h=r(34),f=r(260),m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.c(e,t),e.prototype.componentDidMount=function(){this.fetchPlugins()},e.prototype.fetchPlugins=function(){return n.b(this,void 0,void 0,function(){return n.d(this,function(t){switch(t.label){case 0:return[4,this.props.loadPlugins()];case 1:return t.sent(),[2]}})})},e.prototype.render=function(){var t=this.props,e=t.hasFetched,r=t.navModel,n=t.plugins,a=t.layoutMode,s=t.setPluginsLayoutMode,o=t.setPluginsSearchQuery,p=t.searchQuery;return i.a.createElement("div",null,i.a.createElement(l.a,{model:r}),i.a.createElement("div",{className:"page-container page-body"},i.a.createElement(c.a,{searchQuery:p,layoutMode:a,onSetLayoutMode:function(t){return s(t)},setSearchQuery:function(t){return o(t)},linkButton:{href:"",title:"查找更多插件"}}),e?n&&i.a.createElement(d.a,{plugins:n,layoutMode:a}):i.a.createElement(u.a,{pageName:"Plugins"})))},e}(a.PureComponent);var g={loadPlugins:p.c,setPluginsLayoutMode:p.d,setPluginsSearchQuery:p.e};e.a=Object(s.hot)(t)(Object(o.b)(function(t){return{navModel:Object(h.a)(t.navIndex,"plugins"),plugins:Object(f.b)(t.plugins),layoutMode:Object(f.a)(t.plugins),searchQuery:Object(f.c)(t.plugins),hasFetched:t.plugins.hasFetched}},g)(m))}).call(this,r(66)(t))},function(t,e,r){"use strict";(function(t){var n=r(2),a=r(0),i=r.n(a),s=r(35),o=r(21),l=r(32),c=r(9),u=r(34),d=r(64),p=r(169),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onTitleChange=function(t){e.props.setFolderTitle(t.target.value)},e.onSave=function(t){return n.b(e,void 0,void 0,function(){return n.d(this,function(e){switch(e.label){case 0:return t.preventDefault(),t.stopPropagation(),[4,this.props.saveFolder(this.props.folder)];case 1:return e.sent(),[2]}})})},e.onDelete=function(t){t.stopPropagation(),t.preventDefault(),c.a.emit("confirm-modal",{title:"删除",text:"你想要删除这个文件夹和文件夹下的所有仪表盘吗?",icon:"fa-trash",yesText:"删除",onConfirm:function(){e.props.deleteFolder(e.props.folder.uid)}})},e}return n.c(e,t),e.prototype.componentDidMount=function(){this.props.getFolderByUid(this.props.folderUid)},e.prototype.render=function(){var t=this.props,e=t.navModel,r=t.folder;return i.a.createElement("div",null,i.a.createElement(l.a,{model:e}),i.a.createElement("div",{className:"page-container page-body"},i.a.createElement("h2",{className:"page-sub-heading"},"文件夹设置"),i.a.createElement("div",{className:"section gf-form-group"},i.a.createElement("form",{name:"folderSettingsForm",onSubmit:this.onSave},i.a.createElement("div",{className:"gf-form"},i.a.createElement("label",{className:"gf-form-label width-7"},"名称"),i.a.createElement("input",{type:"text",className:"gf-form-input width-30",value:r.title,onChange:this.onTitleChange})),i.a.createElement("div",{className:"gf-form-button-row"},i.a.createElement("button",{type:"submit",className:"btn btn-success",disabled:!r.canSave||!r.hasChanged},i.a.createElement("i",{className:"fa fa-save"})," 保存"),i.a.createElement("button",{className:"btn btn-danger",onClick:this.onDelete,disabled:!r.canSave},i.a.createElement("i",{className:"fa fa-trash"})," 删除"))))))},e}(a.PureComponent),f={getFolderByUid:d.d,saveFolder:d.g,setFolderTitle:d.h,deleteFolder:d.c};e.a=Object(s.hot)(t)(Object(o.b)(function(t){var e=t.location.routeParams.uid;return{navModel:Object(u.a)(t.navIndex,"folder-settings-"+e,Object(p.b)(2)),folderUid:e,folder:t.folder}},f)(h))}).call(this,r(66)(t))},function(t,e,r){"use strict";(function(t){var n=r(2),a=r(0),i=r.n(a),s=r(35),o=r(21),l=r(32),c=r(119),u=r(98),d=r(34),p=r(64),h=r(169),f=r(255),m=r(257),g=r(249),v=function(t){function e(e){var r=t.call(this,e)||this;return r.onOpenAddPermissions=function(){r.setState({isAdding:!0})},r.onRemoveItem=function(t){r.props.removeFolderPermission(t)},r.onPermissionChanged=function(t,e){r.props.updateFolderPermission(t,e)},r.onAddPermission=function(t){return r.props.addFolderPermission(t)},r.onCancelAddPermission=function(){r.setState({isAdding:!1})},r.state={isAdding:!1},r}return n.c(e,t),e.prototype.componentDidMount=function(){this.props.getFolderByUid(this.props.folderUid),this.props.getFolderPermissions(this.props.folderUid)},e.prototype.render=function(){var t=this.props,e=t.navModel,r=t.folder,n=this.state.isAdding;if(0===r.id)return i.a.createElement(l.a,{model:e});var a={title:r.title,url:r.url,id:r.id};return i.a.createElement("div",null,i.a.createElement(l.a,{model:e}),i.a.createElement("div",{className:"page-container page-body"},i.a.createElement("div",{className:"page-action-bar"},i.a.createElement("h3",{className:"page-sub-heading"},"权限文件夹"),i.a.createElement(c.a,{className:"page-sub-heading-icon",placement:"auto",content:g.a},i.a.createElement("i",{className:"gicon gicon-question gicon--has-hover"})),i.a.createElement("div",{className:"page-action-bar__spacer"}),i.a.createElement("button",{className:"btn btn-success pull-right",onClick:this.onOpenAddPermissions,disabled:n},i.a.createElement("i",{className:"fa fa-plus"})," 添加权限")),i.a.createElement(u.a,{in:n},i.a.createElement(m.a,{onAddPermission:this.onAddPermission,onCancel:this.onCancelAddPermission})),i.a.createElement(f.a,{items:r.permissions,onRemoveItem:this.onRemoveItem,onPermissionChanged:this.onPermissionChanged,isFetching:!1,folderInfo:a})))},e}(a.PureComponent),b={getFolderByUid:p.d,getFolderPermissions:p.e,updateFolderPermission:p.i,removeFolderPermission:p.f,addFolderPermission:p.b};e.a=Object(s.hot)(t)(Object(o.b)(function(t){var e=t.location.routeParams.uid;return{navModel:Object(d.a)(t.navIndex,"folder-permissions-"+e,Object(h.b)(1)),folderUid:e,folder:t.folder}},b)(v))}).call(this,r(66)(t))},function(t,e,r){"use strict";(function(t){var n=r(2),a=r(0),i=r.n(a),s=r(21),o=r(35),l=r(32),c=r(81),u=r(248),d=r(117),p=r(642),h=r(58),f=r(34),m=r(105),g={title:"还没有数据源",buttonIcon:"gicon gicon-add-datasources",buttonLink:"datasources/new",buttonTitle:"添加数据源",proTip:"您还可以通过配置文件定义数据源。",proTipLink:"",proTipLinkTitle:"Learn more",proTipTarget:"_blank"},v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.c(e,t),e.prototype.componentDidMount=function(){this.fetchDataSources()},e.prototype.fetchDataSources=function(){return n.b(this,void 0,void 0,function(){return n.d(this,function(t){switch(t.label){case 0:return[4,this.props.loadDataSources()];case 1:return[2,t.sent()]}})})},e.prototype.render=function(){var t=this.props,e=t.dataSources,r=t.dataSourcesCount,n=t.navModel,a=t.layoutMode,s=t.searchQuery,o=t.setDataSourcesSearchQuery,h=t.setDataSourcesLayoutMode,f=t.hasFetched;return i.a.createElement("div",null,i.a.createElement(l.a,{model:n}),i.a.createElement("div",{className:"page-container page-body"},!f&&i.a.createElement(c.a,{pageName:"Data sources"}),f&&0===r&&i.a.createElement(d.a,{model:g}),f&&r>0&&[i.a.createElement(u.a,{layoutMode:a,searchQuery:s,onSetLayoutMode:function(t){return h(t)},setSearchQuery:function(t){return o(t)},linkButton:{href:"datasources/new",title:"添加数据源"},key:"action-bar"}),i.a.createElement(p.a,{dataSources:e,layoutMode:a,key:"list"})]))},e}(a.PureComponent);var b={loadDataSources:h.e,setDataSourcesSearchQuery:h.h,setDataSourcesLayoutMode:h.g};e.a=Object(o.hot)(t)(Object(s.b)(function(t){return{navModel:Object(f.a)(t.navIndex,"datasources"),dataSources:Object(m.c)(t.dataSources),layoutMode:Object(m.e)(t.dataSources),dataSourcesCount:Object(m.d)(t.dataSources),searchQuery:Object(m.f)(t.dataSources),hasFetched:t.dataSources.hasFetched}},b)(v))}).call(this,r(66)(t))},function(t,e,r){"use strict";(function(t){var n=r(2),a=r(0),i=r.n(a),s=r(21),o=r(35),l=r(32),c=r(58),u=r(34),d=r(105),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onDataSourceTypeClicked=function(t){e.props.addDataSource(t)},e.onSearchQueryChange=function(t){e.props.setDataSourceTypeSearchQuery(t.target.value)},e}return n.c(e,t),e.prototype.componentDidMount=function(){this.props.loadDataSourceTypes()},e.prototype.render=function(){var t=this,e=this.props,r=e.navModel,n=e.dataSourceTypes,a=e.dataSourceTypeSearchQuery;return i.a.createElement("div",null,i.a.createElement(l.a,{model:r}),i.a.createElement("div",{className:"page-container page-body"},i.a.createElement("h2",{className:"add-data-source-header"},"选择数据源类型"),i.a.createElement("div",{className:"add-data-source-search"},i.a.createElement("label",{className:"gf-form--has-input-icon"},i.a.createElement("input",{type:"text",className:"gf-form-input width-20",value:a,onChange:this.onSearchQueryChange,placeholder:"通过名称或类型过滤"}),i.a.createElement("i",{className:"gf-form-input-icon fa fa-search"}))),i.a.createElement("div",{className:"add-data-source-grid"},n.map(function(e,r){return i.a.createElement("div",{onClick:function(){return t.onDataSourceTypeClicked(e)},className:"add-data-source-grid-item",key:e.id+"-"+r},i.a.createElement("img",{className:"add-data-source-grid-item-logo",src:e.info.logos.small}),i.a.createElement("span",{className:"add-data-source-grid-item-text"},e.name))}))))},e}(a.PureComponent);var h={addDataSource:c.b,loadDataSourceTypes:c.d,setDataSourceTypeSearchQuery:c.f};e.a=Object(o.hot)(t)(Object(s.b)(function(t){return{navModel:Object(u.a)(t.navIndex,"datasources"),dataSourceTypes:Object(d.b)(t.dataSources)}},h)(p))}).call(this,r(66)(t))},function(t,e,r){"use strict";(function(t){var n=r(2),a=r(0),i=r.n(a),s=r(35),o=r(21),l=r(99),c=r.n(l),u=r(32),d=r(81),p=r(618),h=r(619),f=r(620),m=r(9),g=r(75),v=r(34),b=r(146),y=function(t){function e(e){var r=t.call(this,e)||this;if(r.onRoleChange=function(t,e){var a=n.a({},e,{role:t});r.props.updateUser(a)},r.onRemoveUser=function(t){m.a.emit("confirm-modal",{title:"删除",text:"你确定要删除用户 "+t.login+"吗?",yesText:"删除",icon:"fa-warning",onConfirm:function(){r.props.removeUser(t.userId)}})},r.onRevokeInvite=function(t){r.props.revokeInvite(t)},r.onShowInvites=function(){r.setState(function(t){return{showInvites:!t.showInvites}})},r.props.externalUserMngInfo){var a=new c.a;r.externalUserMngInfoHtml=a.render(r.props.externalUserMngInfo)}return r.state={showInvites:!1},r}return n.c(e,t),e.prototype.componentDidMount=function(){this.fetchUsers(),this.fetchInvitees()},e.prototype.fetchUsers=function(){return n.b(this,void 0,void 0,function(){return n.d(this,function(t){switch(t.label){case 0:return[4,this.props.loadUsers()];case 1:return[2,t.sent()]}})})},e.prototype.fetchInvitees=function(){return n.b(this,void 0,void 0,function(){return n.d(this,function(t){switch(t.label){case 0:return[4,this.props.loadInvitees()];case 1:return[2,t.sent()]}})})},e.prototype.renderTable=function(){var t=this,e=this.props,r=e.invitees,n=e.users;return this.state.showInvites?i.a.createElement(f.a,{invitees:r,onRevokeInvite:function(e){return t.onRevokeInvite(e)}}):i.a.createElement(h.a,{users:n,onRoleChange:function(e,r){return t.onRoleChange(e,r)},onRemoveUser:function(e){return t.onRemoveUser(e)}})},e.prototype.render=function(){var t=this.props,e=t.navModel,r=t.hasFetched,n=this.externalUserMngInfoHtml;return i.a.createElement("div",null,i.a.createElement(u.a,{model:e}),i.a.createElement("div",{className:"page-container page-body"},i.a.createElement(p.a,{onShowInvites:this.onShowInvites,showInvites:this.state.showInvites}),n&&i.a.createElement("div",{className:"grafana-info-box",dangerouslySetInnerHTML:{__html:n}}),r?this.renderTable():i.a.createElement(d.a,{pageName:"Users"})))},e}(a.PureComponent);var w={loadUsers:g.c,loadInvitees:g.b,setUsersSearchQuery:g.f,updateUser:g.g,removeUser:g.d,revokeInvite:g.e};e.a=Object(s.hot)(t)(Object(o.b)(function(t){return{navModel:Object(v.a)(t.navIndex,"users"),users:Object(b.c)(t.users),searchQuery:Object(b.d)(t.users),invitees:Object(b.a)(t.users),externalUserMngInfo:t.users.externalUserMngInfo,hasFetched:t.users.hasFetched}},w)(y))}).call(this,r(66)(t))},function(t,e,r){"use strict";var n=r(2),a=r(0),i=r.n(a),s=r(21),o=r(104),l=r.n(o),c=r(75),u=r(146),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.c(e,t),e.prototype.render=function(){var t=this.props,e=t.canInvite,r=t.externalUserMngLinkName,n=t.externalUserMngLinkUrl,a=t.searchQuery,s=t.pendingInvitesCount,o=t.setUsersSearchQuery,c=t.onShowInvites,u=t.showInvites,d=l()({btn:!0,"toggle-btn":!0,active:u}),p=l()({btn:!0,"toggle-btn":!0,active:!u});return i.a.createElement("div",{className:"page-action-bar"},i.a.createElement("div",{className:"gf-form gf-form--grow"},i.a.createElement("label",{className:"gf-form--has-input-icon"},i.a.createElement("input",{type:"text",className:"gf-form-input width-20",value:a,onChange:function(t){return o(t.target.value)},placeholder:"通过名称或类型过滤"}),i.a.createElement("i",{className:"gf-form-input-icon fa fa-search"})),s>0&&i.a.createElement("div",{style:{marginLeft:"1rem"}},i.a.createElement("button",{className:p,key:"users",onClick:c},"用户"),i.a.createElement("button",{className:d,onClick:c,key:"pending-invites"},"等待邀请 (",s,")")),i.a.createElement("div",{className:"page-action-bar__spacer"}),e&&i.a.createElement("a",{className:"btn btn-success",href:"org/users/invite"},i.a.createElement("span",null,"邀请")),n&&i.a.createElement("a",{className:"btn btn-success",href:n,target:"_blank"},i.a.createElement("i",{className:"fa fa-external-link-square"})," ",r)))},e}(a.PureComponent);var p={setUsersSearchQuery:c.f};e.a=Object(s.b)(function(t){return{searchQuery:Object(u.d)(t.users),pendingInvitesCount:Object(u.b)(t.users),externalUserMngLinkName:t.users.externalUserMngLinkName,externalUserMngLinkUrl:t.users.externalUserMngLinkUrl,canInvite:t.users.canInvite}},p)(d)},function(t,e,r){"use strict";var n=r(0),a=r.n(n);e.a=function(t){var e=t.users,r=t.onRoleChange,n=t.onRemoveUser;return a.a.createElement("table",{className:"filter-table form-inline"},a.a.createElement("thead",null,a.a.createElement("tr",null,a.a.createElement("th",null),a.a.createElement("th",null,"Login"),a.a.createElement("th",null,"Email"),a.a.createElement("th",null,"Seen"),a.a.createElement("th",null,"Role"),a.a.createElement("th",{style:{width:"34px"}}))),a.a.createElement("tbody",null,e.map(function(t,e){return a.a.createElement("tr",{key:t.userId+"-"+e},a.a.createElement("td",{className:"width-4 text-center"},a.a.createElement("img",{className:"filter-table__avatar",src:t.avatarUrl})),a.a.createElement("td",null,t.login),a.a.createElement("td",null,a.a.createElement("span",{className:"ellipsis"},t.email)),a.a.createElement("td",null,t.lastSeenAtAge),a.a.createElement("td",null,a.a.createElement("div",{className:"gf-form-select-wrapper width-12"},a.a.createElement("select",{value:t.role,className:"gf-form-input",onChange:function(e){return r(e.target.value,t)}},["Viewer","Editor","Admin"].map(function(t,e){return a.a.createElement("option",{value:t,key:t+"-"+e},t)})))),a.a.createElement("td",null,a.a.createElement("div",{onClick:function(){return n(t)},className:"btn btn-danger btn-mini"},a.a.createElement("i",{className:"fa fa-remove"}))))})))}},function(t,e,r){"use strict";var n=r(2),a=r(0),i=r.n(a),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.copyUrlRef=Object(a.createRef)(),e.copyToClipboard=function(){var t=e.copyUrlRef.current;t&&(t.select(),document.execCommand("copy"))},e}return n.c(e,t),e.prototype.render=function(){var t=this,e=this.props,r=e.invitees,n=e.onRevokeInvite;return i.a.createElement("table",{className:"filter-table form-inline"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,"Email"),i.a.createElement("th",null,"Name"),i.a.createElement("th",null),i.a.createElement("th",{style:{width:"34px"}}))),i.a.createElement("tbody",null,r.map(function(e,r){return i.a.createElement("tr",{key:e.id+"-"+r},i.a.createElement("td",null,e.email),i.a.createElement("td",null,e.name),i.a.createElement("td",{className:"text-right"},i.a.createElement("button",{className:"btn btn-inverse btn-mini",onClick:t.copyToClipboard},i.a.createElement("textarea",{readOnly:!0,value:e.url,style:{position:"absolute",right:-1e3},ref:t.copyUrlRef}),i.a.createElement("i",{className:"fa fa-clipboard"})," Copy Invite")," "),i.a.createElement("td",null,i.a.createElement("button",{className:"btn btn-danger btn-mini",onClick:function(){return n(e.code)}},i.a.createElement("i",{className:"fa fa-remove"}))))})))},e}(a.PureComponent);e.a=s},function(t,e,r){"use strict";(function(t){var n=r(2),a=r(0),i=r.n(a),s=r(35),o=r(21),l=r(32),c=r(622),u=r(34),d=r(141),p=r(58),h=r(68),f=r(101),m=r(105),g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onImport=function(t,r){var n=e.props,a=n.dataSource,i=n.importDashboard,s={pluginId:t.pluginId,path:t.path,overwrite:r,inputs:[]};a&&s.inputs.push({name:"*",type:"datasource",pluginId:a.type,value:a.name}),i(s,t.title)},e.onRemove=function(t){e.props.removeDashboard(t.importedUri)},e}return n.c(e,t),e.prototype.componentDidMount=function(){return n.b(this,void 0,void 0,function(){var t,e,r;return n.d(this,function(n){switch(n.label){case 0:return t=this.props,e=t.loadDataSource,r=t.pageId,[4,e(r)];case 1:return n.sent(),this.props.loadPluginDashboards(),[2]}})})},e.prototype.render=function(){var t=this,e=this.props,r=e.dashboards,n=e.navModel;return i.a.createElement("div",null,i.a.createElement(l.a,{model:n}),i.a.createElement("div",{className:"page-container page-body"},i.a.createElement(c.a,{dashboards:r,onImport:function(e,r){return t.onImport(e,r)},onRemove:function(e){return t.onRemove(e)}})))},e}(a.PureComponent);var v={importDashboard:f.d,loadDataSource:p.c,loadPluginDashboards:h.b,removeDashboard:f.e};e.a=Object(s.hot)(t)(Object(o.b)(function(t){var e=Object(d.a)(t.location);return{navModel:Object(u.a)(t.navIndex,"datasource-dashboards-"+e),pageId:e,dashboards:t.plugins.dashboards,dataSource:Object(m.a)(t.dataSources,e)}},v)(g))}).call(this,r(66)(t))},function(t,e,r){"use strict";var n=r(0),a=r.n(n);e.a=function(t){var e=t.dashboards,r=t.onImport,n=t.onRemove;return a.a.createElement("table",{className:"filter-table"},a.a.createElement("tbody",null,e.map(function(t,e){return a.a.createElement("tr",{key:t.dashboardId+"-"+e},a.a.createElement("td",{className:"width-1"},a.a.createElement("i",{className:"icon-gf icon-gf-dashboard"})),a.a.createElement("td",null,t.imported?a.a.createElement("a",{href:t.importedUrl},t.title):a.a.createElement("span",null,t.title)),a.a.createElement("td",{style:{textAlign:"right"}},t.imported?a.a.createElement("button",{className:"btn btn-secondary btn-small",onClick:function(){return r(t,!0)}},function(t){return t.revision!==t.importedRevision?"Update":"Re-import"}(t)):a.a.createElement("button",{className:"btn btn-secondary btn-small",onClick:function(){return r(t,!1)}},"Import"),t.imported&&a.a.createElement("button",{className:"btn btn-danger btn-small",onClick:function(){return n(t)}},a.a.createElement("i",{className:"fa fa-trash"}))))})))}},function(t,e,r){"use strict";(function(t){var n=r(2),a=r(0),i=r.n(a),s=r(35),o=r(21),l=r(32),c=r(81),u=r(624),d=r(177),p=r(144),h=r(34),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onOrgNameChange=function(t){e.props.setOrganizationName(t)},e.onUpdateOrganization=function(){e.props.updateOrganization()},e}return n.c(e,t),e.prototype.componentDidMount=function(){return n.b(this,void 0,void 0,function(){return n.d(this,function(t){switch(t.label){case 0:return[4,this.props.loadOrganization()];case 1:return t.sent(),[2]}})})},e.prototype.render=function(){var t=this,e=this.props,r=e.navModel,n=e.organization,a=0===Object.keys(n).length;return i.a.createElement("div",null,i.a.createElement(l.a,{model:r}),i.a.createElement("div",{className:"page-container page-body"},a&&i.a.createElement(c.a,{pageName:"Organization"}),!a&&i.a.createElement("div",null,i.a.createElement(u.a,{onOrgNameChange:function(e){return t.onOrgNameChange(e)},onSubmit:this.onUpdateOrganization,orgName:n.name}),i.a.createElement(d.b,{resourceUri:"org"}))))},e}(a.PureComponent);var m={loadOrganization:p.b,setOrganizationName:p.c,updateOrganization:p.d};e.a=Object(s.hot)(t)(Object(o.b)(function(t){return{navModel:Object(h.a)(t.navIndex,"org-settings"),organization:t.organization.organization}},m)(f))}).call(this,r(66)(t))},function(t,e,r){"use strict";var n=r(0),a=r.n(n);e.a=function(t){var e=t.onSubmit,r=t.onOrgNameChange,n=t.orgName;return a.a.createElement("div",null,a.a.createElement("h3",{className:"page-sub-heading"},"组织简介"),a.a.createElement("form",{name:"orgForm",className:"gf-form-group",onSubmit:function(t){t.preventDefault(),e()}},a.a.createElement("div",{className:"gf-form-inline"},a.a.createElement("div",{className:"gf-form max-width-28"},a.a.createElement("span",{className:"gf-form-label"},"组织名称"),a.a.createElement("input",{className:"gf-form-input",type:"text",onChange:function(t){r(t.target.value)},value:n}))),a.a.createElement("div",{className:"gf-form-button-row"},a.a.createElement("button",{type:"submit",className:"btn btn-success"},"保存"))))}},,,,,,,,,,,,,,,,,function(t,e,r){"use strict";var n=r(0),a=r.n(n),i=r(104),s=r.n(i),o=function(t){var e=t.plugin;return a.a.createElement("li",{className:"card-item-wrapper"},a.a.createElement("a",{className:"card-item",href:"plugins/"+e.id+"/edit"},a.a.createElement("div",{className:"card-item-header"},a.a.createElement("div",{className:"card-item-type"},a.a.createElement("i",{className:"icon-gf icon-gf-"+e.type}),e.type),e.hasUpdate&&a.a.createElement("div",{className:"card-item-notice"},a.a.createElement("span",{"bs-tooltip":"plugin.latestVersion"},"Update available!"))),a.a.createElement("div",{className:"card-item-body"},a.a.createElement("figure",{className:"card-item-figure"},a.a.createElement("img",{src:e.info.logos.small})),a.a.createElement("div",{className:"card-item-details"},a.a.createElement("div",{className:"card-item-name"},e.name),a.a.createElement("div",{className:"card-item-sub-name"},"By "+e.info.author.name)))))},l=r(82);e.a=function(t){var e=t.plugins,r=t.layoutMode,n=s()({"card-section":!0,"card-list-layout-grid":r===l.a.Grid,"card-list-layout-list":r===l.a.List});return a.a.createElement("section",{className:n},a.a.createElement("ol",{className:"card-list"},e.map(function(t,e){return a.a.createElement(o,{plugin:t,key:t.name+"-"+e})})))}},function(t,e,r){"use strict";var n=r(2),a=r(0),i=r.n(a),s=r(104),o=r.n(s),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.c(e,t),e.prototype.render=function(){var t=this.props.dataSource;return i.a.createElement("li",{className:"card-item-wrapper"},i.a.createElement("a",{className:"card-item",href:"datasources/edit/"+t.id},i.a.createElement("div",{className:"card-item-header"},i.a.createElement("div",{className:"card-item-type"},t.type)),i.a.createElement("div",{className:"card-item-body"},i.a.createElement("figure",{className:"card-item-figure"},i.a.createElement("img",{src:t.typeLogoUrl})),i.a.createElement("div",{className:"card-item-details"},i.a.createElement("div",{className:"card-item-name"},t.name,t.isDefault&&i.a.createElement("span",{className:"btn btn-secondary btn-mini"},"default")),i.a.createElement("div",{className:"card-item-sub-name"},t.url)))))},e}(a.PureComponent),c=r(82),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.c(e,t),e.prototype.render=function(){var t=this.props,e=t.dataSources,r=t.layoutMode,n=o()({"card-section":!0,"card-list-layout-grid":r===c.a.Grid,"card-list-layout-list":r===c.a.List});return i.a.createElement("section",{className:n},i.a.createElement("ol",{className:"card-list"},e.map(function(t,e){return i.a.createElement(l,{dataSource:t,key:t.id+"-"+e})})))},e}(a.PureComponent);e.a=u},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e){!function(t){"use strict";t(function(){t.support.transition=function(){var t=function(){var t,e=document.createElement("bootstrap"),r={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(t in r)if(void 0!==e.style[t])return r[t]}();return t&&{end:t}}()})}(window.jQuery),function(t){"use strict";var e="[data-toggle=dropdown]",r=function(e){var r=t(e).on("click.dropdown.data-api",this.toggle);t("html").on("click.dropdown.data-api",function(){r.parent().removeClass("open")})};function n(){t(".dropdown-backdrop").remove(),t(e).each(function(){a(t(this)).removeClass("open")})}function a(e){var r,n=e.attr("data-target");return n||(n=(n=e.attr("href"))&&/#[A-Za-z]/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,"")),(r=n&&t(n))&&r.length||(r=e.parent()),r}r.prototype={constructor:r,toggle:function(e){var r,i,s=t(this);if(!s.is(".disabled, :disabled"))return i=(r=a(s)).hasClass("open"),n(),i||("ontouchstart"in document.documentElement&&t('<div class="dropdown-backdrop"/>').insertBefore(t(this)).on("click",n),r.toggleClass("open")),s.focus(),!1},keydown:function(r){var n,i,s,o,l;if(/(38|40|27)/.test(r.keyCode)&&(n=t(this),r.preventDefault(),r.stopPropagation(),!n.is(".disabled, :disabled"))){if(!(o=(s=a(n)).hasClass("open"))||o&&27==r.keyCode)return 27==r.which&&s.find(e).focus(),n.click();(i=t("[role=menu] li:not(.divider):visible a",s)).length&&(l=i.index(i.filter(":focus")),38==r.keyCode&&l>0&&l--,40==r.keyCode&&l<i.length-1&&l++,~l||(l=0),i.eq(l).focus())}}};var i=t.fn.dropdown;t.fn.dropdown=function(e){return this.each(function(){var n=t(this),a=n.data("dropdown");a||n.data("dropdown",a=new r(this)),"string"==typeof e&&a[e].call(n)})},t.fn.dropdown.Constructor=r,t.fn.dropdown.noConflict=function(){return t.fn.dropdown=i,this},t(document).on("click.dropdown.data-api",n).on("click.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.dropdown.data-api",e,r.prototype.toggle).on("keydown.dropdown.data-api",e+", [role=menu]",r.prototype.keydown)}(window.jQuery),function(t){"use strict";var e=function(e,r){this.options=r,this.$element=t(e).delegate('[data-dismiss="modal"]',"click.dismiss.modal",t.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};e.prototype={constructor:e,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var e=this,r=t.Event("show");this.$element.trigger(r),this.isShown||r.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.backdrop(function(){var r=t.support.transition&&e.$element.hasClass("fade");e.$element.parent().length||e.$element.appendTo(document.body),e.$element.show(),r&&e.$element[0].offsetWidth,e.$element.addClass("in").attr("aria-hidden",!1),e.enforceFocus(),r?e.$element.one(t.support.transition.end,function(){e.$element.focus().trigger("shown")}):e.$element.focus().trigger("shown")}))},hide:function(e){e&&e.preventDefault();e=t.Event("hide"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),t(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),t.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal())},enforceFocus:function(){var e=this;t(document).on("focusin.modal",function(t){e.$element[0]===t.target||e.$element.has(t.target).length||e.$element.focus()})},escape:function(){var t=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(e){27==e.which&&t.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var e=this,r=setTimeout(function(){e.$element.off(t.support.transition.end),e.hideModal()},500);this.$element.one(t.support.transition.end,function(){clearTimeout(r),e.hideModal()})},hideModal:function(){var t=this;this.$element.hide(),this.backdrop(function(){t.removeBackdrop(),t.$element.trigger("hidden")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(e){var r=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var n=t.support.transition&&r;if(this.$backdrop=t('<div class="modal-backdrop '+r+'" />').appendTo(document.body),this.$backdrop.click("static"==this.options.backdrop?t.proxy(this.$element[0].focus,this.$element[0]):t.proxy(this.hide,this)),n&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!e)return;n?this.$backdrop.one(t.support.transition.end,e):e()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(t.support.transition.end,e):e()):e&&e()}};var r=t.fn.modal;t.fn.modal=function(r){return this.each(function(){var n=t(this),a=n.data("modal"),i=t.extend({},t.fn.modal.defaults,n.data(),"object"==typeof r&&r);a||n.data("modal",a=new e(this,i)),"string"==typeof r?a[r]():i.show&&a.show()})},t.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},t.fn.modal.Constructor=e,t.fn.modal.noConflict=function(){return t.fn.modal=r,this},t(document).on("click.modal.data-api",'[data-toggle="modal"]',function(e){var r=t(this),n=r.attr("href"),a=t(r.attr("data-target")||n&&n.replace(/.*(?=#[^\s]+$)/,"")),i=a.data("modal")?"toggle":t.extend({remote:!/#/.test(n)&&n},a.data(),r.data());e.preventDefault(),a.modal(i).one("hide",function(){r.focus()})})}(window.jQuery),function(t){"use strict";var e=function(t,e){this.init("tooltip",t,e)};e.prototype={constructor:e,init:function(e,r,n){var a,i,s,o,l;for(this.type=e,this.$element=t(r),this.options=this.getOptions(n),this.enabled=!0,l=(s=this.options.trigger.split(" ")).length;l--;)"click"==(o=s[l])?this.$element.on("click."+this.type,this.options.selector,t.proxy(this.toggle,this)):"manual"!=o&&(a="hover"==o?"mouseenter":"focus",i="hover"==o?"mouseleave":"blur",this.$element.on(a+"."+this.type,this.options.selector,t.proxy(this.enter,this)),this.$element.on(i+"."+this.type,this.options.selector,t.proxy(this.leave,this)));this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(e){return(e=t.extend({},t.fn[this.type].defaults,this.$element.data(),e)).delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e},enter:function(e){var r,n=t.fn[this.type].defaults,a={};if(this._options&&t.each(this._options,function(t,e){n[t]!=e&&(a[t]=e)},this),!(r=t(e.currentTarget)[this.type](a).data(this.type)).options.delay||!r.options.delay.show)return r.show();clearTimeout(this.timeout),r.hoverState="in",this.timeout=setTimeout(function(){"in"==r.hoverState&&r.show()},r.options.delay.show)},leave:function(e){var r=t(e.currentTarget)[this.type](this._options).data(this.type);if(this.timeout&&clearTimeout(this.timeout),!r.options.delay||!r.options.delay.hide)return r.hide();r.hoverState="out",this.timeout=setTimeout(function(){"out"==r.hoverState&&r.hide()},r.options.delay.hide)},show:function(){var e,r,n,a,i,s,o=t.Event("show");if(this.hasContent()&&this.enabled){if(this.$element.trigger(o),o.isDefaultPrevented())return;switch(e=this.tip(),this.setContent(),this.options.animation&&e.addClass("fade"),i="function"==typeof this.options.placement?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement,e.detach().css({top:0,left:0,display:"block"}),this.options.container?e.appendTo(this.options.container):e.insertAfter(this.$element),r=this.getPosition(),n=e[0].offsetWidth,a=e[0].offsetHeight,i){case"bottom":s={top:r.top+r.height,left:r.left+r.width/2-n/2};break;case"top":s={top:r.top-a,left:r.left+r.width/2-n/2};break;case"left":s={top:r.top+r.height/2-a/2,left:r.left-n};break;case"right":s={top:r.top+r.height/2-a/2,left:r.left+r.width};break;case"topLeft":s={top:r.top-a,left:r.left+r.width/2-.1*n};break;case"topRight":s={top:r.top-a,left:r.left+r.width/2-.9*n};break;case"rightTop":s={top:r.top+r.height/2-.1*a,left:r.left+r.width};break;case"rightBottom":s={top:r.top+r.height/2-.9*a,left:r.left+r.width};break;case"bottomLeft":s={top:r.top+r.height,left:r.left+r.width/2-.1*n};break;case"bottomRight":s={top:r.top+r.height,left:r.left+r.width/2-.9*n};break;case"leftTop":s={top:r.top+r.height/2-.1*a,left:r.left-n};break;case"leftBottom":s={top:r.top+r.height/2-.9*a,left:r.left-n}}this.applyPlacement(s,i),this.$element.trigger("shown")}},applyPlacement:function(t,e){var r,n,a,i,s=this.tip(),o=s[0].offsetWidth,l=s[0].offsetHeight;s.offset(t).addClass(e).addClass("in"),r=s[0].offsetWidth,n=s[0].offsetHeight,"top"==e&&n!=l&&(t.top=t.top+l-n,i=!0),"bottom"==e||"top"==e?(a=0,t.left<0&&(a=-2*t.left,t.left=0,s.offset(t),r=s[0].offsetWidth,n=s[0].offsetHeight),this.replaceArrow(a-o+r,r,"left")):this.replaceArrow(n-l,n,"top"),i&&s.offset(t)},replaceArrow:function(t,e,r){this.arrow().css(r,t?50*(1-t/e)+"%":"")},setContent:function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e),t.removeClass("fade in top bottom left right")},hide:function(){var e=this.tip(),r=t.Event("hide");if(this.$element.trigger(r),!r.isDefaultPrevented())return e.removeClass("in"),t.support.transition&&this.$tip.hasClass("fade")?function(){var r=setTimeout(function(){e.off(t.support.transition.end).detach()},500);e.one(t.support.transition.end,function(){clearTimeout(r),e.detach()})}():e.detach(),this.$element.trigger("hidden"),this},fixTitle:function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},hasContent:function(){return this.getTitle()},getPosition:function(){var e=this.$element[0];return t.extend({},"function"==typeof e.getBoundingClientRect?e.getBoundingClientRect():{width:e.offsetWidth,height:e.offsetHeight},this.$element.offset())},getTitle:function(){var t=this.$element,e=this.options;return t.attr("data-original-title")||("function"==typeof e.title?e.title.call(t[0]):e.title)},tip:function(){return this.$tip=this.$tip||t(this.options.template)},arrow:function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(e){var r=e?t(e.currentTarget)[this.type](this._options).data(this.type):this;r.tip().hasClass("in")?r.hide():r.show()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}};var r=t.fn.tooltip;t.fn.tooltip=function(r){return this.each(function(){var n=t(this),a=n.data("tooltip"),i="object"==typeof r&&r;a||n.data("tooltip",a=new e(this,i)),"string"==typeof r&&a[r]()})},t.fn.tooltip.Constructor=e,t.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},t.fn.tooltip.noConflict=function(){return t.fn.tooltip=r,this}}(window.jQuery),function(t){"use strict";var e=function(e){this.element=t(e)};e.prototype={constructor:e,show:function(){var e,r,n,a=this.element,i=a.closest("ul:not(.dropdown-menu)"),s=a.attr("data-target");s||(s=(s=a.attr("href"))&&s.replace(/.*(?=#[^\s]*$)/,"")),a.parent("li").hasClass("active")||(e=i.find(".active:last a")[0],n=t.Event("show",{relatedTarget:e}),a.trigger(n),n.isDefaultPrevented()||(r=t(s),this.activate(a.parent("li"),i),this.activate(r,r.parent(),function(){a.trigger({type:"shown",relatedTarget:e})})))},activate:function(e,r,n){var a=r.find("> .active"),i=n&&t.support.transition&&a.hasClass("fade");function s(){a.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),e.addClass("active"),i?(e[0].offsetWidth,e.addClass("in")):e.removeClass("fade"),e.parent(".dropdown-menu")&&e.closest("li.dropdown").addClass("active"),n&&n()}i?a.one(t.support.transition.end,s):s(),a.removeClass("in")}};var r=t.fn.tab;t.fn.tab=function(r){return this.each(function(){var n=t(this),a=n.data("tab");a||n.data("tab",a=new e(this)),"string"==typeof r&&a[r]()})},t.fn.tab.Constructor=e,t.fn.tab.noConflict=function(){return t.fn.tab=r,this},t(document).on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(e){e.preventDefault(),t(this).tab("show")})}(window.jQuery),function(t){"use strict";var e=function(e,r){this.$element=t(e),this.options=t.extend({},t.fn.typeahead.defaults,r),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.source=this.options.source,this.$menu=t(this.options.menu),this.shown=!1,this.listen()};e.prototype={constructor:e,select:function(){var t=this.$menu.find(".active").attr("data-value")||this.$element.val();return this.$element.val(this.updater(t)).change(),this.hide()},updater:function(t){return t},show:function(){var e=t.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return this.$menu.insertAfter(this.$element).css({top:e.top+e.height,left:e.left}).show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(e){var r;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(r=t.isFunction(this.source)?this.source(this.query,t.proxy(this.process,this)):this.source)?this.process(r):this},process:function(e){var r=this;return e=t.grep(e,function(t){return r.matcher(t)}),(e=this.sorter(e)).length?this.render(e.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(t){return~t.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(t){for(var e,r=[],n=[],a=[];e=t.shift();)e.toLowerCase().indexOf(this.query.toLowerCase())?~e.indexOf(this.query)?n.push(e):a.push(e):r.push(e);return r.concat(n,a)},highlighter:function(t){var e=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return e?t.replace(new RegExp("("+e+")","ig"),function(t,e){return"<strong>"+e+"</strong>"}):t},render:function(e){var r=this;return e=t(e).map(function(e,n){return(e=t(r.options.item).attr("data-value",n)).find("a").html(r.highlighter(n)),e[0]}),this.$menu.html(e),this},next:function(e){var r=this.$menu.find(".active").removeClass("active").next();r.length||(r=t(this.$menu.find("li")[0])),r.addClass("active")},prev:function(t){var e=this.$menu.find(".active").removeClass("active").prev();e.length||(e=this.$menu.find("li").last()),e.addClass("active")},listen:function(){this.$element.on("focus",t.proxy(this.focus,this)).on("blur",t.proxy(this.blur,this)).on("keypress",t.proxy(this.keypress,this)).on("keyup",t.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",t.proxy(this.keydown,this)),this.$menu.on("click",t.proxy(this.click,this)).on("mouseenter","li",t.proxy(this.mouseenter,this)).on("mouseleave","li",t.proxy(this.mouseleave,this))},destroy:function(){this.$element.off().removeData("typeahead"),this.$menu.off()},eventSupported:function(t){var e=t in this.$element;return e||(this.$element.setAttribute(t,"return;"),e="function"==typeof this.$element[t]),e},move:function(t){if(this.shown&&(!t.shiftKey||40!==t.keyCode)){switch(t.keyCode){case 9:case 13:case 27:t.preventDefault();break;case 38:t.preventDefault(),this.prev();break;case 40:t.preventDefault(),this.next()}t.stopPropagation()}},keydown:function(e){this.suppressKeyPressRepeat=~t.inArray(e.keyCode,[40,38,9,13,27,57]),this.move(e)},keypress:function(t){this.suppressKeyPressRepeat||this.move(t)},keyup:function(t){switch(t.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}13===t.keyCode&&void 0===this.$menu.find(".active").attr("data-value")?this.$element.submit():(t.stopPropagation(),t.preventDefault())},focus:function(t){this.focused=!0},blur:function(t){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(t){t.stopPropagation(),t.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(e){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),t(e.currentTarget).addClass("active")},mouseleave:function(t){this.mousedover=!1,!this.focused&&this.shown&&this.hide()}};var r=t.fn.typeahead;t.fn.typeahead=function(r){return this.each(function(){var n=t(this),a=n.data("typeahead"),i="object"==typeof r&&r;a||n.data("typeahead",a=new e(this,i)),"string"==typeof r&&a[r]()})},t.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},t.fn.typeahead.Constructor=e,t.fn.typeahead.noConflict=function(){return t.fn.typeahead=r,this},t(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(e){var r=t(this);r.data("typeahead")||r.typeahead(r.data())})}(window.jQuery),function(t){"use strict";var e=function(e,r){this.options=t.extend({},t.fn.affix.defaults,r),this.$window=t(window).on("scroll.affix.data-api",t.proxy(this.checkPosition,this)).on("click.affix.data-api",t.proxy(function(){setTimeout(t.proxy(this.checkPosition,this),1)},this)),this.$element=t(e),this.checkPosition()};e.prototype.checkPosition=function(){if(this.$element.is(":visible")){var e,r=t(document).height(),n=this.$window.scrollTop(),a=this.$element.offset(),i=this.options.offset,s=i.bottom,o=i.top;"object"!=typeof i&&(s=o=i),"function"==typeof o&&(o=i.top()),"function"==typeof s&&(s=i.bottom()),e=!(null!=this.unpin&&n+this.unpin<=a.top)&&(null!=s&&a.top+this.$element.height()>=r-s?"bottom":null!=o&&n<=o&&"top"),this.affixed!==e&&(this.affixed=e,this.unpin="bottom"==e?a.top-n:null,this.$element.removeClass("affix affix-top affix-bottom").addClass("affix"+(e?"-"+e:"")))}};var r=t.fn.affix;t.fn.affix=function(r){return this.each(function(){var n=t(this),a=n.data("affix"),i="object"==typeof r&&r;a||n.data("affix",a=new e(this,i)),"string"==typeof r&&a[r]()})},t.fn.affix.Constructor=e,t.fn.affix.defaults={offset:0},t.fn.affix.noConflict=function(){return t.fn.affix=r,this},t(window).on("load",function(){t('[data-spy="affix"]').each(function(){var e=t(this),r=e.data();r.offset=r.offset||{},r.offsetBottom&&(r.offset.bottom=r.offsetBottom),r.offsetTop&&(r.offset.top=r.offsetTop),e.affix(r)})})}(window.jQuery)},function(t,e){angular.module("ui.bootstrap",["ui.bootstrap.tpls","ui.bootstrap.position","ui.bootstrap.dateparser","ui.bootstrap.datepicker"]),angular.module("ui.bootstrap.tpls",["template/datepicker/datepicker.html","template/datepicker/day.html","template/datepicker/month.html","template/datepicker/popup.html","template/datepicker/year.html"]),angular.module("ui.bootstrap.position",[]).factory("$position",["$document","$window",function(t,e){function r(t){return"static"===(function(t,r){return t.currentStyle?t.currentStyle[r]:e.getComputedStyle?e.getComputedStyle(t)[r]:t.style[r]}(t,"position")||"static")}return{position:function(e){var n=this.offset(e),a={top:0,left:0},i=function(e){for(var n=t[0],a=e.offsetParent||n;a&&a!==n&&r(a);)a=a.offsetParent;return a||n}(e[0]);i!=t[0]&&((a=this.offset(angular.element(i))).top+=i.clientTop-i.scrollTop,a.left+=i.clientLeft-i.scrollLeft);var s=e[0].getBoundingClientRect();return{width:s.width||e.prop("offsetWidth"),height:s.height||e.prop("offsetHeight"),top:n.top-a.top,left:n.left-a.left}},offset:function(r){var n=r[0].getBoundingClientRect();return{width:n.width||r.prop("offsetWidth"),height:n.height||r.prop("offsetHeight"),top:n.top+(e.pageYOffset||t[0].documentElement.scrollTop),left:n.left+(e.pageXOffset||t[0].documentElement.scrollLeft)}},positionElements:function(t,e,r,n){var a,i,s,o,l=r.split("-"),c=l[0],u=l[1]||"center";a=n?this.offset(t):this.position(t),i=e.prop("offsetWidth"),s=e.prop("offsetHeight");var d={center:function(){return a.left+a.width/2-i/2},left:function(){return a.left},right:function(){return a.left+a.width}},p={center:function(){return a.top+a.height/2-s/2},top:function(){return a.top},bottom:function(){return a.top+a.height}};switch(c){case"right":o={top:p[u](),left:d[c]()};break;case"left":o={top:p[u](),left:a.left-i};break;case"bottom":o={top:p[c](),left:d[u]()};break;default:o={top:a.top-s,left:d[u]()}}return o}}}]),angular.module("ui.bootstrap.dateparser",[]).service("dateParser",["$log","$locale","orderByFilter",function(t,e,r){var n=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;this.parsers={};var a={yyyy:{regex:"\\d{4}",apply:function(t){this.year=+t}},yy:{regex:"\\d{2}",apply:function(t){this.year=+t+2e3}},y:{regex:"\\d{1,4}",apply:function(t){this.year=+t}},MMMM:{regex:e.DATETIME_FORMATS.MONTH.join("|"),apply:function(t){this.month=e.DATETIME_FORMATS.MONTH.indexOf(t)}},MMM:{regex:e.DATETIME_FORMATS.SHORTMONTH.join("|"),apply:function(t){this.month=e.DATETIME_FORMATS.SHORTMONTH.indexOf(t)}},MM:{regex:"0[1-9]|1[0-2]",apply:function(t){this.month=t-1}},M:{regex:"[1-9]|1[0-2]",apply:function(t){this.month=t-1}},dd:{regex:"[0-2][0-9]{1}|3[0-1]{1}",apply:function(t){this.date=+t}},d:{regex:"[1-2]?[0-9]{1}|3[0-1]{1}",apply:function(t){this.date=+t}},EEEE:{regex:e.DATETIME_FORMATS.DAY.join("|")},EEE:{regex:e.DATETIME_FORMATS.SHORTDAY.join("|")},HH:{regex:"(?:0|1)[0-9]|2[0-3]",apply:function(t){this.hours=+t}},hh:{regex:"0[0-9]|1[0-2]",apply:function(t){this.hours=+t}},H:{regex:"1?[0-9]|2[0-3]",apply:function(t){this.hours=+t}},h:{regex:"[0-9]|1[0-2]",apply:function(t){this.hours=+t}},mm:{regex:"[0-5][0-9]",apply:function(t){this.minutes=+t}},m:{regex:"[0-9]|[1-5][0-9]",apply:function(t){this.minutes=+t}},sss:{regex:"[0-9][0-9][0-9]",apply:function(t){this.milliseconds=+t}},ss:{regex:"[0-5][0-9]",apply:function(t){this.seconds=+t}},s:{regex:"[0-9]|[1-5][0-9]",apply:function(t){this.seconds=+t}},a:{regex:e.DATETIME_FORMATS.AMPMS.join("|"),apply:function(t){12===this.hours&&(this.hours=0),"PM"===t&&(this.hours+=12)}}};this.parse=function(i,s,o){if(!angular.isString(i)||!s)return i;s=(s=e.DATETIME_FORMATS[s]||s).replace(n,"\\$&"),this.parsers[s]||(this.parsers[s]=function(t){var e=[],n=t.split("");return angular.forEach(a,function(r,a){var i=t.indexOf(a);if(i>-1){t=t.split(""),n[i]="("+r.regex+")",t[i]="$";for(var s=i+1,o=i+a.length;s<o;s++)n[s]="",t[s]="$";t=t.join(""),e.push({index:i,apply:r.apply})}}),{regex:new RegExp("^"+n.join("")+"$"),map:r(e,"index")}}(s));var l=this.parsers[s],c=l.regex,u=l.map,d=i.match(c);if(d&&d.length){var p,h;angular.isDate(o)&&!isNaN(o.getTime())?p={year:o.getFullYear(),month:o.getMonth(),date:o.getDate(),hours:o.getHours(),minutes:o.getMinutes(),seconds:o.getSeconds(),milliseconds:o.getMilliseconds()}:(o&&t.warn("dateparser:","baseDate is not a valid date"),p={year:1900,month:0,date:1,hours:0,minutes:0,seconds:0,milliseconds:0});for(var f=1,m=d.length;f<m;f++){var g=u[f-1];g.apply&&g.apply.call(p,d[f])}return function(t,e,r){if(r<1)return!1;if(1===e&&r>28)return 29===r&&(t%4==0&&t%100!=0||t%400==0);if(3===e||5===e||8===e||10===e)return r<31;return!0}(p.year,p.month,p.date)&&(h=new Date(p.year,p.month,p.date,p.hours,p.minutes,p.seconds,p.milliseconds||0)),h}}}]),angular.module("ui.bootstrap.datepicker",["ui.bootstrap.dateparser","ui.bootstrap.position"]).value("$datepickerSuppressError",!1).constant("datepickerConfig",{formatDay:"dd",formatMonth:"MMMM",formatYear:"yyyy",formatDayHeader:"EEE",formatDayTitle:"MMMM yyyy",formatMonthTitle:"yyyy",datepickerMode:"day",minMode:"day",maxMode:"year",showWeeks:!0,startingDay:0,yearRange:20,minDate:null,maxDate:null,shortcutPropagation:!1}).controller("DatepickerController",["$scope","$attrs","$parse","$interpolate","$log","dateFilter","datepickerConfig","$datepickerSuppressError",function(t,e,r,n,a,i,s,o){var l=this,c={$setViewValue:angular.noop};this.modes=["day","month","year"],angular.forEach(["formatDay","formatMonth","formatYear","formatDayHeader","formatDayTitle","formatMonthTitle","showWeeks","startingDay","yearRange","shortcutPropagation"],function(r,a){l[r]=angular.isDefined(e[r])?a<6?n(e[r])(t.$parent):t.$parent.$eval(e[r]):s[r]}),angular.forEach(["minDate","maxDate"],function(n){e[n]?t.$parent.$watch(r(e[n]),function(t){l[n]=t?new Date(t):null,l.refreshView()}):l[n]=s[n]?new Date(s[n]):null}),angular.forEach(["minMode","maxMode"],function(n){e[n]?t.$parent.$watch(r(e[n]),function(r){l[n]=angular.isDefined(r)?r:e[n],t[n]=l[n],("minMode"==n&&l.modes.indexOf(t.datepickerMode)<l.modes.indexOf(l[n])||"maxMode"==n&&l.modes.indexOf(t.datepickerMode)>l.modes.indexOf(l[n]))&&(t.datepickerMode=l[n])}):(l[n]=s[n]||null,t[n]=l[n])}),t.datepickerMode=t.datepickerMode||s.datepickerMode,t.uniqueId="datepicker-"+t.$id+"-"+Math.floor(1e4*Math.random()),angular.isDefined(e.initDate)?(this.activeDate=t.$parent.$eval(e.initDate)||new Date,t.$parent.$watch(e.initDate,function(t){t&&(c.$isEmpty(c.$modelValue)||c.$invalid)&&(l.activeDate=t,l.refreshView())})):this.activeDate=new Date,t.isActive=function(e){return 0===l.compare(e.date,l.activeDate)&&(t.activeDateId=e.uid,!0)},this.init=function(t){(c=t).$render=function(){l.render()}},this.render=function(){if(c.$viewValue){var t=new Date(c.$viewValue);!isNaN(t)?this.activeDate=t:o||a.error('Datepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.')}this.refreshView()},this.refreshView=function(){if(this.element){this._refreshView();var t=c.$viewValue?new Date(c.$viewValue):null;c.$setValidity("dateDisabled",!t||this.element&&!this.isDisabled(t))}},this.createDateObject=function(t,e){var r=c.$viewValue?new Date(c.$viewValue):null;return{date:t,label:i(t,e),selected:r&&0===this.compare(t,r),disabled:this.isDisabled(t),current:0===this.compare(t,new Date),customClass:this.customClass(t)}},this.isDisabled=function(r){return this.minDate&&this.compare(r,this.minDate)<0||this.maxDate&&this.compare(r,this.maxDate)>0||e.dateDisabled&&t.dateDisabled({date:r,mode:t.datepickerMode})},this.customClass=function(e){return t.customClass({date:e,mode:t.datepickerMode})},this.split=function(t,e){for(var r=[];t.length>0;)r.push(t.splice(0,e));return r},this.fixTimeZone=function(t){var e=t.getHours();t.setHours(23===e?e+2:0)},t.select=function(e){if(t.datepickerMode===l.minMode){var r=c.$viewValue?new Date(c.$viewValue):new Date(0,0,0,0,0,0,0);r.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),c.$setViewValue(r),c.$render()}else l.activeDate=e,t.datepickerMode=l.modes[l.modes.indexOf(t.datepickerMode)-1]},t.move=function(t){var e=l.activeDate.getFullYear()+t*(l.step.years||0),r=l.activeDate.getMonth()+t*(l.step.months||0);l.activeDate.setFullYear(e,r,1),l.refreshView()},t.toggleMode=function(e){e=e||1,t.datepickerMode===l.maxMode&&1===e||t.datepickerMode===l.minMode&&-1===e||(t.datepickerMode=l.modes[l.modes.indexOf(t.datepickerMode)+e])},t.keys={13:"enter",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down"};var u=function(){l.element[0].focus()};t.$on("datepicker.focus",u),t.keydown=function(e){var r=t.keys[e.which];if(r&&!e.shiftKey&&!e.altKey)if(e.preventDefault(),l.shortcutPropagation||e.stopPropagation(),"enter"===r||"space"===r){if(l.isDisabled(l.activeDate))return;t.select(l.activeDate),u()}else!e.ctrlKey||"up"!==r&&"down"!==r?(l.handleKeyDown(r,e),l.refreshView()):(t.toggleMode("up"===r?1:-1),u())}}]).directive("datepicker",function(){return{restrict:"EA",replace:!0,templateUrl:function(t,e){return e.templateUrl||"template/datepicker/datepicker.html"},scope:{datepickerMode:"=?",dateDisabled:"&",customClass:"&",shortcutPropagation:"&?"},require:["datepicker","^ngModel"],controller:"DatepickerController",controllerAs:"datepicker",link:function(t,e,r,n){var a=n[0],i=n[1];a.init(i)}}}).directive("daypicker",["dateFilter",function(t){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/day.html",require:"^datepicker",link:function(e,r,n,a){e.showWeeks=a.showWeeks,a.step={months:1},a.element=r;var i=[31,28,31,30,31,30,31,31,30,31,30,31];function s(t,e){return 1!==e||t%4!=0||t%100==0&&t%400!=0?i[e]:29}function o(t){var e=new Date(t);e.setDate(e.getDate()+4-(e.getDay()||7));var r=e.getTime();return e.setMonth(0),e.setDate(1),Math.floor(Math.round((r-e)/864e5)/7)+1}a._refreshView=function(){var r=a.activeDate.getFullYear(),n=a.activeDate.getMonth(),i=new Date(r,n,1),s=a.startingDay-i.getDay(),l=s>0?7-s:-s,c=new Date(i);l>0&&c.setDate(1-l);for(var u=function(t,e){for(var r,n=new Array(e),i=new Date(t),s=0;s<e;)r=new Date(i),a.fixTimeZone(r),n[s++]=r,i.setDate(i.getDate()+1);return n}(c,42),d=0;d<42;d++)u[d]=angular.extend(a.createDateObject(u[d],a.formatDay),{secondary:u[d].getMonth()!==n,uid:e.uniqueId+"-"+d});e.labels=new Array(7);for(var p=0;p<7;p++)e.labels[p]={abbr:t(u[p].date,a.formatDayHeader),full:t(u[p].date,"EEEE")};if(e.title=t(a.activeDate,a.formatDayTitle),e.rows=a.split(u,7),e.showWeeks){e.weekNumbers=[];for(var h=(11-a.startingDay)%7,f=e.rows.length,m=0;m<f;m++)e.weekNumbers.push(o(e.rows[m][h].date))}},a.compare=function(t,e){return new Date(t.getFullYear(),t.getMonth(),t.getDate())-new Date(e.getFullYear(),e.getMonth(),e.getDate())},a.handleKeyDown=function(t,e){var r=a.activeDate.getDate();if("left"===t)r-=1;else if("up"===t)r-=7;else if("right"===t)r+=1;else if("down"===t)r+=7;else if("pageup"===t||"pagedown"===t){var n=a.activeDate.getMonth()+("pageup"===t?-1:1);a.activeDate.setMonth(n,1),r=Math.min(s(a.activeDate.getFullYear(),a.activeDate.getMonth()),r)}else"home"===t?r=1:"end"===t&&(r=s(a.activeDate.getFullYear(),a.activeDate.getMonth()));a.activeDate.setDate(r)},a.refreshView()}}}]).directive("monthpicker",["dateFilter",function(t){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/month.html",require:"^datepicker",link:function(e,r,n,a){a.step={years:1},a.element=r,a._refreshView=function(){for(var r,n=new Array(12),i=a.activeDate.getFullYear(),s=0;s<12;s++)r=new Date(i,s,1),a.fixTimeZone(r),n[s]=angular.extend(a.createDateObject(r,a.formatMonth),{uid:e.uniqueId+"-"+s});e.title=t(a.activeDate,a.formatMonthTitle),e.rows=a.split(n,3)},a.compare=function(t,e){return new Date(t.getFullYear(),t.getMonth())-new Date(e.getFullYear(),e.getMonth())},a.handleKeyDown=function(t,e){var r=a.activeDate.getMonth();if("left"===t)r-=1;else if("up"===t)r-=3;else if("right"===t)r+=1;else if("down"===t)r+=3;else if("pageup"===t||"pagedown"===t){var n=a.activeDate.getFullYear()+("pageup"===t?-1:1);a.activeDate.setFullYear(n)}else"home"===t?r=0:"end"===t&&(r=11);a.activeDate.setMonth(r)},a.refreshView()}}}]).directive("yearpicker",["dateFilter",function(t){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/year.html",require:"^datepicker",link:function(t,e,r,n){var a=n.yearRange;function i(t){return parseInt((t-1)/a,10)*a+1}n.step={years:a},n.element=e,n._refreshView=function(){for(var e,r=new Array(a),s=0,o=i(n.activeDate.getFullYear());s<a;s++)e=new Date(o+s,0,1),n.fixTimeZone(e),r[s]=angular.extend(n.createDateObject(e,n.formatYear),{uid:t.uniqueId+"-"+s});t.title=[r[0].label,r[a-1].label].join(" - "),t.rows=n.split(r,5)},n.compare=function(t,e){return t.getFullYear()-e.getFullYear()},n.handleKeyDown=function(t,e){var r=n.activeDate.getFullYear();"left"===t?r-=1:"up"===t?r-=5:"right"===t?r+=1:"down"===t?r+=5:"pageup"===t||"pagedown"===t?r+=("pageup"===t?-1:1)*n.step.years:"home"===t?r=i(n.activeDate.getFullYear()):"end"===t&&(r=i(n.activeDate.getFullYear())+a-1),n.activeDate.setFullYear(r)},n.refreshView()}}}]).constant("datepickerPopupConfig",{datepickerPopup:"yyyy-MM-dd",datepickerPopupTemplateUrl:"template/datepicker/popup.html",datepickerTemplateUrl:"template/datepicker/datepicker.html",html5Types:{date:"yyyy-MM-dd","datetime-local":"yyyy-MM-ddTHH:mm:ss.sss",month:"yyyy-MM"},currentText:"Today",clearText:"Clear",closeText:"Done",closeOnDateSelection:!0,appendToBody:!1,showButtonBar:!0,onOpenFocus:!0}).directive("datepickerPopup",["$compile","$parse","$document","$rootScope","$position","dateFilter","dateParser","datepickerPopupConfig","$timeout",function(t,e,r,n,a,i,s,o,l){return{restrict:"EA",require:"ngModel",scope:{isOpen:"=?",currentText:"@",clearText:"@",closeText:"@",dateDisabled:"&",customClass:"&"},link:function(c,u,d,p){var h,f=angular.isDefined(d.closeOnDateSelection)?c.$parent.$eval(d.closeOnDateSelection):o.closeOnDateSelection,m=angular.isDefined(d.datepickerAppendToBody)?c.$parent.$eval(d.datepickerAppendToBody):o.appendToBody,g=angular.isDefined(d.onOpenFocus)?c.$parent.$eval(d.onOpenFocus):o.onOpenFocus,v=angular.isDefined(d.datepickerPopupTemplateUrl)?d.datepickerPopupTemplateUrl:o.datepickerPopupTemplateUrl,b=angular.isDefined(d.datepickerTemplateUrl)?d.datepickerTemplateUrl:o.datepickerTemplateUrl,y={};c.showButtonBar=angular.isDefined(d.showButtonBar)?c.$parent.$eval(d.showButtonBar):o.showButtonBar,c.getText=function(t){return c[t+"Text"]||o[t+"Text"]},c.isDisabled=function(t){return"today"===t&&(t=new Date),c.watchData.minDate&&c.compare(t,y.minDate)<0||c.watchData.maxDate&&c.compare(t,y.maxDate)>0},c.compare=function(t,e){return new Date(t.getFullYear(),t.getMonth(),t.getDate())-new Date(e.getFullYear(),e.getMonth(),e.getDate())};var w=!1;if(o.html5Types[d.type]?(h=o.html5Types[d.type],w=!0):(h=d.datepickerPopup||o.datepickerPopup,d.$observe("datepickerPopup",function(t,e){var r=t||o.datepickerPopup;if(r!==h&&(h=r,p.$modelValue=null,!h))throw new Error("datepickerPopup must have a date format specified.")})),!h)throw new Error("datepickerPopup must have a date format specified.");if(w&&d.datepickerPopup)throw new Error("HTML5 date input types do not support custom formats.");var x=angular.element("<div datepicker-popup-wrap><div datepicker></div></div>");function S(t){return t.replace(/([A-Z])/g,function(t){return"-"+t.toLowerCase()})}x.attr({"ng-model":"date","ng-change":"dateSelection(date)","template-url":v});var k=angular.element(x.children()[0]);if(k.attr("template-url",b),w&&"month"===d.type&&(k.attr("datepicker-mode",'"month"'),k.attr("min-mode","month")),d.datepickerOptions){var C=c.$parent.$eval(d.datepickerOptions);C&&C.initDate&&(c.initDate=C.initDate,k.attr("init-date","initDate"),delete C.initDate),angular.forEach(C,function(t,e){k.attr(S(e),t)})}c.watchData={},angular.forEach(["minMode","maxMode","minDate","maxDate","datepickerMode","initDate","shortcutPropagation"],function(t){if(d[t]){var r=e(d[t]);if(c.$parent.$watch(r,function(e){c.watchData[t]=e,"minDate"!==t&&"maxDate"!==t||(y[t]=new Date(e))}),k.attr(S(t),"watchData."+t),"datepickerMode"===t){var n=r.assign;c.$watch("watchData."+t,function(t,e){angular.isFunction(n)&&t!==e&&n(c.$parent,t)})}}}),d.dateDisabled&&k.attr("date-disabled","dateDisabled({ date: date, mode: mode })"),d.showWeeks&&k.attr("show-weeks",d.showWeeks),d.customClass&&k.attr("custom-class","customClass({ date: date, mode: mode })"),w?p.$formatters.push(function(t){return c.date=t,t}):(p.$$parserName="date",p.$validators.date=function(t,e){var r=t||e;if(!d.ngRequired&&!r)return!0;if(angular.isNumber(r)&&(r=new Date(r)),r){if(angular.isDate(r)&&!isNaN(r))return!0;if(angular.isString(r)){var n=s.parse(r,h);return!isNaN(n)}return!1}return!0},p.$parsers.unshift(function(t){if(angular.isNumber(t)&&(t=new Date(t)),!t)return null;if(angular.isDate(t)&&!isNaN(t))return t;if(angular.isString(t)){var e=s.parse(t,h,c.date);return isNaN(e)?void 0:e}}),p.$formatters.push(function(t){return c.date=t,p.$isEmpty(t)?t:i(t,h)})),c.dateSelection=function(t){angular.isDefined(t)&&(c.date=t);var e=c.date?i(c.date,h):null;u.val(e),p.$setViewValue(e),f&&(c.isOpen=!1,u[0].focus())},p.$viewChangeListeners.push(function(){c.date=s.parse(p.$viewValue,h,c.date)});var T=function(t){!c.isOpen||u[0].contains(t.target)||x[0].contains(t.target)||c.$apply(function(){c.isOpen=!1})},E=function(t){27===t.which&&c.isOpen?(t.preventDefault(),t.stopPropagation(),c.$apply(function(){c.isOpen=!1}),u[0].focus()):40!==t.which||c.isOpen||(t.preventDefault(),t.stopPropagation(),c.$apply(function(){c.isOpen=!0}))};u.bind("keydown",E),c.keydown=function(t){27===t.which&&(c.isOpen=!1,u[0].focus())},c.$watch("isOpen",function(t){t?(c.position=m?a.offset(u):a.position(u),c.position.top=c.position.top+u.prop("offsetHeight"),l(function(){g&&c.$broadcast("datepicker.focus"),r.bind("click",T)},0,!1)):r.unbind("click",T)}),c.select=function(t){if("today"===t){var e=new Date;angular.isDate(c.date)?(t=new Date(c.date)).setFullYear(e.getFullYear(),e.getMonth(),e.getDate()):t=new Date(e.setHours(0,0,0,0))}c.dateSelection(t)},c.close=function(){c.isOpen=!1,u[0].focus()};var _=t(x)(c);x.remove(),m?r.find("body").append(_):u.after(_),c.$on("$destroy",function(){!0===c.isOpen&&(n.$$phase||c.$apply(function(){c.isOpen=!1})),_.remove(),u.unbind("keydown",E),r.unbind("click",T)})}}}]).directive("datepickerPopupWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:function(t,e){return e.templateUrl||"template/datepicker/popup.html"}}}),angular.module("template/datepicker/datepicker.html",[]).run(["$templateCache",function(t){t.put("template/datepicker/datepicker.html",'<div ng-switch="datepickerMode" role="application" ng-keydown="keydown($event)">\n  <daypicker ng-switch-when="day" tabindex="0"></daypicker>\n  <monthpicker ng-switch-when="month" tabindex="0"></monthpicker>\n  <yearpicker ng-switch-when="year" tabindex="0"></yearpicker>\n</div>')}]),angular.module("template/datepicker/day.html",[]).run(["$templateCache",function(t){t.put("template/datepicker/day.html",'<table role="grid" aria-labelledby="{{::uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th colspan="{{::5 + showWeeks}}"><button id="{{::uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" ng-disabled="datepickerMode === maxMode" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n    <tr>\n      <th ng-if="showWeeks" class="text-center"></th>\n      <th ng-repeat="label in ::labels track by $index" class="text-center"><small aria-label="{{::label.full}}">{{::label.abbr}}</small></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-if="showWeeks" class="text-center h6"><em>{{ weekNumbers[$index] }}</em></td>\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{::dt.uid}}" ng-class="::dt.customClass">\n        <button type="button" style="min-width:100%;" class="btn btn-default btn-sm" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="::{\'text-muted\': dt.secondary, \'text-info\': dt.current}">{{::dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/datepicker/month.html",[]).run(["$templateCache",function(t){t.put("template/datepicker/month.html",'<table role="grid" aria-labelledby="{{::uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th><button id="{{::uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" ng-disabled="datepickerMode === maxMode" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{::dt.uid}}" ng-class="::dt.customClass">\n        <button type="button" style="min-width:100%;" class="btn btn-default" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="::{\'text-info\': dt.current}" class="text-info">{{::dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/datepicker/popup.html",[]).run(["$templateCache",function(t){t.put("template/datepicker/popup.html",'<ul class="dropdown-menu" ng-if="isOpen" style="display: block" ng-style="{top: position.top+\'px\', left: position.left+\'px\'}" ng-keydown="keydown($event)" ng-click="$event.stopPropagation()">\n\t<li ng-transclude></li>\n\t<li ng-if="showButtonBar" style="padding:10px 9px 2px">\n\t\t<span class="btn-group pull-left">\n\t\t\t<button type="button" class="btn btn-sm btn-info" ng-click="select(\'today\')" ng-disabled="isDisabled(\'today\')">{{ getText(\'current\') }}</button>\n\t\t\t<button type="button" class="btn btn-sm btn-danger" ng-click="select(null)">{{ getText(\'clear\') }}</button>\n\t\t</span>\n\t\t<button type="button" class="btn btn-sm btn-success pull-right" ng-click="close()">{{ getText(\'close\') }}</button>\n\t</li>\n</ul>\n')}]),angular.module("template/datepicker/year.html",[]).run(["$templateCache",function(t){t.put("template/datepicker/year.html",'<table role="grid" aria-labelledby="{{::uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th colspan="3"><button id="{{::uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" ng-disabled="datepickerMode === maxMode" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{::dt.uid}}">\n        <button type="button" style="min-width:100%;" class="btn btn-default" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="::{\'text-info\': dt.current}" class="text-info">{{::dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}])},function(t,e){
/**
 * AngularStrap - Twitter Bootstrap directives for AngularJS
 * @version v0.7.5 - 2013-07-21
 * @link http://mgcrea.github.com/angular-strap
 * @author Olivier Louvignes <olivier@mg-crea.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
angular.module("$strap.config",[]).value("$strapConfig",{}),angular.module("$strap.filters",["$strap.config"]),angular.module("$strap.directives",["$strap.config"]),angular.module("$strap",["$strap.filters","$strap.directives","$strap.config"]),angular.module("$strap.directives").factory("$modal",["$rootScope","$compile","$http","$timeout","$q","$templateCache","$strapConfig",function(t,e,r,n,a,i,s){return function(o){return new function(o){var l=angular.extend({show:!0},s.modal,o),c=l.scope?l.scope:t.$new(),u=l.template;return a.when(l.templateHtml||i.get(u)||r.get(u,{cache:!0}).then(function(t){return t.data})).then(function(t){var r=c.$id;u&&(r+=u.replace(".html","").replace(/[\/|\.|:]/g,"-"));var a=$('<div class="modal hide" tabindex="-1"></div>').attr("id",r).html(t);return l.modalClass&&a.addClass(l.modalClass),$("body").append(a),n(function(){e(a)(c)}),c.$modal=function(t){a.modal(t)},angular.forEach(["show","hide"],function(t){c[t]=function(){a.modal(t)}}),c.dismiss=c.hide,angular.forEach(["show","shown","hide","hidden"],function(t){a.on(t,function(e){c.$emit("modal-"+t,e)})}),a.on("shown",function(t){$("input[autofocus], textarea[autofocus]",a).first().trigger("focus")}),a.on("hidden",function(t){l.persist||c.$destroy()}),c.$on("$destroy",function(){a.remove()}),a.modal(l),a})}(o)}}]),angular.module("$strap.directives").directive("bsTooltip",["$parse","$compile",function(t,e){return{restrict:"A",scope:!0,link:function(e,r,n,a){var i=t(n.bsTooltip),s=(i.assign,i(e));e.$watch(n.bsTooltip,function(t,e){t!==e&&(s=t)}),r.on("show",function(t){$(".tooltip.in").each(function(){var t=$(this),e=t.data("tooltip");e&&!e.$element.is(r)&&t.tooltip("hide")})}),r.tooltip({title:function(){return angular.isFunction(s)?s.apply(null,arguments):s},html:!0,container:"body"}),r.data("tooltip").show=function(){var t=$.fn.tooltip.Constructor.prototype.show.apply(this,arguments);return this.tip().data("tooltip",this),t},e._tooltip=function(t){r.tooltip(t)},e.hide=function(){r.tooltip("hide")},e.show=function(){r.tooltip("show")},e.dismiss=e.hide}}}]),angular.module("$strap.directives").directive("bsTypeahead",["$parse",function(t){return{restrict:"A",require:"?ngModel",link:function(e,r,n,a){var i=t(n.bsTypeahead),s=(i.assign,i(e));e.$watch(n.bsTypeahead,function(t,e){t!==e&&(s=t)}),r.attr("data-provide","typeahead"),r.typeahead({source:function(t){return angular.isFunction(s)?s.apply(null,arguments):s},minLength:n.minLength||1,items:n.items,updater:function(t){return a&&e.$apply(function(){a.$setViewValue(t)}),e.$emit("typeahead-updated",t),t}});var o=r.data("typeahead");o.lookup=function(t){var e;return this.query=this.$element.val()||"",this.query.length<this.options.minLength?this.shown?this.hide():this:(e=$.isFunction(this.source)?this.source(this.query,$.proxy(this.process,this)):this.source)?this.process(e):this},n.matchAll&&(o.matcher=function(t){return!0}),"0"===n.minLength&&setTimeout(function(){r.on("focus",function(){0===r.val().length&&setTimeout(r.typeahead.bind(r,"lookup"),200)})})}}}])},function(t,e,r){var n={"./af":390,"./af.js":390,"./ar":391,"./ar-dz":392,"./ar-dz.js":392,"./ar-kw":393,"./ar-kw.js":393,"./ar-ly":394,"./ar-ly.js":394,"./ar-ma":395,"./ar-ma.js":395,"./ar-sa":396,"./ar-sa.js":396,"./ar-tn":397,"./ar-tn.js":397,"./ar.js":391,"./az":398,"./az.js":398,"./be":399,"./be.js":399,"./bg":400,"./bg.js":400,"./bm":401,"./bm.js":401,"./bn":402,"./bn.js":402,"./bo":403,"./bo.js":403,"./br":404,"./br.js":404,"./bs":405,"./bs.js":405,"./ca":406,"./ca.js":406,"./cs":407,"./cs.js":407,"./cv":408,"./cv.js":408,"./cy":409,"./cy.js":409,"./da":410,"./da.js":410,"./de":411,"./de-at":412,"./de-at.js":412,"./de-ch":413,"./de-ch.js":413,"./de.js":411,"./dv":414,"./dv.js":414,"./el":415,"./el.js":415,"./en-au":416,"./en-au.js":416,"./en-ca":417,"./en-ca.js":417,"./en-gb":418,"./en-gb.js":418,"./en-ie":419,"./en-ie.js":419,"./en-il":420,"./en-il.js":420,"./en-nz":421,"./en-nz.js":421,"./eo":422,"./eo.js":422,"./es":423,"./es-do":424,"./es-do.js":424,"./es-us":425,"./es-us.js":425,"./es.js":423,"./et":426,"./et.js":426,"./eu":427,"./eu.js":427,"./fa":428,"./fa.js":428,"./fi":429,"./fi.js":429,"./fo":430,"./fo.js":430,"./fr":431,"./fr-ca":432,"./fr-ca.js":432,"./fr-ch":433,"./fr-ch.js":433,"./fr.js":431,"./fy":434,"./fy.js":434,"./gd":435,"./gd.js":435,"./gl":436,"./gl.js":436,"./gom-latn":437,"./gom-latn.js":437,"./gu":438,"./gu.js":438,"./he":439,"./he.js":439,"./hi":440,"./hi.js":440,"./hr":441,"./hr.js":441,"./hu":442,"./hu.js":442,"./hy-am":443,"./hy-am.js":443,"./id":444,"./id.js":444,"./is":445,"./is.js":445,"./it":446,"./it.js":446,"./ja":447,"./ja.js":447,"./jv":448,"./jv.js":448,"./ka":449,"./ka.js":449,"./kk":450,"./kk.js":450,"./km":451,"./km.js":451,"./kn":452,"./kn.js":452,"./ko":453,"./ko.js":453,"./ky":454,"./ky.js":454,"./lb":455,"./lb.js":455,"./lo":456,"./lo.js":456,"./lt":457,"./lt.js":457,"./lv":458,"./lv.js":458,"./me":459,"./me.js":459,"./mi":460,"./mi.js":460,"./mk":461,"./mk.js":461,"./ml":462,"./ml.js":462,"./mn":463,"./mn.js":463,"./mr":464,"./mr.js":464,"./ms":465,"./ms-my":466,"./ms-my.js":466,"./ms.js":465,"./mt":467,"./mt.js":467,"./my":468,"./my.js":468,"./nb":469,"./nb.js":469,"./ne":470,"./ne.js":470,"./nl":471,"./nl-be":472,"./nl-be.js":472,"./nl.js":471,"./nn":473,"./nn.js":473,"./pa-in":474,"./pa-in.js":474,"./pl":475,"./pl.js":475,"./pt":476,"./pt-br":477,"./pt-br.js":477,"./pt.js":476,"./ro":478,"./ro.js":478,"./ru":479,"./ru.js":479,"./sd":480,"./sd.js":480,"./se":481,"./se.js":481,"./si":482,"./si.js":482,"./sk":483,"./sk.js":483,"./sl":484,"./sl.js":484,"./sq":485,"./sq.js":485,"./sr":486,"./sr-cyrl":487,"./sr-cyrl.js":487,"./sr.js":486,"./ss":488,"./ss.js":488,"./sv":489,"./sv.js":489,"./sw":490,"./sw.js":490,"./ta":491,"./ta.js":491,"./te":492,"./te.js":492,"./tet":493,"./tet.js":493,"./tg":494,"./tg.js":494,"./th":495,"./th.js":495,"./tl-ph":496,"./tl-ph.js":496,"./tlh":497,"./tlh.js":497,"./tr":498,"./tr.js":498,"./tzl":499,"./tzl.js":499,"./tzm":500,"./tzm-latn":501,"./tzm-latn.js":501,"./tzm.js":500,"./ug-cn":502,"./ug-cn.js":502,"./uk":503,"./uk.js":503,"./ur":504,"./ur.js":504,"./uz":505,"./uz-latn":506,"./uz-latn.js":506,"./uz.js":505,"./vi":507,"./vi.js":507,"./x-pseudo":508,"./x-pseudo.js":508,"./yo":509,"./yo.js":509,"./zh-cn":510,"./zh-cn.js":510,"./zh-hk":511,"./zh-hk.js":511,"./zh-tw":512,"./zh-tw.js":512};function a(t){var e=i(t);return r(e)}function i(t){var e=n[t];if(!(e+1)){var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}return e}a.keys=function(){return Object.keys(n)},a.resolve=i,t.exports=a,a.id=863},,,,,,,,function(t,e){!function(t){"use strict";var e={tagClass:function(t){return"label label-info"},itemValue:function(t){return t?t.toString():t},itemText:function(t){return this.itemValue(t)},freeInput:!0,maxTags:void 0,confirmKeys:[13],onTagExists:function(t,e){e.hide().fadeIn()}};function r(e,r){this.itemsArray=[],this.$element=t(e),this.$element.hide(),this.widthClass=r.widthClass||"width-9",this.isSelect="SELECT"===e.tagName,this.multiple=this.isSelect&&e.hasAttribute("multiple"),this.objectItems=r&&r.itemValue,this.placeholderText=e.hasAttribute("placeholder")?this.$element.attr("placeholder"):"",this.$container=t('<div class="bootstrap-tagsinput"></div>'),this.$input=t('<input class="gf-form-input '+this.widthClass+'" type="text" placeholder="'+this.placeholderText+'"/>').appendTo(this.$container),this.$element.after(this.$container),this.build(r)}function n(t,e){if("function"!=typeof t[e]){var r=t[e];t[e]=function(t){return t[r]}}}r.prototype={constructor:r,add:function(e,r){var n=this;if(!(n.options.maxTags&&n.itemsArray.length>=n.options.maxTags)&&(!1===e||e)){if("object"==typeof e&&!n.objectItems)throw"Can't add objects when itemValue option is not set";if(!e.toString().match(/^\s*$/)){if(n.isSelect&&!n.multiple&&n.itemsArray.length>0&&n.remove(n.itemsArray[0]),"string"==typeof e&&"INPUT"===this.$element[0].tagName){var a=e.split(",");if(a.length>1){for(var s=0;s<a.length;s++)this.add(a[s],!0);return void(r||n.pushVal())}}var o=n.options.itemValue(e),l=n.options.itemText(e),c=n.options.tagClass(e),u=t.grep(n.itemsArray,function(t){return n.options.itemValue(t)===o})[0];if(u){if(n.options.onTagExists){var d=t(".tag",n.$container).filter(function(){return t(this).data("item")===u});n.options.onTagExists(e,d)}}else{n.itemsArray.push(e);var p=t('<span class="tag '+i(c)+'">'+i(l)+'<span data-role="remove"></span></span>');if(p.data("item",e),n.findInputWrapper().before(p),p.after(" "),n.isSelect&&!t('option[value="'+escape(o)+'"]',n.$element)[0]){var h=t("<option selected>"+i(l)+"</option>");h.data("item",e),h.attr("value",o),n.$element.append(h)}r||n.pushVal(),n.options.maxTags===n.itemsArray.length&&n.$container.addClass("bootstrap-tagsinput-max"),n.$element.trigger(t.Event("itemAdded",{item:e}))}}}},remove:function(e,r){var n=this;n.objectItems&&(e="object"==typeof e?t.grep(n.itemsArray,function(t){return n.options.itemValue(t)==n.options.itemValue(e)})[0]:t.grep(n.itemsArray,function(t){return n.options.itemValue(t)==e})[0]),e&&(t(".tag",n.$container).filter(function(){return t(this).data("item")===e}).remove(),t("option",n.$element).filter(function(){return t(this).data("item")===e}).remove(),n.itemsArray.splice(t.inArray(e,n.itemsArray),1)),r||n.pushVal(),n.options.maxTags>n.itemsArray.length&&n.$container.removeClass("bootstrap-tagsinput-max"),n.$element.trigger(t.Event("itemRemoved",{item:e}))},removeAll:function(){for(t(".tag",this.$container).remove(),t("option",this.$element).remove();this.itemsArray.length>0;)this.itemsArray.pop();this.pushVal(),this.options.maxTags&&!this.isEnabled()&&this.enable()},refresh:function(){var e=this;t(".tag",e.$container).each(function(){var r=t(this),n=r.data("item"),a=e.options.itemValue(n),s=e.options.itemText(n),o=e.options.tagClass(n);(r.attr("class",null),r.addClass("tag "+i(o)),r.contents().filter(function(){return 3==this.nodeType})[0].nodeValue=i(s),e.isSelect)&&t("option",e.$element).filter(function(){return t(this).data("item")===n}).attr("value",a)})},items:function(){return this.itemsArray},pushVal:function(){var e=this,r=t.map(e.items(),function(t){return e.options.itemValue(t).toString()});e.$element.val(r,!0).trigger("change")},build:function(r){var a=this;a.options=t.extend({},e,r);var i=a.options.typeahead||{};a.objectItems&&(a.options.freeInput=!1),n(a.options,"itemValue"),n(a.options,"itemText"),n(a.options,"tagClass"),a.options.source&&(i.source=a.options.source),i.source&&t.fn.typeahead&&(!function(t,e){if("function"!=typeof t[e]){var r=t[e];t[e]=function(){return r}}}(i,"source"),a.$input.typeahead({source:function(e,r){function n(t){for(var e=[],n=0;n<t.length;n++){var i=a.options.itemText(t[n]);s[i]=t[n],e.push(i)}r(e)}this.map={};var s=this.map,o=i.source(e);t.isFunction(o.success)?o.success(n):t.when(o).then(n)},updater:function(t){a.add(this.map[t])},matcher:function(t){return-1!==t.toLowerCase().indexOf(this.query.trim().toLowerCase())},sorter:function(t){return t.sort()},highlighter:function(t){var e=new RegExp("("+this.query+")","gi");return t.replace(e,"<strong>$1</strong>")}})),a.$container.on("click",t.proxy(function(t){a.$input.focus()},a)),a.$container.on("blur","input",t.proxy(function(e){var r=t(e.target);a.add(r.val()),r.val(""),e.preventDefault()},a)),a.$container.on("keydown","input",t.proxy(function(e){var r=t(e.target),n=a.findInputWrapper();switch(e.which){case 8:if(0===s(r[0])){var i=n.prev();i&&a.remove(i.data("item"))}break;case 46:if(0===s(r[0])){var o=n.next();o&&a.remove(o.data("item"))}break;case 37:var l=n.prev();0===r.val().length&&l[0]&&(l.before(n),r.focus());break;case 39:var c=n.next();0===r.val().length&&c[0]&&(c.after(n),r.focus());break;default:a.options.freeInput&&t.inArray(e.which,a.options.confirmKeys)>=0&&(a.add(r.val()),r.val(""),e.preventDefault())}r.attr("size",Math.max(this.inputSize,r.val().length))},a)),a.$container.on("click","[data-role=remove]",t.proxy(function(e){a.remove(t(e.target).closest(".tag").data("item")),e.stopPropagation()},a)),a.options.itemValue===e.itemValue&&("INPUT"===a.$element[0].tagName?a.add(a.$element.val()):t("option",a.$element).each(function(){a.add(t(this).attr("value"),!0)}))},destroy:function(){this.$container.off("keypress","input"),this.$container.off("click","[role=remove]"),this.$container.remove(),this.$element.removeData("tagsinput"),this.$element.show()},focus:function(){this.$input.focus()},input:function(){return this.$input},findInputWrapper:function(){for(var e=this.$input[0],r=this.$container[0];e&&e.parentNode!==r;)e=e.parentNode;return t(e)}},t.fn.tagsinput=function(e,n){var a=[];return this.each(function(){var i=t(this).data("tagsinput");if(i){var s=i[e](n);void 0!==s&&a.push(s)}else i=new r(this,e),t(this).data("tagsinput",i),a.push(i),"SELECT"===this.tagName&&t("option",t(this)).attr("selected","selected"),t(this).val(t(this).val())}),"string"==typeof e?a.length>1?a:a[0]:a},t.fn.tagsinput.Constructor=r;var a=t("<div />");function i(t){return t?a.text(t).html():""}function s(t){var e=0;if(document.selection){t.focus();var r=document.selection.createRange();r.moveStart("character",-t.value.length),e=r.text.length}else(t.selectionStart||"0"==t.selectionStart)&&(e=t.selectionStart);return e}t(function(){t("input[data-role=tagsinput], select[multiple][data-role=tagsinput]").tagsinput()})}(window.jQuery)},function(t,e,r){var n=r(873);n.keys().forEach(function(t){n(t)})},function(t,e,r){var n={"./core/components/help/help.html":874,"./core/components/manage_dashboards/manage_dashboards.html":875,"./core/components/navbar/navbar.html":876,"./core/components/search/search.html":877,"./core/components/search/search_results.html":878,"./features/admin/partials/admin_home.html":879,"./features/admin/partials/edit_org.html":880,"./features/admin/partials/edit_user.html":881,"./features/admin/partials/new_user.html":882,"./features/admin/partials/orgs.html":883,"./features/admin/partials/settings.html":884,"./features/admin/partials/stats.html":885,"./features/admin/partials/styleguide.html":886,"./features/admin/partials/users.html":887,"./features/alerting/partials/alert_howto.html":888,"./features/alerting/partials/alert_tab.html":889,"./features/alerting/partials/notification_edit.html":890,"./features/alerting/partials/notifications_list.html":891,"./features/annotations/partials/editor.html":892,"./features/annotations/partials/event_editor.html":893,"./features/dashboard/dashlinks/editor.html":894,"./features/dashboard/dashnav/dashnav.html":895,"./features/dashboard/export/export_modal.html":896,"./features/dashboard/export_data/export_data_modal.html":897,"./features/dashboard/folder_picker/folder_picker.html":898,"./features/dashboard/history/history.html":899,"./features/dashboard/move_to_folder_modal/move_to_folder.html":900,"./features/dashboard/panellinks/module.html":901,"./features/dashboard/partials/create_folder.html":902,"./features/dashboard/partials/dashboard_import.html":903,"./features/dashboard/partials/folder_dashboards.html":904,"./features/dashboard/partials/folder_permissions.html":905,"./features/dashboard/partials/folder_settings.html":906,"./features/dashboard/partials/inspector.html":907,"./features/dashboard/partials/row_options.html":908,"./features/dashboard/partials/shareModal.html":909,"./features/dashboard/settings/settings.html":910,"./features/dashboard/submenu/submenu.html":911,"./features/dashboard/timepicker/settings.html":912,"./features/dashboard/timepicker/timepicker.html":913,"./features/manage-dashboards/partials/dashboard_list.html":914,"./features/manage-dashboards/partials/snapshot_list.html":915,"./features/org/partials/invite.html":916,"./features/org/partials/newOrg.html":917,"./features/org/partials/select_org.html":918,"./features/panel/partials/metrics_tab.html":919,"./features/panel/partials/panelTime.html":920,"./features/panel/partials/query_editor_row.html":921,"./features/panel/partials/soloPanel.html":922,"./features/playlist/partials/playlist.html":923,"./features/playlist/partials/playlist_search.html":924,"./features/playlist/partials/playlists.html":925,"./features/plugins/import_list/import_list.html":926,"./features/plugins/partials/ds_edit.html":927,"./features/plugins/partials/ds_http_settings.html":928,"./features/plugins/partials/plugin_edit.html":929,"./features/plugins/partials/plugin_page.html":930,"./features/plugins/partials/update_instructions.html":931,"./features/profile/partials/change_password.html":932,"./features/profile/partials/profile.html":933,"./features/teams/partials/create_team.html":934,"./features/templating/partials/editor.html":935,"./partials/confirm_modal.html":936,"./partials/dashboard.html":937,"./partials/edit_json.html":938,"./partials/error.html":939,"./partials/login.html":940,"./partials/metrics-options.html":941,"./partials/modal.html":942,"./partials/oge_alert.html":943,"./partials/panelgeneral.html":944,"./partials/reset_password.html":945,"./partials/signup_invited.html":946,"./partials/signup_step2.html":947,"./partials/valueSelectDropdown.html":948,"./partials/valueSelectUnfold.html":949,"./plugins/datasource/cloudwatch/partials/annotations.editor.html":950,"./plugins/datasource/cloudwatch/partials/config.html":951,"./plugins/datasource/cloudwatch/partials/query.editor.html":952,"./plugins/datasource/cloudwatch/partials/query.parameter.html":953,"./plugins/datasource/elasticsearch/partials/annotations.editor.html":954,"./plugins/datasource/elasticsearch/partials/bucket_agg.html":955,"./plugins/datasource/elasticsearch/partials/config.html":956,"./plugins/datasource/elasticsearch/partials/metric_agg.html":957,"./plugins/datasource/elasticsearch/partials/query.editor.html":958,"./plugins/datasource/grafana-live/partials/query.editor.html":959,"./plugins/datasource/grafana/partials/annotations.editor.html":960,"./plugins/datasource/grafana/partials/query.editor.html":961,"./plugins/datasource/graphite/partials/annotations.editor.html":962,"./plugins/datasource/graphite/partials/config.html":963,"./plugins/datasource/graphite/partials/query.editor.html":964,"./plugins/datasource/influxdb/partials/annotations.editor.html":965,"./plugins/datasource/influxdb/partials/config.html":966,"./plugins/datasource/influxdb/partials/query.editor.html":967,"./plugins/datasource/logging/partials/config.html":968,"./plugins/datasource/mssql/partials/annotations.editor.html":969,"./plugins/datasource/mssql/partials/config.html":970,"./plugins/datasource/mssql/partials/query.editor.html":971,"./plugins/datasource/mysql/partials/annotations.editor.html":972,"./plugins/datasource/mysql/partials/config.html":973,"./plugins/datasource/mysql/partials/query.editor.html":974,"./plugins/datasource/opentsdb/partials/annotations.editor.html":975,"./plugins/datasource/opentsdb/partials/config.html":976,"./plugins/datasource/opentsdb/partials/query.editor.html":977,"./plugins/datasource/postgres/partials/annotations.editor.html":978,"./plugins/datasource/postgres/partials/config.html":979,"./plugins/datasource/postgres/partials/query.editor.html":980,"./plugins/datasource/prometheus/partials/annotations.editor.html":981,"./plugins/datasource/prometheus/partials/config.html":982,"./plugins/datasource/prometheus/partials/query.editor.html":983,"./plugins/datasource/stackdriver/partials/annotations.editor.html":984,"./plugins/datasource/stackdriver/partials/config.html":985,"./plugins/datasource/stackdriver/partials/query.aggregation.html":986,"./plugins/datasource/stackdriver/partials/query.editor.html":987,"./plugins/datasource/stackdriver/partials/query.filter.html":988,"./plugins/datasource/testdata/partials/query.editor.html":989,"./plugins/panel/alertlist/editor.html":990,"./plugins/panel/alertlist/module.html":991,"./plugins/panel/dashlist/editor.html":992,"./plugins/panel/dashlist/module.html":993,"./plugins/panel/gettingstarted/editor.html":994,"./plugins/panel/gettingstarted/module.html":995,"./plugins/panel/graph/axes_editor.html":996,"./plugins/panel/graph/tab_display.html":997,"./plugins/panel/graph/tab_legend.html":998,"./plugins/panel/graph/thresholds_form.html":999,"./plugins/panel/graph/time_regions_form.html":1e3,"./plugins/panel/heatmap/module.html":1001,"./plugins/panel/heatmap/partials/axes_editor.html":1002,"./plugins/panel/heatmap/partials/display_editor.html":1003,"./plugins/panel/pluginlist/editor.html":1004,"./plugins/panel/pluginlist/module.html":1005,"./plugins/panel/singlestat/editor.html":1006,"./plugins/panel/singlestat/mappings.html":1007,"./plugins/panel/singlestat/module.html":1008,"./plugins/panel/singlestat/tips.html":1009,"./plugins/panel/table/column_options.html":1010,"./plugins/panel/table/editor.html":1011,"./plugins/panel/table/module.html":1012,"./plugins/panel/text/editor.html":1013,"./plugins/panel/text/module.html":1014,"./plugins/panel/unknown/module.html":1015};function a(t){var e=i(t);return r(e)}function i(t){var e=n[t];if(!(e+1)){var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}return e}a.keys=function(){return Object.keys(n)},a.resolve=i,t.exports=a,a.id=873},function(t,e){var r="public/app/core/components/help/help.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=modal-body>\r\n\t<div class=modal-header>\r\n\t\t<h2 class=modal-header-title>\r\n\t\t\t<i class="fa fa-keyboard-o"></i>\r\n\t\t\t<span class=p-l-1>快捷键</span>\r\n\t\t</h2>\r\n\t\t<a class=modal-header-close ng-click=ctrl.dismiss();>\r\n\t\t\t<i class="fa fa-remove"></i>\r\n\t\t</a>\r\n\t</div>\r\n\r\n\t<div class="modal-content help-modal">\r\n\r\n\t\t<p class=small style=position:absolute;top:13px;right:44px>\r\n\t\t\t<span class=shortcut-table-key>mod</span> =\r\n\t\t\t<span class=muted>CTRL 在 windows 或 linux ， CMD 键在 Mac</span>\r\n\t\t</p>\r\n\r\n\t\t<div ng-repeat="(category, shortcuts) in ctrl.shortcuts" class=shortcut-category>\r\n\t\t\t<table class=shortcut-table>\r\n\t\t\t\t<tbody>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<th class=shortcut-table-category-header colspan=2>{{category}}</th>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t<tr ng-repeat="shortcut in shortcuts">\r\n\t\t\t\t\t\t<td class=shortcut-table-keys>\r\n              <span class=shortcut-table-key ng-repeat="key in shortcut.keys track by $index" ng-bind-html=key>\r\n              </span>\r\n            </td>\r\n\t\t\t\t\t\t<td class=shortcut-table-description>{{shortcut.description}}</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t<tbody>\r\n\t\t\t</tbody></tbody></table>\r\n\t\t</div>\r\n\r\n\t\t<div class=clearfix></div>\r\n\t</div>\r\n\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/core/components/manage_dashboards/manage_dashboards.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=dashboard-list>\r\n  <div class="page-action-bar page-action-bar--narrow" ng-hide="ctrl.folderId && !ctrl.hasFilters && ctrl.sections.length === 0">\r\n    <label class="gf-form gf-form--grow gf-form--has-input-icon">\r\n      <input type=text class="gf-form-input max-width-30" placeholder=按名称查找仪表板 tabindex=1 give-focus=true ng-model=ctrl.query.query ng-model-options="{ debounce: 500 }" spellcheck=false ng-change=ctrl.onQueryChange() />\r\n      <i class="gf-form-input-icon fa fa-search"></i>\r\n    </label>\r\n    <div class=page-action-bar__spacer></div>\r\n    <a class="btn btn-success" ng-href={{ctrl.createDashboardUrl()}} ng-if="ctrl.hasEditPermissionInFolders || ctrl.canSave">\r\n      <i class="fa fa-plus"></i>\r\n      仪表盘\r\n    </a>\r\n    <a class="btn btn-success" href=dashboards/folder/new ng-if="!ctrl.folderId && ctrl.isEditor">\r\n      <i class="fa fa-plus"></i>\r\n      文件夹\r\n    </a>\r\n    <a class="btn btn-success" href={{ctrl.importDashboardUrl()}} ng-if="ctrl.hasEditPermissionInFolders || ctrl.canSave">\r\n      <i class="fa fa-plus"></i>\r\n      导入\r\n    </a>\r\n  </div>\r\n\r\n  <div class="page-action-bar page-action-bar--narrow" ng-show=ctrl.hasFilters>\r\n    <div class=gf-form-inline>\r\n      <div class=gf-form ng-show="ctrl.query.tag.length > 0">\r\n        <label class="gf-form-label width-4">\r\n          标签\r\n        </label>\r\n        <div class="gf-form-input gf-form-input--plaintext" ng-show="ctrl.query.tag.length > 0">\r\n          <span ng-repeat="tagName in ctrl.query.tag">\r\n            <a ng-click="ctrl.removeTag(tagName, $event)" tag-color-from-name=tagName class="tag label label-tag">\r\n              <i class="fa fa-remove"></i>&nbsp;{{tagName}}\r\n            </a>\r\n          </span>\r\n        </div>\r\n      </div>\r\n      <div class=gf-form ng-show=ctrl.query.starred>\r\n        <label class=gf-form-label>\r\n          <a class=pointer ng-click=ctrl.removeStarred()>\r\n            <i class="fa fa-fw fa-check"></i> 已标星\r\n          </a>\r\n        </label>\r\n      </div>\r\n      <div class=gf-form>\r\n        <label class=gf-form-label>\r\n          <a class=pointer ng-click=ctrl.clearFilters() bs-tooltip="\'清除当前搜索查询和过滤器\'">\r\n            <i class="fa fa-remove"></i>&nbsp;清除\r\n          </a>\r\n        </label>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=search-results ng-show="ctrl.hasFilters && ctrl.sections.length === 0">\r\n    <em class=muted>\r\n      没有找到与您的查询匹配的仪表板。\r\n    </em>\r\n  </div>\r\n\r\n\t<div class=search-results ng-show="!ctrl.folderId && !ctrl.hasFilters && ctrl.sections.length === 0">\r\n    <em class=muted>\r\n        没有仪表盘\r\n    </em>\r\n  </div>\r\n\r\n  <div class=search-results ng-show="ctrl.sections.length > 0">\r\n    <div class=search-results-filter-row>\r\n      <gf-form-switch on-change=ctrl.onSelectAllChanged() checked=ctrl.selectAllChecked switch-class="gf-form-switch--transparent gf-form-switch--search-result-filter-row__checkbox"/>\r\n      <div class=search-results-filter-row__filters>\r\n        <div class=gf-form-select-wrapper ng-show="!(ctrl.canMove || ctrl.canDelete)">\r\n          <select class="search-results-filter-row__filters-item gf-form-input" ng-model=ctrl.selectedStarredFilter ng-options="t.text disable when t.disabled for t in ctrl.starredFilterOptions" ng-change=ctrl.onStarredFilterChange() />\r\n        </div>\r\n        <div class=gf-form-select-wrapper ng-show="!(ctrl.canMove || ctrl.canDelete)">\r\n          <select class="search-results-filter-row__filters-item gf-form-input" ng-model=ctrl.selectedTagFilter ng-options="t.term disable when t.disabled for t in ctrl.tagFilterOptions" ng-change=ctrl.onTagFilterChange() />\r\n        </div>\r\n        <div class=gf-form-button-row ng-show="ctrl.canMove || ctrl.canDelete">\r\n          <button type=button class="btn gf-form-button btn-inverse" ng-disabled=!ctrl.canMove ng-click=ctrl.moveTo() bs-tooltip="ctrl.canMove ? \'\' : \'选择要移动的指示板(不能移动文件夹)\'" data-placement=bottom>\r\n          <i class="fa fa-exchange"></i>&nbsp;&nbsp;移动\r\n          </button>\r\n          <button type=button class="btn gf-form-button btn-danger" ng-click=ctrl.delete() ng-disabled=!ctrl.canDelete>\r\n            <i class="fa fa-trash"></i>&nbsp;&nbsp;删除\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=search-results-container>\r\n      <dashboard-search-results results=ctrl.sections editable=true on-selection-changed=ctrl.selectionChanged() on-tag-selected=ctrl.filterByTag($tag) />\r\n    </div>\r\n  </div>\r\n\r\n</div>\r\n\r\n<div ng-if="ctrl.canSave && ctrl.folderId && !ctrl.hasFilters && ctrl.sections.length === 0">\r\n  <empty-list-cta model="{\r\n    title: \'这个文件夹中没有仪表盘\',\r\n    buttonIcon: \'gicon gicon-dashboard-new\',\r\n    buttonLink: \'dashboard/new?folderId={{ctrl.folderId}}\',\r\n    buttonTitle: \'创建仪表盘\',\r\n    proTip: \'添加/移动仪表板到您的文件夹 ->\',\r\n    proTipLink: \'dashboards\',\r\n    proTipLinkTitle: \'管理仪表板\',\r\n    proTipTarget: \'\'\r\n  }"/>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/core/components/navbar/navbar.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=page-nav>\r\n  <div class=page-breadcrumbs>\r\n    <a class="breadcrumb-item active" href=/ >\r\n      <i class="fa fa-home"></i>\r\n    </a>\r\n    <a class=breadcrumb-item ng-href={{::item.url}} ng-repeat="item in ctrl.model.breadcrumbs">\r\n      {{::item.text}}\r\n    </a>\r\n  </div>\r\n</div>\r\n\r\n<dashboard-search></dashboard-search>\r\n')}]),t.exports=r},function(t,e){var r="public/app/core/components/search/search.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'\r\n<div class=search-backdrop ng-if=ctrl.isOpen></div>\r\n\r\n<div class=search-container ng-if=ctrl.isOpen>\r\n\r\n\t<div class=search-field-wrapper>\r\n\t\t<div class="search-field-icon pointer" ng-click=ctrl.closeSearch()><i class="fa fa-search"></i></div>\r\n\r\n\t\t<input type=text placeholder=按名称查找仪表板 give-focus=ctrl.giveSearchFocus tabindex=1 ng-keydown=ctrl.keyDown($event) ng-model=ctrl.query.query ng-model-options="{ debounce: 500 }" spellcheck=false ng-change=ctrl.search() />\r\n\r\n\t\t<div class=search-field-spacer></div>\r\n\t</div>\r\n\r\n\t<div class=search-dropdown>\r\n    <div class=search-dropdown__col_1>\r\n      <div class=search-results-scroller>\r\n        <div class=search-results-container grafana-scrollbar>\r\n          <h6 ng-show="!ctrl.isLoading && ctrl.results.length === 0">没有符合条件的仪表盘。</h6>\r\n          <dashboard-search-results results=ctrl.results on-tag-selected=ctrl.filterByTag($tag) on-folder-expanding=ctrl.folderExpanding() on-folder-expanded=ctrl.folderExpanded($folder) />\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=search-dropdown__col_2>\r\n      <div class=search-filter-box ng-click=ctrl.onFilterboxClick()>\r\n        <div class=search-filter-box__header>\r\n          <i class="fa fa-filter"></i>\r\n          过滤条件：\r\n          <a class="pointer pull-right small" ng-click=ctrl.clearSearchFilter()>\r\n            <i class="fa fa-remove"></i> 清空\r\n          </a>\r\n        </div>\r\n\r\n        <tag-filter tags=ctrl.query.tag tagoptions=ctrl.getTags onchange=ctrl.onTagFiltersChanged>\r\n        </tag-filter>\r\n      </div>\r\n\r\n      <div class=search-filter-box ng-if="ctrl.isEditor || ctrl.hasEditPermissionInFolders">\r\n        <a href=dashboard/new class=search-filter-box-link>\r\n          <i class="gicon gicon-dashboard-new"></i> 新建仪表盘\r\n        </a>\r\n        <a href=dashboards/folder/new class=search-filter-box-link ng-if=ctrl.isEditor>\r\n          <i class="gicon gicon-folder-new"></i> 新建文件夹\r\n        </a>\r\n        <a href=dashboard/import class=search-filter-box-link ng-if="ctrl.isEditor || ctrl.hasEditPermissionInFolders">\r\n          <i class="gicon gicon-dashboard-import"></i> 导入仪表盘\r\n        </a>\r\n        \x3c!-- [OGE]\r\n        <a class="search-filter-box-link" target="_blank" href="https://grafana.com/dashboards?utm_source=grafana_search">\r\n          <img src="public/img/icn-dashboard-tiny.svg" width="20" /> Find dashboards on Grafana.com\r\n        </a>\r\n        --\x3e\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/core/components/search/search_results.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div ng-repeat="section in ctrl.results" class=search-section>\r\n  <div class="search-section__header pointer" ng-hide=section.hideHeader ng-class="{\'selected\': section.selected}" ng-click=ctrl.toggleFolderExpand(section)>\r\n    <div ng-click="ctrl.toggleSelection(section, $event)">\r\n      <gf-form-switch ng-show=ctrl.editable on-change=ctrl.selectionChanged($event) checked=section.checked switch-class="gf-form-switch--transparent gf-form-switch--search-result__section">\r\n      </gf-form-switch>\r\n    </div>\r\n    <i class=search-section__header__icon ng-class=section.icon></i>\r\n    <span class=search-section__header__text>{{::section.title}}</span>\r\n    <a ng-show=section.url href={{section.url}} class=search-section__header__link>\r\n      <i class="fa fa-cog"></i>\r\n    </a>\r\n    <i class="fa fa-angle-down search-section__header__toggle" ng-show=section.expanded></i>\r\n    <i class="fa fa-angle-right search-section__header__toggle" ng-hide=section.expanded></i>\r\n  </div>\r\n\r\n  <div class=search-section__header ng-show=section.hideHeader></div>\r\n\r\n  <div ng-if=section.expanded>\r\n    <a ng-repeat="item in section.items" class="search-item search-item--indent" ng-class="{\'selected\': item.selected}" ng-href={{::item.url}}>\r\n      <div ng-click="ctrl.toggleSelection(item, $event)">\r\n        <gf-form-switch ng-show=ctrl.editable on-change=ctrl.selectionChanged() checked=item.checked switch-class="gf-form-switch--transparent gf-form-switch--search-result__item">\r\n        </gf-form-switch>\r\n      </div>\r\n      <span class=search-item__icon>\r\n        <i class="gicon mini gicon-dashboard-list"></i>\r\n      </span>\r\n      <span class=search-item__body ng-click=ctrl.onItemClick(item)>\r\n        <div class=search-item__body-title>{{::item.title}}</div>\r\n        <span class=search-item__body-folder-title>{{::item.folderTitle}}</span>\r\n      </span>\r\n      <span class=search-item__tags>\r\n        <span ng-click="ctrl.selectTag(tag, $event)" ng-repeat="tag in item.tags" tag-color-from-name=tag class="label label-tag">\r\n          {{tag}}\r\n        </span>\r\n      </span>\r\n    </a>\r\n  </div>\r\n</div>\r\n\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/admin/partials/admin_home.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<page-header model=ctrl.navModel></page-header>\r\n\r\n<div class="page-container page-body">\r\n\r\n  <div class="grafana-info-box span8">\r\n    Grafana is a multi-tenant system where most can be configured per organization. These\r\n    admin pages are for server admins where you can manage orgs, & all users across all orgs.\r\n  </div>\r\n\r\n</div>\r\n\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/admin/partials/edit_org.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<page-header model=navModel></page-header>\r\n\r\n<div class="page-container page-body">\r\n\t<h2 class=page-sub-heading>Edit Organization</h2>\r\n\r\n\t<form name=orgDetailsForm class=gf-form-group>\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class="gf-form-label width-10">Name</span>\r\n\t\t\t<input type=text required ng-model=org.name class="gf-form-input max-width-14">\r\n\t\t</div>\r\n\r\n\t\t<div class=gf-form-button-row>\r\n\t\t\t<button type=submit class="btn btn-success" ng-click=update() ng-show=!createMode>Update</button>\r\n\t\t</div>\r\n\t</form>\r\n\r\n\t<h3 class=page-heading>Organization Users</h3>\r\n\r\n\t<table class=filter-table>\r\n\t\t<tr>\r\n\t\t\t<th>Username</th>\r\n\t\t\t<th>Email</th>\r\n\t\t\t<th>Role</th>\r\n\t\t\t<th></th>\r\n\t\t</tr>\r\n\t\t<tr ng-repeat="orgUser in orgUsers">\r\n\t\t\t<td>{{orgUser.login}}</td>\r\n\t\t\t<td>{{orgUser.email}}</td>\r\n\t\t\t<td>\r\n        <div class=gf-form>\r\n          <span class=gf-form-select-wrapper>\r\n              <select type=text ng-model=orgUser.role class="gf-form-input max-width-8" ng-options="f for f in [\'Viewer\', \'Editor\', \'Admin\']" ng-change=updateOrgUser(orgUser)>\r\n              </select>\r\n          </span>\r\n        </div>\r\n\t\t\t</td>\r\n\t\t\t<td style=width:1%>\r\n\t\t\t\t<a ng-click=removeOrgUser(orgUser) class="btn btn-danger btn-mini">\r\n\t\t\t\t\t<i class="fa fa-remove"></i>\r\n\t\t\t\t</a>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t</table>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/admin/partials/edit_user.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<page-header model=navModel></page-header>\r\n\r\n<div class="page-container page-body">\r\n\r\n\t<div class=page-sub-heading>\r\n\t\t<h2>编辑用户</h2>\r\n\t</div>\r\n\r\n\t<form name=userForm class=gf-form-group>\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<span class="gf-form-label width-10 addRedStar">用户</span>\r\n\t\t\t\t<input type=text required ng-model=user.name class="gf-form-input max-width-25">\r\n\t\t\t</div>\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<span class="gf-form-label width-10">邮箱</span>\r\n\t\t\t\t<input type=email ng-model=user.email class="gf-form-input max-width-25">\r\n\t\t\t</div>\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<span class="gf-form-label width-10">用户名</span>\r\n\t\t\t\t<input type=text ng-model=user.login class="gf-form-input max-width-25">\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=gf-form-button-row>\r\n\t\t\t\t<button type=submit class="btn btn-success" ng-click=update() ng-show=!createMode>更新</button>\r\n\t\t\t</div>\r\n\t</form>\r\n\r\n\t<h3 class=page-heading>改变密码</h3>\r\n\r\n\t<form name=passwordForm class=gf-form-group>\r\n\t\t<div class=gf-form>\r\n        <span class="gf-form-label width-10">\r\n          <span>\r\n            新密码\r\n          </span>\r\n          <tip>最少10位长度,大小写字母/数字/特殊字符最少3种组合且不能包含空格</tip>\r\n        </span>\r\n\t\t\t\t<input type=password required minlength=10 ng-model=password name=uNPassword class="gf-form-input max-width-25" ng-pattern=passwordPattern>\r\n        <div ng-show="passwordForm.uNPassword.$viewValue && passwordForm.uNPassword.$viewValue !== \'\' && passwordForm.uNPassword.$invalid">\r\n          <span style=color:red>密码复杂度校验失败</span>\r\n        </div>\r\n\t\t</div>\r\n\r\n\t\t<div class=gf-form-button-row>\r\n\t\t\t<button type=submit class="btn btn-success" ng-click=setPassword()>更新</button>\r\n\t\t</div>\r\n\t</form>\r\n\r\n\t<h3 class=page-heading>权限</h3>\r\n\r\n\t<form name=permissionsForm class=gf-form-group>\r\n\t\t<div class=gf-form>\r\n\t\t\t<gf-form-switch class=gf-form label=KAM管理员 checked=permissions.isGrafanaAdmin switch-class=max-width-6></gf-form-switch>\r\n\t\t</div>\r\n\r\n\t\t<div class=gf-form-button-row>\r\n\t\t\t<button type=submit class="btn btn-success" ng-click=updatePermissions()>更新</button>\r\n\t\t</div>\r\n\t</form>\r\n\r\n\t<h3 class=page-heading>组织</h3>\r\n\r\n\t<form name=addOrgForm class=gf-form-group>\r\n\t\t<div class=gf-form-inline>\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<span class=gf-form-label>添加</span>\r\n\t\t\t\t<input type=text ng-model=newOrg.name bs-typeahead=searchOrgs required class="gf-form-input max-width-20" placeholder=组织名称>\r\n\t\t\t</div>\r\n\t\t\t<div class=gf-form>\r\n        \t<span class=gf-form-label>角色</span>\r\n        \t<span class=gf-form-select-wrapper>\r\n            \t<select type=text ng-model=newOrg.role class="gf-form-input width-10" ng-options="f for f in [\'Viewer\', \'Editor\', \'Admin\']"></select>\r\n        \t</span>\r\n\t\t\t</div>\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<button class="btn btn-success gf-form-btn" ng-click=addOrgUser()>添加</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</form>\r\n\r\n\t<table class=filter-table>\r\n\t\t<thead>\r\n\t\t\t<tr>\r\n\t\t\t\t<th>名称</th>\r\n\t\t\t\t<th>角色</th>\r\n\t\t\t\t<th></th>\r\n\t\t\t</tr>\r\n\t\t</thead>\r\n\t\t<tr ng-repeat="org in orgs">\r\n\t\t\t<td>\r\n\t\t\t\t{{org.name}} <span class="label label-info" ng-show="org.orgId === user.orgId">现在</span>\r\n\t\t\t</td>\r\n\t\t\t<td>\r\n        <div class=gf-form>\r\n            <span class=gf-form-select-wrapper>\r\n                <select type=text ng-model=org.role class="gf-form-input max-width-12" ng-options="f for f in [\'Viewer\', \'Editor\', \'Admin\']" ng-change=updateOrgUser(org)>\r\n                </select>\r\n            </span>\r\n        </div>\r\n\t\t\t</td>\r\n\t\t\t<td style=width:1%>\r\n\t\t\t\t<a ng-click=removeOrgUser(org) class="btn btn-danger btn-mini">\r\n\t\t\t\t\t<i class="fa fa-remove"></i>\r\n\t\t\t\t</a>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t</table>\r\n\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/admin/partials/new_user.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<page-header model=navModel></page-header>\r\n\r\n<div class="page-container page-body">\r\n\t<div class=page-sub-heading>\r\n\t\t<h1>Add new user</h1>\r\n\t</div>\r\n\r\n\t<form name=userForm class=gf-form-group>\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class="gf-form-label width-10 addRedStar">\r\n        Name\r\n      </span>\r\n\t\t\t<input type=text required ng-model=user.name class="gf-form-input max-width-20" maxlength=20>\r\n\t\t</div>\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class="gf-form-label width-10">Email</span>\r\n\t\t\t<input type=email ng-model=user.email name=uEmail ng-pattern=emailPattern class="gf-form-input max-width-20">\r\n      <div ng-show=userForm.uEmail.$invalid>\r\n        <span style=color:red>email 格式无效</span>\r\n      </div>\r\n\t\t</div>\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class="gf-form-label width-10">Username</span>\r\n\t\t\t<input type=text ng-model=user.login class="gf-form-input max-width-20" maxlength=20>\r\n\t\t</div>\r\n\t\t<div class=gf-form>\r\n      <span class="gf-form-label width-10">\r\n        <span class=addRedStar>\r\n          Password\r\n        </span>\r\n        <tip>最少10位长度,大小写字母/数字/特殊字符最少3种组合且不能包含空格</tip>\r\n      </span>\r\n\t\t\t<input type=password required ng-model=user.password name=uPassword class="gf-form-input max-width-20" minlength=10 ng-pattern=passwordPattern>\r\n      <div ng-show="userForm.uPassword.$viewValue && userForm.uPassword.$viewValue !== \'\' && userForm.uPassword.$invalid">\r\n        <span style=color:red>密码复杂度校验失败</span>\r\n      </div>\r\n\t\t</div>\r\n\r\n\t\t<div class=gf-form-button-row>\r\n\t\t\t<button type=submit class="btn btn-success" ng-click=create()>Create</button>\r\n\t\t</div>\r\n\t</form>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/admin/partials/orgs.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<page-header model=navModel></page-header>\r\n\r\n<div class="page-container page-body">\r\n  <div class=page-action-bar>\r\n    <div class=page-action-bar__spacer></div>\r\n    <a class="page-header__cta btn btn-success" href=org/new>\r\n      <i class="fa fa-plus"></i>\r\n      新增组织\r\n    </a>\r\n  </div>\r\n\r\n  <table class="filter-table form-inline filter-table--hover">\r\n    <thead>\r\n      <tr>\r\n        <th>Id</th>\r\n        <th>名称</th>\r\n        <th style=width:1%></th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr ng-repeat="org in orgs">\r\n        <td class=link-td>\r\n          <a href=admin/orgs/edit/{{org.id}}>\r\n            {{org.id}}\r\n          </a>\r\n        </td>\r\n        <td class=link-td>\r\n          <a href=admin/orgs/edit/{{org.id}}>\r\n            {{org.name}}\r\n          </a>\r\n        </td>\r\n        <td class=text-right>\r\n          <a ng-click=deleteOrg(org) class="btn btn-danger btn-small">\r\n            <i class="fa fa-remove"></i>\r\n          </a>\r\n        </td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/admin/partials/settings.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<page-header model=ctrl.navModel></page-header>\r\n\r\n<div class="page-container page-body">\r\n\r\n\t<div class="grafana-info-box span8" style="margin:20px 0 25px 0">\r\n\t\t这些系统设置在grafana.ini或custom.ini中定义(或在ENV变量中被覆盖)。\r\n\t\t要更改这些，您目前需要重新启动KAM。\r\n\t</div>\r\n\r\n\t<table class=filter-table>\r\n\t\t<tr ng-repeat-start="(secName, secValue) in settings">\r\n\t\t\t<td class=admin-settings-section>{{secName}}</td>\r\n\t\t\t<td></td>\r\n\t\t</tr>\r\n\t\t<tr ng-repeat="(keyName, keyValue) in secValue" ng-repeat-end>\r\n\t\t\t<td style=padding-left:25px>{{keyName}}</td>\r\n\t\t\t<td>{{keyValue}}</td>\r\n\t\t</tr>\r\n\t</table>\r\n</div>\r\n\r\n\r\n\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/admin/partials/stats.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<page-header model=ctrl.navModel></page-header>\r\n\r\n<div class="page-container page-body">\r\n\t<table class="filter-table form-inline">\r\n\t\t<thead>\r\n\t\t\t<tr>\r\n\t\t\t\t<th>名称</th>\r\n\t\t\t\t<th>值</th>\r\n\t\t\t</tr>\r\n\t\t</thead>\r\n\t\t<tbody>\r\n\t\t\t<tr>\r\n\t\t\t\t<td>总指示板</td>\r\n\t\t\t\t<td>{{ctrl.stats.dashboards}}</td>\r\n\t\t\t</tr>\r\n\t\t\t<tr>\r\n\t\t\t\t<td>总用户</td>\r\n\t\t\t\t<td>{{ctrl.stats.users}}</td>\r\n\t\t\t</tr>\r\n\t\t\t<tr>\r\n\t\t\t\t<td>活跃用户(过去14天)</td>\r\n\t\t\t\t<td>{{ctrl.stats.activeUsers}}</td>\r\n\t\t\t</tr>\r\n\t\t\t<tr>\r\n\t\t\t\t<td>总组织</td>\r\n\t\t\t\t<td>{{ctrl.stats.orgs}}</td>\r\n\t\t\t</tr>\r\n\t\t\t<tr>\r\n\t\t\t\t<td>总数据源</td>\r\n\t\t\t\t<td>{{ctrl.stats.datasources}}</td>\r\n\t\t\t</tr>\r\n\t\t\t<tr>\r\n\t\t\t\t<td>总播放列表</td>\r\n\t\t\t\t<td>{{ctrl.stats.playlists}}</td>\r\n\t\t\t</tr>\r\n\t\t\t<tr>\r\n\t\t\t\t<td>总快照</td>\r\n\t\t\t\t<td>{{ctrl.stats.snapshots}}</td>\r\n\t\t\t</tr>\r\n\t\t\t<tr>\r\n\t\t\t\t<td>总仪表盘标签</td>\r\n\t\t\t\t<td>{{ctrl.stats.tags}}</td>\r\n\t\t\t</tr>\r\n\t\t\t<tr>\r\n\t\t\t\t<td>总标星仪表盘</td>\r\n\t\t\t\t<td>{{ctrl.stats.stars}}</td>\r\n\t\t\t</tr>\r\n      <tr>\r\n\t\t\t\t<td>总报警</td>\r\n\t\t\t\t<td>{{ctrl.stats.alerts}}</td>\r\n\t\t\t</tr>\r\n\t\t</tbody>\r\n\t</table>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/admin/partials/styleguide.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<page-header model=ctrl.navModel></page-header>\r\n\r\n<div class="page-container page-body">\r\n\r\n\t<h3 class=page-heading>按钮</h3>\r\n\r\n\t<div class=tab-pane>\r\n\t\t<div ng-repeat="variant in ctrl.buttonVariants" class=row>\r\n\t\t\t<div ng-repeat="btnSize in ctrl.buttonSizes" class="style-guide-button-list p-a-2 col-md-4">\r\n\t\t\t\t<button ng-repeat="buttonName in ctrl.buttonNames" class="btn btn{{variant}}{{buttonName}} {{btnSize}}">\r\n\t\t\t\t\tbtn{{variant}}{{buttonName}}\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<h3 class=page-heading>表单</h3>\r\n\r\n\t<div class=gf-form-inline>\r\n\t\t<div class=gf-form>\r\n\t\t\t<label class=gf-form-label>标签</label>\r\n\t\t\t<input type=text class=gf-form-input />\r\n\t\t</div>\r\n\t</div>\r\n\r\n</div>\r\n\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/admin/partials/users.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<page-header model=ctrl.navModel></page-header>\r\n\r\n<div class="page-container page-body">\r\n\t<div class=page-action-bar>\r\n    <label class="gf-form gf-form--grow gf-form--has-input-icon">\r\n      <input type=text class="gf-form-input max-width-30" placeholder=通过名称/登录名/邮箱查找用户 tabindex=1 give-focus=true ng-model=ctrl.query ng-model-options="{ debounce: 500 }" spellcheck=false ng-trim=false ng-change=ctrl.getUsers() />\r\n      <i class="gf-form-input-icon fa fa-search"></i>\r\n    </label>\r\n    <div class=page-action-bar__spacer></div>\r\n    <a class="btn btn-success" href=admin/users/create>\r\n      <i class="fa fa-plus"></i>\r\n      添加用户\r\n    </a>\r\n  </div>\r\n\r\n  <div class=admin-list-table>\r\n    <table class="filter-table form-inline filter-table--hover">\r\n      <thead>\r\n        <tr>\r\n          <th></th>\r\n          <th>登录</th>\r\n          <th>邮箱</th>\r\n          <th>\r\n            使用时间\r\n            <tip>用户使用KAM时间</tip>\r\n          </th>\r\n          <th></th>\r\n          <th style=width:1%></th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr ng-repeat="user in ctrl.users">\r\n          <td class="width-4 text-center link-td">\r\n            <a href=admin/users/edit/{{user.id}}>\r\n              <img class=filter-table__avatar ng-src={{user.avatarUrl}}>\r\n            </a>\r\n          </td>\r\n          <td class=link-td>\r\n            <a href=admin/users/edit/{{user.id}}>\r\n              {{user.login}}\r\n            </a>\r\n          </td>\r\n          <td class=link-td>\r\n            <a href=admin/users/edit/{{user.id}}>\r\n              {{user.email}}\r\n            </a>\r\n          </td>\r\n          <td class=link-td>\r\n            <a href=admin/users/edit/{{user.id}}>\r\n              {{user.lastSeenAtAge}}\r\n            </a>\r\n          </td>\r\n          <td class=link-td>\r\n            <a href=admin/users/edit/{{user.id}}>\r\n              <i class="fa fa-shield" ng-show=user.isAdmin bs-tooltip="\'Grafana Admin\'"></i>\r\n            </a>\r\n          </td>\r\n          <td class=text-right>\r\n            <a ng-click=ctrl.deleteUser(user) class="btn btn-danger btn-small">\r\n              <i class="fa fa-remove"></i>\r\n            </a>\r\n          </td>\r\n        </tr>\r\n      </tbody>\r\n\r\n    </table>\r\n  </div>\r\n\r\n  <div class=admin-list-paging ng-if=ctrl.showPaging>\r\n    <ol>\r\n      <li ng-repeat="page in ctrl.pages">\r\n        <button class="btn btn-small" ng-class="{\'btn-secondary\': page.current, \'btn-inverse\': !page.current}" ng-click=ctrl.navigateToPage(page)>{{page.page}}</button>\r\n      </li>\r\n    </ol>\r\n  </div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/alerting/partials/alert_howto.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=modal-body>\r\n\t<div class=modal-header>\r\n\t\t<h2 class=modal-header-title>\r\n\t\t\t<i class="fa fa-info-circle"></i>\r\n\t\t\t<span class=p-l-1>添加一个报警</span>\r\n\t\t</h2>\r\n\r\n\t\t<a class=modal-header-close ng-click=dismiss();>\r\n\t\t\t<i class="fa fa-remove"></i>\r\n\t\t</a>\r\n\t</div>\r\n\r\n\r\n\t<div class=modal-content>\r\n\t\t<div class=text-center>\r\n\t\t\t<img src=public/img/alert_howto_new.png>\r\n\t\t</div>\r\n\t\t<p class="p-a-2 text-center offset-lg-1 col-lg-10">\r\n\t\t\t警报是在任何仪表板图形面板的<strong>警报标签</strong>中添加和配置的，让您可以使用现有的查询构建和可视化警报。要持久化警报规则更改，请记住保存仪表盘。\r\n\t\t\t<br>\r\n\t\t\t<br>\r\n\t\t</p>\r\n\t</div>\r\n\r\n</div>\r\n\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/alerting/partials/alert_tab.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=edit-tab-with-sidemenu ng-if=ctrl.alert>\r\n  <aside class=edit-sidemenu-aside>\r\n    <ul class=edit-sidemenu>\r\n      <li ng-class="{active: ctrl.subTabIndex === 0}">\r\n        <a ng-click=ctrl.changeTabIndex(0)>报警配置</a>\r\n      </li>\r\n      <li ng-class="{active: ctrl.subTabIndex === 1}">\r\n        <a ng-click=ctrl.changeTabIndex(1)>\r\n          通知 <span class=muted>({{ctrl.alertNotifications.length}})</span>\r\n        </a>\r\n      </li>\r\n      <li ng-class="{active: ctrl.subTabIndex === 2}">\r\n        <a ng-click=ctrl.changeTabIndex(2)>状态历史记录</a>\r\n      </li>\r\n      <li>\r\n        <a ng-click=ctrl.delete()>删除</a>\r\n      </li>\r\n    </ul>\r\n  </aside>\r\n\r\n  <div class=edit-tab-content>\r\n    <div ng-if="ctrl.subTabIndex === 0">\r\n      <div class="alert alert-error m-b-2" ng-show=ctrl.error>\r\n        <i class="fa fa-warning"></i> {{ctrl.error}}\r\n      </div>\r\n\r\n      <div class=gf-form-group>\r\n        <h5 class=section-heading>报警配置</h5>\r\n        <div class=gf-form>\r\n          <span class="gf-form-label width-6">名称</span>\r\n          <input type=text class="gf-form-input width-20" ng-model=ctrl.alert.name>\r\n        </div>\r\n        <div class=gf-form-inline>\r\n          <div class=gf-form>\r\n            <span class="gf-form-label width-9">评估间隔</span>\r\n            <input class="gf-form-input max-width-6" type=text ng-model=ctrl.alert.frequency>\r\n          </div>\r\n          <div class="gf-form max-width-11">\r\n            <label class="gf-form-label width-5">For</label>\r\n            <input type=text class="gf-form-input max-width-6" ng-model=ctrl.alert.for spellcheck=false placeholder=5m>\r\n            <info-popover mode=right-absolute>\r\n              如果警报规则配置了For，并且查询违反了配置的阈值，则它将首先从OK转到Pending。\r\n              从OK到Pending，KAM不会发送任何通知。一旦警报规则触发时间超过了持续时间，它将更改为报警并发送警报通知。\r\n            </info-popover>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=gf-form-group>\r\n        <h5 class=section-heading>条件</h5>\r\n        <div class=gf-form-inline ng-repeat="conditionModel in ctrl.conditionModels">\r\n          <div class=gf-form>\r\n            <metric-segment-model css-class="query-keyword width-5" ng-if=$index property=conditionModel.operator.type options=ctrl.evalOperators custom=false></metric-segment-model>\r\n            <span class="gf-form-label query-keyword width-5" ng-if="$index===0">WHEN</span>\r\n          </div>\r\n                <div class=gf-form>\r\n            <query-part-editor class="gf-form-label query-part width-9" part=conditionModel.reducerPart handle-event="ctrl.handleReducerPartEvent(conditionModel, $event)">\r\n            </query-part-editor>\r\n                  <span class="gf-form-label query-keyword">OF</span>\r\n          </div>\r\n          <div class=gf-form>\r\n            <query-part-editor class="gf-form-label query-part" part=conditionModel.queryPart handle-event="ctrl.handleQueryPartEvent(conditionModel, $event)">\r\n            </query-part-editor>\r\n          </div>\r\n          <div class=gf-form>\r\n            <metric-segment-model property=conditionModel.evaluator.type options=ctrl.evalFunctions custom=false css-class=query-keyword on-change=ctrl.evaluatorTypeChanged(conditionModel.evaluator)></metric-segment-model>\r\n            <input class="gf-form-input max-width-9" type=number step=any ng-hide="conditionModel.evaluator.params.length === 0" ng-model=conditionModel.evaluator.params[0] ng-change=ctrl.evaluatorParamsChanged()>\r\n            <label class="gf-form-label query-keyword" ng-show="conditionModel.evaluator.params.length === 2">TO</label>\r\n            <input class="gf-form-input max-width-9" type=number step=any ng-if="conditionModel.evaluator.params.length === 2" ng-model=conditionModel.evaluator.params[1] ng-change=ctrl.evaluatorParamsChanged()>\r\n          </div>\r\n          <div class=gf-form>\r\n            <label class=gf-form-label>\r\n              <a class=pointer tabindex=1 ng-click=ctrl.removeCondition($index)>\r\n                <i class="fa fa-trash"></i>\r\n              </a>\r\n            </label>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=gf-form>\r\n          <label class="gf-form-label dropdown">\r\n            <a class="pointer dropdown-toggle" data-toggle=dropdown>\r\n              <i class="fa fa-plus"></i>\r\n            </a>\r\n            <ul class=dropdown-menu role=menu>\r\n              <li ng-repeat="ct in ctrl.conditionTypes" role=menuitem>\r\n                <a ng-click=ctrl.addCondition(ct.value);>{{ct.text}}</a>\r\n              </li>\r\n            </ul>\r\n          </label>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=gf-form-group>\r\n        <div class=gf-form>\r\n                <span class="gf-form-label width-18">如果没有数据或所有值都为空</span>\r\n                <span class="gf-form-label query-keyword">状态设置为</span>\r\n          <div class=gf-form-select-wrapper>\r\n            <select class=gf-form-input ng-model=ctrl.alert.noDataState ng-options="f.value as f.text for f in ctrl.noDataModes">\r\n            </select>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=gf-form>\r\n                <span class="gf-form-label width-18">如果执行错误或超时</span>\r\n                <span class="gf-form-label query-keyword">状态设置为</span>\r\n          <div class=gf-form-select-wrapper>\r\n            <select class=gf-form-input ng-model=ctrl.alert.executionErrorState ng-options="f.value as f.text for f in ctrl.executionErrorModes">\r\n            </select>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=gf-form-button-row>\r\n          <button class="btn btn-inverse" ng-click=ctrl.test()>\r\n            测试规则\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=gf-form-group ng-if=ctrl.testing>\r\n        评估规则 <i class="fa fa-spinner fa-spin"></i>\r\n      </div>\r\n\r\n      <div class=gf-form-group ng-if=ctrl.testResult>\r\n        <json-tree root-name=result object=ctrl.testResult start-expanded=true></json-tree>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=gf-form-group ng-if="ctrl.subTabIndex === 1">\r\n      <h5 class=section-heading>通知</h5>\r\n      <div class=gf-form-inline>\r\n        <div class="gf-form max-width-30">\r\n          <span class="gf-form-label width-8">发送到</span>\r\n          <span class=gf-form-label ng-repeat="nc in ctrl.alertNotifications" ng-style="{\'background-color\': nc.bgColor }">\r\n            <i class={{nc.iconClass}}></i>&nbsp;{{nc.name}}&nbsp;\r\n            <i class="fa fa-remove pointer muted" ng-click=ctrl.removeNotification($index) ng-if="nc.isDefault === false"></i>\r\n          </span>\r\n          <metric-segment segment=ctrl.addNotificationSegment get-options=ctrl.getNotifications() on-change=ctrl.notificationAdded()></metric-segment>\r\n        </div>\r\n      </div>\r\n      <div class="gf-form gf-form--v-stretch">\r\n        <span class="gf-form-label width-8">信息</span>\r\n        <textarea class=gf-form-input rows=10 ng-model=ctrl.alert.message placeholder=通知信息的详情...></textarea>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=gf-form-group style=max-width:720px ng-if="ctrl.subTabIndex === 2">\r\n      <button class="btn btn-mini btn-danger pull-right" ng-click=ctrl.clearHistory()><i class="fa fa-trash"></i>&nbsp;清除历史</button>\r\n          <h5 class=section-heading style=whitespace:nowrap>\r\n        状态历史 <span class="muted small">(最近50个状态更改)</span>\r\n      </h5>\r\n\r\n      <div ng-show="ctrl.alertHistory.length === 0">\r\n        <br>\r\n        <i>没有状态变化记录</i>\r\n      </div>\r\n\r\n      <ol class=alert-rule-list>\r\n        <li class=alert-rule-item ng-repeat="al in ctrl.alertHistory">\r\n          <div class="alert-rule-item__icon {{al.stateModel.stateClass}}">\r\n            <i class={{al.stateModel.iconClass}}></i>\r\n          </div>\r\n          <div class=alert-rule-item__body>\r\n            <div class=alert-rule-item__header>\r\n              <div class=alert-rule-item__text>\r\n                <span class={{al.stateModel.stateClass}}>{{al.stateModel.text}}</span>\r\n              </div>\r\n            </div>\r\n            <span class=alert-list-info>{{al.info}}</span>\r\n          </div>\r\n          <div class=alert-rule-item__time>\r\n            <span>{{al.time}}</span>\r\n          </div>\r\n        </li>\r\n      </ol>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<div class=gf-form-group ng-if=!ctrl.alert>\r\n  <div class=gf-form-button-row>\r\n    <button class="btn btn-inverse" ng-click=ctrl.enable()>\r\n      <i class="icon-gf icon-gf-alert"></i>\r\n      创建报警\r\n    </button>\r\n  </div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/alerting/partials/notification_edit.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<page-header model=ctrl.navModel></page-header>\r\n\r\n<div class="page-container page-body">\r\n\r\n  <h3 class=page-sub-heading ng-hide=ctrl.isNew>编辑通知渠道</h3>\r\n  <h3 class=page-sub-heading ng-show=ctrl.isNew>新建通知渠道</h3>\r\n\r\n  <form name=ctrl.theForm ng-if=ctrl.notifiers>\r\n    <div class=gf-form-group>\r\n      <div class=gf-form>\r\n        <span class="gf-form-label width-12">名称</span>\r\n        <input type=text required class="gf-form-input max-width-15" ng-model=ctrl.model.name required>\r\n      </div>\r\n      <div class=gf-form>\r\n        <span class="gf-form-label width-12">类型</span>\r\n        <div class="gf-form-select-wrapper width-15">\r\n          <select class=gf-form-input ng-model=ctrl.model.type ng-options="t.type as t.name for t in ctrl.notifiers" ng-change="ctrl.typeChanged(notification, $index)">\r\n          </select>\r\n        </div>\r\n      </div>\r\n      <gf-form-switch class=gf-form label=发送所有报警 label-class=width-14 checked=ctrl.model.isDefault tooltip=对所有警报使用此通知>\r\n      </gf-form-switch>\r\n      <gf-form-switch class=gf-form label=包含图片 label-class=width-14 checked=ctrl.model.settings.uploadImage tooltip=捕获图像并将其包含在通知中>\r\n      </gf-form-switch>\r\n      <gf-form-switch class=gf-form label=禁用解决消息 label-class=width-14 checked=ctrl.model.disableResolveMessage tooltip=禁用当警报状态返回到false时发送的解析消息[OK]>\r\n      </gf-form-switch>\r\n      <gf-form-switch class=gf-form label=发送提醒 label-class=width-14 checked=ctrl.model.sendReminder tooltip=发送触发警报的附加通知>\r\n      </gf-form-switch>\r\n      <div class=gf-form-inline>\r\n        <div class=gf-form ng-if=ctrl.model.sendReminder>\r\n          <span class="gf-form-label width-12">发送提醒\r\n            <info-popover mode=right-normal position="top center">\r\n              每隔多长时间发送一次提醒，例如每30秒、1米、10米、30米或1小时等。\r\n            </info-popover>\r\n          </span>\r\n          <input type=text placeholder=选择或指定自定义 class="gf-form-input width-15" ng-model=ctrl.model.frequency bs-typeahead=ctrl.getFrequencySuggestion data-min-length=0 ng-required=ctrl.model.sendReminder>\r\n        </div>\r\n      </div>\r\n      <div class=gf-form>\r\n          <span class="alert alert-info width-30" ng-if=ctrl.model.sendReminder>\r\n            在评估规则后发送警报提醒。因此，提醒的发送频率永远不能超过配置的警报规则评估间隔\r\n          </span>\r\n        </div>\r\n    </div>\r\n\r\n    <div class=gf-form-group ng-include src=ctrl.notifierTemplateId>\r\n    </div>\r\n\r\n    <div class="gf-form-group gf-form-button-row">\r\n\t\t\t<button type=submit ng-click=ctrl.save() class="btn btn-success width-7">保存</button>\r\n\t\t\t<button type=submit ng-click=ctrl.testNotification() class="btn btn-secondary width-7">发送测试</button>\r\n\t\t\t<a href=alerting/notifications class="btn btn-inverse">返回</a>\r\n    </div>\r\n  </form>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/alerting/partials/notifications_list.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<page-header model=ctrl.navModel></page-header>\r\n\r\n<div class="page-container page-body">\r\n\r\n  <div ng-if=ctrl.notifications.length>\r\n    <div class=page-action-bar>\r\n      <div class=page-action-bar__spacer>\r\n      </div>\r\n\r\n      <a href=alerting/notification/new class="btn btn-success">\r\n        <i class="fa fa-plus"></i>\r\n        新建通道\r\n      </a>\r\n    </div>\r\n\r\n    <table class="filter-table filter-table--hover">\r\n      <thead>\r\n        <th style=min-width:200px>\r\n          <strong>名称</strong>\r\n        </th>\r\n        <th style=min-width:100px>类型</th>\r\n        <th style=width:1%></th>\r\n      </thead>\r\n      <tbody>\r\n        <tr ng-repeat="notification in ctrl.notifications">\r\n          <td class=link-td>\r\n            <a href=alerting/notification/{{notification.id}}/edit>\r\n              {{notification.name}}\r\n            </a>\r\n          </td>\r\n          <td class=link-td>\r\n            <a href=alerting/notification/{{notification.id}}/edit>\r\n              {{notification.type}}\r\n            </a>\r\n          </td>\r\n          <td class=text-right>\r\n            <span class="btn btn-secondary btn-small" ng-show="notification.isDefault == true">\r\n              默认\r\n            </span>\r\n            <a ng-click=ctrl.deleteNotification(notification.id) class="btn btn-danger btn-small">\r\n              <i class="fa fa-remove"></i>\r\n            </a>\r\n          </td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n  <div ng-if="ctrl.notifications.length === 0">\r\n    <empty-list-cta model="{\r\n      title: \'还没有定义通知通道\',\r\n      buttonIcon: \'gicon gicon-add-alert-notification-channel\',\r\n      buttonLink: \'alerting/notification/new\',\r\n      buttonTitle: \'添加通道\',\r\n      proTip: \'可以在警报通知中包含图像。\',\r\n      proTipLink: \'\',\r\n      proTipLinkTitle: \'Learn more\',\r\n      proTipTarget: \'_blank\'\r\n    }"/>\r\n  </div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/annotations/partials/editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'\r\n<div ng-controller=AnnotationsEditorCtrl>\r\n\t<h3 class=dashboard-settings__header>\r\n\t\t<a ng-click=ctrl.backToList()>注释</a>\r\n\t\t<span ng-show="ctrl.mode === \'new\'">&gt; 新建</span>\r\n\t\t<span ng-show="ctrl.mode === \'edit\'">&gt; 编辑</span>\r\n\t</h3>\r\n\r\n\t<div ng-if="ctrl.mode === \'list\'">\r\n\t\t<div class=page-action-bar ng-if="ctrl.annotations.length > 1">\r\n\t\t\t<div class=page-action-bar__spacer></div>\r\n\t\t\t<a type=button class="btn btn-success" ng-click=ctrl.setupNew();><i class="fa fa-plus"></i> 新建</a>\r\n\t\t</div>\r\n\r\n\t\t<table class="filter-table filter-table--hover">\r\n\t\t\t<thead>\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<th>查询名称</th>\r\n\t\t\t\t\t<th>数据源</th>\r\n\t\t\t\t\t<th colspan=3></th>\r\n\t\t\t\t</tr>\r\n\t\t\t</thead>\r\n\t\t\t<tbody>\r\n\t\t\t\t<tr ng-repeat="annotation in ctrl.annotations track by annotation.name">\r\n\t\t\t\t\t<td style=width:90% ng-hide=annotation.builtIn class=pointer ng-click=ctrl.edit(annotation)>\r\n\t\t\t\t\t\t<i class="fa fa-comment" style=color:{};></i> &nbsp;\r\n\t\t\t\t\t\t{{annotation.name}}\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td style=width:90% ng-show=annotation.builtIn class=pointer ng-click=ctrl.edit(annotation)>\r\n\t\t\t\t\t\t<i class="gicon gicon-annotation"></i> &nbsp;\r\n\t\t\t\t\t\t<em class=muted>{{annotation.name}} (Built-in)</em>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td class=pointer ng-click=ctrl.edit(annotation)>\r\n\t\t\t\t\t\t{{annotation.datasource || \'默认\'}}\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td style=width:1%><i ng-click=ctrl.move($index,-1) ng-hide=$first class="pointer fa fa-arrow-up"></i></td>\r\n\t\t\t\t\t<td style=width:1%><i ng-click=ctrl.move($index,1) ng-hide=$last class="pointer fa fa-arrow-down"></i></td>\r\n\t\t\t\t\t<td style=width:1%>\r\n\t\t\t\t\t\t<a ng-click=ctrl.removeAnnotation(annotation) class="btn btn-danger btn-mini" ng-hide=annotation.builtIn>\r\n\t\t\t\t\t\t\t<i class="fa fa-remove"></i>\r\n\t\t\t\t\t\t</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>\r\n\t\t</table>\r\n\r\n\t\t\x3c!-- empty list cta, there is always one built in query --\x3e\r\n\t\t<div ng-if="ctrl.annotations.length === 1" class=p-t-2>\r\n\t\t\t<div class=empty-list-cta>\r\n\t\t\t\t<div class=empty-list-cta__title>还没有添加自定义注释查询</div>\r\n\t\t\t\t<a ng-click=ctrl.setupNew() class="empty-list-cta__button btn btn-xlarge btn-success">\r\n\t\t\t\t\t<i class="gicon gicon-add-annotation"></i>\r\n\t\t\t\t\t添加注释查询\r\n\t\t\t\t</a>\r\n\t\t\t\t<div class=grafana-info-box>\r\n\t\t\t\t\t<h5>什么是注释?</h5>\r\n\t\t\t\t\t<p>\r\n\t\t\t\t\t\t注释提供了一种将事件数据集成到图中的方法。它们在所有的图形面板上显示为垂直线和图标。当你把鼠标悬停在一个注释图标上时，你可以看到事件文本和事件的标记。您可以通过按住CTRL或CMD +单击图形(或拖动区域)直接从grafana添加注释事件。\r\n\t\t\t\t\t</p>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class=annotations-basic-settings ng-if="ctrl.mode === \'edit\' || ctrl.mode === \'new\'">\r\n\t\t<div class=gf-form-group>\r\n\t\t\t<h5 class=section-heading>默认</h5>\r\n\t\t\t<div class=gf-form-inline>\r\n\t\t\t\t<div class=gf-form>\r\n\t\t\t\t\t<span class="gf-form-label width-7">名称</span>\r\n\t\t\t\t\t<input type=text class="gf-form-input width-20" ng-model=ctrl.currentAnnotation.name placeholder=名称>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=gf-form>\r\n\t\t\t\t\t<span class="gf-form-label width-7">数据源</span>\r\n\t\t\t\t\t<div class=gf-form-select-wrapper>\r\n\t\t\t\t\t\t<select class=gf-form-input ng-model=ctrl.currentAnnotation.datasource ng-options="f.name as f.name for f in ctrl.datasources" ng-change=ctrl.datasourceChanged()></select>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class=gf-form-group>\r\n\t\t\t<div class=gf-form-inline>\r\n\t\t\t\t<gf-form-switch class=gf-form label=启用 checked=ctrl.currentAnnotation.enable label-class=width-7>\r\n\t\t\t\t</gf-form-switch>\r\n\t\t\t\t<gf-form-switch class=gf-form label=隐藏 tooltip=隐藏注释查询切换，使其不显示在仪表板的顶部 checked=ctrl.currentAnnotation.hide label-class=width-7>\r\n\t\t\t\t</gf-form-switch>\r\n\t\t\t\t<div class=gf-form>\r\n\t\t\t\t\t<label class="gf-form-label width-9">颜色</label>\r\n\t\t\t\t\t<span class=gf-form-label>\r\n\t\t\t\t\t\t<color-picker color=ctrl.currentAnnotation.iconColor onchange=ctrl.onColorChange></color-picker>\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<h5 class=section-heading>查询</h5>\r\n\t\t<rebuild-on-change property=ctrl.currentDatasource>\r\n\t\t\t<plugin-component type=annotations-query-ctrl>\r\n\t\t\t</plugin-component>\r\n\t\t</rebuild-on-change>\r\n\r\n\t\t<div class=gf-form>\r\n\t\t\t<div class="gf-form-button-row p-y-0">\r\n\t\t\t\t<button ng-show="ctrl.mode === \'new\'" type=button class="btn gf-form-button btn-success" ng-click=ctrl.add()>添加</button>\r\n\t\t\t\t<button ng-show="ctrl.mode === \'edit\'" type=button class="btn btn-success pull-left" ng-click=ctrl.update()>更新</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/annotations/partials/event_editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'\r\n<div class=graph-annotation>\r\n\t<div class=graph-annotation__header>\r\n\t\t<div class=graph-annotation__user bs-tooltip="\'Created by {{ctrl.login}}\'">\r\n\t\t</div>\r\n\r\n\t\t<div class=graph-annotation__title>\r\n\t\t\t<span ng-if=!ctrl.event.id>添加注释</span>\r\n\t\t\t<span ng-if=ctrl.event.id>编辑注释</span>\r\n\t\t</div>\r\n\r\n    <div class=graph-annotation__time>{{ctrl.timeFormated}}</div>\r\n\t</div>\r\n\r\n\t<form name=ctrl.form class="graph-annotation__body text-center">\r\n\t\t<div style=display:inline-block>\r\n\t\t\t<div class="gf-form gf-form--v-stretch">\r\n\t\t\t\t<span class="gf-form-label width-7">描述</span>\r\n\t\t\t\t<textarea class="gf-form-input width-20" rows=2 ng-model=ctrl.event.text placeholder=描述></textarea>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<span class="gf-form-label width-7">标签</span>\r\n\t\t\t\t<bootstrap-tagsinput ng-model=ctrl.event.tags tagclass="label label-tag" placeholder=添加标签>\r\n\t\t\t\t</bootstrap-tagsinput>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=gf-form-button-row>\r\n\t\t\t\t<button type=submit class="btn btn-success" ng-click=ctrl.save()>保存</button>\r\n\t\t\t\t<button ng-if=ctrl.event.id type=submit class="btn btn-danger" ng-click=ctrl.delete()>删除</button>\r\n\t\t\t\t<a class=btn-text ng-click=ctrl.close();>取消</a>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</form>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/dashboard/dashlinks/editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<h3 class=dashboard-settings__header>\r\n  <a ng-click=ctrl.backToList()>仪表盘链接</a>\r\n  <span ng-show="ctrl.mode === \'new\'">&gt; 新建</span>\r\n  <span ng-show="ctrl.mode === \'edit\'">&gt; 编辑</span>\r\n</h3>\r\n\r\n<div ng-if="ctrl.mode == \'list\'">\r\n  <div ng-if="ctrl.dashboard.links.length === 0">\r\n    <div class=empty-list-cta>\r\n      <div class=empty-list-cta__title>\r\n        还没有添加仪表盘链接\r\n      </div>\r\n      <a ng-click=ctrl.setupNew() class="empty-list-cta__button btn btn-xlarge btn-success">\r\n        <i class="gicon gicon-add-link"></i>\r\n        添加仪表盘链接\r\n      </a>\r\n      <div class=grafana-info-box>\r\n        <h5>什么是仪表盘链接?</h5>\r\n        <p>\r\n\t\t\t\t\t仪表盘链接可以在面板标题下面直接放置指向其他指示板和web站点的链接。\r\n        </p>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <div ng-if="ctrl.dashboard.links.length > 0">\r\n    <div class=page-action-bar>\r\n      <div class=page-action-bar__spacer></div>\r\n      <a type=button class="btn btn-success" ng-click=ctrl.setupNew()>\r\n        <i class="fa fa-plus"></i> 新建</a>\r\n    </div>\r\n    <table class="filter-table filter-table--hover">\r\n      <thead>\r\n        <tr>\r\n          <th>类型</th>\r\n          <th>信息</th>\r\n          <th colspan=3></th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr ng-repeat="link in ctrl.dashboard.links">\r\n          <td class=pointer ng-click=ctrl.editLink(link)>\r\n            <i class="fa fa-fw fa-external-link"></i>\r\n            {{link.type}}\r\n          </td>\r\n          <td>\r\n            <div ng-if=link.title>\r\n              {{link.title}}\r\n            </div>\r\n            <div ng-if="!link.title && link.url">\r\n              {{link.url}}\r\n            </div>\r\n            <span ng-if="!link.title && link.tags" ng-repeat="tag in link.tags" tag-color-from-name=tag class="label label-tag" style=margin-right:6px>\r\n              {{tag}}\r\n            </span>\r\n          </td>\r\n          <td style=width:1%>\r\n            <i ng-click="ctrl.moveLink($index, -1)" ng-hide=$first class="pointer fa fa-arrow-up"></i>\r\n          </td>\r\n          <td style=width:1%>\r\n            <i ng-click="ctrl.moveLink($index, 1)" ng-hide=$last class="pointer fa fa-arrow-down"></i>\r\n          </td>\r\n          <td style=width:1%>\r\n            <a ng-click=ctrl.deleteLink($index) class="btn btn-danger btn-mini" ng-hide=annotation.builtIn>\r\n              <i class="fa fa-remove"></i>\r\n            </a>\r\n          </td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n</div>\r\n\r\n<div ng-if="ctrl.mode == \'edit\' || ctrl.mode == \'new\'">\r\n  <div class=gf-form-group>\r\n    <div class=gf-form-group>\r\n      <div class=gf-form>\r\n        <span class="gf-form-label width-8">类型</span>\r\n        <div class="gf-form-select-wrapper width-10">\r\n          <select class=gf-form-input ng-model=ctrl.link.type ng-options="f for f in [\'dashboards\',\'link\',\'Export CSV\']"></select>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=gf-form ng-show="ctrl.link.type === \'dashboards\'">\r\n        <span class="gf-form-label width-8">标签</span>\r\n        <bootstrap-tagsinput ng-model=ctrl.link.tags tagclass="label label-tag" placeholder=添加标签 style=margin-right:.25rem></bootstrap-tagsinput>\r\n      </div>\r\n\r\n      <gf-form-switch ng-show="ctrl.link.type === \'dashboards\'" class=gf-form label=可下拉选择 checked=ctrl.link.asDropdown switch-class=max-width-4 label-class=width-8></gf-form-switch>\r\n      <div class=gf-form ng-show="ctrl.link.type === \'dashboards\' && ctrl.link.asDropdown">\r\n        <span class="gf-form-label width-8">标题</span>\r\n        <input type=text ng-model=ctrl.link.title class="gf-form-input max-width-10" ng-model-onblur>\r\n      </div>\r\n      <div ng-show="ctrl.link.type === \'link\'">\r\n        <div class=gf-form>\r\n          <li class="gf-form-label width-8">链接</li>\r\n          <input type=text ng-model=ctrl.link.url class="gf-form-input width-20" ng-model-onblur>\r\n        </div>\r\n\r\n        <div class=gf-form>\r\n          <span class="gf-form-label width-8">标题</span>\r\n          <input type=text ng-model=ctrl.link.title class="gf-form-input width-20" ng-model-onblur>\r\n        </div>\r\n\r\n        <div class=gf-form>\r\n          <span class="gf-form-label width-8">提示</span>\r\n          <input type=text ng-model=ctrl.link.tooltip class="gf-form-input width-20" placeholder=打开仪表盘 ng-model-onblur>\r\n        </div>\r\n\r\n        <div class=gf-form>\r\n          <span class="gf-form-label width-8">图标</span>\r\n          <div class="gf-form-select-wrapper width-20">\r\n            <select class=gf-form-input ng-model=ctrl.link.icon ng-options="k as k for (k, v) in ctrl.iconMap"></select>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div ng-show="ctrl.link.type === \'Export CSV\'">\r\n        <div class=gf-form>\r\n          <span class="gf-form-label width-8">标题</span>\r\n          <input type=text ng-model=ctrl.link.title class="gf-form-input width-20" ng-model-onblur>\r\n        </div>\r\n\r\n        <div class=gf-form>\r\n          <span class="gf-form-label width-8">提示</span>\r\n          <input type=text ng-model=ctrl.link.tooltip class="gf-form-input width-20" placeholder="Open dashboard" ng-model-onblur>\r\n        </div>\r\n\r\n        <div class=gf-form>\r\n          <span class="gf-form-label width-8">图标</span>\r\n          <div class="gf-form-select-wrapper width-20">\r\n            <select class=gf-form-input ng-model=ctrl.link.icon ng-options="k as k for (k, v) in ctrl.iconMap"></select>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <gf-form-switch class=gf-form label=查看模式 checked=ctrl.link.iskioskTv switch-class=max-width-4 label-class=width-8></gf-form-switch>\r\n    </div>\r\n\r\n    <div class=gf-form-group>\r\n      <h5 class=section-heading>包含</h5>\r\n      <div>\r\n        <gf-form-switch class=gf-form label=时间范围 checked=ctrl.link.keepTime switch-class=max-width-6 label-class=width-9></gf-form-switch>\r\n        <gf-form-switch class=gf-form label=变量值 checked=ctrl.link.includeVars switch-class=max-width-6 label-class=width-9></gf-form-switch>\r\n        <gf-form-switch class=gf-form label=在新页面打开 checked=ctrl.link.targetBlank switch-class=max-width-6 label-class=width-9></gf-form-switch>\r\n      </div>\r\n    </div>\r\n    \x3c!-- 添加链接的字体颜色和背景颜色————OGE --\x3e\r\n\t\t\t<div class="section gf-form-inline" style=display:flex>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<div class=gf-form>\r\n\t\t\t\t\t\t<span class="gf-form-label width-6">字体颜色</span>\r\n\t\t\t\t\t\t<span class=gf-form-label>\r\n\t\t                    <spectrum-picker ng-model=ctrl.link.color></spectrum-picker>\r\n\t\t                </span>\r\n\t\t                <span class=gf-form-label>\r\n\t\t\t                <i class="fa fa-arrow-right"></i>\r\n\t\t\t            </span>\r\n\t\t\t            <input type=text ng-model=ctrl.link.color class="gf-form-input max-width-9">\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=gf-form>\r\n\t\t\t\t\t\t<span class="gf-form-label width-6">背景颜色</span>\r\n\t\t\t\t\t\t<span class=gf-form-label>\r\n\t\t                    <spectrum-picker ng-model=ctrl.link.bgcolor></spectrum-picker>\r\n\t\t                </span>\r\n\t\t                <span class=gf-form-label>\r\n\t\t\t                <i class="fa fa-arrow-right"></i>\r\n\t\t\t            </span>\r\n\t\t\t            <input type=text ng-model=ctrl.link.bgcolor class="gf-form-input max-width-9">\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t\x3c!-- 结束 --\x3e\r\n\r\n  </div>\r\n  <button class="btn btn-success" ng-if="ctrl.mode == \'new\'" ng-click=ctrl.addLink()>\r\n    添加\r\n  </button>\r\n  <button class="btn btn-success" ng-if="ctrl.mode == \'edit\'" ng-click=ctrl.saveLink()>\r\n    更新\r\n  </button>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/dashboard/dashnav/dashnav.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=navbar>\r\n\r\n\t<div ng-show=::ctrl.dashboard.meta.canEdit>\r\n\t\t<a class=navbar-page-btn ng-click=ctrl.showSearch()>\r\n\t\t\t<i class="gicon gicon-dashboard"></i>\r\n\t\t\t<span ng-if="ctrl.dashboard.meta.folderId > 0" class=navbar-page-btn--folder>{{ctrl.dashboard.meta.folderTitle}} / </span>{{ctrl.dashboard.title}}\r\n\t\t\t<i class="fa fa-caret-down"></i>\r\n\t\t</a>\r\n\t</div>\r\n\r\n\t<div class=navbar__spacer></div>\r\n\r\n\t<div class="navbar-buttons navbar-buttons--playlist" ng-if=ctrl.playlistSrv.isPlaying>\r\n\t\t<a class="navbar-button navbar-button--tight" ng-click=ctrl.playlistSrv.prev()><i class="fa fa-step-backward"></i></a>\r\n\t\t<a class="navbar-button navbar-button--tight" ng-click=ctrl.playlistSrv.stop()><i class="fa fa-stop"></i></a>\r\n\t\t<a class="navbar-button navbar-button--tight" ng-click=ctrl.playlistSrv.next()><i class="fa fa-step-forward"></i></a>\r\n\t</div>\r\n\r\n\t<div class="navbar-buttons navbar-buttons--actions">\r\n\t\t<button class="btn navbar-button navbar-button--add-panel" ng-show=::ctrl.dashboard.meta.canSave bs-tooltip="\'添加面板\'" data-placement=bottom ng-click=ctrl.addPanel()>\r\n\t\t\t<i class="gicon gicon-add-panel"></i>\r\n\t\t</button>\r\n\r\n\t\t<button class="btn navbar-button navbar-button--star" ng-show=::ctrl.dashboard.meta.canStar ng-click=ctrl.starDashboard() bs-tooltip="\'标记收藏\'" data-placement=bottom>\r\n\t\t\t<i class=fa ng-class="{\'fa-star-o\': !ctrl.dashboard.meta.isStarred, \'fa-star\': ctrl.dashboard.meta.isStarred}"></i>\r\n\t\t</button>\r\n\r\n    <button class="btn navbar-button navbar-button--share" ng-show=::ctrl.dashboard.meta.canShare ng-click=ctrl.shareDashboard(0) bs-tooltip="\'分享仪表盘\'" data-placement=bottom>\r\n\t\t\t<i class="fa fa-share-square-o"></i>\r\n\t\t</button>\r\n\r\n    <button class="btn navbar-button navbar-button--save" ng-show=ctrl.dashboard.meta.canSave ng-click=ctrl.saveDashboard() bs-tooltip="\'保存仪表盘<br> CTRL+S\'" data-placement=bottom>\r\n\t\t\t<i class="fa fa-save"></i>\r\n\t\t</button>\r\n\r\n\t\t<a class="btn navbar-button navbar-button--snapshot-origin" ng-if=::ctrl.dashboard.snapshot.originalUrl href={{ctrl.dashboard.snapshot.originalUrl}} bs-tooltip="\'打开原始仪表盘\'" data-placement=bottom>\r\n\t\t\t<i class="fa fa-link"></i>\r\n\t\t</a>\r\n\r\n\t\t<button class="btn navbar-button navbar-button--settings" ng-click=ctrl.toggleSettings() bs-tooltip="\'设置\'" data-placement=bottom ng-show=ctrl.dashboard.meta.showSettings>\r\n\t\t\t<i class="fa fa-cog"></i>\r\n\t\t</button>\r\n\t</div>\r\n\r\n\t<div class="navbar-buttons navbar-buttons--tv">\r\n    <button class="btn navbar-button navbar-button--tv" ng-click=ctrl.toggleViewMode() bs-tooltip="\'循环查看模式\'" data-placement=bottom>\r\n      <i class="fa fa-desktop"></i>\r\n    </button>\r\n\t</div>\r\n\r\n\t\x3c!-- [OGE]专业工具 --\x3e\r\n\t<div class="navbar-buttons navbar-buttons--actions">\r\n\t\t<li class="dropdown navbar-buttons">\r\n\t\t\t<button class="btn navbar-button" ng-click=ctrl.hideTooltip($event) bs-tooltip="\'专业工具\'" data-placement=bottom data-toggle=dropdown><i class="fa fa-wrench"></i></button>\r\n\t\t\t<ul class=dropdown-menu>\r\n\t\t\t\t<li>\r\n\t\t\t\t\t<a class=pointer ng-href=dashboard/db/__shu-zhi-fen-xi>\r\n\t\t\t\t\t\t<i class="fa fa-line-chart"></i> 数值分析\r\n\t\t\t\t\t\t<div class=dropdown-desc>对点值数据趋势进行对比分析</div>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t</li>\r\n\t\t\t\t<li>\r\n\t\t\t\t\t<a class=pointer ng-href=dashboard/db/__pin-pu-fen-xi>\r\n\t\t\t\t\t\t<i class="fa fa-area-chart"></i> 频谱分析\r\n\t\t\t\t\t\t<div class=dropdown-desc>对振摆波形数据进行时域和频域的分析展示</div>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t</li>\r\n\t\t\t\t<li>\r\n\t\t\t\t\t<a class=pointer ng-href=dashboard/db/__zhou-xian-fen-xi>\r\n\t\t\t\t\t\t<i class="fa fa-ioxhost"></i> 轴线分析\r\n\t\t\t\t\t\t<div class=dropdown-desc>对机组的轴系进行弯曲量、影响量等分析展示</div>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t</li>\r\n\t\t\t\t<li>\r\n\t\t\t\t\t<a class=pointer ng-href=dashboard/db/__qi-xi-fen-xi>\r\n\t\t\t\t\t\t<i class="fa fa-dot-circle-o"></i> 气隙分析\r\n\t\t\t\t\t\t<div class=dropdown-desc>对发电机的空气间隙进行中心偏移，磁极伸长等分析展示</div>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t</li>\r\n\t\t\t\t<li>\r\n\t\t\t\t\t<a class=pointer ng-href=dashboard/db/__mo-xing-fen-xi>\r\n\t\t\t\t\t\t<i class="fa fa-cube"></i> 3D模型分析\r\n\t\t\t\t\t\t<div class=dropdown-desc>对关联数据进行三维空间分析展示</div>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t</li>\r\n\t\t\t</ul>\r\n\t\t</li>\r\n\t</div>\r\n\t\x3c!-- 结束 --\x3e\r\n\r\n\t<gf-time-picker class=gf-timepicker-nav dashboard=ctrl.dashboard ng-if=!ctrl.dashboard.timepicker.hidden></gf-time-picker>\r\n\r\n\t<div class="navbar-buttons navbar-buttons--close">\r\n\t\t<button class="btn navbar-button navbar-button--primary" ng-click=ctrl.close() bs-tooltip="\'返回仪表盘\'" data-placement=bottom>\r\n\t\t\t<i class="fa fa-reply"></i>\r\n\t\t</button>\r\n\t</div>\r\n  <span style=margin-right:10px;margin-top:20px>{{nowTime|date:\'yyyy-MM-dd hh:mm:ss\'}}</span>\r\n</div>\r\n\r\n<dashboard-search></dashboard-search>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/dashboard/export/export_modal.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=share-modal-header>\r\n\t<div class=share-modal-big-icon>\r\n\t\t<i class="fa fa-cloud-upload"></i>\r\n\t</div>\r\n\t<div>\r\n\t\t<gf-form-switch class=gf-form label=导出用于外部共享 label-class=width-16 checked=ctrl.shareExternally>\r\n\t\t</gf-form-switch>\r\n\r\n\t\t<div class=gf-form-button-row>\r\n\t\t\t<button type=button class="btn gf-form-btn width-10 btn-success" ng-click=ctrl.saveDashboardAsFile()>\r\n\t\t\t\t<i class="fa fa-save"></i> 保存到文件\r\n\t\t\t</button>\r\n\t\t\t<button type=button class="btn gf-form-btn width-10 btn-secondary" ng-click=ctrl.viewJson()>\r\n\t\t\t\t<i class="fa fa-file-text-o"></i> 查看JSON\r\n\t\t\t</button>\r\n\t\t\t<a class="btn btn-link" ng-click=ctrl.dismiss()>取消</a>\r\n\t\t</div>\r\n\r\n\t</div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/dashboard/export_data/export_data_modal.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=modal-body>\r\n  <div class=modal-header>\r\n    <h2 class=modal-header-title>\r\n      导出 CSV\r\n    </h2>\r\n\r\n    <a class=modal-header-close ng-click=ctrl.dismiss();>\r\n      <i class="fa fa-remove"></i>\r\n    </a>\r\n  </div>\r\n\r\n  <div class=modal-content>\r\n    <div class=p-t-2>\r\n      <div class=gf-form ng-hide="ctrl.panel === \'table\'">\r\n        <label class="gf-form-label width-10">模型</label>\r\n        <div class=gf-form-select-wrapper>\r\n          <select class=gf-form-input ng-model=ctrl.asRows ng-options="f.value as f.text for f in [{text: \'系列的行\', value: true}, {text: \'系列的列\', value: false}]">\r\n          </select>\r\n        </div>\r\n      </div>\r\n      <div class=gf-form ng-hide="ctrl.panel === \'table\'">\r\n        <label class="gf-form-label width-10">日期时间格式</label>\r\n        <input type=text class=gf-form-input ng-model=ctrl.dateTimeFormat>\r\n      </div>\r\n      <gf-form-switch class=gf-form label="Excel CSV格式" label-class=width-10 switch-class=max-width-6 checked=ctrl.excel>\r\n      </gf-form-switch>\r\n    </div>\r\n\r\n    <div class="gf-form-button-row text-center">\r\n      <a class="btn btn-success" ng-click=ctrl.export();>导出</a>\r\n      <a class=btn-text ng-click=ctrl.dismiss();>取消</a>\r\n    </div>\r\n  </div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/dashboard/folder_picker/folder_picker.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=gf-form-inline>\r\n  <div class=gf-form>\r\n    <label class="gf-form-label {{ctrl.labelClass}}">文件夹</label>\r\n    <div class=dropdown ng-hide=ctrl.createNewFolder>\r\n      <gf-form-dropdown model=ctrl.folder get-options=ctrl.getOptions($query) on-change=ctrl.onFolderChange($option)>\r\n      </gf-form-dropdown>\r\n    </div>\r\n    <input type=text class="gf-form-input max-width-10" ng-if=ctrl.createNewFolder give-focus=ctrl.createNewFolder ng-model=ctrl.newFolderName ng-model-options="{ debounce: 400 }" ng-change=ctrl.newFolderNameChanged() />\r\n  </div>\r\n  <div class=gf-form ng-if=ctrl.createNewFolder>\r\n    <button class="btn btn-inverse" ng-click=ctrl.createFolder($event) ng-disabled="!ctrl.newFolderNameTouched || ctrl.hasValidationError">\r\n      <i class="fa fa-fw fa-save"></i>&nbsp;创建\r\n    </button>\r\n  </div>\r\n  <div class=gf-form ng-if=ctrl.createNewFolder>\r\n    <button class="btn btn-inverse" ng-click=ctrl.cancelCreateFolder($event)>\r\n      取消\r\n  </button>\r\n  </div>\r\n</div>\r\n<div class=gf-form-inline ng-if="ctrl.newFolderNameTouched && ctrl.hasValidationError">\r\n  <div class="gf-form gf-form--grow">\r\n    <label class="gf-form-label text-warning gf-form-label--grow">\r\n      <i class="fa fa-warning"></i>\r\n      {{ctrl.validationError}}\r\n    </label>\r\n  </div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/dashboard/history/history.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<h3 class=dashboard-settings__header>\r\n  <a ng-click="ctrl.switchMode(\'list\')">版本</a>\r\n  <span ng-show="ctrl.mode === \'compare\'">\r\n    &gt; Comparing {{ctrl.baseInfo.version}}\r\n    <i class="fa fa-arrows-h"></i>\r\n    {{ctrl.newInfo.version}}\r\n    <cite class=muted ng-if=ctrl.isNewLatest>(最新)</cite>\r\n  </span>\r\n</h3>\r\n\r\n<div ng-if="ctrl.mode === \'list\'">\r\n  <div ng-if=ctrl.loading>\r\n    <i class="fa fa-spinner fa-spin"></i>\r\n    <em>抓起历史列表</em>\r\n  </div>\r\n\r\n  <div ng-if=!ctrl.loading>\r\n    <div class=gf-form-group>\r\n      <table class=filter-table>\r\n        <thead>\r\n          <tr>\r\n            <th class=width-4></th>\r\n            <th class=width-4>版本</th>\r\n            <th class=width-14>日期</th>\r\n            <th class=width-10>更新于</th>\r\n            <th>说明</th>\r\n            <th></th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <tr ng-repeat="revision in ctrl.revisions">\r\n            <td class=filter-table__switch-cell bs-tooltip="!revision.checked && ctrl.canCompare ? \'一次只能比较两个版本\' : \'\'" data-placement=right>\r\n              <gf-form-switch switch-class=gf-form-switch--table-cell checked=revision.checked on-change=ctrl.revisionSelectionChanged() ng-disabled="!revision.checked && ctrl.canCompare">\r\n              </gf-form-switch>\r\n            </td>\r\n            <td class=text-center>{{revision.version}}</td>\r\n            <td>{{revision.createdDateString}}</td>\r\n            <td>{{revision.createdBy}}</td>\r\n            <td>{{revision.message}}</td>\r\n            <td class=text-right>\r\n              <a class="btn btn-inverse btn-small" ng-show="revision.version !== ctrl.dashboard.version" ng-click=ctrl.restore(revision.version)>\r\n                <i class="fa fa-history"></i>&nbsp;&nbsp;恢复\r\n              </a>\r\n              <a class="btn btn-outline-disabled btn-small" ng-show="revision.version === ctrl.dashboard.version">\r\n                <i class="fa fa-check"></i>&nbsp;&nbsp;最新\r\n              </a>\r\n            </td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n\r\n      <div ng-if=ctrl.appending>\r\n        <i class="fa fa-spinner fa-spin"></i>\r\n        <em>抓取更多记录;</em>\r\n      </div>\r\n\r\n      <div class=gf-form-group>\r\n        <div class=gf-form-button-row>\r\n          <button type=button class="btn gf-form-button btn-inverse" ng-if="ctrl.revisions.length >= ctrl.limit" ng-click=ctrl.addToLog() ng-disabled=ctrl.isLastPage()>\r\n            展示更多版本\r\n          </button>\r\n          <button type=button class="btn btn-success" ng-if="ctrl.revisions.length > 1" ng-disabled=!ctrl.canCompare ng-click=ctrl.getDiff(ctrl.diff) bs-tooltip="ctrl.canCompare ? \'\' : \'选择两个版本开始比较\'" data-placement=bottom>\r\n            <i class="fa fa-code-fork"></i>&nbsp;&nbsp;比较版本\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<div ng-if="ctrl.mode === \'compare\'">\r\n  <div ng-if=ctrl.loading>\r\n    <i class="fa fa-spinner fa-spin"></i>\r\n    <em>抓取修改;</em>\r\n  </div>\r\n\r\n  <div ng-if=!ctrl.loading>\r\n    <button type=button class="btn btn-danger pull-right" ng-click=ctrl.restore(ctrl.baseInfo.version) ng-if=ctrl.isNewLatest>\r\n      <i class="fa fa-history"></i>&nbsp;&nbsp;恢复版本 {{ctrl.baseInfo.version}}\r\n    </button>\r\n    <section>\r\n      <p class="small muted">\r\n      <strong>版本 {{ctrl.newInfo.version}}</strong> 是\r\n      <span>{{ctrl.newInfo.createdBy}} </span>更新于\r\n      <span>{{ctrl.newInfo.ageString}}</span>\r\n      <span> - {{ctrl.newInfo.message}}</span>\r\n      </p>\r\n      <p class="small muted">\r\n      <strong>版本 {{ctrl.baseInfo.version}}</strong> 是\r\n      <span>{{ctrl.baseInfo.createdBy}} </span>更新于\r\n      <span>{{ctrl.baseInfo.ageString}}</span>\r\n      <span> - {{ctrl.baseInfo.message}}</span>\r\n      </p>\r\n    </section>\r\n\r\n    <div id=delta diff-delta>\r\n      <div class=delta-basic compile=ctrl.delta.basic></div>\r\n    </div>\r\n\r\n    <div class=gf-form-button-row>\r\n      <button class="btn btn-secondary" ng-click="ctrl.getDiff(\'json\')">查看JSON的差异</button>\r\n    </div>\r\n\r\n    <div class=delta-html ng-show="ctrl.diff === \'json\'" compile=ctrl.delta.json></div>\r\n  </div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/dashboard/move_to_folder_modal/move_to_folder.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=modal-body>\r\n  <div class=modal-header>\r\n    <h2 class=modal-header-title>\r\n\t\t\t<i class="gicon gicon-folder-new"></i>\r\n      <span class=p-l-1>选择仪表盘文件夹</span>\r\n    </h2>\r\n\r\n    <a class=modal-header-close ng-click=ctrl.dismiss();>\r\n      <i class="fa fa-remove"></i>\r\n    </a>\r\n  </div>\r\n\r\n  <form name=ctrl.saveForm ng-submit=ctrl.save() class="modal-content folder-modal" novalidate>\r\n    <p>移动 {{ctrl.dashboards.length}} 个已选择仪表盘，移动到下面的文件夹中:</p>\r\n\r\n    <div class=p-t-2>\r\n      <div class=gf-form>\r\n          <folder-picker on-load=ctrl.onFolderChange($folder) on-change=ctrl.onFolderChange($folder) enter-folder-creation=ctrl.onEnterFolderCreation() exit-folder-creation=ctrl.onExitFolderCreation() enable-create-new=true label-class=width-7>\r\n          </folder-picker>\r\n      </div>\r\n    </div>\r\n    <div class="gf-form-button-row text-center">\r\n      <button type=submit class="btn btn-success" ng-disabled="ctrl.saveForm.$invalid || !ctrl.isValidFolderSelection">移动</button>\r\n      <a class=btn-text ng-click=ctrl.dismiss();>取消</a>\r\n    </div>\r\n  </form>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/dashboard/panellinks/module.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=editor-row>\r\n\t<h5 class=section-heading>\r\n\t\t深入分析/详细信息链接<tip> 这些链接将出现在面板菜单的下拉菜单中 </tip>\r\n\t</h5>\r\n\t\x3c!-- [OGE] --\x3e\r\n\t<div class=gf-form>\r\n\t\t<gf-form-switch ng-model=isSZFXChecked class=gf-form label=数值分析 label-class=width-9 checked=isSZFXChecked on-change=chooseDefaulDashboard()></gf-form-switch>\r\n\t</div>\r\n\t\x3c!-- END --\x3e\r\n\t<div class=gf-form-group ng-repeat="link in panel.links">\r\n\t\t<div class=section>\r\n\t\t\t<div class="gf-form max-width-25">\r\n\t\t\t\t<span class="gf-form-label width-7">类型</span>\r\n\t\t\t\t<div class="gf-form-select-wrapper gf-form--grow">\r\n\t\t\t\t\t<select class=gf-form-input ng-model=link.type ng-options="f for f in [\'dashboard\',\'absolute\']"></select>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class="gf-form max-width-25">\r\n\t\t\t\t<span class="gf-form-label width-7" ng-show="link.type === \'dashboard\'">仪表盘</span>\r\n\t\t\t\t<input ng-show="link.type === \'dashboard\'" type=text ng-model=link.dashboard bs-typeahead=searchDashboards class=gf-form-input ng-blur=dashboardChanged(link)>\r\n\r\n\t\t\t\t<span class="gf-form-label width-7" ng-show="link.type === \'absolute\'">链接</span>\r\n\t\t\t\t<input ng-show="link.type === \'absolute\'" type=text ng-model=link.url class="gf-form-input max-width-14">\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class="gf-form max-width-25">\r\n\t\t\t\t<div class="gf-form-label width-7">标题</div>\r\n\t\t\t\t<input type=text ng-model=link.title class=gf-form-input>\r\n\t\t\t</div>\r\n\r\n\t\t</div>\r\n\r\n\t\t<div class=section>\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<span class="gf-form-label width-10">连接参数</span>\r\n\t\t\t\t<input type=text ng-model=link.params class="gf-form-input width-10">\r\n\t\t\t</div>\r\n\r\n\t\t\t<gf-form-switch class=gf-form label-class=width-10 label=包含时间范围 checked=link.keepTime></gf-form-switch>\r\n\t\t\t<gf-form-switch class=gf-form label-class=width-10 label=包含变量 checked=link.includeVars></gf-form-switch>\r\n\t\t\t<gf-form-switch class=gf-form label-class=width-10 label=在新标签页打开 checked=link.targetBlank></gf-form-switch>\r\n\t\t</div>\r\n\r\n\t\t<div class=section>\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<button class="btn btn-inverse gf-form-btn" ng-click=deleteLink(link)><i class="fa fa-trash"></i> 删除连接</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n\r\n<div class=editor-row>\r\n\t<button class="btn btn-inverse" ng-click=addLink()><i class="fa fa-plus"></i> 添加连接</button>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/dashboard/partials/create_folder.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<page-header model=ctrl.navModel></page-header>\r\n\r\n<div class="page-container page-body" ng-cloak>\r\n\r\n\t<h3 class=page-sub-heading>新建仪表盘文件夹</h3>\r\n\r\n  <form name=ctrl.saveForm ng-submit=ctrl.create() novalidate>\r\n\t\t<div class=gf-form-inline>\r\n\t\t\t<div class="gf-form gf-form--grow">\r\n\t\t\t\t<label class="gf-form-label width-10">名称</label>\r\n\t\t\t\t<input type=text class=gf-form-input ng-model=ctrl.title give-focus=true ng-change=ctrl.titleChanged() ng-model-options="{ debounce: 400 }" ng-class="{\'validation-error\': ctrl.nameExists || !ctrl.dash.title}">\r\n\t\t\t\t<label class="gf-form-label text-success" ng-if="ctrl.titleTouched && !ctrl.hasValidationError">\r\n\t\t\t\t\t<i class="fa fa-check"></i>\r\n\t\t\t\t</label>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class=gf-form-inline ng-if=ctrl.hasValidationError>\r\n\t\t\t<div class="gf-form offset-width-10 gf-form--grow">\r\n\t\t\t\t<label class="gf-form-label text-warning gf-form-label--grow">\r\n\t\t\t\t\t<i class="fa fa-warning"></i>\r\n\t\t\t\t\t{{ctrl.validationError}}\r\n\t\t\t\t</label>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class=gf-form-button-row>\r\n\t\t\t<button type=submit class="btn btn-success width-12" ng-disabled="!ctrl.titleTouched || ctrl.hasValidationError">\r\n\t\t\t\t<i class="fa fa-save"></i> 创建\r\n\t\t\t</button>\r\n\t\t</div>\r\n\t</form>\r\n\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/dashboard/partials/dashboard_import.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<page-header model=ctrl.navModel></page-header>\r\n\r\n<div class="page-container page-body" ng-cloak>\r\n  <div ng-if="ctrl.step === 1">\r\n\r\n    <form class=page-action-bar>\r\n      <div class=page-action-bar__spacer></div>\r\n      <dash-upload on-upload=ctrl.onUpload(dash)></dash-upload>\r\n    </form>\r\n\r\n    <h5 class=section-heading>KAM仪表盘</h5>\r\n\r\n    <div class=gf-form-group>\r\n      <div class="gf-form gf-form--grow">\r\n        <input type=text class="gf-form-input max-width-30" ng-model=ctrl.gnetUrl placeholder=粘贴KAM仪表盘链接或ID ng-blur=ctrl.checkGnetDashboard()>\r\n      </div>\r\n      <div class=gf-form ng-if=ctrl.gnetError>\r\n        <label class="gf-form-label text-warning">\r\n          <i class="fa fa-warning"></i>\r\n          {{ctrl.gnetError}}\r\n        </label>\r\n      </div>\r\n    </div>\r\n\r\n    <h5 class=section-heading>或粘贴JSON</h5>\r\n\r\n    <div class=gf-form-group>\r\n      <div class=gf-form>\r\n        <textarea rows=10 data-share-panel-url="" class=gf-form-input ng-model=ctrl.jsonText></textarea>\r\n      </div>\r\n      <button type=button class="btn btn-secondary" ng-click=ctrl.loadJsonText()>\r\n        <i class="fa fa-paste"></i>\r\n        加载\r\n      </button>\r\n      <span ng-if=ctrl.parseError class="text-error p-l-1">\r\n        <i class="fa fa-warning"></i>\r\n        {{ctrl.parseError}}\r\n      </span>\r\n    </div>\r\n  </div>\r\n\r\n  <div ng-if="ctrl.step === 2">\r\n    <div class=gf-form-group ng-if=ctrl.dash.gnetId>\r\n      <h3 class=section-heading>\r\n        从<a href=https://grafana.com/dashboards/{{ctrl.dash.gnetId}} class=external-link target=_blank>Grafana.com</a>导入仪表盘\r\n      </h3>\r\n\r\n      <div class=gf-form>\r\n        <label class="gf-form-label width-15">出版于</label>\r\n        <label class="gf-form-label width-15">{{ctrl.gnetInfo.orgName}}</label>\r\n      </div>\r\n      <div class=gf-form>\r\n        <label class="gf-form-label width-15">更新于</label>\r\n        <label class="gf-form-label width-15">{{ctrl.gnetInfo.updatedAt | date : \'yyyy-MM-dd HH:mm:ss\'}}</label>\r\n      </div>\r\n    </div>\r\n\r\n    <h3 class=section-heading>\r\n      选项\r\n    </h3>\r\n\r\n    <div class=gf-form-group>\r\n      <div class=gf-form-inline>\r\n        <div class="gf-form gf-form--grow">\r\n          <label class="gf-form-label width-15">名称</label>\r\n          <input type=text class=gf-form-input ng-model=ctrl.dash.title give-focus=true ng-change=ctrl.titleChanged() ng-class="{\'validation-error\': ctrl.nameExists || !ctrl.dash.title}">\r\n          <label class="gf-form-label text-success" ng-if="ctrl.titleTouched && !ctrl.hasNameValidationError">\r\n            <i class="fa fa-check"></i>\r\n          </label>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=gf-form-inline ng-if=ctrl.hasNameValidationError>\r\n        <div class="gf-form offset-width-15 gf-form--grow">\r\n          <label class="gf-form-label text-warning gf-form-label--grow">\r\n            <i class="fa fa-warning"></i>\r\n            {{ctrl.nameValidationError}}\r\n          </label>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=gf-form-inline>\r\n        <div class="gf-form gf-form--grow">\r\n          <folder-picker label-class=width-15 initial-folder-id=ctrl.folderId initial-title=ctrl.initialFolderTitle on-change=ctrl.onFolderChange($folder) on-load=ctrl.onFolderChange($folder) enter-folder-creation=ctrl.onEnterFolderCreation() exit-folder-creation=ctrl.onExitFolderCreation() enable-create-new=true>\r\n          </folder-picker>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=gf-form-inline>\r\n        <div class="gf-form gf-form--grow">\r\n          <span class="gf-form-label width-15">\r\n            唯一识别码 (uid)\r\n            <info-popover mode=right-normal>\r\n              仪表板的惟一标识符(uid)可用于在多个KAM安装之间唯一的标识仪表板。uid允许使用一致的URL访问仪表板，因此更改仪表板的标题不会破坏到该仪表板的任何书签链接。\r\n            </info-popover>\r\n          </span>\r\n          <input type=text class=gf-form-input disabled=disabled ng-model=ctrl.autoGenerateUidValue ng-if=ctrl.autoGenerateUid>\r\n          <a class="btn btn-secondary gf-form-btn" href=# ng-click="ctrl.autoGenerateUid = false" ng-if=ctrl.autoGenerateUid>改变</a>\r\n          <input type=text class=gf-form-input maxlength=40 placeholder=可选的，如果为空将自动生成 ng-model=ctrl.dash.uid ng-change=ctrl.uidChanged() ng-if=!ctrl.autoGenerateUid>\r\n          <label class="gf-form-label text-success" ng-if="!ctrl.autoGenerateUid && !ctrl.hasUidValidationError">\r\n            <i class="fa fa-check"></i>\r\n          </label>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=gf-form-inline ng-if=ctrl.hasUidValidationError>\r\n        <div class="gf-form offset-width-15 gf-form--grow">\r\n          <label class="gf-form-label text-warning gf-form-label--grow">\r\n            <i class="fa fa-warning"></i>\r\n            {{ctrl.uidValidationError}}\r\n          </label>\r\n        </div>\r\n      </div>\r\n\r\n      <div ng-repeat="input in ctrl.inputs">\r\n        <div class=gf-form>\r\n          <label class="gf-form-label width-15">\r\n            {{input.label}}\r\n            <info-popover mode=right-normal>\r\n              {{input.info}}\r\n            </info-popover>\r\n          </label>\r\n          \x3c!-- Data source input --\x3e\r\n          <div class=gf-form-select-wrapper style=width:100% ng-if="input.type === \'datasource\'">\r\n            <select class=gf-form-input ng-model=input.value ng-options="v.value as v.text for v in input.options" ng-change=ctrl.inputValueChanged()>\r\n              <option value="" ng-hide=input.value>{{input.info}}</option>\r\n            </select>\r\n          </div>\r\n          \x3c!-- Constant input --\x3e\r\n          <input ng-if="input.type === \'constant\'" type=text class=gf-form-input ng-model=input.value placeholder={{input.default}} ng-change=ctrl.inputValueChanged()>\r\n          <label class="gf-form-label text-success" ng-show=input.value>\r\n            <i class="fa fa-check"></i>\r\n          </label>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=gf-form-button-row>\r\n      <button type=button class="btn btn-success width-12" ng-click=ctrl.saveDashboard() ng-hide="ctrl.nameExists || ctrl.uidExists" ng-disabled=!ctrl.isValid()>\r\n        <i class="fa fa-save"></i> 导入\r\n      </button>\r\n      <button type=button class="btn btn-danger width-12" ng-click=ctrl.saveDashboard() ng-show="ctrl.nameExists || ctrl.uidExists" ng-disabled=!ctrl.isValid()>\r\n        <i class="fa fa-save"></i> 导入 (覆盖)\r\n      </button>\r\n      <a class="btn btn-link" ng-click=ctrl.back()>取消</a>\r\n    </div>\r\n\r\n  </div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/dashboard/partials/folder_dashboards.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<page-header ng-if=ctrl.navModel model=ctrl.navModel></page-header>\r\n\r\n<div class="page-container page-body">\r\n    <manage-dashboards ng-if="ctrl.folderId && ctrl.uid" folder-id=ctrl.folderId folder-uid=ctrl.uid />\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/dashboard/partials/folder_permissions.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<page-header model=ctrl.navModel></page-header>\r\n\r\n<div class="page-container page-body">\r\n  <dashboard-permissions ng-if="ctrl.dashboard && ctrl.meta" dashboardid=ctrl.dashboard.id />\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/dashboard/partials/folder_settings.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<page-header model=ctrl.navModel></page-header>\r\n\r\n<div class="page-container page-body">\r\n\t<h2 class=page-sub-heading>文件夹设置</h2>\r\n\r\n\t<div class="section gf-form-group">\r\n\t\t<form name=folderSettingsForm ng-submit=ctrl.save()>\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<label class="gf-form-label width-7">名称</label>\r\n\t\t\t\t<input type=text class="gf-form-input width-30" ng-model=ctrl.title ng-change=ctrl.titleChanged()>\r\n\t\t\t</div>\r\n\t\t\t<div class=gf-form-button-row>\r\n\t\t\t\t<button type=submit class="btn btn-success" ng-disabled="!ctrl.canSave || !ctrl.hasChanged">\r\n\t\t\t\t\t<i class="fa fa-save"></i>保存\r\n\t\t\t\t</button>\r\n\t\t\t\t<button class="btn btn-danger" ng-click=ctrl.delete($event) ng-disabled=!ctrl.canSave>\r\n\t\t\t\t\t<i class="fa fa-trash"></i>\r\n\t\t\t\t\t删除\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t</form>\r\n\t</div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/dashboard/partials/inspector.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=modal-body ng-controller=InspectCtrl ng-init=init()>\r\n\t<div class=modal-header>\r\n\t\t<h2 class=modal-header-title>\r\n\t\t\t<i class="fa fa-info-circle"></i>\r\n\t\t\t<span class=p-l-1>Inspector</span>\r\n\t\t</h2>\r\n\r\n\t\t<ul class=gf-tabs>\r\n\t\t\t<li class=gf-tabs-item ng-repeat="tab in [\'Panel Description\', \'Request\', \'Response\', \'JS Error\']">\r\n\t\t\t\t<a class=gf-tabs-link ng-click="editor.index = $index" ng-class="{active: editor.index === $index}">\r\n\t\t\t\t\t{{::tab}}\r\n\t\t\t\t</a>\r\n\t\t\t</li>\r\n\t\t</ul>\r\n\r\n\t\t<a class=modal-header-close ng-click=dismiss();>\r\n\t\t\t<i class="fa fa-remove"></i>\r\n\t\t</a>\r\n\t</div>\r\n\r\n\t<div class=modal-content>\r\n\t\t<div ng-if="editor.index == 0" ng-bind-html=panelInfoHtml>\r\n\t\t</div>\r\n\r\n\t\t<div ng-if="editor.index == 1">\r\n\t\t\t<h5 class=section-heading>Request details</h5>\r\n\t\t\t<table class="filter-table gf-form-group">\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<td>Url</td>\r\n\t\t\t\t\t<td>{{inspector.error.config.url}}</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<td>Method</td>\r\n\t\t\t\t\t<td>{{inspector.error.config.method}}</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr ng-repeat="(key, value) in inspector.error.config.headers">\r\n\t\t\t\t\t<td>\r\n\t\t\t\t\t\t{{key}}\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td>\r\n\t\t\t\t\t\t{{value}}\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</table>\r\n\r\n\t\t\t<h5 class=section-heading>Request parameters</h5>\r\n\t\t\t<table class=filter-table>\r\n\t\t\t\t<tr ng-repeat="param in request_parameters">\r\n\t\t\t\t\t<td>\r\n\t\t\t\t\t\t{{param.key}}\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td>\r\n\t\t\t\t\t\t{{param.value}}\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</table>\r\n\t\t</div>\r\n\r\n\t\t<div ng-if="editor.index == 2">\r\n\t\t\t<h5 ng-show=message>{{message}}</h5>\r\n \t\t\t<pre class=small>\r\n{{response}}\r\n\t\t\t</pre>\r\n\t\t</div>\r\n\r\n\t\t<div ng-if="editor.index == 3">\r\n\r\n\t\t\t<label>Message:</label>\r\n<pre>\r\n{{message}}\r\n</pre>\r\n\r\n\t\t\t<label>Stack trace:</label>\r\n<pre>\r\n{{stack_trace}}\r\n</pre>\r\n\r\n\t\t</div>\r\n\r\n\t</div>\r\n</div>\r\n\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/dashboard/partials/row_options.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=modal-body>\r\n\t<div class=modal-header>\r\n\t\t<h2 class=modal-header-title>\r\n\t\t\t<i class="fa fa-copy"></i>\r\n\t\t\t<span class=p-l-1>Row Options</span>\r\n\t\t</h2>\r\n\r\n\t\t<a class=modal-header-close ng-click=ctrl.dismiss();>\r\n\t\t\t<i class="fa fa-remove"></i>\r\n\t\t</a>\r\n\t</div>\r\n\r\n\t<form name=ctrl.saveForm ng-submit=ctrl.save() class="modal-content text-center" novalidate>\r\n\t\t<div class=section>\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<span class="gf-form-label width-7">Title</span>\r\n\t\t\t\t<input type=text class="gf-form-input max-width-13" ng-model=ctrl.row.title>\r\n\t\t\t</div>\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<span class="gf-form-label width-7">Repeat for</span>\r\n\t\t\t\t<dash-repeat-option panel=ctrl.row></dash-repeat-option>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=gf-form-button-row>\r\n\t\t\t\t<button type=submit class="btn btn-success" ng-click=ctrl.update()>Update</button>\r\n\t\t\t\t<button type=button class="btn btn-inverse" ng-click=ctrl.dismiss()>Cancel</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</form>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/dashboard/partials/shareModal.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=modal-body ng-controller=ShareModalCtrl ng-init=init()>\r\n\r\n\t<div class=modal-header>\r\n\t\t<h2 class=modal-header-title>\r\n\t\t\t<i class="fa fa-share-square-o"></i>\r\n\t\t\t<span class=p-l-1>{{modalTitle}}</span>\r\n\t\t</h2>\r\n\r\n\t\t<ul class=gf-tabs>\r\n\t\t\t<li class=gf-tabs-item ng-repeat="tab in tabs">\r\n\t\t\t\t<a class=gf-tabs-link ng-click="editor.index = $index" ng-class="{active: editor.index === $index}">\r\n\t\t\t\t\t{{::tab.title}}\r\n\t\t\t\t</a>\r\n\t\t\t</li>\r\n\t\t</ul>\r\n\r\n\t\t<a class=modal-header-close ng-click=dismiss();>\r\n\t\t\t<i class="fa fa-remove"></i>\r\n\t\t</a>\r\n\t</div>\r\n\r\n\t<div class=modal-content ng-repeat="tab in tabs" ng-if="editor.index == $index">\r\n\t\t<div ng-include src=tab.src class=share-modal-body></div>\r\n\t</div>\r\n\r\n</div>\r\n\r\n<script type=text/ng-template id=shareEmbed.html>\r\n\t<div class="share-modal-header">\r\n\t\t<div class="share-modal-big-icon">\r\n\t\t\t<i class="fa fa-code"></i>\r\n\t\t</div>\r\n\t\t<div class="share-modal-content">\r\n\t\t\t<p class="share-modal-info-text">\r\n\t\t\t\t下面的html代码可以粘贴在另一个网页中。\r\n\t\t\t</p>\r\n\r\n\t\t\t<div ng-include src="\'shareLinkOptions.html\'"></div>\r\n\r\n\t\t\t<div class="gf-form-group gf-form--grow">\r\n\t\t\t\t<div class="gf-form">\r\n\t\t\t\t\t<textarea rows="5" data-share-panel-url class="gf-form-input" ng-model=\'iframeHtml\'></textarea>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n<\/script>\r\n\r\n<script type=text/ng-template id=shareExport.html>\r\n\t<dash-export-modal dismiss="dismiss()"></dash-export-modal>\r\n<\/script>\r\n\r\n<script type=text/ng-template id=shareLinkOptions.html>\r\n\t<div class="gf-form-group">\r\n\t\t<gf-form-switch class="gf-form"\r\n\t\t\tlabel="当前时间范围" label-class="width-12" switch-class="max-width-6"\r\n\t\t\tchecked="options.forCurrent" on-change="buildUrl()">\r\n\t\t</gf-form-switch>\r\n\t\t<gf-form-switch class="gf-form"\r\n\t\t\tlabel="模板变量" label-class="width-12" switch-class="max-width-6"\r\n\t\t\tchecked="options.includeTemplateVars" on-change="buildUrl()">\r\n\t\t</gf-form-switch>\r\n\t\t<div class="gf-form">\r\n\t\t\t<span class="gf-form-label width-12">主题</span>\r\n\t\t\t<div class="gf-form-select-wrapper width-10">\r\n\t\t\t\t<select class="gf-form-input" ng-model="options.theme" ng-options="f as f for f in [\'current\', \'dark\', \'light\']" ng-change="buildUrl()"></select>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n<\/script>\r\n\r\n<script type=text/ng-template id=shareLink.html>\r\n\t<div class="share-modal-header">\r\n\t\t<div class="share-modal-big-icon">\r\n\t\t\t<i class="fa fa-link"></i>\r\n\t\t</div>\r\n\t\t<div class="share-modal-content">\r\n\t\t\t<p class="share-modal-info-text">\r\n\t\t\t\t创建这个仪表盘或面板的链接，使用下面的选项进行定制。\r\n\t\t\t</p>\r\n\t\t\t<div ng-include src="\'shareLinkOptions.html\'"></div>\r\n\t\t\t<div>\r\n\t\t\t\t<div class="gf-form-group">\r\n\t\t\t\t\t<div class="gf-form-inline">\r\n\t\t\t\t\t\t<div class="gf-form gf-form--grow">\r\n\t\t\t\t\t\t\t<input type="text" data-share-panel-url class="gf-form-input" ng-model="shareUrl"></input>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class="gf-form">\r\n\t\t\t\t\t\t\t<button class="btn btn-inverse" clipboard-button="getShareUrl()"><i class="fa fa-clipboard"></i> 复制</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class="gf-form" ng-show="modeSharePanel">\r\n\t\t\t\t<a href="{{imageUrl}}" target="_blank"><i class="fa fa-camera"></i> 直接链接渲染图像</a>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<\/script>\r\n\r\n<script type=text/ng-template id=shareSnapshot.html>\r\n\t<div class="ng-cloak" ng-cloak ng-controller="ShareSnapshotCtrl" ng-init="init()">\r\n\t\t<div class="share-modal-header">\r\n\t\t\t<div class="share-modal-big-icon">\r\n\t\t\t\t<i ng-if="loading" class="fa fa-spinner fa-spin"></i>\r\n\t\t\t\t<i ng-if="!loading" class="icon-gf icon-gf-snapshot"></i>\r\n\t\t\t</div>\r\n      <div class="share-modal-content">\r\n        <div ng-if="step === 1">\r\n          <p class="share-modal-info-text">\r\n\t\t\t快照是一种即时共享交互式仪表板的方式。当创建时，我们查询(度量、模板和注释)和面板链接，只留下可见的度量数据和系列名称嵌入到您的仪表板。\r\n          </p>\r\n          <p class="share-modal-info-text">\r\n            请记住，你的<strong>快照可以被任何</strong>有链接的人查看。\r\n          </p>\r\n        </div>\r\n\r\n\t\t\t\t<div class="share-modal-header" ng-if="step === 3">\r\n\t\t\t\t\t<p class="share-modal-info-text">\r\n\t\t\t\t\t\t快照被删除. 如果你已经访问过它一次，它可能需要一个小时才能从浏览器缓存或CDN缓存中删除。\r\n\t\t\t\t\t</p>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class="gf-form-group share-modal-options">\r\n\t\t\t\t\t<div class="gf-form" ng-if="step === 1">\r\n\t\t\t\t\t\t<span class="gf-form-label width-12">快照名称</span>\r\n\t\t\t\t\t\t<input type="text" ng-model="snapshot.name" class="gf-form-input max-width-15" >\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class="gf-form" ng-if="step === 1">\r\n\t\t\t\t\t\t<span class="gf-form-label width-12">失效时间</span>\r\n\t\t\t\t\t\t<div class="gf-form-select-wrapper max-width-15">\r\n\t\t\t\t\t\t\t<select class="gf-form-input" ng-model="snapshot.expires" ng-options="f.value as f.text for f in expireOptions"></select>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class="gf-form" ng-if="step === 2" style="margin-top: 40px">\r\n\t\t\t\t\t\t<div class="gf-form-row">\r\n\t\t\t\t\t\t\t<a href="{{snapshotUrl}}" class="large share-modal-link" target="_blank">\r\n\t\t\t\t\t\t\t\t<i class="fa fa-external-link-square"></i>\r\n\t\t\t\t\t\t\t\t{{snapshotUrl}}\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t\t<button class="btn btn-inverse" clipboard-button="getSnapshotUrl()"><i class="fa fa-clipboard"></i> 复制链接</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div ng-if="step === 1">\r\n\t\t\t\t\t<p class="share-modal-info-text">\r\n\t\t\t\t\t\t如果收集仪表板指标需要很长时间，则可能需要配置超时值。\r\n\t\t\t\t\t</p>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class="gf-form-group share-modal-options">\r\n\t\t\t\t\t<div class="gf-form" ng-if="step === 1">\r\n\t\t\t\t\t\t<span class="gf-form-label width-12">超时 (秒)</span>\r\n\t\t\t\t\t\t<input type="number" ng-model="snapshot.timeoutSeconds" class="gf-form-input max-width-15" >\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div ng-if="step === 1" class="gf-form-button-row">\r\n\t\t\t\t\t<button class="btn gf-form-btn width-10 btn-success" ng-click="createSnapshot()" ng-disabled="loading">\r\n\t\t\t\t\t\t<i class="fa fa-save"></i>\r\n\t\t\t\t\t\t本地快照\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<button class="btn gf-form-btn width-16 btn-secondary" ng-if="externalEnabled" ng-click="createSnapshot(true)" ng-disabled="loading">\r\n\t\t\t\t\t\t<i class="fa fa-cloud-upload"></i>\r\n\t\t\t\t\t\t{{sharingButtonText}}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<a class="btn btn-link" ng-click="dismiss()">取消</a>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class="pull-right" ng-if="step === 2" style="padding: 5px">\r\n\t\t\t\t\t有错误? <a class="pointer" ng-click="deleteSnapshot()" target="_blank">删除快照.</a>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\r\n</div>\r\n<\/script>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/dashboard/settings/settings.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<aside class=dashboard-settings__aside>\r\n\t<h2 class=dashboard-settings__aside-header>\r\n\t\t<i class="fa fa-cog"></i>\r\n\t\t设置\r\n\t</h2>\r\n\r\n\t<a href={{::section.url}} class=dashboard-settings__nav-item ng-class="{active: ctrl.viewId === section.id}" ng-repeat="section in ctrl.sections">\r\n    <i class={{::section.icon}}></i>\r\n\t\t{{::section.title}}\r\n\t</a>\r\n\r\n\t<div class=dashboard-settings__aside-actions>\r\n    <button class="btn btn-success" ng-click=ctrl.saveDashboard() ng-show=ctrl.canSave>\r\n\t\t\t<i class="fa fa-save"></i> 保存\r\n\t\t</button>\r\n\t\t<button class="btn btn-inverse" ng-click=ctrl.openSaveAsModal() ng-show=ctrl.canSaveAs>\r\n\t\t\t<i class="fa fa-copy"></i>\r\n\t\t\t保存为...\r\n\t\t</button>\r\n\t\t<button class="btn btn-danger" ng-click=ctrl.deleteDashboard() ng-show=ctrl.canDelete>\r\n\t\t\t<i class="fa fa-trash"></i>\r\n\t\t\t删除\r\n\t\t</button>\r\n\t</div>\r\n</aside>\r\n\r\n<div class=dashboard-settings__content ng-if="ctrl.viewId === \'settings\'">\r\n\t<h3 class=dashboard-settings__header>\r\n\t\t默认\r\n\t</h3>\r\n\r\n\t<div class=gf-form-group>\r\n\t\t<div class=gf-form>\r\n\t\t\t<label class="gf-form-label width-7">名称</label>\r\n\t\t\t<input type=text class="gf-form-input width-30" ng-model=ctrl.dashboard.title>\r\n\t\t</div>\r\n\t\t<div class=gf-form>\r\n\t\t\t<label class="gf-form-label width-7">描述</label>\r\n\t\t\t<input type=text class="gf-form-input width-30" ng-model=ctrl.dashboard.description>\r\n\t\t</div>\r\n\r\n\t\t\x3c!-- [OGE] --\x3e\r\n\t\t<div class=gf-form>\r\n\t\t\t<label class="gf-form-label width-7">背景色</label>\r\n\t\t\t<span class=gf-form-label>\r\n\t\t\t\t\t\t<spectrum-picker ng-model=ctrl.dashboard.bgColor></spectrum-picker>\r\n\t\t\t\t</span>\r\n\t\t\t\t<span class=gf-form-label>\r\n\t\t\t\t\t<i class="fa fa-arrow-right"></i>\r\n\t\t\t</span>\r\n\t\t\t<input type=text ng-model=ctrl.dashboard.bgColor class="gf-form-input max-width-9">\r\n\t\t</div>\t\r\n\t\t\x3c!-- [OGE].END --\x3e\r\n\r\n\t\t<div class=gf-form>\r\n\t\t\t<label class="gf-form-label width-7">\r\n\t\t\t\t标签\r\n\t\t\t\t<info-popover mode=right-normal>按Enter键添加标签</info-popover>\r\n\t\t\t</label>\r\n\t\t\t<bootstrap-tagsinput ng-model=ctrl.dashboard.tags tagclass="label label-tag" placeholder=添加标签s>\r\n\t\t\t</bootstrap-tagsinput>\r\n\t\t</div>\r\n\t\t<folder-picker initial-title=ctrl.dashboard.meta.folderTitle initial-folder-id=ctrl.dashboard.meta.folderId on-change=ctrl.onFolderChange($folder) enable-create-new=true is-valid-selection=true label-class=width-7>\r\n\t\t</folder-picker>\r\n\t\t<gf-form-switch class=gf-form label=可编辑 tooltip=取消选中，然后保存并重新加载以禁用所有仪表板编辑 checked=ctrl.dashboard.editable label-class=width-7>\r\n\t\t</gf-form-switch>\r\n\t</div>\r\n\r\n\t<gf-time-picker-settings dashboard=ctrl.dashboard></gf-time-picker-settings>\r\n\r\n\t<h5 class=section-heading>面板选项</h5>\r\n\t<div class=gf-form>\r\n\t\t<label class="gf-form-label width-11">\r\n\t\t\t图表提示\r\n\t\t\t<info-popover mode=right-normal>\r\n\t\t\t\t使用快捷键在选项之间循环:CTRL+O或CMD+O\r\n\t\t\t</info-popover>\r\n\t\t</label>\r\n\t\t<div class=gf-form-select-wrapper>\r\n\t\t\t<select ng-model=ctrl.dashboard.graphTooltip class=gf-form-input ng-options="f.value as f.text for f in [{value: 0, text: \'默认\'}, {value: 1, text: \'Shared crosshair\'},{value: 2, text: \'分享提示\'}]"></select>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n\r\n<div class=dashboard-settings__content ng-if="ctrl.viewId === \'annotations\'" ng-include="\'public/app/features/annotations/partials/editor.html\'">\r\n</div>\r\n\r\n<div class=dashboard-settings__content ng-if="ctrl.viewId === \'templating\'" ng-include="\'public/app/features/templating/partials/editor.html\'">\r\n</div>\r\n\r\n<div class=dashboard-settings__content ng-if="ctrl.viewId === \'links\'">\r\n\t<dash-links-editor dashboard=ctrl.dashboard></dash-links-editor>\r\n</div>\r\n\r\n<div class=dashboard-settings__content ng-if="ctrl.viewId === \'versions\'">\r\n\t<gf-dashboard-history dashboard=dashboard></gf-dashboard-history>\r\n</div>\r\n\r\n<div class=dashboard-settings__content ng-if="ctrl.viewId === \'dashboard_json\'">\r\n\t<h3 class=dashboard-settings__header>JSON模型</h3>\r\n  <div class=dashboard-settings__subheader>\r\n    下面的JSON模型是定义仪表板的数据结构。包括设置，面板设置和布局，查询等。\r\n  </div>\r\n\r\n\t<div class=gf-form>\r\n\t\t<code-editor content=ctrl.json data-mode=json data-max-lines=30></code-editor>\r\n\t</div>\r\n\r\n  <div class=gf-form-button-row>\r\n    <button class="btn btn-success" ng-click=ctrl.saveDashboardJson() ng-show=ctrl.canSave>\r\n      <i class="fa fa-save"></i> 保存修改\r\n    </button>\r\n  </div>\r\n</div>\r\n\r\n<div class=dashboard-settings__content ng-if="ctrl.viewId === \'permissions\'">\r\n  <dashboard-permissions ng-if="ctrl.dashboard && !ctrl.hasUnsavedFolderChange" dashboardid=ctrl.dashboard.id backendsrv=ctrl.backendSrv folder=ctrl.getFolder() />\r\n  <div ng-if=ctrl.hasUnsavedFolderChange>\r\n    <h5>您已更改文件夹，请保存以查看权限。</h5>\r\n  </div>\r\n</div>\r\n\r\n<div class=dashboard-settings__content ng-if="ctrl.viewId === \'404\'">\r\n  <h3 class=dashboard-settings__header>未找到设置视图</h3>\r\n\r\n  <div>\r\n    <h5>找不到设置页面，或者您没有访问该页的权限</h5>\r\n  </div>\r\n</div>\r\n\r\n<div class=dashboard-settings__content ng-if="ctrl.viewId === \'make_editable\'">\r\n  <h3 class=dashboard-settings__header>可编辑</h3>\r\n\r\n  <button class="btn btn-success" ng-click=ctrl.makeEditable()>\r\n    可编辑\r\n  </button>\r\n</div>\r\n\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/dashboard/submenu/submenu.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=submenu-controls>\r\n  \x3c!-- [OGE] --\x3e\r\n  <div class="submenu-item gf-form-inline" id=a-spacial-class-sd ng-if="ctrl.dashboard.description && ctrl.dashboard.description.length > 0" style="font-size:24px;padding:0 20px">{{ctrl.regDCandJZ(ctrl.dashboard.description)}}</div>\r\n  \x3c!-- 结束 --\x3e\r\n  <div ng-repeat="variable in ctrl.variables" ng-hide="variable.hide === 2" class="submenu-item gf-form-inline">\r\n    <div class=gf-form>\r\n      <label class="gf-form-label template-variable" ng-hide="variable.hide === 1">\r\n        {{variable.label || variable.name}}\r\n      </label>\r\n      <value-select-dropdown ng-if="variable.type !== \'adhoc\' && variable.type !== \'textbox\'" variable=variable on-updated=ctrl.variableUpdated(variable)></value-select-dropdown>\r\n      <input type=text ng-if="variable.type === \'textbox\'" ng-model=variable.query class="gf-form-input width-12" ng-blur="variable.current.value != variable.query && variable.updateOptions() && ctrl.variableUpdated(variable);" ng-keydown="$event.keyCode === 13 && variable.current.value != variable.query && variable.updateOptions() && ctrl.variableUpdated(variable);">\r\n    </div>\r\n    <ad-hoc-filters ng-if="variable.type === \'adhoc\'" variable=variable></ad-hoc-filters>\r\n  </div>\r\n\r\n  <div ng-if="ctrl.dashboard.annotations.list.length > 0">\r\n    <div ng-repeat="annotation in ctrl.dashboard.annotations.list" ng-hide=annotation.hide class=submenu-item ng-class="{\'annotation-disabled\': !annotation.enable}">\r\n\t\t\t<gf-form-switch class=gf-form label={{annotation.name}} checked=annotation.enable on-change=ctrl.annotationStateChanged()></gf-form-switch>\r\n    </div>\r\n  </div>\r\n\r\n  <div class="gf-form gf-form--grow">\r\n  </div>\r\n\r\n  <div ng-if="ctrl.dashboard.links.length > 0">\r\n    <dash-links-container links=ctrl.dashboard.links dashboard=ctrl.dashboard class=gf-form-inline></dash-links-container>\r\n  </div>\r\n\r\n  <div class=clearfix></div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/dashboard/timepicker/settings.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,"<div class=editor-row>\r\n\t<h5 class=section-heading>时间选项</h5>\r\n\r\n  <div class=gf-form-group>\r\n\t\t<div class=gf-form>\r\n\t\t\t<label class=\"gf-form-label width-10\">时区</label>\r\n\t\t\t<div class=gf-form-select-wrapper>\r\n\t\t\t\t<select ng-model=ctrl.dashboard.timezone class=gf-form-input ng-options=\"f.value as f.text for f in [{value: '', text: 'Default'}, {value: 'browser', text: 'Local browser time'},{value: 'utc', text: 'UTC'}]\"></select>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class=\"gf-form-label width-10\">自动刷新</span>\r\n\t\t\t<input type=text class=\"gf-form-input max-width-25\" ng-model=ctrl.panel.refresh_intervals array-join>\r\n\t\t</div>\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class=\"gf-form-label width-10\">现在延迟-</span>\r\n\t\t\t<input type=text class=\"gf-form-input max-width-25\" ng-model=ctrl.panel.nowDelay placeholder=0m valid-time-span bs-tooltip=\"'Enter 1m to ignore the last minute (because it can contain incomplete metrics)'\" data-placement=right>\r\n\t\t</div>\r\n\r\n\t\t<gf-form-switch class=gf-form label=隐藏时间选择器 checked=ctrl.panel.hidden label-class=width-10></gf-form-switch>\r\n\t</div>\r\n</div>\r\n")}]),t.exports=r},function(t,e){var r="public/app/features/dashboard/timepicker/timepicker.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=navbar-buttons>\r\n  <button class="btn navbar-button navbar-button--tight" ng-click=ctrl.move(-1) ng-if=ctrl.isAbsolute>\r\n\t\t<i class="fa fa-chevron-left"></i>\r\n\t</button>\r\n\r\n\t<button bs-tooltip=ctrl.tooltip data-placement=bottom ng-click=ctrl.openDropdown() class="btn navbar-button gf-timepicker-nav-btn">\r\n\t\t<i class="fa fa-clock-o"></i>\r\n\t\t<span ng-bind=ctrl.rangeString></span>\r\n\t\t<span ng-show=ctrl.isUtc class=gf-timepicker-utc>UTC</span>\r\n\t\t<span ng-show=ctrl.dashboard.refresh class=text-warning>&nbsp; 每 {{ctrl.dashboard.refresh}} 刷新一次</span>\r\n\t</button>\r\n\r\n  <button class="btn navbar-button navbar-button--tight" ng-click=ctrl.move(1) ng-if=ctrl.isAbsolute>\r\n\t\t<i class="fa fa-chevron-right"></i>\r\n\t</button>\r\n\r\n  <button class="btn navbar-button navbar-button--zoom" bs-tooltip="\'缩小时间范围 <br> CTRL+Z\'" data-placement=bottom ng-click=ctrl.zoom(2)>\r\n\t\t<i class="fa fa-search-minus"></i>\r\n\t</button>\r\n\r\n  <button class="btn navbar-button navbar-button--refresh" ng-click=ctrl.timeSrv.refreshDashboard()>\r\n\t\t<i class="fa fa-refresh"></i>\r\n\t</button>\r\n</div>\r\n\r\n<div ng-if=ctrl.isOpen class=gf-timepicker-dropdown>\r\n  <form name=timeForm class=gf-timepicker-absolute-section>\r\n    <h3 class=section-heading>自定义范围</h3>\r\n\r\n    <label class=small>从：</label>\r\n    <div class=gf-form-inline>\r\n      <div class="gf-form max-width-28">\r\n        <input type=text class="gf-form-input input-large" ng-model=ctrl.editTimeRaw.from input-datetime>\r\n      </div>\r\n      <div class=gf-form>\r\n        <button class="btn gf-form-btn btn-primary" type=button ng-click="openFromPicker=!openFromPicker">\r\n          <i class="fa fa-calendar"></i>\r\n        </button>\r\n      </div>\r\n    </div>\r\n\r\n    <div ng-if=openFromPicker>\r\n      <datepicker ng-model=ctrl.absolute.fromJs class=gf-timepicker-component show-weeks=false starting-day=ctrl.firstDayOfWeek ng-change=ctrl.absoluteFromChanged()></datepicker>\r\n    </div>\r\n\r\n\r\n    <label class=small>到：</label>\r\n    <div class=gf-form-inline>\r\n      <div class="gf-form max-width-28">\r\n        <input type=text class="gf-form-input input-large" ng-model=ctrl.editTimeRaw.to input-datetime>\r\n      </div>\r\n      <div class=gf-form>\r\n        <button class="btn gf-form-btn btn-primary" type=button ng-click="openToPicker=!openToPicker">\r\n          <i class="fa fa-calendar"></i>\r\n        </button>\r\n      </div>\r\n    </div>\r\n\r\n    <div ng-if=openToPicker>\r\n      <datepicker ng-model=ctrl.absolute.toJs class=gf-timepicker-component show-weeks=false starting-day=ctrl.firstDayOfWeek ng-change=ctrl.absoluteToChanged()></datepicker>\r\n    </div>\r\n\r\n    <label class=small>刷新间隔：</label>\r\n    <div class=gf-form-inline>\r\n      <div class="gf-form max-width-28">\r\n        <select ng-model=ctrl.refresh.value class="gf-form-input input-medium" ng-options="f.value as f.text for f in ctrl.refresh.options"></select>\r\n      </div>\r\n      <div class=gf-form>\r\n        <button type=submit class="btn gf-form-btn btn-secondary" ng-click=ctrl.applyCustom(); ng-disabled=!timeForm.$valid>应用</button>\r\n      </div>\r\n    </div>\r\n  </form>\r\n\r\n  <div class=gf-timepicker-relative-section>\r\n    <h3 class=section-heading>常用范围</h3>\r\n    <ul ng-repeat="group in ctrl.timeOptions">\r\n      <li bindonce ng-repeat="option in group" ng-class="{active: option.active}">\r\n        <a ng-click=ctrl.setRelativeFilter(option) bo-text=option.display></a>\r\n      </li>\r\n    </ul>\r\n  </div>\r\n</div>\r\n\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/manage-dashboards/partials/dashboard_list.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<page-header model=ctrl.navModel></page-header>\r\n\r\n<div class="page-container page-body">\r\n  <manage-dashboards/>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/manage-dashboards/partials/snapshot_list.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<page-header model=ctrl.navModel></page-header>\r\n\r\n<div class="page-container page-body">\r\n   <table class=filter-table>\r\n    <thead>\r\n      <th><strong>名称</strong></th>\r\n      <th><strong>快照链接</strong></th>\r\n      <th style=width:70px></th>\r\n      <th style=width:25px></th>\r\n\t\t</thead>\r\n\t\t<tr ng-repeat="snapshot in ctrl.snapshots">\r\n      <td>\r\n\t\t\t\t<a href=dashboard/snapshot/{{snapshot.key}}>{{snapshot.name}}</a>\r\n      </td>\r\n      <td>\r\n        <a href=dashboard/snapshot/{{snapshot.key}}>dashboard/snapshot/{{snapshot.key}}</a>\r\n      </td>\r\n      <td class=text-center>\r\n        <a href=dashboard/snapshot/{{snapshot.key}} class="btn btn-inverse btn-mini">\r\n          <i class="fa fa-eye"></i>\r\n          查看\r\n        </a>\r\n      </td>\r\n      <td class=text-right>\r\n        <a ng-click=ctrl.removeSnapshot(snapshot) class="btn btn-danger btn-mini">\r\n          <i class="fa fa-remove"></i>\r\n        </a>\r\n      </td>\r\n    </tr>\r\n  </table>\r\n\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/org/partials/invite.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<page-header model=ctrl.navModel></page-header>\r\n\r\n<div class="page-container page-body" ng-cloak>\r\n\r\n\t<h2 class=page-sub-heading>邀请用户</h2>\r\n\r\n\t<div class=p-b-2>\r\n\t\t向组织发送邀请或添加现有的KAM用户\r\n\t\t<span class=highlight-word>{{contextSrv.user.orgName}}</span>\r\n\t</div>\r\n\r\n\t<form name=ctrl.inviteForm>\r\n\t\t<div class=gf-form-group>\r\n\t\t\t<div class="gf-form max-width-30">\r\n\t\t\t\t<span class="gf-form-label width-10">邮箱或用户</span>\r\n\t\t\t\t<input type=text ng-model=ctrl.invite.loginOrEmail required class=gf-form-input placeholder=email@test.com>\r\n\t\t\t</div>\r\n\t\t\t<div class="gf-form max-width-30">\r\n\t\t\t\t<span class="gf-form-label width-10">名称</span>\r\n\t\t\t\t<input type=text ng-model=ctrl.invite.name class=gf-form-input placeholder="名称 (可选)">\r\n\t\t\t</div>\r\n\t\t\t<div class="gf-form max-width-30">\r\n        <span class="gf-form-label width-10">角色</span>\r\n\t\t\t\t<select ng-model=ctrl.invite.role class=gf-form-input ng-options="f for f in [\'Viewer\', \'Editor\', \'Admin\']">\r\n\t\t\t\t</select>\r\n\t\t\t</div>\r\n\r\n\t\t\t<gf-form-switch class=gf-form label=发送邀请邮件 checked=ctrl.invite.sendEmail label-class=width-10></gf-form-switch>\r\n\r\n\t\t\t<div class=gf-form-button-row>\r\n\t\t\t\t<button type=submit class="btn btn-success" ng-click=ctrl.sendInvite();>邀请</button>\r\n\t\t\t\t<a class="btn btn-inverse" href=org/users>返回</a>\r\n\t\t\t</div>\r\n\t</div></form>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/org/partials/newOrg.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<page-header model=navModel></page-header>\r\n\r\n<div class="page-container page-body" ng-form=playlistEditForm>\r\n\t<h2 class=page-sub-heading>\r\n\t\t新组织\r\n\t</h2>\r\n\r\n\t<p class=playlist-description>每个组织都包含自己的仪表板、数据源和配置，并且不能在组织之间共享。虽然一个用户可能属于多个组织，但在多用户部署中最常用的是多个组织。 </p>\r\n\r\n\t<form>\r\n\t\t<div class=gf-form-group>\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<span class="gf-form-label width-10">组织名称</span>\r\n\t\t\t\t<input type=text ng-model=newOrg.name required class="gf-form-input max-width-21" placeholder=组织名称>\r\n\t\t\t</div>\r\n\t\t\t<br>\r\n\t\t\t<div class=gf-form-buttons-row>\r\n\t\t\t\t<button type=submit class="btn btn-success" ng-click=createOrg()>创建</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</form>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/org/partials/select_org.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<page-header model=navModel></page-header>\r\n\r\n<div class="page-container page-body">\r\n\r\n\t<div class=signup>\r\n\t\t<div class=login-form>\r\n\r\n\t\t\t<div class=modal-tagline>\r\n\t\t\t\tYou have been added to another Organization due to an open invitation!\r\n\r\n\t\t\t\tPlease select which organization you want to <br>\r\n\t\t\t\tuse right now (you can change this later at any time).\r\n\t\t\t</div>\r\n\r\n\t\t\t<div style="display:inline-block;width:400px;margin:30px 0">\r\n\t\t\t\t<div ng-repeat="org in orgs">\r\n\t\t\t\t\t<a ng-click=setUsingOrg(org) class="btn btn-success">\r\n\t\t\t\t\t\t{{org.name}} ({{org.role}})\r\n\t\t\t\t\t</a>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n\r\n\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/panel/partials/metrics_tab.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=gf-form-group>\r\n  <div class=gf-form-inline>\r\n    <div class=gf-form>\r\n      <label class=gf-form-label>数据源</label>\r\n      <gf-form-dropdown model=ctrl.panelDsValue css-class=gf-size-auto lookup-text=true get-options=ctrl.getOptions(true) on-change=ctrl.datasourceChanged($option)>\r\n      </gf-form-dropdown>\r\n\t\t</div>\r\n\r\n\t\t<div class="gf-form gf-form--grow">\r\n\t\t\t<label class="gf-form-label gf-form-label--grow"></label>\r\n\t\t</div>\r\n\t\t<div class=gf-form ng-if=ctrl.queryOptions>\r\n\t\t\t<a class=gf-form-label ng-click=ctrl.toggleOptions()>\r\n\t\t\t\t<i class="fa fa-fw fa-caret-right" ng-hide=ctrl.optionsOpen></i><i class="fa fa-fw fa-caret-down" ng-show=ctrl.optionsOpen></i>选项\r\n\t\t\t</a>\r\n\t\t</div>\r\n\t\t<div class=gf-form ng-if=ctrl.hasQueryHelp>\r\n\t\t\t<button class=gf-form-label ng-click=ctrl.toggleHelp()>\r\n\t\t\t\t<i class="fa fa-fw fa-caret-right" ng-hide=ctrl.helpOpen></i><i class="fa fa-fw fa-caret-down" ng-show=ctrl.helpOpen></i>帮助\r\n\t\t\t</button>\r\n\t\t</div>\r\n\t\t<div class=gf-form>\r\n\t\t\t<button class=gf-form-label ng-click=ctrl.toggleQueryTroubleshooter() bs-tooltip="\'显示查询请求和响应\'">\r\n\t\t\t\t<i class="fa fa-fw fa-caret-right" ng-hide=ctrl.queryTroubleshooterOpen></i><i class="fa fa-fw fa-caret-down" ng-show=ctrl.queryTroubleshooterOpen></i>查询检查器\r\n\t\t\t</button>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div>\r\n\t\t<div ng-if=ctrl.optionsOpen>\r\n\t\t\t<div class="gf-form gf-form--flex-end" ng-if=ctrl.queryOptions.minInterval>\r\n\t\t\t\t<label class=gf-form-label>最小时间间隔</label>\r\n\t\t\t\t<input type=text class="gf-form-input width-6" placeholder={{ctrl.panelCtrl.interval}} ng-model=ctrl.panel.interval spellcheck=false ng-model-onblur ng-change=ctrl.panelCtrl.refresh() />\r\n\t\t\t\t<info-popover mode=right-absolute>\r\n\t\t\t\t\t通过时间间隔自动分组的最低限制。建议设置为写入频率，\r\n\t\t\t\t\t例如，如果您的数据每分钟写入一次，则为<code>1m</code>。通过变量<code>$__interval</code>（用于时间范围字符串）和<code>$__interval_ms</code>（用于可用于数学表达式的数值变量）访问自动间隔时间。\r\n\t\t\t\t</info-popover>\r\n\t\t\t</div>\r\n\t\t\t<div class="gf-form gf-form--flex-end" ng-if=ctrl.queryOptions.cacheTimeout>\r\n\t\t\t\t<label class="gf-form-label width-9">缓存超时</label>\r\n\t\t\t\t<input type=text class="gf-form-input width-6" placeholder=60 ng-model=ctrl.panel.cacheTimeout ng-model-onblur ng-change=ctrl.panelCtrl.refresh() spellcheck=false />\r\n\t\t\t\t<info-popover mode=right-absolute>\r\n\t\t\t\t\t如果时间序列存储区有查询缓存，则此选项可以覆盖默认缓存超时。指定以秒为单位的数值。\r\n\t\t\t\t</info-popover>\r\n\t\t\t</div>\r\n\t\t\t<div class="gf-form gf-form--flex-end" ng-if=ctrl.queryOptions.maxDataPoints>\r\n\t\t\t\t<label class="gf-form-label width-9">最大数据点</label>\r\n\t\t\t\t<input type=text class="gf-form-input width-6" placeholder=auto ng-model-onblur ng-change=ctrl.panelCtrl.refresh() ng-model=ctrl.panel.maxDataPoints spellcheck=false />\r\n\t\t\t\t<info-popover mode=right-absolute>\r\n\t\t\t\t\t查询应返回的最大数据点。对于图形，它自动设置为每像素一个数据点。\r\n\t\t\t\t</info-popover>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class=grafana-info-box ng-if=ctrl.helpOpen>\r\n\t\t\t<div class=markdown-html ng-bind-html=ctrl.helpHtml></div>\r\n\t\t\t<a class=grafana-info-box__close ng-click=ctrl.toggleHelp()>\r\n\t\t\t\t<i class="fa fa-chevron-up"></i>\r\n\t\t\t</a>\r\n\t\t</div>\r\n\r\n\t\t<query-troubleshooter panel-ctrl=ctrl.panelCtrl is-open=ctrl.queryTroubleshooterOpen></query-troubleshooter>\r\n\t</div>\r\n</div>\r\n\r\n<div class="query-editor-rows gf-form-group" ng-if=ctrl.datasourceInstance>\r\n\t<div ng-repeat="target in ctrl.panel.targets" ng-class="{\'gf-form-disabled\': target.hide}">\r\n\t\t<rebuild-on-change property="ctrl.panel.datasource || target.datasource" show-null=true>\r\n\t\t\t<plugin-component type=query-ctrl>\r\n\t\t\t</plugin-component>\r\n\t\t</rebuild-on-change>\r\n\t</div>\r\n\r\n\t<div class=gf-form-query>\r\n\t\t<div class="gf-form gf-form-query-letter-cell">\r\n\t\t\t<label class=gf-form-label>\r\n\t\t\t\t<span class=gf-form-query-letter-cell-carret>\r\n\t\t\t\t\t<i class="fa fa-caret-down"></i>\r\n\t\t\t\t</span>\r\n\t\t\t\t<span class=gf-form-query-letter-cell-letter>{{ctrl.panelCtrl.nextRefId}}</span>\r\n\t\t\t</label>\r\n\t\t\t<button class="btn btn-secondary gf-form-btn" ng-click=ctrl.addQuery() ng-hide=ctrl.datasourceInstance.meta.mixed>\r\n\t\t\t\t添加查询\r\n\t\t\t</button>\r\n\t\t\t<div class=dropdown ng-if=ctrl.datasourceInstance.meta.mixed>\r\n\t\t\t\t<gf-form-dropdown model=ctrl.addQueryDropdown get-options=ctrl.getOptions(false) on-change=ctrl.addMixedQuery($option)>\r\n\t\t\t\t</gf-form-dropdown>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n\x3c!-- [OGE] --\x3e\r\n<rebuild-on-change property=ctrl.panel.datasource show-null=true>\r\n  <plugin-component type=query-options-ctrl>\r\n  </plugin-component>\r\n</rebuild-on-change>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/panel/partials/panelTime.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=gf-form-group>\r\n\t<div class=gf-form>\r\n\t\t<span class=gf-form-label>\r\n\t\t\t<i class="fa fa-clock-o"></i>\r\n\t\t</span>\r\n\r\n\t\t<span class="gf-form-label width-12">覆盖相对时间</span>\r\n\t\t<span class="gf-form-label width-6">最新</span>\r\n\r\n\t\t<input type=text class="gf-form-input max-width-8" placeholder=1h empty-to-null ng-model=ctrl.panel.timeFrom valid-time-span ng-change=ctrl.refresh() ng-model-onblur>\r\n\t</div>\r\n\r\n\t<div class=gf-form>\r\n\t\t<span class=gf-form-label>\r\n\t\t\t<i class="fa fa-clock-o"></i>\r\n\t\t</span>\r\n\t\t<span class="gf-form-label width-12">添加时位移</span>\r\n\t\t<span class="gf-form-label width-6">总数</span>\r\n\t\t<input type=text class="gf-form-input max-width-8" placeholder=1h empty-to-null ng-model=ctrl.panel.timeShift valid-time-span ng-change=ctrl.refresh() ng-model-onblur>\r\n\t</div>\r\n\r\n\t<div class=gf-form-inline>\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class=gf-form-label>\r\n\t\t\t\t<i class="fa fa-clock-o"></i>\r\n\t\t\t</span>\r\n\t\t</div>\r\n\t\t<gf-form-switch class="gf-form max-width-30" label=隐藏时间覆盖信息 label-class=width-12 checked=ctrl.panel.hideTimeOverride switch-class=max-width-6 on-change=ctrl.refresh()>\r\n\t\t</gf-form-switch>\r\n\t</div>\r\n</div>\r\n\r\n\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/panel/partials/query_editor_row.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'\r\n<div class=gf-form-query>\r\n\t<div class="gf-form gf-form-query-letter-cell">\r\n    <label class=gf-form-label>\r\n      <a class=pointer tabindex=1 ng-click=ctrl.toggleCollapse()>\r\n        <span ng-class="{muted: !ctrl.canCollapse}" class=gf-form-query-letter-cell-carret>\r\n          <i class="fa fa-caret-down" ng-hide=ctrl.collapsed></i>\r\n          <i class="fa fa-caret-right" ng-show=ctrl.collapsed></i>\r\n        </span>\r\n        <span class=gf-form-query-letter-cell-letter>{{ctrl.target.refId}}</span>\r\n        <em class=gf-form-query-letter-cell-ds ng-show=ctrl.target.datasource>({{ctrl.target.datasource}})</em>\r\n      </a>\r\n\t\t</label>\r\n  </div>\r\n\r\n\t<div class="gf-form-query-content gf-form-query-content--collapsed" ng-if=ctrl.collapsed>\r\n\t\t<div class=gf-form>\r\n\t\t\t<label class="gf-form-label pointer gf-form-label--grow" ng-click=ctrl.toggleCollapse()>\r\n\t\t\t\t{{ctrl.collapsedText}}\r\n\t\t\t</label>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div ng-transclude class=gf-form-query-content ng-if=!ctrl.collapsed>\r\n\t</div>\r\n\r\n\t<div class=gf-form>\r\n\t\t<label class="gf-form-label dropdown">\r\n\t\t\t<a class="pointer dropdown-toggle" data-toggle=dropdown tabindex=1>\r\n\t\t\t\t<i class="fa fa-bars"></i>\r\n\t\t\t</a>\r\n\t\t\t<ul class="dropdown-menu pull-right" role=menu>\r\n\t\t\t\t<li role=menuitem ng-if=ctrl.hasTextEditMode>\r\n\t\t\t\t\t<a tabindex=1 ng-click=ctrl.toggleEditorMode()>切换编辑模式</a>\r\n\t\t\t\t</li>\r\n\t\t\t\t<li role=menuitem>\r\n\t\t\t\t\t<a tabindex=1 ng-click=ctrl.duplicateQuery()>复制</a>\r\n\t\t\t\t</li>\r\n\t\t\t\t<li role=menuitem>\r\n\t\t\t\t\t<a tabindex=1 ng-click=ctrl.moveQuery(-1)>上移</a>\r\n\t\t\t\t</li>\r\n\t\t\t\t<li role=menuitem>\r\n\t\t\t\t\t<a tabindex=1 ng-click=ctrl.moveQuery(1)>下移</a>\r\n\t\t\t\t</li>\r\n\t\t\t</ul>\r\n\t\t</label>\r\n    <label class=gf-form-label>\r\n\t\t\t<a ng-click=ctrl.toggleHideQuery() role=menuitem>\r\n\t\t\t\t<i class="fa fa-eye"></i>\r\n\t\t\t</a>\r\n\t\t</label>\r\n\t\t<label class=gf-form-label>\r\n\t\t\t<a class=pointer tabindex=1 ng-click=ctrl.removeQuery(ctrl.target)>\r\n\t\t\t\t<i class="fa fa-trash"></i>\r\n\t\t\t</a>\r\n\t\t</label>\r\n\t</div>\r\n</div>\r\n\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/panel/partials/soloPanel.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,"<div class=panel-solo ng-if=panel>\r\n\t<plugin-component type=panel>\r\n\t</plugin-component>\r\n</div>\r\n")}]),t.exports=r},function(t,e){var r="public/app/features/playlist/partials/playlist.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<page-header model=ctrl.navModel></page-header>\r\n\r\n<div class="page-container page-body" ng-form=ctrl.playlistEditForm>\r\n\r\n\t<h3 class=page-sub-heading ng-hide=ctrl.isNew>编辑播放列表</h3>\r\n\t<h3 class=page-sub-heading ng-show=ctrl.isNew>新建播放列表</h3>\r\n\r\n\t<p class=playlist-description>播放列表在仪表板的预选列表中循环播放。</p>\r\n\r\n\t<div class=gf-form-group>\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class="gf-form-label width-7">名称</span>\r\n\t\t\t<input type=text required ng-model=ctrl.playlist.name class="gf-form-input max-width-21">\r\n\t\t</div>\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class="gf-form-label width-7">间隔</span>\r\n\t\t\t<input type=text required ng-model=ctrl.playlist.interval placeholder=5m class="gf-form-input max-width-21">\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class=gf-form-group>\r\n\t\t<h3 class=page-headering>仪表盘</h3>\r\n\r\n\t\t<table class="filter-table playlist-available-list">\r\n\t\t\t<tr ng-repeat="playlistItem in ctrl.playlistItems">\r\n\t\t\t\t<td ng-if="playlistItem.type === \'dashboard_by_id\'">\r\n\t\t\t\t\t<i class="icon-gf icon-gf-dashboard"></i>&nbsp;&nbsp;{{playlistItem.title}}\r\n\t\t\t\t</td>\r\n\t\t\t\t<td ng-if="playlistItem.type === \'dashboard_by_tag\'">\r\n\t\t\t\t\t<a class="search-result-tag label label-tag" tag-color-from-name=playlistItem.title>\r\n\t\t\t\t\t\t<i class="fa fa-tag"></i>\r\n\t\t\t\t\t\t<span>{{playlistItem.title}}</span>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t</td>\r\n\r\n\t\t\t\t<td class=selected-playlistitem-settings>\r\n\t\t\t\t\t<button class="btn btn-inverse btn-mini" ng-hide=$first ng-click=ctrl.movePlaylistItemUp(playlistItem)>\r\n\t\t\t\t\t\t<i class="fa fa-arrow-up"></i>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<button class="btn btn-inverse btn-mini" ng-hide=$last ng-click=ctrl.movePlaylistItemDown(playlistItem)>\r\n\t\t\t\t\t\t<i class="fa fa-arrow-down"></i>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<button class="btn btn-inverse btn-mini" ng-click=ctrl.removePlaylistItem(playlistItem)>\r\n\t\t\t\t\t\t<i class="fa fa-remove"></i>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</td>\r\n\t\t\t</tr>\r\n\t\t\t<tr ng-if="ctrl.playlistItems.length === 0">\r\n\t\t\t\t<td><em>播放列表是空的，请在上方添加仪表盘。</em></td>\r\n\t\t\t</tr>\r\n\t\t</table>\r\n\t</div>\r\n\r\n\t<div class=gf-form-group>\r\n\t\t<h3 class=page-headering>添加仪表盘</h3>\r\n\t\t<playlist-search class=playlist-search-container search-started=ctrl.searchStarted(promise)></playlist-search>\r\n\r\n\t\t<div ng-if="ctrl.filteredDashboards.length > 0">\r\n\t\t\t<table class="filter-table playlist-available-list">\r\n\t\t\t\t<tr ng-repeat="playlistItem in ctrl.filteredDashboards">\r\n\t\t\t\t\t<td>\r\n\t\t\t\t\t\t<i class="icon-gf icon-gf-dashboard"></i>\r\n\t\t\t\t\t\t&nbsp;&nbsp;{{playlistItem.title}}\r\n\t\t\t\t\t\t<i class="fa fa-star" ng-show=playlistItem.isStarred></i>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td class=add-dashboard>\r\n\t\t\t\t\t\t<button class="btn btn-inverse btn-mini pull-right" ng-click=ctrl.addPlaylistItem(playlistItem)>\r\n\t\t\t\t\t\t\t<i class="fa fa-plus"></i>\r\n\t\t\t\t\t\t\t添加到发放列表中\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</table>\r\n\t\t</div>\r\n\t\t<div class=playlist-search-results-container ng-if="ctrl.filteredTags.length > 0;">\r\n\t\t\t<table class="filter-table playlist-available-list">\r\n\t\t\t\t<tr ng-repeat="tag in ctrl.filteredTags">\r\n\t\t\t\t\t<td>\r\n\t\t\t\t\t\t<a class="search-result-tag label label-tag" tag-color-from-name=tag.term>\r\n\t\t\t\t\t\t\t<i class="fa fa-tag"></i>\r\n\t\t\t\t\t\t\t<span>{{tag.term}} &nbsp;({{tag.count}})</span>\r\n\t\t\t\t\t\t</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td class=add-dashboard>\r\n\t\t\t\t\t\t<button class="btn btn-inverse btn-mini pull-right" ng-click=ctrl.addTagPlaylistItem(tag)>\r\n\t\t\t\t\t\t\t<i class="fa fa-plus"></i>\r\n\t\t\t\t\t\t\t添加到播放列表中\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</table>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class=clearfix></div>\r\n\r\n\t<div class=gf-form-button-row>\r\n\t\t<a class="btn btn-success" ng-show=ctrl.isNew ng-disabled="ctrl.playlistEditForm.$invalid || ctrl.isPlaylistEmpty()" ng-click="ctrl.savePlaylist(ctrl.playlist, ctrl.playlistItems)">创建</a>\r\n\t\t<a class="btn btn-success" ng-show=!ctrl.isNew ng-disabled="ctrl.playlistEditForm.$invalid || ctrl.isPlaylistEmpty()" ng-click="ctrl.savePlaylist(ctrl.playlist, ctrl.playlistItems)">保存</a>\r\n\t\t<a class=btn-text ng-click=ctrl.backToList()>取消</a>\r\n\t</div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/playlist/partials/playlist_search.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=playlist-search-field-wrapper>\r\n  <span style=position:relative>\r\n    <input type=text placeholder=按名称查找仪表板 tabindex=1 ng-keydown=ctrl.keyDown($event) ng-model=ctrl.query.query ng-model-options="{ debounce: 500 }" spellcheck=false ng-change=ctrl.searchDashboards() />\r\n\t\t<div class=playlist-search-switches>\r\n\t\t\t<i class="fa fa-filter"></i>\r\n\t\t\t<a class=pointer href="javascript:void 0;" ng-click=ctrl.showStarred() tabindex=2>\r\n\t\t\t\t<i class="fa fa-remove" ng-show=ctrl.query.starred></i>\r\n\t\t\t\t已标星\r\n\t\t\t</a> |\r\n\t\t\t<a class=pointer href="javascript:void 0;" ng-click=ctrl.getTags() tabindex=3>\r\n\t\t\t\t<i class="fa fa-remove" ng-show=ctrl.tagsMode></i>\r\n\t\t\t\t标签\r\n\t\t\t</a>\r\n\t\t\t<span ng-if=ctrl.query.tag.length>\r\n\t\t\t\t|\r\n\t\t\t\t<span ng-repeat="tagName in ctrl.query.tag">\r\n\t\t\t\t\t<a ng-click="ctrl.removeTag(tagName, $event)" tag-color-from-name=ctrl.tagName class="label label-tag">\r\n\t\t\t\t\t\t<i class="fa fa-remove"></i>\r\n\t\t\t\t\t\t{{tagName}}\r\n\t\t\t\t\t</a>\r\n\t\t\t\t</span>\r\n\t\t\t</span>\r\n\t\t</div>\r\n\t</span>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/playlist/partials/playlists.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<page-header model=ctrl.navModel></page-header>\r\n\r\n<div class="page-container page-body">\r\n  <div ng-if="ctrl.playlists.length > 0">\r\n    <div class=page-action-bar>\r\n      <div class=page-action-bar__spacer></div>\r\n      <a class="btn btn-success pull-right" href=playlists/create>\r\n        <i class="fa fa-plus"></i>\r\n        新播放列表\r\n      </a>\r\n    </div>\r\n\r\n    <table class="filter-table filter-table--hover">\r\n      <thead>\r\n        <th><strong>名称</strong></th>\r\n        <th style=width:100px></th>\r\n        <th style=width:78px></th>\r\n      </thead>\r\n      <tr ng-repeat="playlist in ctrl.playlists">\r\n        <td class=link-td>\r\n          <a href=playlists/edit/{{playlist.id}}>{{playlist.name}}</a>\r\n        </td>\r\n        <td class=dropdown>\r\n          <button class="btn btn-inverse btn-small" data-toggle=dropdown>\r\n            开始播放列表\r\n            <i class="fa fa-caret-down"></i>\r\n          </button>\r\n          <ul class=dropdown-menu role=menu>\r\n            <li>\r\n              <a href={{playlist.startUrl}}>\r\n                <i class="fa fa-play"></i> In Normal mode\r\n              </a>\r\n              <a href="{{playlist.startUrl}}?kiosk=tv">\r\n                <i class="fa fa-play"></i> In TV mode\r\n              </a>\r\n              <a href="{{playlist.startUrl}}?kiosk=tv&autofitpanels">\r\n                <i class="fa fa-play"></i> In TV mode <span class=muted>(带有自动面板)</span>\r\n              </a>\r\n              <a href={{playlist.startUrl}}?kiosk>\r\n                <i class="fa fa-play"></i> In Kiosk mode\r\n              </a>\r\n              <a ng-href={{playlist.startUrl}}?kiosk&autofitpanels>\r\n                <i class="fa fa-play"></i> In Kiosk mode <span class=muted>(带有自动面板)</span>\r\n              </a>\r\n            </li>\r\n          </ul>\r\n        </td>\r\n        <td class=text-right>\r\n          <a ng-click=ctrl.removePlaylist(playlist) class="btn btn-danger btn-small">\r\n            <i class="fa fa-remove"></i>\r\n          </a>\r\n        </td>\r\n      </tr>\r\n    </table>\r\n  </div>\r\n  <div ng-if="ctrl.playlists.length === 0">\r\n    <empty-list-cta model="{\r\n      title: \'还没有创建播放列表\',\r\n      buttonIcon: \'fa fa-plus\',\r\n      buttonLink: \'playlists/create\',\r\n      buttonTitle: \' 创建播放列表\',\r\n      proTip: \'可以使用播放列表来循环界面上的仪表盘，而不需要用户控制\',\r\n      proTipLink: \'\',\r\n      proTipLinkTitle: \'Learn more\',\r\n      proTipTarget: \'_blank\'\r\n    }"/>\r\n  </div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/plugins/import_list/import_list.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=gf-form-group ng-if=ctrl.dashboards.length>\r\n\t<table class=filter-table>\r\n\t\t<tbody>\r\n\t\t\t<tr ng-repeat="dash in ctrl.dashboards">\r\n\t\t\t\t<td class=width-1>\r\n\t\t\t\t\t<i class="icon-gf icon-gf-dashboard"></i>\r\n\t\t\t\t</td>\r\n\t\t\t\t<td>\r\n\t\t\t\t\t<a href={{dash.importedUrl}} ng-show=dash.imported>\r\n\t\t\t\t\t\t{{dash.title}}\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t<span ng-show=!dash.imported>{{dash.title}}</span>\r\n\t\t\t\t</td>\r\n\t\t\t\t<td style=text-align:right>\r\n\t\t\t\t\t<button class="btn btn-secondary btn-small" ng-click="ctrl.import(dash, false)" ng-show=!dash.imported>\r\n\t\t\t\t\t\tImport\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<button class="btn btn-secondary btn-small" ng-click="ctrl.import(dash, true)" ng-show=dash.imported>\r\n            <span ng-if="dash.revision !== dash.importedRevision">Update</span>\r\n            <span ng-if="dash.revision === dash.importedRevision">Re-import</span>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<button class="btn btn-danger btn-small" ng-click=ctrl.remove(dash) ng-show=dash.imported>\r\n\t\t\t\t\t\t<i class="fa fa-trash"></i>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</td>\r\n\t\t\t</tr>\r\n\t\t</tbody>\r\n\t</table>\r\n</div>\r\n\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/plugins/partials/ds_edit.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<page-header model=ctrl.navModel></page-header>\r\n\r\n<div class="page-container page-body">\r\n  <h3 class=page-sub-heading>Settings</h3>\r\n\r\n  <form name=ctrl.editForm ng-if=ctrl.current>\r\n    <div class=gf-form-group>\r\n      <div class=gf-form-inline>\r\n        <div class="gf-form max-width-30">\r\n          <span class="gf-form-label width-10">Name</span>\r\n          <input class="gf-form-input max-width-23" type=text ng-model=ctrl.current.name placeholder=name required>\r\n          <info-popover offset="0px -135px" mode=right-absolute>\r\n            The name is used when you select the data source in panels.\r\n            The <em>Default</em> data source is preselected in new\r\n            panels.\r\n          </info-popover>\r\n        </div>\r\n        <gf-form-switch class=gf-form label=Default checked=ctrl.current.isDefault switch-class=max-width-6></gf-form-switch>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=grafana-info-box ng-if="ctrl.datasourceMeta.state === \'alpha\'">\r\n      This plugin is marked as being in alpha state, which means it is in early development phase and\r\n      updates will include breaking changes.\r\n    </div>\r\n\r\n\t\t<div class=grafana-info-box ng-if="ctrl.datasourceMeta.state === \'beta\'">\r\n      This plugin is marked as being in a beta development state. This means it is in currently in active development and could be\r\n      missing important features.\r\n    </div>\r\n\r\n    <rebuild-on-change property=ctrl.datasourceMeta.id>\r\n      <plugin-component type=datasource-config-ctrl>\r\n      </plugin-component>\r\n    </rebuild-on-change>\r\n\r\n    <div ng-if=ctrl.hasDashboards>\r\n      <h3 class=section-heading>Bundled Plugin Dashboards</h3>\r\n      <div class=section>\r\n        <dashboard-import-list plugin=ctrl.datasourceMeta datasource=ctrl.current></dashboard-import-list>\r\n      </div>\r\n    </div>\r\n\r\n    <div ng-if=ctrl.testing class="gf-form-group section">\r\n      <h5 ng-show=!ctrl.testing.done>Testing.... <i class="fa fa-spiner fa-spin"></i></h5>\r\n      <div class="alert-{{ctrl.testing.status}} alert" ng-show=ctrl.testing.done>\r\n        <div class=alert-icon>\r\n          <i class="fa fa-exclamation-triangle" ng-show="ctrl.testing.status === \'error\'"></i>\r\n          <i class="fa fa-check" ng-show="ctrl.testing.status !== \'error\'"></i>\r\n        </div>\r\n        <div class=alert-body>\r\n          <div class=alert-title>{{ctrl.testing.message}}</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n\t\t<div class="grafana-info-box span8" ng-if=ctrl.current.readOnly>\r\n\t\t\tThis datasource was added by config and cannot be modified using the UI. Please contact your server admin to update this datasource.\r\n\t\t</div>\r\n\r\n\t\t<div class=gf-form-button-row>\r\n\t\t\t<button type=submit class="btn btn-success" ng-disabled=ctrl.current.readOnly ng-click=ctrl.saveChanges()>Save &amp; Test</button>\r\n\t\t\t<button type=submit class="btn btn-danger" ng-disabled=ctrl.current.readOnly ng-show=!ctrl.isNew ng-click=ctrl.delete()>Delete</button>\r\n\t\t\t<a class="btn btn-inverse" href=datasources>Back</a>\r\n\t\t</div>\r\n\r\n\t\t<br/>\r\n\t\t<br/>\r\n\t\t<br/>\r\n\r\n\t</form>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/plugins/partials/ds_http_settings.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=gf-form-group>\r\n\t<h3 class=page-heading>HTTP</h3>\r\n  <div class=gf-form-group>\r\n    <div class=gf-form-inline>\r\n      <div class="gf-form max-width-30">\r\n        <span class="gf-form-label width-10">URL</span>\r\n        <input class=gf-form-input type=text ng-model=current.url placeholder={{suggestUrl}} bs-typeahead=getSuggestUrls min-length=0 ng-pattern="/^(ftp|http|https):\\/\\/(\\w+:{0,1}\\w*@)?(\\S+)(:[0-9]+)?(\\/|\\/([\\w#!:.?+=&%@!\\-\\/]))?$/" required>\r\n        <info-popover mode=right-absolute>\r\n          <p>Specify a complete HTTP URL (for example http://your_server:8080)</p>\r\n          <span ng-show="current.access === \'direct\'">\r\n            Your access method is <em>Browser</em>, this means the URL\r\n            needs to be accessible from the browser.\r\n          </span>\r\n          <span ng-show="current.access === \'proxy\'">\r\n            Your access method is <em>Server</em>, this means the URL\r\n            needs to be accessible from the grafana backend/server.\r\n          </span>\r\n        </info-popover>\r\n      </div>\r\n\t\t</div>\r\n\r\n\t\t<div class=gf-form-inline ng-if=showAccessOption>\r\n\t\t\t<div class="gf-form max-width-30">\r\n\t\t\t\t<span class="gf-form-label width-10">Access</span>\r\n\t\t\t\t<div class="gf-form-select-wrapper max-width-24">\r\n\t\t\t\t\t<select class=gf-form-input ng-model=current.access ng-options="f.key as f.value for f in [{key: \'proxy\', value: \'Server (Default)\'}, { key: \'direct\', value: \'Browser\'}]"></select>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<label class="gf-form-label query-keyword pointer" ng-click=toggleAccessHelp()>\r\n\t\t\t\t\tHelp&nbsp;\r\n\t\t\t\t\t<i class="fa fa-caret-down" ng-show=showAccessHelp></i>\r\n\t\t\t\t\t<i class="fa fa-caret-right" ng-hide=showAccessHelp>&nbsp;</i>\r\n\t\t\t\t</label>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class="grafana-info-box m-t-2" ng-show=showAccessHelp>\r\n\t\t\t<p>\r\n\t\t\tAccess mode controls how requests to the data source will be handled.\r\n\t\t\t<strong><i>Server</i></strong> should be the preferred way if nothing else stated.\r\n\t\t\t</p>\r\n\t\t\t<div class=alert-title>Server access mode (Default):</div>\r\n\t\t\t<p>\r\n\t\t\tAll requests will be made from the browser to Grafana backend/server which in turn will forward the requests to the data source\r\n\t\t\tand by that circumvent possible Cross-Origin Resource Sharing (CORS) requirements.\r\n\t\t\tThe URL needs to be accessible from the grafana backend/server if you select this access mode.\r\n\t\t\t</p>\r\n\t\t\t<div class=alert-title>Browser access mode:</div>\r\n\t\t\t<p>\r\n\t\t\tAll requests will be made from the browser directly to the data source and may be subject to\r\n\t\t\tCross-Origin Resource Sharing (CORS) requirements. The URL needs to be accessible from the browser if you select this\r\n\t\t\taccess mode.\r\n\t\t</p></div>\r\n\r\n\t\t<div class=gf-form-inline ng-if="current.access==\'proxy\'">\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<span class="gf-form-label width-10">Whitelisted Cookies</span>\r\n\t\t\t\t<bootstrap-tagsinput ng-model=current.jsonData.keepCookies width-class=width-20 tagclass="label label-tag" placeholder="Add Name">\r\n\t\t\t\t</bootstrap-tagsinput>\r\n\t\t\t\t<info-popover mode=right-absolute>\r\n\t\t\t\t\tGrafana Proxy deletes forwarded cookies by default. Specify cookies by name that should be forwarded to the data source.\r\n\t\t\t\t</info-popover>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<h3 class=page-heading>Auth</h3>\r\n\t<div class=gf-form-group>\r\n\t\t<div class=gf-form-inline>\r\n\t\t\t<gf-form-switch class=gf-form label="Basic Auth" checked=current.basicAuth label-class=width-10 switch-class=max-width-6></gf-form-switch>\r\n\t\t\t<gf-form-switch class=gf-form label="With Credentials" tooltip="Whether credentials such as cookies or auth headers should be sent with cross-site requests." checked=current.withCredentials label-class=width-11 switch-class=max-width-6></gf-form-switch>\r\n\t\t</div>\r\n\t\t<div class=gf-form-inline>\r\n\t\t\t<gf-form-switch class=gf-form ng-if="current.access==\'proxy\'" label="TLS Client Auth" label-class=width-10 checked=current.jsonData.tlsAuth switch-class=max-width-6></gf-form-switch>\r\n\t\t\t<gf-form-switch class=gf-form ng-if="current.access==\'proxy\'" label="With CA Cert" tooltip="Needed for verifing self-signed TLS Certs" checked=current.jsonData.tlsAuthWithCACert label-class=width-11 switch-class=max-width-6></gf-form-switch>\r\n\t\t</div>\r\n\t\t<div class=gf-form-inline>\r\n\t\t\t<gf-form-switch class=gf-form ng-if="current.access==\'proxy\'" label="Skip TLS Verify" label-class=width-10 checked=current.jsonData.tlsSkipVerify switch-class=max-width-6></gf-form-switch>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class=gf-form-group ng-if=current.basicAuth>\r\n\t\t<h6>Basic Auth Details</h6>\r\n\t\t<div class=gf-form ng-if=current.basicAuth>\r\n\t\t\t<span class="gf-form-label width-10">User</span>\r\n\t\t\t<input class="gf-form-input max-width-21" type=text ng-model=current.basicAuthUser placeholder=user required>\r\n\t\t</div>\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class="gf-form-label width-10">Password</span>\r\n\t\t\t<input class="gf-form-input max-width-21" type=password ng-model=current.basicAuthPassword placeholder=password required>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class=gf-form-group ng-if="(current.jsonData.tlsAuth || current.jsonData.tlsAuthWithCACert) && current.access==\'proxy\'">\r\n\t\t<div class=gf-form>\r\n\t\t\t<h6>TLS Auth Details</h6>\r\n\t\t\t<info-popover mode=header>TLS Certs are encrypted and stored in the Grafana database.</info-popover>\r\n\t\t</div>\r\n\t\t<div ng-if=current.jsonData.tlsAuthWithCACert>\r\n\t\t\t<div class=gf-form-inline>\r\n\t\t\t\t<div class="gf-form gf-form--v-stretch">\r\n\t\t\t\t\t<label class="gf-form-label width-7">CA Cert</label>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class="gf-form gf-form--grow" ng-if=!current.secureJsonFields.tlsCACert>\r\n\t\t\t\t\t<textarea rows=7 class="gf-form-input gf-form-textarea" ng-model=current.secureJsonData.tlsCACert placeholder="Begins with -----BEGIN CERTIFICATE-----"></textarea>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=gf-form ng-if=current.secureJsonFields.tlsCACert>\r\n\t\t\t\t\t<input type=text class="gf-form-input max-width-12" disabled=disabled value=configured>\r\n\t\t\t\t\t<a class="btn btn-secondary gf-form-btn" href=# ng-click="current.secureJsonFields.tlsCACert = false">reset</a>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div ng-if=current.jsonData.tlsAuth>\r\n\t\t<div class=gf-form-inline>\r\n\t\t\t<div class="gf-form gf-form--v-stretch">\r\n\t\t\t\t<label class="gf-form-label width-7">Client Cert</label>\r\n\t\t\t</div>\r\n\t\t\t<div class="gf-form gf-form--grow" ng-if=!current.secureJsonFields.tlsClientCert>\r\n\t\t\t\t<textarea rows=7 class="gf-form-input gf-form-textarea" ng-model=current.secureJsonData.tlsClientCert placeholder="Begins with -----BEGIN CERTIFICATE-----" required></textarea>\r\n\t\t\t</div>\r\n\t\t\t<div class=gf-form ng-if=current.secureJsonFields.tlsClientCert>\r\n\t\t\t\t<input type=text class="gf-form-input max-width-12" disabled=disabled value=configured>\r\n\t\t\t\t<a class="btn btn-secondary gf-form-btn" href=# ng-click="current.secureJsonFields.tlsClientCert = false">reset</a>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class=gf-form-inline>\r\n\t\t\t<div class="gf-form gf-form--v-stretch">\r\n\t\t\t\t<label class="gf-form-label width-7">Client Key</label>\r\n\t\t\t</div>\r\n\t\t\t<div class="gf-form gf-form--grow" ng-if=!current.secureJsonFields.tlsClientKey>\r\n\t\t\t\t<textarea rows=7 class="gf-form-input gf-form-textarea" ng-model=current.secureJsonData.tlsClientKey placeholder="Begins with -----BEGIN RSA PRIVATE KEY-----" required></textarea>\r\n\t\t\t</div>\r\n\t\t\t<div class=gf-form ng-if=current.secureJsonFields.tlsClientKey>\r\n\t\t\t\t<input type=text class="gf-form-input max-width-12" disabled=disabled value=configured>\r\n\t\t\t\t<a class="btn btn-secondary gf-form-btn" href=# ng-click="current.secureJsonFields.tlsClientKey = false">reset</a>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n\r\n</div>')}]),t.exports=r},function(t,e){var r="public/app/features/plugins/partials/plugin_edit.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div ng-if=ctrl.navModel>\r\n  <page-header model=ctrl.navModel></page-header>\r\n\r\n  <div class="page-container page-body">\r\n    <div class=sidebar-container>\r\n      <div class="tab-content sidebar-content" ng-if="ctrl.tab === \'readme\'">\r\n        <div ng-bind-html=ctrl.readmeHtml class=markdown-html>\r\n        </div>\r\n      </div>\r\n\r\n      <div class="tab-content sidebar-content" ng-if="ctrl.tab === \'config\'">\r\n        <div ng-if=ctrl.model.id>\r\n          <plugin-component type=app-config-ctrl></plugin-component>\r\n\r\n          <div class=gf-form-button-row>\r\n            <button type=submit class="btn btn-success" ng-click=ctrl.enable() ng-show=!ctrl.model.enabled>Enable</button>\r\n            <button type=submit class="btn btn-success" ng-click=ctrl.update() ng-show=ctrl.model.enabled>Update</button>\r\n            <button type=submit class="btn btn-danger" ng-click=ctrl.disable() ng-show=ctrl.model.enabled>Disable</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class="tab-content sidebar-content" ng-if="ctrl.tab === \'dashboards\'">\r\n        <dashboard-import-list plugin=ctrl.model></dashboard-import-list>\r\n      </div>\r\n\r\n      <aside class=page-sidebar>\r\n        <section class=page-sidebar-section>\r\n          <h4>Version</h4>\r\n          <span>{{ctrl.model.info.version}}</span>\r\n          <div ng-show=ctrl.model.hasUpdate>\r\n            <a ng-click=ctrl.updateAvailable() bs-tooltip=ctrl.model.latestVersion>Update Available!</a>\r\n          </div>\r\n        </section>\r\n        <section class=page-sidebar-section ng-show="ctrl.model.type === \'app\'">\r\n          <h5>Includes\r\n          <ul class="ui-list plugin-info-list">\r\n            <li ng-repeat="plug in ctrl.includes" class=plugin-info-list-item>\r\n              <i class={{plug.icon}}></i>\r\n              {{plug.name}}\r\n            </li>\r\n          </ul>\r\n        </h5></section>\r\n        <section class=page-sidebar-section>\r\n          <h5>Dependencies\r\n          <ul class="ui-list plugin-info-list">\r\n            <li class=plugin-info-list-item>\r\n              <img src=public/img/grafana_icon.svg>\r\n              Grafana {{ctrl.model.dependencies.grafanaVersion}}\r\n            </li>\r\n            <li ng-repeat="plugDep in ctrl.model.dependencies.plugins" class=plugin-info-list-item>\r\n              <i class={{plugDep.icon}}></i>\r\n              {{plugDep.name}} {{plugDep.version}}\r\n            </li>\r\n          </ul>\r\n        </h5></section>\r\n        <section class=page-sidebar-section>\r\n          <h5>Links\r\n          <ul class=ui-list>\r\n            <li ng-repeat="link in ctrl.model.info.links">\r\n              <a href={{link.url}} class=external-link target=_blank>{{link.name}}</a>\r\n            </li>\r\n          </ul>\r\n        </h5></section>\r\n      </aside>\r\n    </div>\r\n  </div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/plugins/partials/plugin_page.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,"<div ng-if=ctrl.navModel>\r\n  <page-header model=ctrl.navModel></page-header>\r\n\r\n  <div class=page-container>\r\n    <div ng-if=ctrl.page>\r\n      <plugin-component type=app-page>\r\n      </plugin-component>\r\n    </div>\r\n  </div>\r\n</div>\r\n")}]),t.exports=r},function(t,e){var r="public/app/features/plugins/partials/update_instructions.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=modal-body>\r\n\t<div class=modal-header>\r\n\t\t<h2 class=modal-header-title>\r\n\t\t\t<i class="fa fa-cloud-download"></i>\r\n\t\t\t<span class=p-l-1>Update Plugin</span>\r\n\t\t</h2>\r\n\r\n\t\t<a class=modal-header-close ng-click=dismiss();>\r\n\t\t\t<i class="fa fa-remove"></i>\r\n\t\t</a>\r\n\t</div>\r\n\r\n\t<div class=modal-content>\r\n\t\t<div class=gf-form-group>\r\n\t\t\t<p>Type the following on the command line to update {{plugin.name}}.</p>\r\n\t\t\t<pre><code>grafana-cli plugins update {{plugin.id}}</code></pre>\r\n\t\t\t<span class=small>Check out {{plugin.name}} on <a href=https://grafana.com/plugins/{{plugin.id}}>Grafana.com</a> for README and changelog. If you do not have access to the command line, ask your Grafana administator.</span>\r\n\t\t</div>\r\n\t\t<p class=pluginlist-none-installed><img class=pluginlist-inline-logo src=public/img/grafana_icon.svg><strong>Pro tip</strong>: To update all plugins at once, type <code class=code--small>grafana-cli plugins update-all</code> on the command line.</p></div>\r\n\t</div>\r\n\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/profile/partials/change_password.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<page-header model=navModel></page-header>\r\n\r\n<div class="page-container page-body">\r\n\t<h2 class=page-sub-heading>\r\n\t\t修改密码\r\n\t</h2>\r\n\r\n\t<div ng-if="ldapEnabled || authProxyEnabled">\r\n\t\t启用ldap或auth代理认证时，不能修改密码。\r\n\t</div>\r\n\r\n\t<form name=userForm class=gf-form-group ng-hide="ldapEnabled || authProxyEnabled">\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class="gf-form-label width-10">旧密码</span>\r\n\t\t\t<input class="gf-form-input max-width-21" type=password required ng-model=command.oldPassword>\r\n\t\t</div>\r\n\r\n\t\t<div class=gf-form>\r\n      <span class="gf-form-label width-10">\r\n          <span>\r\n            新密码\r\n          </span>\r\n          <tip>最少10位长度,大小写字母/数字/特殊字符最少3种组合且不能包含空格</tip>\r\n        </span>\r\n\t\t\t<input class="gf-form-input max-width-21" type=password required ng-minlength=10 ng-model=command.newPassword ng-pattern=passwordPattern>\r\n      <div ng-show="userForm.newPassword.$viewValue && userForm.newPassword.$viewValue !== \'\' && userForm.newPassword.$invalid">\r\n        <span style=color:red>密码复杂度校验失败</span>\r\n      </div>\r\n\t\t</div>\r\n\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class="gf-form-label width-10">确认密码</span>\r\n\t\t\t<input class="gf-form-input max-width-21" type=password required ng-minlength=10 ng-model=command.confirmNew>\r\n\t\t</div>\r\n\r\n\t\t<div class=gf-form-button-row>\r\n\t\t\t<button type=submit class="btn btn-success" ng-click=changePassword()>修改密码</button>\r\n\t\t\t<a class=btn-text href=profile>取消</a>\r\n\t\t</div>\r\n\t</form>\r\n\r\n</div>\r\n\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/profile/partials/profile.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<page-header model=ctrl.navModel></page-header>\r\n\r\n<div class="page-container page-body">\r\n  <h3 class=page-sub-heading>用户预置文件</h3>\r\n\r\n  <form name=ctrl.userForm class=gf-form-group>\r\n\r\n    <div class="gf-form max-width-30">\r\n      <span class="gf-form-label width-8">名称</span>\r\n      <input class="gf-form-input max-width-22" type=text required ng-model=ctrl.user.name>\r\n    </div>\r\n    <div class="gf-form max-width-30">\r\n      <span class="gf-form-label width-8">邮箱</span>\r\n      <input class="gf-form-input max-width-22" type=email ng-readonly=ctrl.readonlyLoginFields required ng-model=ctrl.user.email>\r\n      <i ng-if=ctrl.readonlyLoginFields class="fa fa-lock gf-form-icon--right-absolute" bs-tooltip="\'登录详细信息锁定-在另一个系统中管理。\'"></i>\r\n    </div>\r\n    <div class="gf-form max-width-30">\r\n      <span class="gf-form-label width-8">用户名</span>\r\n      <input class="gf-form-input max-width-22" type=text ng-readonly=ctrl.readonlyLoginFields required ng-model=ctrl.user.login>\r\n      <i ng-if=ctrl.readonlyLoginFields class="fa fa-lock gf-form-icon--right-absolute" bs-tooltip="\'登录详细信息锁定-在另一个系统中管理。\'"></i>\r\n    </div>\r\n    <div class=gf-form-button-row>\r\n      <button type=submit class="btn btn-success" ng-click=ctrl.update()>保存</button>\r\n    </div>\r\n  </form>\r\n\r\n  <prefs-control resource-uri="\'user\'"></prefs-control>\r\n\r\n  <h3 class=page-heading ng-show=ctrl.showTeamsList>团队</h3>\r\n  <div class=gf-form-group ng-show=ctrl.showTeamsList>\r\n    <table class="filter-table form-inline">\r\n      <thead>\r\n        <tr>\r\n          <th></th>\r\n          <th>名称</th>\r\n          <th>邮件</th>\r\n          <th>成员</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr ng-repeat="team in ctrl.teams">\r\n          <td class="width-4 text-center"><img class=filter-table__avatar src={{team.avatarUrl}}></td>\r\n          <td>{{team.name}}</td>\r\n          <td>{{team.email}}</td>\r\n          <td>{{team.memberCount}}</td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n\r\n  <h3 class=page-heading ng-show=ctrl.showOrgsList>组织</h3>\r\n  <div class=gf-form-group ng-show=ctrl.showOrgsList>\r\n    <table class="filter-table form-inline">\r\n      <thead>\r\n        <tr>\r\n          <th>名称</th>\r\n          <th>角色</th>\r\n          <th></th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr ng-repeat="org in ctrl.orgs">\r\n          <td>{{org.name}}</td>\r\n          <td>{{org.role}}</td>\r\n          <td class=text-right>\r\n            <span class="btn btn-primary btn-mini" ng-show="org.orgId === contextSrv.user.orgId">\r\n              当前\r\n            </span>\r\n            <a ng-click=ctrl.setUsingOrg(org) class="btn btn-inverse btn-mini" ng-show="org.orgId !== contextSrv.user.orgId">\r\n              选择\r\n            </a>\r\n          </td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n</div>')}]),t.exports=r},function(t,e){var r="public/app/features/teams/partials/create_team.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<page-header model=ctrl.navModel></page-header>\r\n\r\n<div class="page-container page-body" ng-cloak>\r\n\t<h3 class=page-sub-heading>新团队</h3>\r\n\r\n\t<form name=ctrl.saveForm class=gf-form-group ng-submit=ctrl.create()>\r\n\t\t<div class="gf-form max-width-30">\r\n\t\t\t<span class="gf-form-label width-10">名称</span>\r\n\t\t\t<input type=text required ng-model=ctrl.name class="gf-form-input max-width-22" give-focus=true>\r\n\t\t</div>\r\n\t\t<div class="gf-form max-width-30">\r\n\t\t\t<span class="gf-form-label width-10">\r\n\t\t\t\t邮箱\r\n\t\t\t\t<info-popover mode=right-normal>\r\n\t\t\t\t\t这是可选的，主要用于允许自定义团队角色。\r\n\t\t\t\t</info-popover>\r\n\t\t\t</span>\r\n\t\t\t<input class="gf-form-input max-width-22" type=email ng-model=ctrl.email placeholder=email@test.com>\r\n\t\t</div>\r\n\t\t<div class=gf-form-button-row>\r\n\t\t\t<button type=submit class="btn btn-success width-12">\r\n\t\t\t\t<i class="fa fa-save"></i> 创建\r\n\t\t\t</button>\r\n\t\t</div>\r\n\t</form>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/features/templating/partials/editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div ng-controller=VariableEditorCtrl ng-init=init()>\r\n\r\n\t<h3 class=dashboard-settings__header>\r\n\t\t<a ng-click="setMode(\'list\')">变量</a>\r\n\t\t<span ng-show="mode === \'new\'">&gt; 新建</span>\r\n\t\t<span ng-show="mode === \'edit\'">&gt; 编辑</span>\r\n\t</h3>\r\n\r\n\t<div ng-if="mode === \'list\'">\r\n\r\n\t\t<div ng-if="variables.length === 0">\r\n\t\t\t<div class=empty-list-cta>\r\n\t\t\t\t<div class=empty-list-cta__title>还没有变量</div>\r\n\t\t\t\t<a ng-click="setMode(\'new\')" class="empty-list-cta__button btn btn-xlarge btn-success">\r\n\t\t\t\t\t<i class="gicon gicon-add-variable"></i>\r\n\t\t\t\t\t添加变量\r\n\t\t\t\t</a>\r\n\t\t\t\t<div class=grafana-info-box>\r\n\t\t\t\t\t<h5>变量的作用是什么？</h5>\r\n\t\t\t\t\t<p>变量使仪表板更具互动性和动态性。变量显示为仪表板顶部的下拉选择框。通过下拉菜单切换更改显示在仪表板上的数据。</p>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div ng-if=variables.length>\r\n\t\t\t<div class=page-action-bar>\r\n\t\t\t\t<div class=page-action-bar__spacer></div>\r\n\t\t\t\t<a type=button class="btn btn-success" ng-click="setMode(\'new\');"><i class="fa fa-plus"></i> 新建</a>\r\n\t\t\t</div>\r\n\r\n\t\t\t<table class="filter-table filter-table--hover">\r\n\t\t\t\t<thead>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<th>变量</th>\r\n\t\t\t\t\t\t<th>定义</th>\r\n\t\t\t\t\t\t<th colspan=5></th>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</thead>\r\n\t\t\t\t<tbody>\r\n\t\t\t\t\t<tr ng-repeat="variable in variables">\r\n\t\t\t\t\t\t<td style=width:1%>\r\n\t\t\t\t\t\t\t<span ng-click=edit(variable) class="pointer template-variable">\r\n\t\t\t\t\t\t\t\t${{variable.name}}\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t<td style=max-width:200px ng-click=edit(variable) class="pointer max-width">\r\n\t\t\t\t\t\t\t{{variable.definition ? variable.definition : variable.query}}\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t<td style=width:1%><i ng-click=_.move(variables,$index,$index-1) ng-hide=$first class="pointer fa fa-arrow-up"></i></td>\r\n\t\t\t\t\t\t<td style=width:1%><i ng-click=_.move(variables,$index,$index+1) ng-hide=$last class="pointer fa fa-arrow-down"></i></td>\r\n\t\t\t\t\t\t<td style=width:1%>\r\n\t\t\t\t\t\t\t<a ng-click=duplicate(variable) class="btn btn-inverse btn-mini">\r\n\t\t\t\t\t\t\t\t复制\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t<td style=width:1%>\r\n\t\t\t\t\t\t\t<a ng-click=removeVariable(variable) class="btn btn-danger btn-mini">\r\n\t\t\t\t\t\t\t\t<i class="fa fa-remove"></i>\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</tbody>\r\n\t\t\t</table>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<form ng-if="mode === \'edit\' || mode === \'new\'" name=ctrl.form>\r\n\t\t<h5 class=section-heading>默认设置</h5>\r\n\t\t<div class=gf-form-group>\r\n\t\t\t<div class=gf-form-inline>\r\n\t\t\t\t<div class="gf-form max-width-19">\r\n\t\t\t\t\t<span class="gf-form-label width-6">名称</span>\r\n\t\t\t\t\t<input type=text class=gf-form-input name=name placeholder=名称 ng-model=current.name required ng-pattern=namePattern>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class="gf-form max-width-19">\r\n\t\t\t\t\t<span class="gf-form-label width-6">\r\n\t\t\t\t\t\t类型\r\n\t\t\t\t\t\t<info-popover mode=right-normal>\r\n\t\t\t\t\t\t\t{{variableTypes[current.type].description}}\r\n\t\t\t\t\t\t</info-popover>\r\n\t\t\t\t\t</span>\r\n\t\t\t\t\t<div class="gf-form-select-wrapper max-width-17">\r\n\t\t\t\t\t\t<select class=gf-form-input ng-model=current.type ng-options="k as v.name for (k, v) in variableTypes" ng-change=typeChanged()></select>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=gf-form ng-show=ctrl.form.name.$error.pattern>\r\n\t\t\t\t<span class="gf-form-label gf-form-label--error">模板名称不能以\'_\'开头，这是为KAM的全局变量保留的</span>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=gf-form-inline>\r\n\t\t\t\t<div class="gf-form max-width-19">\r\n\t\t\t\t\t<span class="gf-form-label width-6">标签</span>\r\n\t\t\t\t\t<input type=text class=gf-form-input ng-model=current.label placeholder=显示名称>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class="gf-form max-width-19">\r\n\t\t\t\t\t<span class="gf-form-label width-6">隐藏</span>\r\n\t\t\t\t\t<div class="gf-form-select-wrapper max-width-15">\r\n\t\t\t\t\t\t<select class=gf-form-input ng-model=current.hide ng-options="f.value as f.text for f in hideOptions"></select>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div ng-if="current.type === \'interval\'" class=gf-form-group>\r\n\t\t\t<h5 class=section-heading>间隔选项</h5>\r\n\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<span class="gf-form-label width-9">值</span>\r\n\t\t\t\t<input type=text class=gf-form-input ng-model=current.query placeholder=1m,10m,1h,6h,1d,7d ng-model-onblur ng-change=runQuery() required>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=gf-form-inline>\r\n\t\t\t\t<gf-form-switch class=gf-form label=自动选项 label-class=width-9 checked=current.auto on-change=runQuery()>\r\n\t\t\t\t</gf-form-switch>\r\n\r\n\t\t\t\t<div class=gf-form>\r\n\t\t\t\t\t<span class="gf-form-label width-9" ng-show=current.auto>\r\n\t\t\t\t\t\t步进计数 <tip>当前时间范围应该被分割多少次来计算</tip>\r\n\t\t\t\t\t</span>\r\n\t\t\t\t\t<div class="gf-form-select-wrapper max-width-10" ng-show=current.auto>\r\n\t\t\t\t\t\t<select class=gf-form-input ng-model=current.auto_count ng-options="f for f in [1,2,3,4,5,10,20,30,40,50,100,200,300,400,500]" ng-change=runQuery()></select>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=gf-form>\r\n\t\t\t\t\t<span class=gf-form-label ng-show=current.auto>\r\n\t\t\t\t\t\t最小间隔 <tip>计算的值不会低于此阈值</tip>\r\n\t\t\t\t\t</span>\r\n\t\t\t\t\t<input type=text class="gf-form-input max-width-10" ng-show=current.auto ng-model=current.auto_min ng-change=runQuery() placeholder=10s>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div ng-if="current.type === \'custom\'" class=gf-form-group>\r\n\t\t\t<h5 class=section-heading>自定义选项</h5>\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<span class="gf-form-label width-14">值以逗号\',\'分割</span>\r\n\t\t\t\t\x3c!-- [OGE]将输入框改为作用域 ——df --\x3e\r\n\t\t\t\t<textarea rows="" cols="" class=gf-form-input ng-model=current.query ng-blur=runQuery() placeholder="1, 10, 20, myvalue" required></textarea>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t\x3c!-- [OGE]添加Json和Link变量类型 ——df --\x3e\r\n\t\t<div ng-if="current.type === \'json\'" class=gf-form-group>\r\n\t\t\t<h5 class=section-heading>Json 选项</h5>\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<span class="gf-form-label width-14">Json</span>\r\n\t\t\t\t<textarea rows="" cols="" class=gf-form-input ng-model=current.query ng-blur=runQuery() placeholder=\'[{"text":"西安","value":{"key":"222","id":1}},{"text":"广州","value":{"key":"333","id":2}}]\' required></textarea>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div ng-if="current.type === \'link\'" class=gf-form-group>\r\n\t\t\t<h5 class=section-heading>链接选项</h5>\r\n\t\t\t<div class=gf-form ng-repeat="link in current.links">\r\n\t\t\t\t<div class=section>\r\n\t\t\t\t\t<div class="gf-form max-width-25">\r\n\t\t\t\t\t\t<span class="gf-form-label width-7">类型</span>\r\n\t\t\t\t\t\t<div class="gf-form-select-wrapper gf-form--grow">\r\n\t\t\t\t\t\t\t<select class=gf-form-input ng-model=link.type ng-options="f for f in [\'dashboard\',\'absolute\']"></select>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class="gf-form max-width-25">\r\n\t\t\t\t\t\t<span class="gf-form-label width-7" ng-show="link.type === \'dashboard\'">仪表盘</span>\r\n\t\t\t\t\t\t<input ng-show="link.type === \'dashboard\'" type=text ng-model=link.dashboard bs-typeahead=searchDashboards class=gf-form-input ng-blur=dashboardChanged(link) ng-blur=runQuery()>\r\n\r\n\t\t\t\t\t\t<span class="gf-form-label width-7" ng-show="link.type === \'absolute\'">链接</span>\r\n\t\t\t\t\t\t<input ng-show="link.type === \'absolute\'" type=text ng-model=link.url class="gf-form-input max-width-14" ng-blur=runQuery()>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class="gf-form max-width-25">\r\n\t\t\t\t\t\t<div class="gf-form-label width-7">标题</div>\r\n\t\t\t\t\t\t<input type=text ng-model=link.title class=gf-form-input ng-blur=runQuery()>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class="gf-form max-width-25">\r\n\t\t\t\t\t\t<span class="gf-form-label width-7">链接参数</span>\r\n\t\t\t\t\t\t<input type=text ng-model=link.params class="gf-form-input width-14" ng-blur=runQuery()>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=section>\r\n\t\t\t\t\t<gf-form-switch class=gf-form label-class=width-10 label=包含时间范围 checked=link.keepTime></gf-form-switch>\r\n\t\t\t\t\t<gf-form-switch class=gf-form label-class=width-10 label=包含变量 checked=link.includeVars></gf-form-switch>\r\n\t\t\t\t\t<gf-form-switch class=gf-form label-class=width-10 label="在新页面打开 " checked=link.targetBlank></gf-form-switch>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=section>\r\n\t\t\t\t\t<button class="btn btn-inverse gf-form-btn width-4" ng-click=removeOneLink($index);>\r\n\t\t\t\t\t\t<i class="fa fa-remove"></i>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<button class="btn btn-inverse gf-form-btn width-4" ng-click="moveOneLink($index, -1)" ng-hide=$first><i class="fa fa-arrow-up"></i></button>\r\n\t\t\t\t\t<button class="btn btn-inverse gf-form-btn width-4" ng-click="moveOneLink($index, 1)" ng-hide=$last><i class="fa fa-arrow-down"></i></button>\r\n\t\t\t\t</div>  \r\n\t\t\t</div>\r\n\t\t\t<button class="btn btn-inverse" ng-click=addOneLink();>\r\n\t\t\t\t<i class="fa fa-plus"></i>\r\n\t\t\t</button>\r\n\t\t</div>\r\n\t\t\x3c!-- END --\x3e\r\n\r\n\t\t<div ng-if="current.type === \'constant\'" class=gf-form-group>\r\n\t\t\t<h5 class=section-heading>常量选项</h5>\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<span class=gf-form-label>值</span>\r\n\t\t\t\t<input type=text class=gf-form-input ng-model=current.query ng-blur=runQuery() placeholder=度量前缀>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div ng-if="current.type === \'textbox\'" class=gf-form-group>\r\n\t\t\t<h5 class=section-heading>文本选项</h5>\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<span class=gf-form-label>默认值</span>\r\n\t\t\t\t<input type=text class=gf-form-input ng-model=current.query ng-blur=runQuery() placeholder=如果有，则为默认值>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div ng-if="current.type === \'query\'" class=gf-form-group>\r\n\t\t\t<h5 class=section-heading>查询选项</h5>\r\n\r\n\t\t\t<div class=gf-form-inline>\r\n\t\t\t\t<div class="gf-form max-width-21">\r\n\t\t\t\t\t<span class="gf-form-label width-10">数据源</span>\r\n\t\t\t\t\t<div class="gf-form-select-wrapper max-width-14">\r\n\t\t\t\t\t\t<select class=gf-form-input ng-model=current.datasource ng-options="f.value as f.name for f in datasources" ng-change=datasourceChanged() required>\r\n\t\t\t\t\t\t\t<option value="" ng-if=false></option>\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class="gf-form max-width-22">\r\n\t\t\t\t\t<span class="gf-form-label width-10">\r\n\t\t\t\t\t\t刷新\r\n\t\t\t\t\t\t<info-popover mode=right-normal>\r\n\t\t\t\t\t\t\t更新变量值\r\n\t\t\t\t\t\t</info-popover>\r\n\t\t\t\t\t</span>\r\n\t\t\t\t\t<div class="gf-form-select-wrapper width-15">\r\n\t\t\t\t\t\t<select class=gf-form-input ng-model=current.refresh ng-options="f.value as f.text for f in refreshOptions"></select>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<rebuild-on-change property=currentDatasource>\r\n\t\t\t\t<variable-query-editor-loader>\r\n\t\t\t\t</variable-query-editor-loader>\r\n\t\t\t</rebuild-on-change>\r\n\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<span class="gf-form-label width-10">\r\n\t\t\t\t\t正则表达式\r\n\t\t\t\t\t<info-popover mode=right-normal>\r\n\t\t\t\t\t\t可选，如果您想提取系列名称或度量节点段的一部分可输入正则表达式。\r\n\t\t\t\t\t</info-popover>\r\n\t\t\t\t</span>\r\n\t\t\t\t<input type=text class=gf-form-input ng-model=current.regex placeholder=/.*-(.*)-.*/ ng-model-onblur ng-change=runQuery()>\r\n\t\t\t</div>\r\n\t\t\t<div class="gf-form max-width-21">\r\n\t\t\t\t<span class="gf-form-label width-10">\r\n\t\t\t\t\t排序\r\n\t\t\t\t\t<info-popover mode=right-normal>\r\n\t\t\t\t\t\t如何对这个变量的值排序。\r\n\t\t\t\t\t</info-popover>\r\n\t\t\t\t</span>\r\n\t\t\t\t<div class="gf-form-select-wrapper max-width-14">\r\n\t\t\t\t\t<select class=gf-form-input ng-model=current.sort ng-options="f.value as f.text for f in sortOptions" ng-change=runQuery()></select>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div ng-show="current.type === \'datasource\'" class=gf-form-group>\r\n\t\t\t<h5 class=section-heading>数据源选项</h5>\r\n\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<label class="gf-form-label width-12">类型</label>\r\n\t\t\t\t<div class="gf-form-select-wrapper max-width-18">\r\n\t\t\t\t\t<select class=gf-form-input ng-model=current.query ng-options="f.value as f.text for f in datasourceTypes" ng-change=runQuery()></select>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<label class="gf-form-label width-12">\r\n\t\t\t\t\t实例名过滤\r\n\t\t\t\t\t<info-popover mode=right-normal>\r\n\t\t\t\t\t\t在变量值下拉列表中选择数据源实例的Regex过滤器。让所有都空着。\r\n\t\t\t\t\t\t<br><br>\r\n\t\t\t\t\t\t例如: <code>/^prod/</code>\r\n\r\n\t\t\t\t\t</info-popover>\r\n\t\t\t\t</label>\r\n\t\t\t\t<input type=text class="gf-form-input max-width-18" ng-model=current.regex placeholder=/.*-(.*)-.*/ ng-model-onblur ng-change=runQuery()>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div ng-if="current.type === \'adhoc\'" class=gf-form-group>\r\n\t\t\t<h5 class=section-heading>选项</h5>\r\n\t\t\t<div class="gf-form max-width-21">\r\n\t\t\t\t<span class="gf-form-label width-8">数据源</span>\r\n\t\t\t\t<div class="gf-form-select-wrapper max-width-14">\r\n\t\t\t\t\t<select class=gf-form-input ng-model=current.datasource ng-options="f.value as f.name for f in datasources" required ng-change=validate()>\r\n\t\t\t\t\t\t<option value="" ng-if=false></option>\r\n\t\t\t\t\t</select>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class="section gf-form-group" ng-show=variableTypes[current.type].supportsMulti>\r\n\t\t\t<h5 class=section-heading>选择选项</h5>\r\n\t\t\t<div class=section>\r\n\t\t\t\t<gf-form-switch class=gf-form label=多选 label-class=width-10 tooltip=可同时选择多个值 checked=current.multi on-change=runQuery()>\r\n\t\t\t\t</gf-form-switch>\r\n\t\t\t\t<gf-form-switch class=gf-form label=包括所有选项 label-class=width-10 checked=current.includeAll on-change=runQuery()>\r\n\t\t\t\t</gf-form-switch>\r\n\t\t\t</div>\r\n\t\t\t<div class=gf-form ng-if=current.includeAll>\r\n\t\t\t\t<span class="gf-form-label width-10">自定义所有值</span>\r\n\t\t\t\t<input type=text class="gf-form-input max-width-15" ng-model=current.allValue placeholder="blank = auto">\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class=gf-form-group ng-if="current.type === \'query\'">\r\n\t\t\t<h5>值组/标签(实验特性)</h5>\r\n\t\t\t<gf-form-switch class=gf-form label=启用 label-class=width-10 checked=current.useTags on-change=runQuery()>\r\n\t\t\t</gf-form-switch>\r\n\t\t\t<div class="gf-form last" ng-if=current.useTags>\r\n\t\t\t\t<span class="gf-form-label width-10">标签查询</span>\r\n\t\t\t\t<input type=text class=gf-form-input ng-model=current.tagsQuery placeholder=度量名称或标记查询 ng-model-onblur>\r\n\t\t\t</div>\r\n\t\t\t<div class=gf-form ng-if=current.useTags>\r\n\t\t\t\t<li class="gf-form-label width-10">标签值查询</li>\r\n\t\t\t\t<input type=text class=gf-form-input ng-model=current.tagValuesQuery placeholder=apps.$tag.* ng-model-onblur>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class=gf-form-group ng-show=current.options.length>\r\n\t\t\t<h5>预览值</h5>\r\n\t\t\t<div class=gf-form-inline>\r\n\t\t\t\t<div class=gf-form ng-repeat="option in current.options | limitTo: optionsLimit">\r\n\t\t\t\t\t<span class=gf-form-label>{{option.text}}</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=gf-form ng-if="current.options.length > optionsLimit">\r\n\t\t\t\t\t<a class="gf-form-label btn-secondary" ng-click=showMoreOptions()>展示更多</a>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class="alert alert-info gf-form-group" ng-if=infoText>\r\n\t\t\t{{infoText}}\r\n\t\t</div>\r\n\r\n\t\t<div class="gf-form-button-row p-y-0">\r\n\t\t\t<button type=submit class="btn btn-success" ng-show="mode === \'edit\'" ng-click=update();>更新</button>\r\n\t\t\t<button type=submit class="btn btn-success" ng-show="mode === \'new\'" ng-click=add();>增加</button>\r\n\t\t</div>\r\n\r\n\t</form>\r\n</div>')}]),t.exports=r},function(t,e){var r="public/app/partials/confirm_modal.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=modal-body ng-cloak>\r\n\t<div class=modal-header>\r\n\t\t<h2 class=modal-header-title>\r\n\t\t\t<i class="fa {{icon}}"></i>\r\n\t\t\t<span class=p-l-1>\r\n\t\t\t\t{{title}}\r\n\t\t\t</span>\r\n\t\t</h2>\r\n\r\n\t\t<a class=modal-header-close ng-click=dismiss();>\r\n\t\t\t<i class="fa fa-remove"></i>\r\n\t\t</a>\r\n\t</div>\r\n\r\n\t<div class="modal-content text-center">\r\n\r\n\t\t<div class=confirm-modal-text>\r\n\t\t\t{{text}}\r\n\t\t\t<div class=confirm-modal-text2 ng-show=text2>\r\n\t\t\t\t{{text2}}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class=modal-content-confirm-text ng-if=confirmText>\r\n\t\t\t<input type=text class="gf-form-input width-16" style=display:inline-block placeholder="Type {{confirmText}} to confirm" ng-model=confirmInput ng-change=updateConfirmText(confirmInput)>\r\n\t\t</div>\r\n\r\n\t\t<div class=confirm-modal-buttons>\r\n\t\t\t<button ng-show=onAltAction type=button class="btn btn-success" ng-click=dismiss();onAltAction();>{{altActionText}}</button>\r\n\t\t\t<button type=button class="btn btn-danger" ng-click=onConfirm();dismiss(); ng-disabled=!confirmTextValid give-focus=true>{{yesText}}</button>\r\n\t\t\t<button type=button class="btn btn-inverse" ng-click=dismiss()>{{noText}}</button>\r\n\t\t</div>\r\n\t</div>\r\n\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/partials/dashboard.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div dash-class ng-if=ctrl.dashboard>\r\n\t<dashnav dashboard=ctrl.dashboard></dashnav>\r\n\r\n\t<div class="scroll-canvas scroll-canvas--dashboard" page-scrollbar ng-style="{\'background\':ctrl.backgroundUrl}">\r\n    <dashboard-settings dashboard=ctrl.dashboard ng-if=ctrl.dashboardViewState.state.editview class=dashboard-settings>\r\n    </dashboard-settings>\r\n\r\n\t\t<div class=dashboard-container ng-class="{\'dashboard-container--has-submenu\': ctrl.dashboard.meta.submenuEnabled}">\r\n      <dashboard-submenu ng-if=ctrl.dashboard.meta.submenuEnabled dashboard=ctrl.dashboard>\r\n      </dashboard-submenu>\r\n\r\n      <dashboard-grid dashboard=ctrl.dashboard></dashboard-grid>\r\n    </div>\r\n  </div>\r\n  \x3c!-- [OGE]添加全屏按钮 ——df --\x3e\r\n  <div class=a-hidden-or-show-btn ng-click=hiddenOrShowClick()>\r\n    <span class=gf-form-label ng-show=!dashboard.showTimes>\r\n      <i class="fa fa-arrows-alt pointer"></i>\r\n    </span>\r\n    <span class=gf-form-label ng-show=dashboard.showTimes>\r\n      <i class="fa fa-compress pointer"></i>\r\n    </span> \r\n  </div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/partials/edit_json.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div ng-controller=JsonEditorCtrl>\r\n\t<div class=tabbed-view-header>\r\n\t\t<h2 class=tabbed-view-title>\r\n\t\t\tJSON\r\n\t\t</h2>\r\n\r\n\t\t<button class=tabbed-view-close-btn ng-click=dismiss()>\r\n\t\t\t<i class="fa fa-remove"></i>\r\n\t\t</button>\r\n\t</div>\r\n\r\n\t<div class=tabbed-view-body>\r\n\t\t<div class=gf-form>\r\n\t\t\t<code-editor content=json data-mode=json data-max-lines=20></code-editor>\r\n\t\t</div>\r\n\r\n\t\t<div class=gf-form-button-row>\r\n\t\t\t<button type=button class="btn btn-success" ng-show=canUpdate ng-click="update(); dismiss();">Update</button>\r\n\t\t\t<button class="btn btn-secondary" ng-if=canCopy clipboard-button=getContentForClipboard()>\r\n\t\t\t\t<i class="fa fa-clipboard"></i>&nbsp;Copy to Clipboard\r\n\t\t\t</button>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/partials/error.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<page-header model=navModel></page-header>\r\n\r\n<div class="page-container page-body">\r\n  <div class="panel-container error-container">\r\n    <div class="error-column graph-box">\r\n      <div class=error-row>\r\n        <div class="error-column error-space-between graph-percentage">\r\n          <p>100%</p>\r\n          <p>80%</p>\r\n          <p>60%</p>\r\n          <p>40%</p>\r\n          <p>20%</p>\r\n          <p>0%</p>\r\n        </div>\r\n        <div class="error-column image-box">\r\n          <img src=public/img/graph404.svg width=100%>\r\n          <div class="error-row error-space-between">\r\n            <p class=graph-text>Then</p>\r\n            <p class=graph-text>Now</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class="error-column info-box">\r\n      <div class="error-row current-box">\r\n        <p class=current-text>current</p>\r\n      </div>\r\n      <div class=error-row style=flex:1>\r\n        <i class="fa fa-minus error-minus"></i>\r\n        <div class="error-column error-space-between error-full-width">\r\n          <div class="error-row error-space-between">\r\n            <p>Chances you are on the page you are looking for.</p>\r\n            <p class=left-margin>0%</p>\r\n          </div>\r\n          <div>\r\n            <h3>Sorry for the inconvenience</h3>\r\n            <p>Please go back to your\r\n            <a href={{appSubUrl}}/ class=error-link>home dashboard</a> and try again.</p>\r\n            <p>If the error persists, seek help on the\r\n            <a href=https://community.grafana.com target=_blank class=error-link>community site</a>.</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <span class=react-resizable-handle style=cursor:default></span>\r\n  </div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/partials/login.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class="login container">\r\n  <div class=login-content>\r\n    <div class=login-branding>\r\n      <img class=logo-icon src=public/img/grafana_icon.svg alt=Grafana />\r\n      <span style=font-size:30px;margin-left:-8px>奥技异</span>\r\n    </div>\r\n    <div class=login-outer-box>\r\n      <div class=login-inner-box id=login-view>\r\n        <form name=loginForm class="login-form-group gf-form-group" ng-hide=disableLoginForm>\r\n          <div class=login-form>\r\n            <input type=text name=username class="gf-form-input login-form-input" required ng-model=formModel.user placeholder={{loginHint}} autofocus>\r\n          </div>\r\n          <div class=login-form>\r\n            <input type=password name=password class="gf-form-input login-form-input" required ng-model=formModel.password id=inputPassword placeholder=密码>\r\n          </div>\r\n          <div class="login-form gf-form-inline" ng-if=verificationCode>\r\n            <img src="" alt="" id=identificationNumberPic style=display:inline-block ng-click=refreshIdentificationNumberPic()>\r\n            <input type=text name=verifyValue class="gf-form-input login-form-input" required ng-model=formModel.verifyValue placeholder=验证码 style=min-width:50px;width:90px;display:inline-block;margin-left:2px>\r\n          </div>\r\n          <div class=login-button-group>\r\n            <button type=submit class="btn btn-large p-x-2" ng-if=!loggingIn ng-click=submit(); ng-class="{\'btn-inverse\': !loginForm.$valid, \'btn-primary\': loginForm.$valid}">\r\n              登录\r\n            </button>\r\n            <button type=submit class="btn btn-large p-x-2 btn-inverse btn-loading" ng-if=loggingIn>\r\n              正在登录<span>.</span><span>.</span><span>.</span>\r\n            </button>\r\n            <div class="small login-button-forgot-password">\r\n              <a href=user/password/send-reset-email>\r\n                忘记密码？\r\n              </a>\r\n            </div>\r\n          </div>\r\n        </form>\r\n        <div class="text-center login-divider" ng-show=oauthEnabled>\r\n          <div>\r\n            <div class=login-divider-line>\r\n            </div>\r\n          </div>\r\n          <div>\r\n            <span class=login-divider-text>\r\n              <span ng-hide=disableLoginForm>或者</span>\r\n            </span>\r\n          </div>\r\n          <div>\r\n            <div class=login-divider-line>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=clearfix></div>\r\n        <div class="login-oauth text-center" ng-show=oauthEnabled>\r\n          <a class="btn btn-medium btn-service btn-service--google login-btn" href=login/google target=_self ng-if=oauth.google>\r\n            <i class="btn-service-icon fa fa-google"></i>\r\n            用谷歌账号登录\r\n          </a>\r\n          <a class="btn btn-medium btn-service btn-service--github login-btn" href=login/github target=_self ng-if=oauth.github>\r\n            <i class="btn-service-icon fa fa-github"></i>\r\n            用GitHub账号登录\r\n          </a>\r\n          <a class="btn btn-medium btn-service btn-service--gitlab login-btn" href=login/gitlab target=_self ng-if=oauth.gitlab>\r\n            <i class="btn-service-icon fa fa-gitlab"></i>\r\n            用GitLab账号登录\r\n          </a>\r\n          <a class="btn btn-medium btn-service btn-service--oauth login-btn" href=login/generic_oauth target=_self ng-if=oauth.generic_oauth>\r\n            <i class="btn-service-icon fa fa-sign-in"></i>\r\n            用{{oauth.generic_oauth.name}}登录\r\n          </a>\r\n        </div>\r\n        <div class=login-signup-box ng-show=!disableUserSignUp>\r\n          <div class="login-signup-title p-r-1">\r\n            首次使用\r\n          </div>\r\n          <a href=signup class="btn btn-medium btn-signup btn-p-x-2">\r\n            注册\r\n          </a>\r\n        </div>\r\n      </div>\r\n      <div class="login-inner-box remove hidden" id=change-password-view>\r\n        <div class="text-left login-change-password-info">\r\n          <h5>修改密码</h5>\r\n          首次使用前, 需要您通过更改密码来确保帐户更加安全。\r\n        </div>\r\n        <form name=passwordForm class="login-form-group gf-form-group">\r\n          <div class=login-form>\r\n            <input type=password name=oldPassword class="gf-form-input login-form-input" required ng-model=command.oldPassword placeholder=旧密码>\r\n          </div>\r\n          <div class=login-form>\r\n            <input type=password id=newPassword name=newPassword minlength=10 class="gf-form-input login-form-input" required ng-model=command.newPassword placeholder=新密码,最少10位长度,大小写字母/数字/特殊字符最少3种组合且不能包含空格 ng-pattern=passwordPattern>\r\n            <div ng-show="passwordForm.newPassword.$viewValue && passwordForm.newPassword.$viewValue !== \'\' && passwordForm.newPassword.$invalid">\r\n              <span style=color:red>密码复杂度校验失败</span>\r\n            </div>\r\n          </div>\r\n          <div class=login-form>\r\n            <input type=password name=confirmNew class="gf-form-input login-form-input" required ng-model=command.confirmNew placeholder=确认新的密码>\r\n          </div>\r\n          <div class="login-button-group login-button-group--right text-right">\r\n            \x3c!--<a class="btn btn-link" ng-click="skip();">\r\n              跳过\r\n              <info-popover mode="no-padding">\r\n                如果跳过, 系统将在下次登录时提示您更改密码。\r\n              </info-popover>\r\n            </a>--\x3e\r\n            <button type=submit class="btn btn-large p-x-2" ng-click=changePassword(); ng-class="{\'btn-inverse\': !loginForm.$valid, \'btn-success\': loginForm.$valid}">\r\n              保存\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n      <div class=clearfix></div>\r\n    </div>\r\n  </div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/partials/metrics-options.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=editor-row ng-if=ctrl.panel.targets>\r\n  <div class=gf-form-group>\r\n    <div class=gf-form-inline ng-repeat="item in ctrl.panel.metricsOptionsAll">\r\n      <div class=gf-form>\r\n        <div class="gf-form width-2 gf-form-label gf-form-query-letter-cell">\r\n          <span class=gf-form-query-letter-cell-letter>{{$index+1}}</span>\r\n        </div>\r\n      </div>\r\n      <div class=gf-form>\r\n        <div class="gf-form gf-form--grow max-width-10">\r\n          <select class=gf-form-input ng-model=item.target ng-options="f for f in ctrl.panel.targetName"></select>\r\n        </div>\r\n      </div>\r\n      <div class=gf-form>\r\n        <div class="gf-form gf-form--grow max-width-7">\r\n          <select class=gf-form-input ng-model=item.kindOf ng-options="n for n in [\'公式\',\'运算\']"></select>\r\n        </div>\r\n      </div>\r\n      <div class=gf-form ng-if="item.kindOf === \'运算\'">\r\n        <div class="gf-form gf-form--grow">\r\n          <metric-segment-model property=item.metricsOptionLists.targetOne options=ctrl.panel.targetOrigin custom=true on-change=ctrl.refresh();></metric-segment-model>\r\n        </div>\r\n        <div class=gf-form ng-repeat="sign in item.metricsOptionLists.sign">\r\n          <select class="gf-form-input max-width-4" ng-model=sign.sign ng-options="i for i in [\'+\',\'-\',\'*\',\'/\']" ng-change=ctrl.refresh();></select>\r\n          <metric-segment-model property=sign.targetTwo options=ctrl.panel.targetOrigin custom=true on-change=ctrl.refresh();></metric-segment-model>\r\n        </div>\r\n        <div class=gf-form>\r\n          <label class=gf-form-label>\r\n            <a class=pointer ng-click=ctrl.addOneCount(item.metricsOptionLists)><i class="fa fa-plus"></i></a>\r\n          </label>\r\n          <label class=gf-form-label>\r\n            <a class=pointer ng-click=ctrl.removeOneCount(item.metricsOptionLists)><i class="fa fa-minus"></i></a>\r\n          </label>\r\n        </div>\r\n      </div>\r\n      <div class=gf-form ng-if="item.kindOf === \'公式\'">\r\n        <div class=gf-form>\r\n          <span class=gf-form-label>别名</span>\r\n          <input ng-model=item.metricsOptions.alisa type=text class="gf-form-input ng-pristine ng-untouched ng-valid ng-empty width-12" placeholder=无 empty-to-null=1 ng-change=ctrl.refresh();>\r\n        </div>\r\n        <div class=gf-form>\r\n          <span class=gf-form-label>公式转换</span>\r\n          <span class=gf-form-label><i class="fa fa-remove"></i></span>\r\n          <input ng-model=item.metricsOptions.math_multiply type=number class="gf-form-input ng-pristine ng-untouched ng-valid ng-empty width-6" placeholder=1 empty-to-null=1 ng-change=ctrl.refresh();>\r\n          <span class=gf-form-label><i class="fa fa-plus"></i></span>\r\n          <input ng-model=item.metricsOptions.math_add type=number class="gf-form-input ng-pristine ng-untouched ng-valid ng-empty width-6" placeholder=0 empty-to-null=0 ng-change=ctrl.refresh();>\r\n        </div>\r\n        <div class=gf-form ng-if=ctrl.panel.metricsOptionSettings.showPrecision>\r\n          <span class=gf-form-label>精度</span>\r\n          <input ng-model=item.metricsOptions.precision type=number class="gf-form-input ng-pristine ng-untouched ng-valid ng-empty width-4" placeholder=- empty-to-null="" ng-change=ctrl.refresh();>\r\n        </div>\r\n      </div>\r\n      <div class=gf-form>\r\n        <div class=gf-form>\r\n          <button class="btn btn-inverse gf-form-btn" ng-click=ctrl.removeOneRow($index)><i class="fa fa-trash"></i> 删除</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class=gf-form-button-row>\r\n    <button class="btn btn-inverse" ng-click=ctrl.addOneRow()>\r\n      <i class="fa fa-plus"></i>\r\n          添加一行\r\n    </button>\r\n  </div>  \r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/partials/modal.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=modal-header>\r\n  <button type=button class=close data-dismiss=modal aria-hidden=true>×</button>\r\n  <h3>{{modal.title}}</h3>\r\n</div>\r\n<div class=modal-body>\r\n\r\n  <div ng-bind-html=modal.body></div>\r\n\r\n</div>\r\n<div class=modal-footer>\r\n  <button type=button class="btn btn-danger" ng-click=dismiss()>Close</button>\r\n</div>')}]),t.exports=r},function(t,e){var r="public/app/partials/oge_alert.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=editor-row>\r\n  <div class="section gf-form-group">\r\n    <h5 class=section-heading>报警设置</h5>\r\n    <div class=gf-form-inline>\r\n      <gf-form-switch class=gf-form label-class=width-7 label=启用报警 checked=ctrl.panel.ogeAlertEnabled on-change=ctrl.render()></gf-form-switch>\r\n    </div>\r\n    <div class=gf-form-inline>\r\n      <gf-form-switch class=gf-form label-class=width-7 label=数值变色 checked=ctrl.ogeAlertColorValue on-change="ctrl.changeOgeAlertColorType(\'V\')"></gf-form-switch>\r\n    </div>\r\n    <div class=gf-form-inline>\r\n      <gf-form-switch class=gf-form label-class=width-7 label=背景变色 checked=ctrl.ogeAlertColorBackground on-change="ctrl.changeOgeAlertColorType(\'B\')"></gf-form-switch>\r\n    </div>\r\n    <div class=gf-form-inline>\r\n      <gf-form-switch class=gf-form label-class=width-7 label=行变色 checked=ctrl.ogeAlertColorRow on-change="ctrl.changeOgeAlertColorType(\'R\')" tooltip=仅对表格控件有效></gf-form-switch>\r\n    </div>\r\n  </div>\r\n\r\n  <oge-alert-colors-selector panel-ctrl=ctrl></oge-alert-colors-selector>\r\n\r\n  <div class="section gf-form-group" ng-show=ctrl.ogeAlertConfig.showCover>\r\n    <h5 class=section-heading>显示设置</h5>\r\n    <div class=gf-form-inline>\r\n      <gf-form-switch class=gf-form label-class=width-15 label=使用报警状态代替当前数值 checked=ctrl.panel.ogeAlertNameCoverValue tooltip=勾选此选项则所有显示的数值均以其报警状态显示 on-change=ctrl.selectCoverValue(true)></gf-form-switch>\r\n    </div>\r\n    <div class=gf-form-inline>\r\n      <gf-form-switch class=gf-form label-class=width-15 label=使用报警数值代替当前数值 checked=ctrl.panel.ogeAlertValueCoverValue tooltip=勾选此选项则所有显示的数值均以其报警数值显示 on-change=ctrl.selectCoverValue(false)></gf-form-switch>\r\n    </div>\r\n    <div class=gf-form-inline>\r\n      <gf-form-switch class=gf-form label-class=width-15 label=使用报警时间代替当前时间 checked=ctrl.panel.ogeAlertTimeCoverTime tooltip=勾选此选项则所有显示的时间均以其报警时间显示 on-change=ctrl.render()></gf-form-switch>\r\n    </div>\r\n    <div class=gf-form-inline>\r\n      <gf-form-switch class=gf-form label-class=width-15 label=播放报警音 checked=ctrl.panel.ogeAlertSound tooltip=勾选此选项则在危险状态时播放报警音 on-change=ctrl.render()></gf-form-switch>\r\n    </div>\r\n    <div class=gf-form-inline ng-show=ctrl.panel.ogeAlertSound>\r\n      <label class="gf-form-label width-15">播放间隔\r\n        <tip>0表示播放一次后终止，大于0则表示播放下一次的间隔，单位ms，注意间隔时间需大于音频时长</tip>\r\n      </label>\r\n      <input type=number class=gf-form-input style=width:57px placeholder=2000 empty-to-null ng-model=ctrl.panel.timeInterval valid-time-span ng-change=ctrl.refresh() ng-model-onblur/>\r\n    </div>\r\n  </div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/partials/panelgeneral.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=editor-row>\r\n\t<div class="section gf-form-group">\r\n\t\t<h5 class=section-heading>信息</h5>\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class="gf-form-label width-7">标题</span>\r\n\t\t\t<input type=text class="gf-form-input width-25" ng-model=ctrl.panel.title>\r\n\t\t</div>\r\n\t\t<div class="gf-form gf-form--v-stretch">\r\n\t\t\t<span class="gf-form-label width-7">描述</span>\r\n\t\t\t<textarea class="gf-form-input width-25" rows=3 ng-model=ctrl.panel.description placeholder=面板描述，支持标记和链接></textarea>\r\n\t\t</div>\r\n    <gf-form-switch class=gf-form label-class=width-7 switch-class=max-width-6 label=背景透明 checked=ctrl.panel.transparent on-change=ctrl.render()></gf-form-switch>\r\n\t</div>\r\n\r\n  <div class="section gf-form-group">\r\n    <h5 class=section-heading>重复</h5>\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class="gf-form-label width-9">对于每个值</span>\r\n\t\t\t<dash-repeat-option panel=ctrl.panel></dash-repeat-option>\r\n\t\t</div>\r\n    <div class=gf-form ng-show=ctrl.panel.repeat>\r\n\t\t\t<span class="gf-form-label width-9">描述</span>\r\n\t\t\t<select class=gf-form-input ng-model=ctrl.panel.repeatDirection ng-options="f.value as f.text for f in [{value: \'v\', text: \'垂直\'}, {value: \'h\', text: \'水平\'}]">\r\n\t\t\t\t<option value=""></option>\r\n\t\t\t</select>\r\n\t\t</div>\r\n\t\t<div class=gf-form ng-show="ctrl.panel.repeat && ctrl.panel.repeatDirection == \'h\'">\r\n\t\t\t<span class="gf-form-label width-9">最小宽度</span>\r\n\t\t\t<select class=gf-form-input ng-model=ctrl.panel.minSpan ng-options="f for f in [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24]">\r\n\t\t\t\t<option value=""></option>\r\n\t\t\t</select>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<panel-links-editor panel=ctrl.panel></panel-links-editor>\r\n\r\n\r\n</div>')}]),t.exports=r},function(t,e){var r="public/app/partials/reset_password.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<page-header model=navModel></page-header>\r\n\r\n<div class="page-container page-body">\r\n\t<div class=signup>\r\n\t\t<h3 class=p-b-1>重置密码</h3>\r\n\t\t<form name=sendResetForm class="login-form gf-form-group" ng-show="mode === \'send\'">\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t\t<span class="gf-form-label width-7">User</span>\r\n\t\t\t\t\t<input type=text name=username class="gf-form-input max-width-14" required ng-model=formModel.userOrEmail placeholder=邮箱或用户名>\r\n\t\t\t</div>\r\n\t\t\t<div class=gf-form-button-row>\r\n\t\t\t\t<button type=submit class="btn btn-success" ng-click=sendResetEmail(); ng-disabled=!sendResetForm.$valid>\r\n\t\t\t\t\t重置密码\r\n\t\t\t\t</button>\r\n\t\t\t\t<a href=login class="btn btn-inverse">\r\n\t\t\t\t\t返回\r\n\t\t\t\t</a>\r\n\r\n\t\t\t</div>\r\n\t\t</form>\r\n\t\t<div ng-show="mode === \'email-sent\'">\r\n\t\t\t重置链接已发送到您的电子邮件地址。<br>\r\n\t\t\t稍后您应该就可以收到。\r\n\t\t\t<div class=p-t-1>\r\n\t\t\t\t<a href=login class="btn btn-success p-t-1">\r\n\t\t\t\t\t登录\r\n\t\t\t\t</a>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<form name=resetForm class="login-form gf-form-group" ng-show="mode === \'reset\'">\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<span class="gf-form-label width-9">输入新密码</span>\r\n\t\t\t\t<input type=password name=NewPassword class="gf-form-input max-width-14" required ng-minlength=4 ng-model=formModel.newPassword placeholder=密码 watch-change="formModel.newPassword = inputValue;">\r\n\t\t\t</div>\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<span class="gf-form-label width-9">确认新密码</span>\r\n\t\t\t\t<input type=password name=ConfirmPassword class="gf-form-input max-width-14" required ng-minlength=4 ng-model=formModel.confirmPassword placeholder=确认密码>\r\n\t\t\t</div>\r\n\t\t\t<div class=signup__password-strength>\r\n\t\t\t\t<password-strength password=formModel.newPassword></password-strength>\r\n\t\t\t</div>\r\n\t\t\t<div class=gf-form-button-row>\r\n\t\t\t\t<button type=submit class="btn btn-success" ng-click=submitReset(); ng-disabled=!resetForm.$valid>\r\n\t\t\t\t\t重置密码\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t</form>\r\n\t</div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/partials/signup_invited.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<page-header model=navModel></page-header>\r\n\r\n<div class="page-container page-body">\r\n\t<h3 class=page-sub-heading>你好 {{greeting}}.</h3>\r\n\r\n\t<div class="modal-tagline p-b-2">\r\n\t\t<em>{{invitedBy}}</em> 邀请您加入KAM组织 <span class=highlight-word>{{contextSrv.user.orgName}}</span><br>请填写以下信息接受邀请并继续:\r\n\t</div>\r\n\r\n\t<form name=inviteForm class="login-form gf-form-group">\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class="gf-form-label width-7">邮箱</span>\r\n\t\t\t<input type=email name=email class="gf-form-input max-width-21" required ng-model=formModel.email placeholder=邮箱>\r\n\t\t</div>\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class="gf-form-label width-7">名称</span>\r\n\t\t\t<input type=text name=name class="gf-form-input max-width-21" ng-model=formModel.name placeholder="名称 (可选)">\r\n\t\t</div>\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class="gf-form-label width-7">用户名</span>\r\n\t\t\t<input type=text name=username class="gf-form-input max-width-21" required ng-model=formModel.username placeholder=用户名>\r\n\t\t</div>\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class="gf-form-label width-7">密码</span>\r\n\t\t\t<input type=password name=password class="gf-form-input max-width-21" required ng-model=formModel.password id=inputPassword placeholder=密码>\r\n\t\t</div>\r\n\r\n\t\t<div style=margin-left:7.5rem;width:254px>\r\n\t\t\t<password-strength password=formModel.password></password-strength>\r\n\t\t</div>\r\n\r\n\t\t<div class=gf-form-button-row>\r\n\t\t\t<button type=submit class="btn btn-success" ng-click=submit(); ng-disable=!inviteForm.$valid>\r\n\t\t\t\t注册\r\n\t\t\t</button>\r\n\t\t</div>\r\n\t</form>\r\n</div>\r\n\r\n\r\n')}]),t.exports=r},function(t,e){var r="public/app/partials/signup_step2.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<page-header model=navModel></page-header>\r\n\r\n<div class="page-container page-body">\r\n  <div class=signup>\r\n    <h3 class=p-b-1>注册</h3>\r\n    <div class=p-b-1>\r\n      请填写详细信息<br>完成您的注册.\r\n    </div>\r\n    <form name=signUpForm class="login-form gf-form-group">\r\n      <div class=gf-form ng-if=verifyEmailEnabled>\r\n        <span class="gf-form-label width-9">\r\n          验证码<tip>发送到您邮箱的验证码</tip>\r\n        </span>\r\n        <input type=text class="gf-form-input max-width-14" ng-model=formModel.code required>\r\n      </div>\r\n\r\n      <div class=gf-form ng-if=!autoAssignOrg>\r\n        <span class="gf-form-label width-9">组织</span>\r\n        <input type=text name=orgName class="gf-form-input max-width-14" ng-model=formModel.orgName placeholder=为您的组织命名>\r\n      </div>\r\n\r\n      <div class=gf-form>\r\n        <span class="gf-form-label width-9">姓名</span>\r\n        <input type=text name=name class="gf-form-input max-width-14" ng-model=formModel.name placeholder=(可选)>\r\n      </div>\r\n      <div class=gf-form>\r\n        <span class="gf-form-label width-9">邮箱</span>\r\n        <input type=text class="gf-form-input max-width-14" required ng-model=formModel.username placeholder=邮箱 autocomplete=off>\r\n      </div>\r\n      <div class=gf-form>\r\n        <span class="gf-form-label width-9">密码</span>\r\n        <input type=password class="gf-form-input max-width-14" required ng-model=formModel.password id=inputPassword placeholder=密码 autocomplete=off>\r\n      </div>\r\n\r\n      <div class=signup__password-strength>\r\n        <password-strength password=formModel.password></password-strength>\r\n      </div>\r\n\r\n      <div class="gf-form-button-row p-t-3">\r\n        <button type=submit class="btn btn-success" ng-click=ctrl.submit(); ng-disabled=!signUpForm.$valid>\r\n          注册\r\n        </button>\r\n        <a href=login class="btn btn-inverse">\r\n            返回\r\n        </a>\r\n      </div>\r\n    </form>\r\n  </div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/partials/valueSelectDropdown.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=variable-link-wrapper>\r\n\t<a ng-click=vm.show() class=variable-value-link>\r\n\t\t{{vm.linkText}}\r\n\t\t<span ng-repeat="tag in vm.selectedTags" bs-tooltip=tag.valuesText data-placement=bottom>\r\n\t\t\t<span class=label-tag tag-color-from-name=tag.text>\r\n\t\t\t\t&nbsp;&nbsp;<i class="fa fa-tag"></i>&nbsp;\r\n\t\t\t\t{{tag.text}}\r\n\t\t\t</span>\r\n\t\t</span>\r\n\t\t<i class="fa fa-caret-down" style=font-size:12px></i>\r\n\t</a>\r\n\r\n\t<input type=text class=gf-form-input style=display:none ng-keydown=vm.keyDown($event) ng-model=vm.search.query ng-change=vm.queryChanged()>\r\n\r\n\t<div class=variable-value-dropdown ng-if=vm.dropdownVisible ng-class="{\'multi\': vm.variable.multi, \'single\': !vm.variable.multi}">\r\n\t\t<div class=variable-options-wrapper>\r\n\t\t\t<div class=variable-options-column>\r\n\t\t\t\t<a class=variable-options-column-header ng-if=vm.variable.multi ng-class="{\'many-selected\': vm.selectedValues.length > 1}" bs-tooltip="\'Clear selections\'" data-placement=top ng-click=vm.clearSelections()>\r\n\t\t\t\t\t<span class=variable-option-icon></span>\r\n\t\t\t\t\t已选择 ({{vm.selectedValues.length}})\r\n\t\t\t\t</a>\r\n\t\t\t\t<a class="variable-option pointer" ng-repeat="option in vm.search.options" ng-class="{\'selected\': option.selected, \'highlighted\': $index === vm.highlightIndex}" ng-click="vm.selectValue(option, $event)">\r\n\t\t\t\t\t<span class=variable-option-icon></span>\r\n\t\t\t\t\t<span>{{option.text}}</span>\r\n\t\t\t\t</a>\r\n\t\t\t</div>\r\n\t\t\t<div class=variable-options-column ng-if=vm.tags.length>\r\n\t\t\t\t<div class="variable-options-column-header text-center">\r\n\t\t\t\t\tTags\r\n\t\t\t\t</div>\r\n\t\t\t\t<a class="variable-option-tag pointer" ng-repeat="tag in vm.tags" ng-click="vm.selectTag(tag, $event)" ng-class="{\'selected\': tag.selected}">\r\n\t\t\t\t\t<span class="fa fa-fw variable-option-icon"></span>\r\n\t\t\t\t\t<span class=label-tag tag-color-from-name=tag.text>{{tag.text}}&nbsp;&nbsp;<i class="fa fa-tag"></i>&nbsp;</span>\r\n\t\t\t\t</a>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/partials/valueSelectUnfold.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=variable-link-wrapper>\t\r\n\t<a ng-click=vm.show() class="gf-form-label variable-value-link">\r\n\t\t{{vm.linkText}}\r\n\t\t<span ng-repeat="tag in vm.selectedTags" bs-tooltip=tag.valuesText data-placement=bottom>\r\n\t\t\t<span class=label-tag tag-color-from-name=tag.text>\r\n\t\t\t\t&nbsp;&nbsp;<i class="fa fa-tag"></i>&nbsp;\r\n\t\t\t\t{{tag.text}}\r\n\t\t\t</span>\r\n\t\t</span>\r\n\t</a>\r\n\r\n\t<input type=text class=gf-form-input style=display:none ng-keydown=vm.keyDown($event) ng-model=vm.search.query ng-change=vm.queryChanged()>\r\n\r\n\t<div ng-class="{\'multi\': vm.variable.multi, \'single\': !vm.variable.multi}">\r\n\t\t<div class=gf-form ng-repeat="option in vm.search.options">\r\n\t\t\t\x3c!-- <a class="variable-options-column-header" ng-if="vm.variable.multi" ng-class="{\'many-selected\': vm.selectedValues.length > 1}" bs-tooltip="\'Clear selections\'" data-placement="top" ng-click="vm.clearSelections()">\r\n\t\t\t\t<span class="variable-option-icon"></span>\r\n\t\t\t\t已选择 ({{vm.selectedValues.length}})\r\n\t\t\t</a> --\x3e\r\n\t\t\t<a class=pointer ng-class="{\'selected\': option.selected, \'highlighted\': $index === vm.highlightIndex}" ng-click="vm.selectValue(option, $event)">\r\n\t\t\t\t<span class=variable-option-icon></span>\r\n\t\t\t\t<span>{{option.text}}</span>\r\n\t\t\t</a>\r\n\t\t</div>\r\n\t\t<div class=gf-form ng-if=vm.tags.length>\r\n\t\t\t<div class="variable-options-column-header text-center">\r\n\t\t\t\tTags\r\n\t\t\t</div>\r\n\t\t\t<a class=pointer ng-repeat="tag in vm.tags" ng-click="vm.selectTag(tag, $event)" ng-class="{\'selected\': tag.selected}">\r\n\t\t\t\t<span class="fa fa-fw variable-option-icon"></span>\r\n\t\t\t\t<span class=label-tag tag-color-from-name=tag.text>{{tag.text}}&nbsp;&nbsp;<i class="fa fa-tag"></i>&nbsp;</span>\r\n\t\t\t</a>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/cloudwatch/partials/annotations.editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<cloudwatch-query-parameter target=ctrl.annotation datasource=ctrl.datasource></cloudwatch-query-parameter>\r\n\r\n<div class=editor-row style="padding:2rem 0">\r\n\t<div class=section>\r\n\t\t<h5>Prefix matching</h5>\r\n\t\t<div class=gf-form-inline>\r\n\t\t\t<gf-form-switch class=gf-form label=Enable checked=ctrl.annotation.prefixMatching switch-class=max-width-6></gf-form-switch>\r\n\t\t\t<div class=gf-form ng-if=ctrl.annotation.prefixMatching>\r\n\t\t\t\t<span class=gf-form-label>Action</span>\r\n\t\t\t\t<input type=text class=gf-form-input ng-model=ctrl.annotation.actionPrefix>\r\n\t\t\t</div>\r\n\t\t\t<div class=gf-form ng-if=ctrl.annotation.prefixMatching>\r\n\t\t\t\t<span class=gf-form-label>Alarm Name</span>\r\n\t\t\t\t<input type=text class=gf-form-input ng-model=ctrl.annotation.alarmNamePrefix>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/cloudwatch/partials/config.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<h3 class=page-heading>CloudWatch details</h3>\r\n\r\n<div class="gf-form-group max-width-30">\r\n  <div class="gf-form gf-form-select-wrapper">\r\n    <label class="gf-form-label width-13">Auth Provider</label>\r\n    <select class="gf-form-input gf-max-width-13" ng-model=ctrl.current.jsonData.authType ng-options="f.value as f.name for f in ctrl.authTypes"></select>\r\n  </div>\r\n\r\n  <div class=gf-form ng-show=\'ctrl.current.jsonData.authType == "credentials"\'>\r\n    <label class="gf-form-label width-13">Credentials profile name</label>\r\n    <input type=text class="gf-form-input max-width-18" ng-model=ctrl.current.database placeholder=default>\r\n    <info-popover mode=right-absolute>\r\n      Credentials profile name, as specified in ~/.aws/credentials, leave blank for default\r\n    </info-popover>\r\n  </div>\r\n\r\n  <div class=gf-form ng-show=\'ctrl.current.jsonData.authType == "keys"\'>\r\n    <label class="gf-form-label width-13">Access key ID </label>\r\n    <label class="gf-form-label width-13" ng-show=ctrl.accessKeyExist>Configured</label>\r\n    <a class="btn btn-secondary gf-form-btn" type=submit ng-click=ctrl.resetAccessKey() ng-show=ctrl.accessKeyExist>Reset</a>\r\n    <input type=text class="gf-form-input max-width-18" ng-hide=ctrl.accessKeyExist ng-model=ctrl.current.secureJsonData.accessKey>\r\n  </div>\r\n\r\n  <div class=gf-form ng-show=\'ctrl.current.jsonData.authType == "keys"\'>\r\n    <label class="gf-form-label width-13">Secret access key</label>\r\n    <label class="gf-form-label width-13" ng-show=ctrl.secretKeyExist>Configured</label>\r\n    <a class="btn btn-secondary gf-form-btn" type=submit ng-click=ctrl.resetSecretKey() ng-show=ctrl.secretKeyExist>Reset</a>\r\n    <input type=text class="gf-form-input max-width-18" ng-hide=ctrl.secretKeyExist ng-model=ctrl.current.secureJsonData.secretKey>\r\n  </div>\r\n\r\n  <div class=gf-form ng-show=\'ctrl.current.jsonData.authType == "arn"\'>\r\n    <label class="gf-form-label width-13">Assume Role ARN</label>\r\n    <input type=text class="gf-form-input max-width-18" ng-model=ctrl.current.jsonData.assumeRoleArn placeholder=arn:aws:iam:*>\r\n    <info-popover mode=right-absolute>\r\n      ARN of Assume Role\r\n    </info-popover>\r\n  </div>\r\n\r\n  <div class=gf-form>\r\n    <label class="gf-form-label width-13">Default Region</label>\r\n    <div class="gf-form-select-wrapper max-width-18 gf-form-select-wrapper--has-help-icon">\r\n      <select class=gf-form-input ng-model=ctrl.current.jsonData.defaultRegion ng-options="region for region in ctrl.regions"></select>\r\n      <info-popover mode=right-absolute>\r\n        Specify the region, such as for US West (Oregon) use ` us-west-2 ` as the region.\r\n      </info-popover>\r\n    </div>\r\n  </div>\r\n  <div class=gf-form>\r\n    <label class="gf-form-label width-13">Custom Metrics</label>\r\n    <input type=text class="gf-form-input max-width-18" ng-model=ctrl.current.jsonData.customMetricsNamespaces placeholder=Namespace1,Namespace2>\r\n    <info-popover mode=right-absolute>\r\n      Namespaces of Custom Metrics\r\n    </info-popover>\r\n  </div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/cloudwatch/partials/query.editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,"<query-editor-row query-ctrl=ctrl can-collapse=false>\r\n\t<cloudwatch-query-parameter target=ctrl.target datasource=ctrl.datasource on-change=ctrl.refresh()></cloudwatch-query-parameter>\r\n</query-editor-row>\r\n\r\n")}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/cloudwatch/partials/query.parameter.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=gf-form-inline ng-if="target.expression.length === 0">\r\n\t<div class=gf-form>\r\n\t\t<label class="gf-form-label query-keyword width-8">Metric</label>\r\n\r\n\t\t<metric-segment segment=regionSegment get-options=getRegions() on-change=regionChanged()></metric-segment>\r\n\t\t<metric-segment segment=namespaceSegment get-options=getNamespaces() on-change=namespaceChanged()></metric-segment>\r\n\t\t<metric-segment segment=metricSegment get-options=getMetrics() on-change=metricChanged()></metric-segment>\r\n\t</div>\r\n\r\n\t<div class=gf-form>\r\n\t\t<label class="gf-form-label query-keyword">Stats</label>\r\n\t</div>\r\n\r\n\t<div class=gf-form ng-repeat="segment in statSegments">\r\n\t\t<metric-segment segment=segment get-options="getStatSegments(segment, $index)" on-change="statSegmentChanged(segment, $index)"></metric-segment>\r\n\t</div>\r\n\r\n\t<div class="gf-form gf-form--grow">\r\n\t\t<div class="gf-form-label gf-form-label--grow"></div>\r\n\t</div>\r\n</div>\r\n\r\n<div class=gf-form-inline ng-if="target.expression.length === 0">\r\n\t<div class=gf-form>\r\n\t\t<label class="gf-form-label query-keyword width-8">Dimensions</label>\r\n\t\t<metric-segment ng-repeat="segment in dimSegments" segment=segment get-options="getDimSegments(segment, $index)" on-change="dimSegmentChanged(segment, $index)"></metric-segment>\r\n\t</div>\r\n\r\n\t<div class="gf-form gf-form--grow">\r\n\t\t<div class="gf-form-label gf-form-label--grow"></div>\r\n\t</div>\r\n</div>\r\n\r\n<div class=gf-form-inline ng-if="target.statistics.length === 1">\r\n\t<div class=gf-form>\r\n\t\t<label class="gf-form-label query-keyword width-8">\r\n\t\t\tId\r\n\t\t\t<info-popover mode="right-normal ">Id can include numbers, letters, and underscore, and must start with a lowercase letter.</info-popover>\r\n\t\t</label>\r\n\t\t<input type="text " class=gf-form-input ng-model="target.id " spellcheck=false ng-pattern=/^[a-z][a-zA-Z0-9_]*$/ ng-model-onblur ng-change="onChange() ">\r\n\t</div>\r\n\t<div class="gf-form max-width-30">\r\n\t\t<label class="gf-form-label query-keyword width-7">Expression</label>\r\n\t\t<input type="text " class=gf-form-input ng-model="target.expression\r\n\t " spellcheck=false ng-model-onblur ng-change="onChange() ">\r\n\t</div>\r\n</div>\r\n\r\n<div class=gf-form-inline>\r\n\t<div class=gf-form>\r\n\t\t<label class="gf-form-label query-keyword width-8">\r\n\t\t\tMin period\r\n\t\t\t<info-popover mode="right-normal ">Minimum interval between points in seconds</info-popover>\r\n\t\t</label>\r\n\t\t<input type="text " class=gf-form-input ng-model="target.period " spellcheck=false placeholder="auto\r\n\t " ng-model-onblur ng-change="onChange() "/>\r\n\t</div>\r\n\t<div class="gf-form max-width-30">\r\n\t\t<label class="gf-form-label query-keyword width-7">Alias</label>\r\n\t\t<input type="text " class=gf-form-input ng-model="target.alias " spellcheck=false ng-model-onblur ng-change="onChange() ">\r\n\t\t<info-popover mode="right-absolute ">\r\n\t\t\tAlias replacement variables:\r\n\t\t\t<ul ng-non-bindable>\r\n\t\t\t\t<li>{{metric}}</li>\r\n\t\t\t\t<li>{{stat}}</li>\r\n\t\t\t\t<li>{{namespace}}</li>\r\n\t\t\t\t<li>{{region}}</li>\r\n\t\t\t\t<li>{{period}}</li>\r\n\t\t\t\t<li>{{YOUR_DIMENSION_NAME}}</li>\r\n\t\t\t</ul>\r\n\t\t</info-popover>\r\n\t</div>\r\n\t<div class=gf-form>\r\n\t\t<gf-form-switch class=gf-form label="HighRes " label-class="width-5 " checked="target.highResolution " on-change="onChange() ">\r\n\t\t</gf-form-switch>\r\n\t</div>\r\n\r\n\t<div class="gf-form gf-form--grow">\r\n\t\t<div class="gf-form-label gf-form-label--grow"></div>\r\n\t</div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/elasticsearch/partials/annotations.editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=gf-form-group>\r\n\t<div class=gf-form ng-if=ctrl.annotation.index>\r\n\t\t<span class="gf-form-label width-14">索引名称</span>\r\n\t\t<input type=text class="gf-form-input max-width-20" ng-model=ctrl.annotation.index placeholder=events-*>\r\n\t</div>\r\n\t<div class=gf-form-group>\r\n\t\t<div class=gf-form>\r\n\t\t\t<input type=text class=gf-form-input ng-model=ctrl.annotation.query placeholder="Elasticsearch lucene query">\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n\r\n<div class=gf-form-group>\r\n\t<h6>Field mappings</h6>\r\n\t<div class=gf-form-inline>\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class=gf-form-label>Time</span>\r\n\t\t\t<input type=text class="gf-form-input max-width-14" ng-model=ctrl.annotation.timeField placeholder=@timestamp>\r\n\t\t</div>\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class=gf-form-label>Text</span>\r\n\t\t\t<input type=text class="gf-form-input max-width-14" ng-model=ctrl.annotation.textField placeholder="">\r\n\t\t</div>\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class=gf-form-label>Tags</span>\r\n\t\t\t<input type=text class="gf-form-input max-width-10" ng-model=ctrl.annotation.tagsField placeholder=tags>\r\n\t\t</div>\r\n\t\t<div class=gf-form ng-show=ctrl.annotation.titleField>\r\n\t\t\t<span class=gf-form-label>Title <em class=muted>(deprecated)</em></span>\r\n\t\t\t<input type=text class="gf-form-input max-width-16" ng-model=ctrl.annotation.titleField placeholder=desc>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/elasticsearch/partials/bucket_agg.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=gf-form-inline>\r\n\t<div class=gf-form>\r\n\t\t<label class="gf-form-label query-keyword width-7">\r\n\t\t\t<span ng-show=isFirst>Group by</span>\r\n\t\t\t<span ng-hide=isFirst>Then by</span>\r\n\t\t</label>\r\n\r\n\t\t<gf-form-dropdown model=agg.type lookup-text=true get-options=getBucketAggTypes() on-change=onTypeChanged() allow-custom=false label-mode=true css-class=width-10>\r\n\t\t</gf-form-dropdown>\r\n\t\t<gf-form-dropdown ng-if=agg.field model=agg.field get-options=getFieldsInternal() on-change=onChange() allow-custom=false label-mode=true css-class=width-12>\r\n\t\t</gf-form-dropdown>\r\n\t</div>\r\n\r\n\t<div class="gf-form gf-form--grow">\r\n\t\t<label class="gf-form-label gf-form-label--grow">\r\n\t\t\t<a ng-click=toggleOptions()>\r\n\t\t\t\t<i class="fa fa-caret-down" ng-show=showOptions></i>\r\n\t\t\t\t<i class="fa fa-caret-right" ng-hide=showOptions></i>\r\n\t\t\t\t{{settingsLinkText}}\r\n\t\t\t</a>\r\n\t\t</label>\r\n\t</div>\r\n\r\n\t<div class=gf-form>\r\n\t\t<label class=gf-form-label ng-if=isFirst>\r\n\t\t\t<a class=pointer ng-click=addBucketAgg()><i class="fa fa-plus"></i></a>\r\n\t\t</label>\r\n\t\t<label class=gf-form-label ng-if="bucketAggCount > 1">\r\n\t\t\t<a class=pointer ng-click=removeBucketAgg()><i class="fa fa-minus"></i></a>\r\n\t\t</label>\r\n\t</div>\r\n</div>\r\n\r\n<div class=gf-form-group ng-if=showOptions>\r\n\t<div ng-if="agg.type === \'date_histogram\'">\r\n\t\t<div class="gf-form offset-width-7">\r\n\t\t\t<label class="gf-form-label width-10">Interval</label>\r\n\t\t\t<gf-form-dropdown model=agg.settings.interval get-options=getIntervalOptions() on-change=onChangeInternal() allow-custom=true label-mode=true css-class=width-12>\r\n\t\t\t</gf-form-dropdown>\r\n\t\t</div>\r\n\r\n\t\t<div class="gf-form offset-width-7">\r\n\t\t\t<label class="gf-form-label width-10">Min Doc Count</label>\r\n\t\t\t<input type=number class="gf-form-input max-width-12" ng-model=agg.settings.min_doc_count ng-blur=onChangeInternal()>\r\n\t\t</div>\r\n\r\n\t\t<div class="gf-form offset-width-7">\r\n\t\t\t<label class="gf-form-label width-10">\r\n\t\t\t\tTrim edges\r\n\t\t\t\t<info-popover mode=right-normal>\r\n\t\t\t\t\tTrim the edges on the timeseries datapoints\r\n\t\t\t\t</info-popover>\r\n\t\t\t</label>\r\n\t\t\t<input class="gf-form-input max-width-12" type=number ng-model=agg.settings.trimEdges ng-change=onChangeInternal()>\r\n\t\t</div>\r\n\t\t\x3c!-- [OGE] -DF --\x3e\r\n\t\t<div class="gf-form offset-width-7">\r\n\t\t\t<label class="gf-form-label width-10">Order</label>\r\n\t\t\t<gf-form-dropdown model=agg.settings.order lookup-text=true get-options=getOrderOptions() on-change=onChangeInternal() label-mode=true css-class=width-12>\r\n\t\t\t</gf-form-dropdown> \r\n\t\t</div>\r\n\t\t<div class="gf-form offset-width-7">\r\n\t\t\t<label class="gf-form-label width-10">Offset</label>\r\n\t\t\t<input type=text class="gf-form-input max-width-12" ng-model=agg.settings.offset ng-blur=onChangeInternal()>\r\n\t\t</div>\r\n\t\t\x3c!-- END --\x3e\r\n\t</div>\r\n\t<div ng-if="agg.type === \'histogram\'">\r\n\t\t<div class="gf-form offset-width-7">\r\n\t\t\t<label class="gf-form-label width-10">Interval</label>\r\n\t\t\t<input type=number class="gf-form-input max-width-12" ng-model=agg.settings.interval ng-blur=onChangeInternal()>\r\n\t\t</div>\r\n\t\t<div class="gf-form offset-width-7">\r\n\t\t\t<label class="gf-form-label width-10">Min Doc Count</label>\r\n\t\t\t<input type=number class="gf-form-input max-width-12" ng-model=agg.settings.min_doc_count ng-blur=onChangeInternal()>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div ng-if="agg.type === \'terms\'">\r\n\t\t<div class="gf-form offset-width-7">\r\n\t\t\t<label class="gf-form-label width-10">Order</label>\r\n\t\t\t<gf-form-dropdown model=agg.settings.order lookup-text=true get-options=getOrderOptions() on-change=onChangeInternal() label-mode=true css-class=width-12>\r\n\t\t\t</gf-form-dropdown>\r\n\t\t</div>\r\n\t\t<div class="gf-form offset-width-7">\r\n\t\t\t<label class="gf-form-label width-10">Size</label>\r\n\t\t\t<gf-form-dropdown model=agg.settings.size lookup-text=true get-options=getSizeOptions() on-change=onChangeInternal() label-mode=true allow-custom=true css-class=width-12>\r\n\t\t\t</gf-form-dropdown>\r\n\t\t</div>\r\n\t\t<div class="gf-form offset-width-7">\r\n\t\t\t<label class="gf-form-label width-10">Min Doc Count</label>\r\n\t\t\t<input type=number class="gf-form-input max-width-12" ng-model=agg.settings.min_doc_count ng-blur=onChangeInternal()>\r\n\t\t</div>\r\n\t\t<div class="gf-form offset-width-7">\r\n\t\t\t<label class="gf-form-label width-10">Order By</label>\r\n\t\t\t<gf-form-dropdown model=agg.settings.orderBy lookup-text=true get-options=getOrderByOptions() on-change=onChangeInternal() label-mode=true css-class=width-12>\r\n\t\t\t</gf-form-dropdown>\r\n\t\t</div>\r\n\t\t<div class="gf-form offset-width-7">\r\n\t\t\t<label class="gf-form-label width-10">\r\n\t\t\t\tMissing\r\n\t\t\t\t<info-popover mode=right-normal>\r\n\t\t\t\t\tThe missing parameter defines how documents that are missing a value should be treated. By default they will be ignored but it is also possible to treat them as if they had a value\r\n\t\t\t\t</info-popover>\r\n\t\t\t</label>\r\n\t\t\t<input type=text class="gf-form-input max-width-12" empty-to-null ng-model=agg.settings.missing ng-blur=onChangeInternal() spellcheck=false>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div ng-if="agg.type === \'filters\'">\r\n\t\t<div class="gf-form-inline offset-width-7" ng-repeat="filter in agg.settings.filters">\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<label class="gf-form-label width-10">Query {{$index + 1}}</label>\r\n\t\t\t\t<input type=text class="gf-form-input max-width-12" ng-model=filter.query spellcheck=false placeholder="Lucene query" ng-blur=onChangeInternal()>\r\n\t\t\t\t<label class="gf-form-label width-10">Label {{$index + 1}}</label>\r\n\t\t\t\t<input type=text class="gf-form-input max-width-12" ng-model=filter.label spellcheck=false placeholder=Label ng-blur=onChangeInternal()>\r\n\t\t\t</div>\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<label class=gf-form-label ng-if=$first>\r\n\t\t\t\t\t<a class=pointer ng-click=addFiltersQuery()><i class="fa fa-plus"></i></a>\r\n\t\t\t\t</label>\r\n\t\t\t\t<label class=gf-form-label ng-if=!$first>\r\n\t\t\t\t\t<a class=pointer ng-click=removeFiltersQuery(filter)><i class="fa fa-minus"></i></a>\r\n\t\t\t\t</label>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div ng-if="agg.type === \'geohash_grid\'">\r\n\t\t<div class="gf-form offset-width-7">\r\n\t\t\t<label class="gf-form-label width-10">Precision</label>\r\n\t\t\t<input type=number class="gf-form-input max-width-12" ng-model=agg.settings.precision spellcheck=false placeholder=3 ng-blur=onChangeInternal()>\r\n\t\t</div>\r\n\t</div>\r\n\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/elasticsearch/partials/config.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<datasource-http-settings current=ctrl.current suggest-url=http://localhost:9200>\r\n</datasource-http-settings>\r\n\r\n<h3 class=page-heading>Elasticsearch details</h3>\r\n\r\n<div class=gf-form-group>\r\n\t<div class=gf-form-inline>\r\n\t\t<div class="gf-form max-width-25">\r\n\t\t\t<span class="gf-form-label width-9">Index name</span>\r\n\t\t\t<input class=gf-form-input type=text ng-model=ctrl.current.database placeholder="" required>\r\n\t\t</div>\r\n\r\n\t\t<div class="gf-form width-14">\r\n      <span class="gf-form-label width-9">Pattern</span>\r\n      <span class=gf-form-select-wrapper>\r\n          <select class="gf-form-input gf-size-auto" ng-model=ctrl.current.jsonData.interval ng-options="f.value as f.name for f in ctrl.indexPatternTypes" ng-change=ctrl.indexPatternTypeChanged()></select>\r\n      </span>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class="gf-form max-width-25">\r\n\t\t<span class="gf-form-label width-9">Time field name</span>\r\n\t\t<input class=gf-form-input type=text ng-model=ctrl.current.jsonData.timeField placeholder="" required ng-init="">\r\n\t</div>\r\n\r\n\t<div class=gf-form>\r\n    <span class="gf-form-label width-9">Version</span>\r\n    <span class=gf-form-select-wrapper>\r\n        <select class="gf-form-input gf-size-auto" ng-model=ctrl.current.jsonData.esVersion ng-options="f.value as f.name for f in ctrl.esVersions"></select>\r\n    </span>\r\n\t</div>\r\n    <div class="gf-form max-width-30" ng-if="ctrl.current.jsonData.esVersion>=56">\r\n        <span class="gf-form-label width-15">Max concurrent Shard Requests</span>\r\n        <input class=gf-form-input type=text ng-model=ctrl.current.jsonData.maxConcurrentShardRequests placeholder="" required>\r\n    </div>\r\n\t<div class=gf-form-inline>\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class="gf-form-label width-9">Min time interval</span>\r\n\t\t\t<input type=text class="gf-form-input width-6" ng-model=ctrl.current.jsonData.timeInterval spellcheck=false placeholder=10s>\r\n\t\t\t<info-popover mode=right-absolute>\r\n\t\t\t\tA lower limit for the auto group by time interval. Recommended to be set to write frequency,\r\n\t\t\t\tfor example <code>1m</code> if your data is written every minute.\r\n\t\t\t</info-popover>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/elasticsearch/partials/metric_agg.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=gf-form-inline ng-class="{\'gf-form-disabled\': agg.hide}">\r\n\t<div class=gf-form>\r\n\t\t<label class="gf-form-label query-keyword width-7">\r\n\t\t\t度量\r\n\t\t\t&nbsp;\r\n\t\t\t<a ng-click=toggleShowMetric() bs-tooltip="\'Click to toggle show / hide metric\'">\r\n\t\t\t\t<i class="fa fa-eye" ng-hide=agg.hide></i>\r\n\t\t\t\t<i class="fa fa-eye-slash" ng-show=agg.hide></i>\r\n\t\t\t</a>\r\n\t\t</label>\r\n\t</div>\r\n\r\n\t<div class=gf-form>\r\n\t\t<metric-segment-model property=agg.type options=metricAggTypes on-change=onTypeChange() custom=false css-class=width-10></metric-segment-model>\r\n\t\t<metric-segment-model ng-if=aggDef.requiresField property=agg.field get-options=getFieldsInternal() on-change=onChange() css-class=width-12></metric-segment-model>\r\n\t\t<metric-segment-model ng-if=aggDef.isPipelineAgg property=agg.pipelineAgg options=pipelineAggOptions on-change=onChangeInternal() custom=false css-class=width-12></metric-segment-model>\r\n    \x3c!-- [OGE]添加除法参数-DF --\x3e\r\n    <metric-segment-model ng-if="aggDef.isPipelineAgg && aggDef.isDivisionAgg" property=item.text options=pipelineAggOptions ng-repeat="item in agg.ParamNames" on-change=onChangeInternal() custom=false css-class=width-10></metric-segment-model>\r\n    <div class=gf-form ng-if="aggDef.isPipelineAgg && aggDef.isDivisionAgg">\r\n      <label class=gf-form-label>\r\n        <a class=pointer ng-click=addParams()><i class="fa fa-plus"></i></a>\r\n      </label>\r\n      <label class=gf-form-label>\r\n        <a class=pointer ng-click=removeParams()><i class="fa fa-minus"></i></a>\r\n      </label>\r\n    </div>\r\n    \x3c!-- 别名-DF --\x3e\r\n    <div class="gf-form max-width-15">\r\n      <label class=gf-form-label>别名</label>\r\n      <input type=text class=gf-form-input ng-model=agg.aliasNew spellcheck=false placeholder=别名 ng-blur=onChangeInternal()>\r\n    </div>\r\n\t</div>\r\n  \x3c!-- END --\x3e\r\n\t<div class="gf-form gf-form--grow">\r\n\t\t<label class="gf-form-label gf-form-label--grow">\r\n\t\t\t<a ng-click=toggleOptions() ng-if=settingsLinkText>\r\n\t\t\t\t<i class="fa fa-caret-down" ng-show=showOptions></i>\r\n\t\t\t\t<i class="fa fa-caret-right" ng-hide=showOptions></i>\r\n\t\t\t\t\t{{settingsLinkText}}\r\n\t\t\t</a>\r\n\t\t</label>\r\n\t</div>\r\n\r\n\t<div class=gf-form>\r\n\t\t<label class=gf-form-label ng-if=isFirst>\r\n\t\t\t<a class=pointer ng-click=addMetricAgg()><i class="fa fa-plus"></i></a>\r\n\t\t</label>\r\n\t\t<label class=gf-form-label ng-if=!isSingle>\r\n\t\t\t<a class=pointer ng-click=removeMetricAgg()><i class="fa fa-minus"></i></a>\r\n\t\t</label>\r\n\t</div>\r\n</div>\r\n\r\n<div class=gf-form-group ng-if=showOptions>\r\n\t<div class="gf-form offset-width-7" ng-if="agg.type === \'derivative\'">\r\n\t\t<label class="gf-form-label width-10">Unit</label>\r\n\t\t<input type=text class="gf-form-input max-width-12" ng-model=agg.settings.unit ng-blur=onChangeInternal() spellcheck=false>\r\n\t</div>\r\n\r\n  <div ng-if="agg.type === \'moving_avg\'">\r\n    <div class="gf-form offset-width-7">\r\n      <label class="gf-form-label width-10">Model</label>\r\n      <metric-segment-model property=agg.settings.model options=movingAvgModelTypes on-change=onChangeClearInternal() custom=false css-class=width-12></metric-segment-model>\r\n    </div>\r\n\r\n    <div class="gf-form offset-width-7">\r\n      <label class="gf-form-label width-10">Window</label>\r\n      <input type=number class="gf-form-input max-width-12" ng-model=agg.settings.window ng-blur=onChangeInternal() spellcheck=false>\r\n    </div>\r\n\r\n    <div class="gf-form offset-width-7">\r\n      <label class="gf-form-label width-10">Predict</label>\r\n      <input type=number class="gf-form-input max-width-12" ng-model=agg.settings.predict ng-blur=onChangeInternal() spellcheck=false>\r\n    </div>\r\n\r\n\r\n    <div class="gf-form offset-width-7" ng-repeat="setting in modelSettings">\r\n      <label class="gf-form-label width-10">{{setting.text}}</label>\r\n      <input type=number class="gf-form-input max-width-12" ng-model=agg.settings.settings[setting.value] ng-blur=onChangeInternal() spellcheck=false>\r\n    </div>\r\n\r\n    <gf-form-switch ng-if="agg.settings.model == \'holt_winters\'" class="gf-form offset-width-7" label=Pad label-class=width-10 checked=agg.settings.settings.pad on-change=onChangeInternal()></gf-form-switch>\r\n    <gf-form-switch ng-if="agg.settings.model.match(\'ewma|holt_winters|holt\') !== null" class="gf-form offset-width-7" label=Minimize label-class=width-10 checked=agg.settings.minimize on-change=onChangeInternal()></gf-form-switch>\r\n  </div>\r\n\r\n  <div class="gf-form offset-width-7" ng-if="agg.type === \'percentiles\'">\r\n    <label class="gf-form-label width-10">Percentiles</label>\r\n    <input type=text class="gf-form-input max-width-12" ng-model=agg.settings.percents array-join ng-blur=onChange()>\r\n  </div>\r\n  <div class="gf-form offset-width-7" ng-if="agg.type === \'raw_document\'">\r\n    <label class="gf-form-label width-10">Size</label>\r\n    <input type=number class="gf-form-input max-width-12" ng-model=agg.settings.size ng-blur=onChange()>\r\n  </div>\r\n\r\n\r\n  <div class="gf-form offset-width-7" ng-if="agg.type === \'cardinality\'">\r\n    <label class="gf-form-label width-10">Precision threshold</label>\r\n    <input type=number class="gf-form-input max-width-12" ng-model=agg.settings.precision_threshold ng-blur=onChange()>\r\n  </div>\r\n\r\n  <div ng-if="agg.type === \'extended_stats\'">\r\n    <gf-form-switch ng-repeat="stat in extendedStats" class="gf-form offset-width-7" label={{stat.text}} label-class=width-10 checked=agg.meta[stat.value] on-change=onChangeInternal()></gf-form-switch>\r\n\r\n    <div class="gf-form offset-width-7">\r\n      <label class="gf-form-label width-10">Sigma</label>\r\n      <input type=number class="gf-form-input max-width-12" placeholder=3 ng-model=agg.settings.sigma ng-blur=onChange()>\r\n    </div>\r\n  </div>\r\n\r\n  <div class="gf-form offset-width-7" ng-if=aggDef.supportsInlineScript>\r\n    \x3c!-- [OGE]添加tip使用说明 --\x3e\r\n    <label class="gf-form-label width-10">Script\r\n      <tip ng-if="aggDef.isPipelineAgg && aggDef.isDivisionAgg">在这里可以直接对所选参数进行数学运算，例如：两个所选参数相除，则params.var_1/params.var_2。三个参数相除，则params.var_1/params.var_2/params.var_3，以此类推。</tip>\r\n    </label>\r\n    <input type=text class="gf-form-input max-width-50" empty-to-null ng-model=agg.inlineScript ng-blur=onChangeInternal() spellcheck=false placeholder="_value * 1">\r\n  </div>\r\n\r\n  <div class="gf-form offset-width-7" ng-if=aggDef.supportsMissing>\r\n\t\t<label class="gf-form-label width-10">\r\n\t\t\tMissing\r\n\t\t\t<tip>The missing parameter defines how documents that are missing a value should be treated. By default they will be ignored but it is also possible to treat them as if they had a value</tip>\r\n\t\t</label>\r\n\t\t<input type=number class="gf-form-input max-width-12" empty-to-null ng-model=agg.settings.missing ng-blur=onChangeInternal() spellcheck=false>\r\n\t</div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/elasticsearch/partials/query.editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<query-editor-row query-ctrl=ctrl can-collapse=true>\r\n\r\n\t<div class=gf-form-inline>\r\n\t\t<div class="gf-form gf-form--grow">\r\n\t\t\t<label class="gf-form-label query-keyword width-7">Query</label>\r\n\t\t\t<input type=text class=gf-form-input ng-model=ctrl.target.query spellcheck=false placeholder="Lucene query" ng-blur=ctrl.refresh()>\r\n\t\t</div>\r\n\t\t<div class="gf-form max-width-15">\r\n\t\t\t<label class="gf-form-label query-keyword">Alias</label>\r\n\t\t\t<input type=text class=gf-form-input ng-model=ctrl.target.alias spellcheck=false placeholder="alias patterns" ng-blur=ctrl.refresh()>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div ng-repeat="agg in ctrl.target.metrics">\r\n\t\t<elastic-metric-agg target=ctrl.target index=$index get-fields=ctrl.getFields($fieldType) on-change=ctrl.queryUpdated() es-version=ctrl.esVersion>\r\n\t\t</elastic-metric-agg>\r\n\t</div>\r\n\r\n\t<div ng-repeat="agg in ctrl.target.bucketAggs">\r\n\t\t<elastic-bucket-agg target=ctrl.target index=$index get-fields=ctrl.getFields($fieldType) on-change=ctrl.queryUpdated()>\r\n\t\t</elastic-bucket-agg>\r\n\t</div>\r\n\r\n</query-editor-row>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/grafana-live/partials/query.editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<query-editor-row query-ctrl=ctrl can-collapse=false>\r\n\t<div class=gf-form-inline>\r\n\t\t<div class="gf-form gf-form--grow">\r\n\t\t\t<label class="gf-form-label width-8">Stream</label>\r\n\t\t\t<input type=text class=gf-form-input ng-model=ctrl.target.stream spellcheck=false placeholder=metric>\r\n\t\t</div>\r\n\t</div>\r\n</query-editor-row>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/grafana/partials/annotations.editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'\r\n<div class=gf-form-group>\r\n\t<div class=gf-form-inline>\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class="gf-form-label width-9">\r\n\t\t\t\t筛选条件\r\n\t\t\t\t<info-popover mode=right-normal>\r\n\t\t\t\t\t<ul>\r\n\t\t\t\t\t\t<li>仪表盘: 这将为整个仪表板获取注释和警报状态更改，并仅在事件的初始面板上显示它们。</li>\r\n\t\t\t\t\t\t<li>所有: 这将获取匹配标签过滤器的所有注释事件。</li>\r\n\t\t\t\t\t</ul>\r\n\t\t\t\t</info-popover>\r\n\t\t\t</span>\r\n\t\t\t<div class="gf-form-select-wrapper width-8">\r\n\t\t\t\t<select class=gf-form-input ng-model=ctrl.annotation.type ng-options="f.value as f.text for f in ctrl.types">\r\n\t\t\t\t</select>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class=gf-form-label>最大限制</span>\r\n\t\t\t<div class=gf-form-select-wrapper>\r\n\t\t\t\t<select class=gf-form-input ng-model=ctrl.annotation.limit ng-options="f for f in [10,50,100,200,300,500,1000,2000]">\r\n\t\t\t\t</select>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\t<div class=gf-form-inline>\r\n\t\t<div class=gf-form ng-if="ctrl.annotation.type === \'tags\'">\r\n\t\t\t<gf-form-switch class=gf-form label=匹配所有 label-class=width-9 checked=ctrl.annotation.matchAny on-change=ctrl.refresh() tooltip=默认情况下，KAM将显示匹配查询中的所有标记的注释。启用此功能将使KAM返回所有带有您指定的标记的注释。></gf-form-switch>\r\n\t\t</div>\r\n\t\t<div class=gf-form ng-if="ctrl.annotation.type === \'tags\'">\r\n\t\t\t<span class=gf-form-label>标签</span>\r\n\t\t\t<bootstrap-tagsinput ng-model=ctrl.annotation.tags tagclass="label label-tag" placeholder=添加标签>\r\n\t\t\t</bootstrap-tagsinput>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n\r\n\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/grafana/partials/query.editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<query-editor-row query-ctrl=ctrl can-collapse=false>\r\n\t<div class=gf-form-inline>\r\n\t\t<div class=gf-form>\r\n\t\t\t<label class=gf-form-label>Test data: random walk</label>\r\n\t\t</div>\r\n\r\n\t\t<div class="gf-form gf-form--grow">\r\n\t\t\t<div class="gf-form-label gf-form-label--grow"></div>\r\n\t\t</div>\r\n\t</div>\r\n</query-editor-row>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/graphite/partials/annotations.editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=gf-form-group>\r\n  <div class=gf-form>\r\n    <span class="gf-form-label width-12">Graphite query</span>\r\n    <input type=text class=gf-form-input ng-model=ctrl.annotation.target placeholder="Example: statsd.application.counters.*.count">\r\n  </div>\r\n\r\n\t<h5 class=section-heading>Or</h5>\r\n\r\n  <div class=gf-form>\r\n    <span class="gf-form-label width-12">Graphite events tags</span>\r\n    <input type=text class=gf-form-input ng-model=ctrl.annotation.tags placeholder="Example: event_tag_name">\r\n  </div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/graphite/partials/config.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<datasource-http-settings current=ctrl.current suggest-url=http://localhost:8080>\r\n</datasource-http-settings>\r\n\r\n<h3 class=page-heading>Graphite details</h3>\r\n\r\n<div class=gf-form-group>\r\n\t<div class=gf-form>\r\n\t\t<span class="gf-form-label width-8">\r\n      Version\r\n      <info-popover mode=right-normal position="top center">\r\n        This option controls what functions are available in the Graphite query editor.\r\n      </info-popover>\r\n    </span>\r\n    <span class=gf-form-select-wrapper>\r\n        <select class="gf-form-input gf-size-auto" ng-model=ctrl.current.jsonData.graphiteVersion ng-options="f.value as f.name for f in ctrl.graphiteVersions"></select>\r\n    </span>\r\n\t</div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/graphite/partials/query.editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<query-editor-row query-ctrl=ctrl has-text-edit-mode=true>\r\n\r\n  <div class=gf-form ng-show=ctrl.target.textEditor>\r\n    <input type=text class=gf-form-input ng-model=ctrl.target.target spellcheck=false ng-blur=ctrl.targetTextChanged()>\r\n  </div>\r\n\r\n  <div ng-hide=ctrl.target.textEditor>\r\n    <div class=gf-form-inline>\r\n      <div class=gf-form>\r\n        <label class="gf-form-label width-6 query-keyword">Series</label>\r\n      </div>\r\n\r\n      <div ng-if=ctrl.queryModel.seriesByTagUsed ng-repeat="tag in ctrl.queryModel.tags" class=gf-form>\r\n        <gf-form-dropdown model=tag.key allow-custom=true label-mode=true debounce=true placeholder="Tag key" css-class=query-segment-key get-options="ctrl.getTags($index, $query)" on-change="ctrl.tagChanged(tag, $index)"/>\r\n        <gf-form-dropdown model=tag.operator label-mode=true css-class=query-segment-operator get-options=ctrl.getTagOperators() on-change="ctrl.tagChanged(tag, $index)" min-input-width=30 />\r\n        <gf-form-dropdown model=tag.value allow-custom=true label-mode=true debounce=true css-class=query-segment-value placeholder="Tag value" get-options="ctrl.getTagValues(tag, $index, $query)" on-change="ctrl.tagChanged(tag, $index)"/>\r\n        <label class="gf-form-label query-keyword" ng-if=ctrl.showDelimiter($index)>AND</label>\r\n      </div>\r\n\r\n      <div ng-if=ctrl.queryModel.seriesByTagUsed ng-repeat="segment in ctrl.addTagSegments" role=menuitem class=gf-form>\r\n        <metric-segment segment=segment get-options=ctrl.getTagsAsSegments($query) on-change=ctrl.addNewTag(segment) debounce=true />\r\n      </div>\r\n\r\n      <div ng-if=!ctrl.queryModel.seriesByTagUsed ng-repeat="segment in ctrl.segments" role=menuitem class=gf-form>\r\n        <metric-segment segment=segment get-options="ctrl.getAltSegments($index, $query)" on-change="ctrl.segmentValueChanged(segment, $index)"/>\r\n      </div>\r\n\r\n      <div ng-if=ctrl.paused class=gf-form>\r\n        <a ng-click=ctrl.unpause() class="gf-form-label query-part"><i class="fa fa-play"></i></a>\r\n      </div>\r\n\r\n      <div class="gf-form gf-form--grow">\r\n        <div class="gf-form-label gf-form-label--grow"></div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=gf-form-inline>\r\n      <div class=gf-form>\r\n        <label class="gf-form-label width-6 query-keyword">Functions</label>\r\n      </div>\r\n\r\n      <div ng-repeat="func in ctrl.queryModel.functions" class=gf-form>\r\n        <span graphite-func-editor class="gf-form-label query-part" ng-hide=func.hidden></span>\r\n      </div>\r\n\r\n      <div class="gf-form dropdown">\r\n        <span graphite-add-func></span>\r\n      </div>\r\n\r\n      <div class="gf-form gf-form--grow">\r\n        <div class="gf-form-label gf-form-label--grow"></div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n</query-editor-row>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/influxdb/partials/annotations.editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'\r\n<div class=gf-form-group>\r\n\t<div class=gf-form>\r\n\t\t<input type=text class=gf-form-input ng-model=ctrl.annotation.query placeholder="select text from events where $timeFilter limit 1000">\r\n\t</div>\r\n</div>\r\n\r\n<h5 class=section-heading>Field mappings <tip>If your influxdb query returns more than one field you need to specify the column names below. An annotation event is composed of a title, tags, and an additional text field.</tip></h5>\r\n<div class=gf-form-group>\r\n\t<div class=gf-form-inline>\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class="gf-form-label width-4">Text</span>\r\n\t\t\t<input type=text class="gf-form-input max-width-10" ng-model=ctrl.annotation.textColumn placeholder="">\r\n\t\t</div>\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class="gf-form-label width-4">Tags</span>\r\n\t\t\t<input type=text class="gf-form-input max-width-10" ng-model=ctrl.annotation.tagsColumn placeholder="">\r\n\t\t</div>\r\n\t\t<div class=gf-form ng-show=ctrl.annotation.titleColumn>\r\n\t\t\t<span class="gf-form-label width-4">Title <em class=muted>(deprecated)</em></span>\r\n\t\t\t<input type=text class="gf-form-input max-width-10" ng-model=ctrl.annotation.titleColumn placeholder="">\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/influxdb/partials/config.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<datasource-http-settings current=ctrl.current suggest-url=http://localhost:8086>\r\n</datasource-http-settings>\r\n\r\n<h3 class=page-heading>InfluxDB Details</h3>\r\n\r\n<div class=gf-form-group>\r\n\t<div class=gf-form-inline>\r\n\t\t<div class="gf-form max-width-30">\r\n\t\t\t<span class="gf-form-label width-10">Database</span>\r\n\t\t\t<input type=text class=gf-form-input ng-model=ctrl.current.database placeholder="" required>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class=gf-form-inline>\r\n\t\t<div class="gf-form max-width-15">\r\n\t\t\t<span class="gf-form-label width-10">User</span>\r\n\t\t\t<input type=text class=gf-form-input ng-model=ctrl.current.user placeholder="">\r\n\t\t</div>\r\n\t\t<div class="gf-form max-width-15">\r\n\t\t\t<span class="gf-form-label width-10">Password</span>\r\n\t\t\t<input type=password class=gf-form-input ng-model=ctrl.current.password placeholder="">\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n\r\n\r\n<div class=gf-form-group>\r\n\t<div class=grafana-info-box>\r\n\t\t<h5>Database Access</h5>\r\n\t\t<p>\r\n\t\t\tSetting the database for this datasource does not deny access to other databases.  The InfluxDB query syntax allows\r\n\t\t\tswitching the database in the query.  For example:\r\n\t\t\t<code>SHOW MEASUREMENTS ON _internal</code> or <code>SELECT * FROM "_internal".."database" LIMIT 10</code>\r\n\t\t\t<br/><br/>\r\n\t\t\tTo support data isolation and security, make sure appropriate permissions are configured in InfluxDB.\r\n\t\t</p>\r\n\t</div>\r\n</div>\r\n\r\n<div class=gf-form-group>\r\n\t<div class=gf-form-inline>\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class=gf-form-label>Min time interval</span>\r\n\t\t\t<input type=text class="gf-form-input width-6" ng-model=ctrl.current.jsonData.timeInterval spellcheck=false placeholder=10s>\r\n\t\t\t<info-popover mode=right-absolute>\r\n\t\t\t\tA lower limit for the auto group by time interval. Recommended to be set to write frequency,\r\n\t\t\t\tfor example <code>1m</code> if your data is written every minute.\r\n\t\t\t</info-popover>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/influxdb/partials/query.editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<query-editor-row query-ctrl=ctrl can-collapse=true has-text-edit-mode=true>\r\n\r\n\t<div ng-if=ctrl.target.rawQuery>\r\n    <div class=gf-form>\r\n      <textarea rows=3 class=gf-form-input ng-model=ctrl.target.query spellcheck=false placeholder="InfluxDB Query" ng-model-onblur ng-change=ctrl.refresh()></textarea>\r\n    </div>\r\n    <div class=gf-form-inline>\r\n      <div class=gf-form>\r\n        <label class="gf-form-label query-keyword">FORMAT AS</label>\r\n        <div class=gf-form-select-wrapper>\r\n          <select class="gf-form-input gf-size-auto" ng-model=ctrl.target.resultFormat ng-options="f.value as f.text for f in ctrl.resultFormats" ng-change=ctrl.refresh()></select>\r\n        </div>\r\n      </div>\r\n      <div class="gf-form max-width-25" ng-hide="ctrl.target.resultFormat === \'table\'">\r\n        <label class="gf-form-label query-keyword">ALIAS BY</label>\r\n        <input type=text class=gf-form-input ng-model=ctrl.target.alias spellcheck=false placeholder="Naming pattern" ng-blur=ctrl.refresh()>\r\n      </div>\r\n      <div class="gf-form gf-form--grow">\r\n        <div class="gf-form-label gf-form-label--grow"></div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n\t<div ng-if=!ctrl.target.rawQuery>\r\n\r\n\t\t<div class=gf-form-inline>\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<label class="gf-form-label query-keyword width-7">FROM</label>\r\n\r\n\t\t\t\t<metric-segment segment=ctrl.policySegment get-options=ctrl.getPolicySegments() on-change=ctrl.policyChanged()></metric-segment>\r\n\t\t\t\t<metric-segment segment=ctrl.measurementSegment get-options=ctrl.getMeasurements($query) on-change=ctrl.measurementChanged()></metric-segment>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<label class="gf-form-label query-keyword">WHERE</label>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=gf-form ng-repeat="segment in ctrl.tagSegments">\r\n\t\t\t\t<metric-segment segment=segment get-options="ctrl.getTagsOrValues(segment, $index)" on-change="ctrl.tagSegmentUpdated(segment, $index)"></metric-segment>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class="gf-form gf-form--grow">\r\n\t\t\t\t<div class="gf-form-label gf-form-label--grow"></div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class=gf-form-inline ng-repeat="selectParts in ctrl.queryModel.selectModels">\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<label class="gf-form-label query-keyword width-7">\r\n\t\t\t\t\t<span ng-show="$index === 0">SELECT</span>&nbsp;\r\n\t\t\t\t</label>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=gf-form ng-repeat="part in selectParts">\r\n\t\t\t\t<query-part-editor class="gf-form-label query-part" part=part handle-event="ctrl.handleSelectPartEvent(selectParts, part, $event)">\r\n\t\t\t\t</query-part-editor>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<label class=dropdown dropdown-typeahead=ctrl.selectMenu dropdown-typeahead-on-select="ctrl.addSelectPart(selectParts, $item, $subItem)">\r\n\t\t\t\t</label>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class="gf-form gf-form--grow">\r\n\t\t\t\t<div class="gf-form-label gf-form-label--grow"></div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class=gf-form-inline>\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<label class="gf-form-label query-keyword width-7">\r\n\t\t\t\t\t<span>GROUP BY</span>\r\n\t\t\t\t</label>\r\n\r\n\t\t\t\t<query-part-editor ng-repeat="part in ctrl.queryModel.groupByParts" part=part class="gf-form-label query-part" handle-event="ctrl.handleGroupByPartEvent(part, $index, $event)">\r\n\t\t\t\t</query-part-editor>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<metric-segment segment=ctrl.groupBySegment get-options=ctrl.getGroupByOptions() on-change="ctrl.groupByAction(part, $index)"></metric-segment>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class="gf-form gf-form--grow">\r\n\t\t\t\t<div class="gf-form-label gf-form-label--grow"></div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n    <div class=gf-form-inline ng-if="ctrl.target.orderByTime === \'DESC\'">\r\n      <div class=gf-form>\r\n        <label class="gf-form-label query-keyword width-7">ORDER BY</label>\r\n        <label class="gf-form-label pointer" ng-click=ctrl.removeOrderByTime()>time <span class=query-keyword>DESC</span> <i class="fa fa-remove"></i></label>\r\n      </div>\r\n      <div class="gf-form gf-form--grow">\r\n\t\t\t\t<div class="gf-form-label gf-form-label--grow"></div>\r\n\t\t\t</div>\r\n    </div>\r\n\r\n    <div class=gf-form-inline ng-if=ctrl.target.limit>\r\n      <div class=gf-form>\r\n        <label class="gf-form-label query-keyword width-7">LIMIT</label>\r\n        <input type=text class="gf-form-input width-9" ng-model=ctrl.target.limit spellcheck=false placeholder="No Limit" ng-blur=ctrl.refresh()>\r\n      </div>\r\n      <div class="gf-form gf-form--grow">\r\n\t\t\t\t<div class="gf-form-label gf-form-label--grow"></div>\r\n\t\t\t</div>\r\n    </div>\r\n\r\n    <div class=gf-form-inline ng-if=ctrl.target.slimit>\r\n      <div class=gf-form>\r\n        <label class="gf-form-label query-keyword width-7">SLIMIT</label>\r\n        <input type=text class="gf-form-input width-9" ng-model=ctrl.target.slimit spellcheck=false placeholder="No Limit" ng-blur=ctrl.refresh()>\r\n      </div>\r\n      <div class="gf-form gf-form--grow">\r\n\t\t\t\t<div class="gf-form-label gf-form-label--grow"></div>\r\n\t\t\t</div>\r\n    </div>\r\n\r\n    <div class=gf-form-inline>\r\n      <div class=gf-form>\r\n        <label class="gf-form-label query-keyword width-7">FORMAT AS</label>\r\n        <div class=gf-form-select-wrapper>\r\n          <select class="gf-form-input gf-size-auto" ng-model=ctrl.target.resultFormat ng-options="f.value as f.text for f in ctrl.resultFormats" ng-change=ctrl.refresh()></select>\r\n        </div>\r\n      </div>\r\n      <div class="gf-form gf-form--grow">\r\n        <div class="gf-form-label gf-form-label--grow"></div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=gf-form-inline ng-hide="ctrl.target.resultFormat === \'table\'">\r\n      <div class="gf-form max-width-30">\r\n        <label class="gf-form-label query-keyword width-7">ALIAS BY</label>\r\n        <input type=text class=gf-form-input ng-model=ctrl.target.alias spellcheck=false placeholder="Naming pattern" ng-blur=ctrl.refresh()>\r\n      </div>\r\n      <div class="gf-form gf-form--grow">\r\n        <div class="gf-form-label gf-form-label--grow"></div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n</query-editor-row>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/logging/partials/config.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,"<datasource-http-settings current=ctrl.current no-direct-access=true>\r\n</datasource-http-settings>")}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/mssql/partials/annotations.editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'\r\n<div class=gf-form-group>\r\n  <div class=gf-form-inline>\r\n\t\t<div class="gf-form gf-form--grow">\r\n\t\t\t<textarea rows=10 class=gf-form-input ng-model=ctrl.annotation.rawQuery spellcheck=false placeholder="query expression" data-min-length=0 data-items=100 ng-model-onblur ng-change=ctrl.panelCtrl.refresh()></textarea>\r\n\t\t</div>\r\n\t</div>\r\n\r\n  <div class=gf-form-inline>\r\n    <div class=gf-form>\r\n      <label class="gf-form-label query-keyword" ng-click="ctrl.showHelp = !ctrl.showHelp">\r\n        Show Help\r\n        <i class="fa fa-caret-down" ng-show=ctrl.showHelp></i>\r\n        <i class="fa fa-caret-right" ng-hide=ctrl.showHelp></i>\r\n      </label>\r\n\t\t</div>\r\n  </div>\r\n\r\n  <div class=gf-form ng-show=ctrl.showHelp>\r\n\t\t<pre class="gf-form-pre alert alert-info"><h6>Annotation Query Format</h6>\r\nAn annotation is an event that is overlaid on top of graphs. The query can have up to three columns per row, the <b>time</b> column is mandatory. Annotation rendering is expensive so it is important to limit the number of rows returned.\r\n\r\n- column with alias: <b>time</b> for the annotation event time. Use epoch time or any native date data type.\r\n- column with alias: <b>text</b> for the annotation text.\r\n- column with alias: <b>tags</b> for annotation tags. This is a comma separated string of tags e.g. \'tag1,tag2\'.\r\n\r\n\r\nMacros:\r\n- $__time(column) -&gt; column AS time\r\n- $__timeEpoch(column) -&gt; DATEDIFF(second, \'1970-01-01\', column) AS time\r\n- $__timeFilter(column) -&gt; column BETWEEN \'2017-04-21T05:01:17Z\' AND \'2017-04-21T05:01:17Z\'\r\n- $__unixEpochFilter(column) -&gt; column &gt;= 1492750877 AND column &lt;= 1492750877\r\n\r\nOr build your own conditionals using these macros which just return the values:\r\n- $__timeFrom() -&gt;  \'2017-04-21T05:01:17Z\'\r\n- $__timeTo() -&gt;  \'2017-04-21T05:01:17Z\'\r\n- $__unixEpochFrom() -&gt; 1492750877\r\n- $__unixEpochTo() -&gt; 1492750877\r\n\t\t</pre>\r\n\t</div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/mssql/partials/config.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'\r\n<h3 class=page-heading>MSSQL Connection</h3>\r\n\r\n<div class=gf-form-group>\r\n\t<div class="gf-form max-width-30">\r\n\t\t<span class="gf-form-label width-7">Host</span>\r\n\t\t<input type=text class=gf-form-input ng-model=ctrl.current.url placeholder=localhost:1433 bs-typeahead="{{[\'localhost\', \'localhost:1433\']}}" required>\r\n\t</div>\r\n\r\n\t<div class="gf-form max-width-30">\r\n\t\t<span class="gf-form-label width-7">Database</span>\r\n\t\t<input type=text class=gf-form-input ng-model=ctrl.current.database placeholder="database name" required>\r\n\t</div>\r\n\r\n\t<div class=gf-form-inline>\r\n\t\t<div class="gf-form max-width-15">\r\n\t\t\t<span class="gf-form-label width-7">User</span>\r\n\t\t\t<input type=text class=gf-form-input ng-model=ctrl.current.user placeholder=user>\r\n\t\t</div>\r\n\t\t<div class="gf-form max-width-15" ng-if=!ctrl.current.secureJsonFields.password>\r\n\t\t\t<span class="gf-form-label width-7">Password</span>\r\n\t\t\t<input type=password class=gf-form-input ng-model=ctrl.current.secureJsonData.password placeholder=password>\r\n\t\t</div>\r\n\t\t<div class="gf-form max-width-19" ng-if=ctrl.current.secureJsonFields.password>\r\n\t\t\t<span class="gf-form-label width-7">Password</span>\r\n\t\t\t<input type=text class=gf-form-input disabled=disabled value=configured>\r\n\t\t\t<a class="btn btn-secondary gf-form-btn" href=# ng-click="ctrl.current.secureJsonFields.password = false">reset</a>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class=gf-form>\r\n\t\t<label class="gf-form-label width-7">Encrypt</label>\r\n\t\t<div class="gf-form-select-wrapper max-width-15 gf-form-select-wrapper--has-help-icon">\r\n\t\t\t<select class=gf-form-input ng-model=ctrl.current.jsonData.encrypt ng-options="mode for mode in [\'disable\', \'false\', \'true\']" ng-init=ctrl.current.jsonData.encrypt></select>\r\n\t\t\t<info-popover mode=right-absolute>\r\n\t\t\t\tDetermines whether or to which extent a secure SSL TCP/IP connection will be negotiated with the server.\r\n\t\t\t\t<ul>\r\n\t\t\t\t\t<li><i>disable</i> - Data sent between client and server is not encrypted.</li>\r\n\t\t\t\t\t<li><i>false</i> - Data sent between client and server is not encrypted beyond the login packet. (default)</li>\r\n\t\t\t\t\t<li><i>true</i> - Data sent between client and server is encrypted.</li>\r\n\t\t\t\t</ul>\r\n\t\t\t\tIf you\'re using an older version of Microsoft SQL Server like 2008 and 2008R2 you may need to disable encryption to be able to connect.\r\n\t\t\t</info-popover>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n\r\n<b>Connection limits</b>\r\n\r\n<div class=gf-form-group>\r\n\t<div class="gf-form max-width-15">\r\n\t\t<span class="gf-form-label width-7">Max open</span>\r\n\t\t<input type=number min=0 class=gf-form-input ng-model=ctrl.current.jsonData.maxOpenConns placeholder=unlimited>\r\n\t\t<info-popover mode=right-absolute>\r\n\t\t\tThe maximum number of open connections to the database. If <i>Max idle connections</i> is greater than 0 and the\r\n\t\t\t<i>Max open connections</i> is less than <i>Max idle connections</i>, then <i>Max idle connections</i> will be\r\n\t\t\treduced to match the <i>Max open connections</i> limit. If set to 0, there is no limit on the number of open\r\n\t\t\tconnections.\r\n\t\t</info-popover>\r\n\t</div>\r\n\t<div class="gf-form max-width-15">\r\n\t\t<span class="gf-form-label width-7">Max idle</span>\r\n\t\t<input type=number min=0 class=gf-form-input ng-model=ctrl.current.jsonData.maxIdleConns placeholder=2>\r\n\t\t<info-popover mode=right-absolute>\r\n\t\t\tThe maximum number of connections in the idle connection pool. If <i>Max open connections</i> is greater than 0 but\r\n\t\t\tless than the <i>Max idle connections</i>, then the <i>Max idle connections</i> will be reduced to match the\r\n\t\t\t<i>Max open connections</i> limit. If set to 0, no idle connections are retained.\r\n\t\t</info-popover>\r\n\t</div>\r\n\t<div class="gf-form max-width-15">\r\n\t\t<span class="gf-form-label width-7">Max lifetime</span>\r\n\t\t<input type=number min=0 class=gf-form-input ng-model=ctrl.current.jsonData.connMaxLifetime placeholder=14400>\r\n\t\t<info-popover mode=right-absolute>\r\n\t\t\tThe maximum amount of time in seconds a connection may be reused. If set to 0, connections are reused forever.\r\n\t\t</info-popover>\r\n\t</div>\r\n</div>\r\n\r\n<h3 class=page-heading>MSSQL details</h3>\r\n\r\n<div class=gf-form-group>\r\n\t<div class=gf-form-inline>\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class="gf-form-label width-9">Min time interval</span>\r\n\t\t\t<input type=text class="gf-form-input width-6" ng-model=ctrl.current.jsonData.timeInterval spellcheck=false placeholder=1m>\r\n\t\t\t<info-popover mode=right-absolute>\r\n\t\t\t\tA lower limit for the auto group by time interval. Recommended to be set to write frequency,\r\n\t\t\t\tfor example <code>1m</code> if your data is written every minute.\r\n\t\t\t</info-popover>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n\r\n<div class=gf-form-group>\r\n\t<div class=grafana-info-box>\r\n\t\t<h5>User Permission</h5>\r\n\t\t<p>\r\n\t\t\tThe database user should only be granted SELECT permissions on the specified database &amp; tables you want to query.\r\n\t\t\tGrafana does not validate that queries are safe so queries can contain any SQL statement. For example, statements\r\n\t\t\tlike <code>USE otherdb;</code> and <code>DROP TABLE user;</code> would be executed. To protect against this we\r\n\t\t\t<strong>Highly</strong> recommmend you create a specific MSSQL user with restricted permissions.\r\n\t\t</p>\r\n\t</div>\r\n</div>\r\n\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/mssql/partials/query.editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<query-editor-row query-ctrl=ctrl can-collapse=false>\r\n\t<div class=gf-form-inline>\r\n\t\t<div class="gf-form gf-form--grow">\r\n\t\t\t<code-editor content=ctrl.target.rawSql datasource=ctrl.datasource on-change=ctrl.panelCtrl.refresh() data-mode=sqlserver>\r\n\t\t\t</code-editor>\r\n\t\t</div>\r\n\t</div>\r\n\r\n  <div class=gf-form-inline>\r\n    <div class=gf-form>\r\n\t\t\t<label class="gf-form-label query-keyword">Format as</label>\r\n\t\t\t<div class=gf-form-select-wrapper>\r\n\t\t\t\t<select class="gf-form-input gf-size-auto" ng-model=ctrl.target.format ng-options="f.value as f.text for f in ctrl.formats" ng-change=ctrl.refresh()></select>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class=gf-form>\r\n      <label class="gf-form-label query-keyword" ng-click="ctrl.showHelp = !ctrl.showHelp">\r\n        Show Help\r\n        <i class="fa fa-caret-down" ng-show=ctrl.showHelp></i>\r\n        <i class="fa fa-caret-right" ng-hide=ctrl.showHelp></i>\r\n      </label>\r\n\t\t</div>\r\n\t\t<div class=gf-form ng-show=ctrl.lastQueryMeta>\r\n      <label class="gf-form-label query-keyword" ng-click="ctrl.showLastQuerySQL = !ctrl.showLastQuerySQL">\r\n        Generated SQL\r\n        <i class="fa fa-caret-down" ng-show=ctrl.showLastQuerySQL></i>\r\n        <i class="fa fa-caret-right" ng-hide=ctrl.showLastQuerySQL></i>\r\n      </label>\r\n\t\t</div>\r\n\t\t<div class="gf-form gf-form--grow">\r\n\t\t\t<div class="gf-form-label gf-form-label--grow"></div>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class=gf-form ng-show=ctrl.showLastQuerySQL>\r\n\t\t<pre class=gf-form-pre>{{ctrl.lastQueryMeta.sql}}</pre>\r\n\t</div>\r\n\r\n\t<div class=gf-form ng-show=ctrl.showHelp>\r\n\t\t<pre class="gf-form-pre alert alert-info">Time series:\r\n- return column named time (in UTC), as a unix time stamp or any sql native date data type. You can use the macros below.\r\n- any other columns returned will be the time point values.\r\nOptional:\r\n  - return column named <i>metric</i> to represent the series name.\r\n  - If multiple value columns are returned the metric column is used as prefix.\r\n  - If no column named metric is found the column name of the value column is used as series name\r\n\r\nResultsets of time series queries need to be sorted by time.\r\n\r\nTable:\r\n- return any set of columns\r\n\r\nMacros:\r\n- $__time(column) -&gt; column AS time\r\n- $__timeEpoch(column) -&gt; DATEDIFF(second, \'1970-01-01\', column) AS time\r\n- $__timeFilter(column) -&gt; column BETWEEN \'2017-04-21T05:01:17Z\' AND \'2017-04-21T05:01:17Z\'\r\n- $__unixEpochFilter(column) -&gt; column &gt;= 1492750877 AND column &lt;= 1492750877\r\n- $__timeGroup(column, \'5m\'[, fillvalue]) -&gt; CAST(ROUND(DATEDIFF(second, \'1970-01-01\', column)/300.0, 0) as bigint)*300.\r\n     by setting fillvalue grafana will fill in missing values according to the interval\r\n     fillvalue can be either a literal value, NULL or previous; previous will fill in the previous seen value or NULL if none has been seen yet\r\n- $__timeGroupAlias(column, \'5m\'[, fillvalue]) -&gt; CAST(ROUND(DATEDIFF(second, \'1970-01-01\', column)/300.0, 0) as bigint)*300 AS [time]\r\n- $__unixEpochGroup(column,\'5m\') -&gt; FLOOR(column/300)*300\r\n- $__unixEpochGroupAlias(column,\'5m\') -&gt; FLOOR(column/300)*300 AS [time]\r\n\r\nExample of group by and order by with $__timeGroup:\r\nSELECT\r\n  $__timeGroup(date_time_col, \'1h\') AS time,\r\n  sum(value) as value\r\nFROM yourtable\r\nGROUP BY $__timeGroup(date_time_col, \'1h\')\r\nORDER BY 1\r\n\r\nOr build your own conditionals using these macros which just return the values:\r\n- $__timeFrom() -&gt;  \'2017-04-21T05:01:17Z\'\r\n- $__timeTo() -&gt;  \'2017-04-21T05:01:17Z\'\r\n- $__unixEpochFrom() -&gt; 1492750877\r\n- $__unixEpochTo() -&gt; 1492750877\r\n\t\t</pre>\r\n\t</div>\r\n\r\n\t\r\n\r\n\t<div class=gf-form ng-show=ctrl.lastQueryError>\r\n\t\t<pre class="gf-form-pre alert alert-error">{{ctrl.lastQueryError}}</pre>\r\n\t</div>\r\n\r\n</query-editor-row>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/mysql/partials/annotations.editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'\r\n<div class=gf-form-group>\r\n  <div class=gf-form-inline>\r\n\t\t<div class="gf-form gf-form--grow">\r\n\t\t\t<textarea rows=10 class=gf-form-input ng-model=ctrl.annotation.rawQuery spellcheck=false placeholder="query expression" data-min-length=0 data-items=100 ng-model-onblur ng-change=ctrl.panelCtrl.refresh()></textarea>\r\n\t\t</div>\r\n\t</div>\r\n\r\n  <div class=gf-form-inline>\r\n    <div class=gf-form>\r\n      <label class="gf-form-label query-keyword" ng-click="ctrl.showHelp = !ctrl.showHelp">\r\n        Show Help\r\n        <i class="fa fa-caret-down" ng-show=ctrl.showHelp></i>\r\n        <i class="fa fa-caret-right" ng-hide=ctrl.showHelp></i>\r\n      </label>\r\n\t\t</div>\r\n  </div>\r\n\r\n  <div class=gf-form ng-show=ctrl.showHelp>\r\n\t\t<pre class="gf-form-pre alert alert-info"><h6>Annotation Query Format</h6>\r\nAn annotation is an event that is overlaid on top of graphs. The query can have up to three columns per row, the <i>time</i> or <i>time_sec</i> column is mandatory. Annotation rendering is expensive so it is important to limit the number of rows returned.\r\n\r\n- column with alias: <b>time</b> or <i>time_sec</i> for the annotation event time. Use epoch time or any native date data type.\r\n- column with alias: <b>text</b> for the annotation text\r\n- column with alias: <b>tags</b> for annotation tags. This is a comma separated string of tags e.g. \'tag1,tag2\'\r\n\r\n\r\nMacros:\r\n- $__time(column) -&gt; UNIX_TIMESTAMP(column) as time (or as time_sec)\r\n- $__timeEpoch(column) -&gt; UNIX_TIMESTAMP(column) as time (or as time_sec)\r\n- $__timeFilter(column) -&gt; column BETWEEN FROM_UNIXTIME(1492750877) AND FROM_UNIXTIME(1492750877)\r\n- $__unixEpochFilter(column) -&gt;  time_unix_epoch &gt; 1492750877 AND time_unix_epoch &lt; 1492750877\r\n\r\nOr build your own conditionals using these macros which just return the values:\r\n- $__timeFrom() -&gt; FROM_UNIXTIME(1492750877)\r\n- $__timeTo() -&gt;  FROM_UNIXTIME(1492750877)\r\n- $__unixEpochFrom() -&gt;  1492750877\r\n- $__unixEpochTo() -&gt;  1492750877\r\n\t\t</pre>\r\n\t</div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/mysql/partials/config.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'\r\n<h3 class=page-heading>MySQL Connection</h3>\r\n\r\n<div class=gf-form-group>\r\n\t<div class="gf-form max-width-30">\r\n\t\t<span class="gf-form-label width-7">Host</span>\r\n\t\t<input type=text class=gf-form-input ng-model=ctrl.current.url placeholder=localhost:3306 bs-typeahead="{{[\'localhost:3306\', \'localhost:3307\']}}" required>\r\n\t</div>\r\n\r\n\t<div class="gf-form max-width-30">\r\n\t\t<span class="gf-form-label width-7">Database</span>\r\n\t\t<input type=text class=gf-form-input ng-model=ctrl.current.database placeholder="database name" required>\r\n\t</div>\r\n\r\n\t<div class=gf-form-inline>\r\n\t\t<div class="gf-form max-width-15">\r\n\t\t\t<span class="gf-form-label width-7">User</span>\r\n\t\t\t<input type=text class=gf-form-input ng-model=ctrl.current.user placeholder=user>\r\n\t\t</div>\r\n\t\t<div class="gf-form max-width-15">\r\n\t\t\t<span class="gf-form-label width-7">Password</span>\r\n\t\t\t<input type=password class=gf-form-input ng-model=ctrl.current.password placeholder=password>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n\r\n<b>Connection limits</b>\r\n\r\n<div class=gf-form-group>\r\n\t<div class="gf-form max-width-15">\r\n\t\t<span class="gf-form-label width-7">Max open</span>\r\n\t\t<input type=number min=0 class=gf-form-input ng-model=ctrl.current.jsonData.maxOpenConns placeholder=unlimited>\r\n\t\t<info-popover mode=right-absolute>\r\n\t\t\tThe maximum number of open connections to the database. If <i>Max idle connections</i> is greater than 0 and the\r\n\t\t\t<i>Max open connections</i> is less than <i>Max idle connections</i>, then <i>Max idle connections</i> will be\r\n\t\t\treduced to match the <i>Max open connections</i> limit. If set to 0, there is no limit on the number of open\r\n\t\t\tconnections.\r\n\t\t</info-popover>\r\n\t</div>\r\n\t<div class="gf-form max-width-15">\r\n\t\t<span class="gf-form-label width-7">Max idle</span>\r\n\t\t<input type=number min=0 class=gf-form-input ng-model=ctrl.current.jsonData.maxIdleConns placeholder=2>\r\n\t\t<info-popover mode=right-absolute>\r\n\t\t\tThe maximum number of connections in the idle connection pool. If <i>Max open connections</i> is greater than 0 but\r\n\t\t\tless than the <i>Max idle connections</i>, then the <i>Max idle connections</i> will be reduced to match the\r\n\t\t\t<i>Max open connections</i> limit. If set to 0, no idle connections are retained.\r\n\t\t</info-popover>\r\n\t</div>\r\n\t<div class="gf-form max-width-15">\r\n\t\t<span class="gf-form-label width-7">Max lifetime</span>\r\n\t\t<input type=number min=0 class=gf-form-input ng-model=ctrl.current.jsonData.connMaxLifetime placeholder=14400>\r\n\t\t<info-popover mode=right-absolute>\r\n\t\t\tThe maximum amount of time in seconds a connection may be reused. If set to 0, connections are reused forever.<br/><br/>\r\n\t\t\tThis should always be lower than configured <a href=https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html#sysvar_wait_timeout target=_blank>wait_timeout</a> in MySQL.\r\n\t\t</info-popover>\r\n\t</div>\r\n</div>\r\n\r\n<h3 class=page-heading>MySQL details</h3>\r\n\r\n<div class=gf-form-group>\r\n\t<div class=gf-form-inline>\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class="gf-form-label width-9">Min time interval</span>\r\n\t\t\t<input type=text class="gf-form-input width-6" ng-model=ctrl.current.jsonData.timeInterval spellcheck=false placeholder=1m>\r\n\t\t\t<info-popover mode=right-absolute>\r\n\t\t\t\tA lower limit for the auto group by time interval. Recommended to be set to write frequency,\r\n\t\t\t\tfor example <code>1m</code> if your data is written every minute.\r\n\t\t\t</info-popover>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n\r\n<div class=gf-form-group>\r\n\t<div class=grafana-info-box>\r\n\t\t<h5>User Permission</h5>\r\n\t\t<p>\r\n\t\t\tThe database user should only be granted SELECT permissions on the specified database &amp; tables you want to query.\r\n\t\t\tGrafana does not validate that queries are safe so queries can contain any SQL statement. For example, statements\r\n\t\t\tlike <code>USE otherdb;</code> and <code>DROP TABLE user;</code> would be executed. To protect against this we\r\n\t\t\t<strong>Highly</strong> recommmend you create a specific MySQL user with restricted permissions.\r\n\r\n\t\t\tCheckout the <a class=external-link target=_blank href=http://docs.grafana.org/features/datasources/mysql/ >MySQL Data Source Docs</a> for more information.\r\n\t\t</p>\r\n\t</div>\r\n</div>\r\n\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/mysql/partials/query.editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<query-editor-row query-ctrl=ctrl has-text-edit-mode=true>\r\n\r\n  <div ng-if=ctrl.target.rawQuery>\r\n    <div class=gf-form-inline>\r\n      <div class="gf-form gf-form--grow">\r\n        <code-editor content=ctrl.target.rawSql datasource=ctrl.datasource on-change=ctrl.panelCtrl.refresh() data-mode=sql>\r\n        </code-editor>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <div ng-if=!ctrl.target.rawQuery>\r\n    <div class=gf-form-inline>\r\n      <div class=gf-form>\r\n        <label class="gf-form-label query-keyword width-6">FROM</label>\r\n        <metric-segment segment=ctrl.tableSegment get-options=ctrl.getTableSegments() on-change=ctrl.tableChanged()></metric-segment>\r\n\r\n        <label class="gf-form-label query-keyword width-7">Time column</label>\r\n        <metric-segment segment=ctrl.timeColumnSegment get-options=ctrl.getTimeColumnSegments() on-change=ctrl.timeColumnChanged()></metric-segment>\r\n\r\n        <label class="gf-form-label query-keyword width-9">\r\n          Metric column\r\n          <info-popover mode=right-normal>Column to be used as metric name for the value column.</info-popover>\r\n        </label>\r\n        <metric-segment segment=ctrl.metricColumnSegment get-options=ctrl.getMetricColumnSegments() on-change=ctrl.metricColumnChanged()></metric-segment>\r\n      </div>\r\n\r\n      <div class="gf-form gf-form--grow">\r\n        <div class="gf-form-label gf-form-label--grow"></div>\r\n      </div>\r\n\r\n    </div>\r\n\r\n    <div class=gf-form-inline ng-repeat="selectParts in ctrl.selectParts">\r\n      <div class=gf-form>\r\n        <label class="gf-form-label query-keyword width-6">\r\n          <span ng-show="$index === 0">SELECT</span>&nbsp;\r\n        </label>\r\n      </div>\r\n\r\n      <div class=gf-form ng-repeat="part in selectParts">\r\n        <sql-part-editor class="gf-form-label sql-part" part=part handle-event="ctrl.handleSelectPartEvent(selectParts, part, $event)">\r\n        </sql-part-editor>\r\n      </div>\r\n\r\n      <div class=gf-form>\r\n        <label class=dropdown dropdown-typeahead=ctrl.selectMenu dropdown-typeahead-on-select="ctrl.addSelectPart(selectParts, $item, $subItem)">\r\n        </label>\r\n      </div>\r\n\r\n      <div class="gf-form gf-form--grow">\r\n        <div class="gf-form-label gf-form-label--grow"></div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=gf-form-inline>\r\n      <div class=gf-form>\r\n        <label class="gf-form-label query-keyword width-6">WHERE</label>\r\n      </div>\r\n\r\n      <div class=gf-form ng-repeat="part in ctrl.whereParts">\r\n        <sql-part-editor class="gf-form-label sql-part" part=part handle-event="ctrl.handleWherePartEvent(ctrl.whereParts, part, $event, $index)">\r\n        </sql-part-editor>\r\n      </div>\r\n\r\n      <div class=gf-form>\r\n        <metric-segment segment=ctrl.whereAdd get-options=ctrl.getWhereOptions() on-change="ctrl.addWhereAction(part, $index)"></metric-segment>\r\n      </div>\r\n\r\n      <div class="gf-form gf-form--grow">\r\n        <div class="gf-form-label gf-form-label--grow"></div>\r\n      </div>\r\n\r\n    </div>\r\n\r\n    <div class=gf-form-inline>\r\n      <div class=gf-form>\r\n        <label class="gf-form-label query-keyword width-6">\r\n          <span>GROUP BY</span>\r\n        </label>\r\n\r\n        <sql-part-editor ng-repeat="part in ctrl.groupParts" part=part class="gf-form-label sql-part" handle-event="ctrl.handleGroupPartEvent(part, $index, $event)">\r\n        </sql-part-editor>\r\n      </div>\r\n\r\n      <div class=gf-form>\r\n        <metric-segment segment=ctrl.groupAdd get-options=ctrl.getGroupOptions() on-change="ctrl.addGroupAction(part, $index)"></metric-segment>\r\n      </div>\r\n\r\n      <div class="gf-form gf-form--grow">\r\n        <div class="gf-form-label gf-form-label--grow"></div>\r\n      </div>\r\n    </div>\r\n\r\n  </div>\r\n\r\n  <div class=gf-form-inline>\r\n    <div class=gf-form>\r\n      <label class="gf-form-label query-keyword">Format as</label>\r\n      <div class=gf-form-select-wrapper>\r\n        <select class="gf-form-input gf-size-auto" ng-model=ctrl.target.format ng-options="f.value as f.text for f in ctrl.formats" ng-change=ctrl.refresh()></select>\r\n      </div>\r\n    </div>\r\n    <div class=gf-form>\r\n      <label class="gf-form-label query-keyword pointer" ng-click=ctrl.toggleEditorMode() ng-show="ctrl.panelCtrl.panel.type !== \'table\'">\r\n        <span ng-show=ctrl.target.rawQuery>Query Builder</span>\r\n        <span ng-hide=ctrl.target.rawQuery>Edit SQL</span>\r\n      </label>\r\n    </div>\r\n    <div class=gf-form>\r\n      <label class="gf-form-label query-keyword pointer" ng-click="ctrl.showHelp = !ctrl.showHelp">\r\n        Show Help\r\n        <i class="fa fa-caret-down" ng-show=ctrl.showHelp></i>\r\n        <i class="fa fa-caret-right" ng-hide=ctrl.showHelp></i>\r\n      </label>\r\n    </div>\r\n    <div class=gf-form ng-show=ctrl.lastQueryMeta>\r\n      <label class="gf-form-label query-keyword pointer" ng-click="ctrl.showLastQuerySQL = !ctrl.showLastQuerySQL">\r\n        Generated SQL\r\n        <i class="fa fa-caret-down" ng-show=ctrl.showLastQuerySQL></i>\r\n        <i class="fa fa-caret-right" ng-hide=ctrl.showLastQuerySQL></i>\r\n      </label>\r\n    </div>\r\n    <div class="gf-form gf-form--grow">\r\n      <div class="gf-form-label gf-form-label--grow"></div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=gf-form ng-show=ctrl.showLastQuerySQL>\r\n    <pre class=gf-form-pre>{{ctrl.lastQueryMeta.sql}}</pre>\r\n  </div>\r\n\r\n  <div class=gf-form ng-show=ctrl.showHelp>\r\n    <pre class="gf-form-pre alert alert-info">Time series:\r\n- return column named time or time_sec (in UTC), as a unix time stamp or any sql native date data type. You can use the macros below.\r\n- return column(s) with numeric datatype as values\r\nOptional:\r\n  - return column named <i>metric</i> to represent the series name.\r\n  - If multiple value columns are returned the metric column is used as prefix.\r\n  - If no column named metric is found the column name of the value column is used as series name\r\n\r\nResultsets of time series queries need to be sorted by time.\r\n\r\nTable:\r\n- return any set of columns\r\n\r\nMacros:\r\n- $__time(column) -&gt; UNIX_TIMESTAMP(column) as time_sec\r\n- $__timeEpoch(column) -&gt; UNIX_TIMESTAMP(column) as time_sec\r\n- $__timeFilter(column) -&gt; column BETWEEN FROM_UNIXTIME(1492750877) AND FROM_UNIXTIME(1492750877)\r\n- $__unixEpochFilter(column) -&gt;  time_unix_epoch &gt; 1492750877 AND time_unix_epoch &lt; 1492750877\r\n- $__timeGroup(column,\'5m\'[, fillvalue]) -&gt; cast(cast(UNIX_TIMESTAMP(column)/(300) as signed)*300 as signed)\r\n     by setting fillvalue grafana will fill in missing values according to the interval\r\n     fillvalue can be either a literal value, NULL or previous; previous will fill in the previous seen value or NULL if none has been seen yet\r\n- $__timeGroupAlias(column,\'5m\') -&gt; cast(cast(UNIX_TIMESTAMP(column)/(300) as signed)*300 as signed) AS "time"\r\n- $__unixEpochGroup(column,\'5m\') -&gt; column DIV 300 * 300\r\n- $__unixEpochGroupAlias(column,\'5m\') -&gt; column DIV 300 * 300 AS "time"\r\n\r\nExample of group by and order by with $__timeGroup:\r\nSELECT\r\n  $__timeGroupAlias(timestamp_col, \'1h\'),\r\n  sum(value_double) as value\r\nFROM yourtable\r\nGROUP BY 1\r\nORDER BY 1\r\n\r\nOr build your own conditionals using these macros which just return the values:\r\n- $__timeFrom() -&gt; FROM_UNIXTIME(1492750877)\r\n- $__timeTo() -&gt;  FROM_UNIXTIME(1492750877)\r\n- $__unixEpochFrom() -&gt;  1492750877\r\n- $__unixEpochTo() -&gt;  1492750877\r\n    </pre>\r\n  </div>\r\n\r\n  \r\n\r\n  <div class=gf-form ng-show=ctrl.lastQueryError>\r\n    <pre class="gf-form-pre alert alert-error">{{ctrl.lastQueryError}}</pre>\r\n  </div>\r\n\r\n</query-editor-row>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/opentsdb/partials/annotations.editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=gf-form-group>\r\n  <div class=gf-form>\r\n    <span class="gf-form-label width-13">OpenTSDB metrics query</span>\r\n    <input type=text class=gf-form-input ng-model=ctrl.annotation.target placeholder=events.eventname>\r\n  </div>\r\n  <gf-form-switch class=gf-form label="Show Global Annotations?" checked=ctrl.annotation.isGlobal switch-class=max-width-6 label-class=width-13></gf-form-switch>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/opentsdb/partials/config.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<datasource-http-settings current=ctrl.current suggest-url=http://localhost:4242></datasource-http-settings>\r\n\r\n<h5>OpenTSDB settings</h5>\r\n<div class=gf-form>\r\n  <span class="gf-form-label width-7">\r\n    Version\r\n  </span>\r\n  <span class=gf-form-select-wrapper>\r\n    <select class="gf-form-input gf-size-auto" ng-model=ctrl.current.jsonData.tsdbVersion ng-options="v.value as v.name for v in ctrl.tsdbVersions"></select>\r\n  </span>\r\n</div>\r\n<div class=gf-form>\r\n  <span class="gf-form-label width-7">\r\n    Resolution\r\n  </span>\r\n  <span class=gf-form-select-wrapper>\r\n    <select class="gf-form-input gf-size-auto" ng-model=ctrl.current.jsonData.tsdbResolution ng-options="v.value as v.name for v in ctrl.tsdbResolutions"></select>\r\n  </span>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/opentsdb/partials/query.editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<query-editor-row query-ctrl=ctrl can-collapse=false>\r\n\t<div class=gf-form-inline>\r\n\t\t<div class="gf-form max-width-25">\r\n\t\t\t<label class="gf-form-label query-keyword width-8">\r\n\t\t\t\tMetric\r\n\t\t\t\t<label class=gf-form-label bs-tooltip=ctrl.errors.metric style=color:#e5bd1c ng-show=ctrl.errors.metric>\r\n\t\t\t\t\t<i class="fa fa-warning"></i>\r\n\t\t\t\t</label>\r\n\t\t\t</label>\r\n\t\t\t<input type=text class=gf-form-input ng-model=ctrl.target.metric spellcheck=false bs-typeahead=ctrl.suggestMetrics placeholder="metric name" data-min-length=0 data-items=100 ng-blur=ctrl.targetBlur()>\r\n\t\t\t\r\n\t\t</div>\r\n\t\t<div class=gf-form>\r\n\t\t\t<label class="gf-form-label query-keyword">\r\n\t\t\t\tAggregator\r\n\t\t\t\t<a bs-tooltip=ctrl.errors.aggregator style=color:#e5bd1c ng-show=ctrl.errors.aggregator>\r\n\t\t\t\t\t<i class="fa fa-warning"></i>\r\n\t\t\t\t</a>\r\n\t\t\t</label>\r\n\t\t\t<div class="gf-form-select-wrapper max-width-15">\r\n\t\t\t\t<select ng-model=ctrl.target.aggregator class=gf-form-input ng-options="agg for agg in ctrl.aggregators" ng-change=ctrl.targetBlur()>\r\n\t\t \t </select>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t\t<div class="gf-form max-width-20">\r\n\t\t\t\t<label class="gf-form-label query-keyword width-6">\r\n\t\t\t\t\tAlias:\r\n\t\t\t\t\t<info-popover mode=right-normal>\r\n\t\t\t\t\t\tUse patterns like $tag_tagname to replace part of the alias for a tag value\r\n\t\t\t\t\t</info-popover>\r\n\t\t\t\t</label>\r\n\t\t\t\t<input type=text class=gf-form-input ng-model=ctrl.target.alias spellcheck=false placeholder="series alias" data-min-length=0 data-items=100 ng-blur=ctrl.targetBlur()>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class="gf-form gf-form--grow">\r\n\t\t\t\t<div class="gf-form-label gf-form-label--grow"></div>\r\n\t\t\t</div>\r\n\t</div>\r\n\r\n\t<div class=gf-form-inline>\r\n\t\t<div class="gf-form max-width-25">\r\n\t\t\t<label class="gf-form-label query-keyword width-8">Down sample</label>\r\n\t\t\t<input type=text class=gf-form-input ng-model=ctrl.target.downsampleInterval ng-model-onblur ng-change=ctrl.targetBlur() placeholder=interval>\r\n\t\t\t<info-popover mode=right-absolute>\r\n\t\t\t\tblank for auto, or for example <code>1m</code>\r\n\t\t\t</info-popover>\r\n\t\t</div>\r\n\r\n\t\t<div class=gf-form>\r\n\t\t\t<label class="gf-form-label query-keyword">Aggregator</label>\r\n\t\t\t<div class=gf-form-select-wrapper>\r\n\t\t\t\t<select ng-model=ctrl.target.downsampleAggregator class=gf-form-input ng-options="agg for agg in ctrl.aggregators" ng-change=ctrl.targetBlur()>\r\n\t\t\t\t</select>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class=gf-form ng-if="ctrl.tsdbVersion >= 2">\r\n\t\t\t<label class="gf-form-label query-keyword width-6">Fill</label>\r\n\t\t\t<div class=gf-form-select-wrapper>\r\n\t\t\t\t<select ng-model=ctrl.target.downsampleFillPolicy class=gf-form-input ng-options="agg for agg in ctrl.fillPolicies" ng-change=ctrl.targetBlur()>\r\n\t\t\t\t</select>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<gf-form-switch class=gf-form label="Disable downsampling" label-class=query-keyword checked=ctrl.target.disableDownsampling on-change=ctrl.targetBlur()>\r\n\t\t</gf-form-switch>\r\n\r\n\t\t<div class="gf-form gf-form--grow">\r\n\t\t\t<div class="gf-form-label gf-form-label--grow"></div>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class=gf-form-inline ng-if="ctrl.tsdbVersion >= 2">\r\n\t\t<div class=gf-form>\r\n\r\n\t\t\t<label class="gf-form-label query-keyword width-8">\r\n\t\t\t\tFilters\r\n\t\t\t\t<info-popover mode=right-normal>\r\n\t\t\t\t\tFilters does not work with tags, either of the two will work but not both.\r\n\t\t\t\t</info-popover>\r\n\t\t\t</label>\r\n\r\n\t\t\t<div ng-repeat="fil in ctrl.target.filters track by $index" class=gf-form-label>\r\n\t\t\t\t{{fil.tagk}}&nbsp;=&nbsp;{{fil.type}}&#40;{{fil.filter}}&#41;&nbsp;&#44&nbsp;groupBy&nbsp;=&nbsp;{{fil.groupBy}}\r\n\t\t\t\t<a ng-click="ctrl.editFilter(fil, $index)">\r\n\t\t\t\t\t<i class="fa fa-pencil"></i>\r\n\t\t\t\t</a>\r\n\t\t\t\t<a ng-click=ctrl.removeFilter($index)>\r\n\t\t\t\t\t<i class="fa fa-remove"></i>\r\n\t\t\t\t</a>\r\n\t\t\t</div>\r\n\t\t\t<label class="gf-form-label query-keyword" ng-hide=ctrl.addFilterMode>\r\n\t\t\t\t<a ng-click=ctrl.addFilter()>\r\n\t\t\t\t\t<i class="fa fa-plus"></i>\r\n\t\t\t\t</a>\r\n\t\t\t</label>\r\n \t\t</div>\r\n\r\n\t\t<div class=gf-form-inline ng-show=ctrl.addFilterMode>\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<input type=text class=gf-form-input spellcheck=false bs-typeahead=ctrl.suggestTagKeys data-min-length=0 data-items=100 ng-model=ctrl.target.currentFilterKey placeholder=key>\r\n\t\t\t\t\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<label class="gf-form-label query-keyword">Type</label>\r\n\t\t\t\t<div class=gf-form-select-wrapper>\r\n\t\t\t\t\t<select ng-model=ctrl.target.currentFilterType class=gf-form-input ng-options="filType for filType in ctrl.filterTypes">\r\n\t\t\t\t\t</select>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<input type=text class=gf-form-input spellcheck=false bs-typeahead=ctrl.suggestTagValues data-min-length=0 data-items=100 ng-model=ctrl.target.currentFilterValue placeholder=filter>\r\n\t\t\t\t\r\n\t\t\t</div>\r\n\r\n      <gf-form-switch class=gf-form label="Group by" label-class=query-keyword checked=ctrl.target.currentFilterGroupBy on-change=ctrl.targetBlur()>\r\n\t\t\t</gf-form-switch>\r\n\r\n\t\t\t<div class=gf-form ng-show=ctrl.addFilterMode>\r\n\t\t\t\t<label class=gf-form-label ng-show=ctrl.errors.filters>\r\n\t\t\t\t\t<a bs-tooltip=ctrl.errors.filters style=color:#e5bd1c>\r\n\t\t\t\t\t\t<i class="fa fa-warning"></i>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t</label>\r\n\t\t\t\t<label class=gf-form-label>\r\n\t\t\t\t\t<a ng-click=ctrl.addFilter() ng-hide=ctrl.errors.filters>add filter</a>\r\n\t\t\t\t\t<a ng-click=ctrl.closeAddFilterMode()>\r\n\t\t\t\t\t\t<i class="fa fa-remove"></i>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t</label>\r\n\t\t\t</div>\r\n\r\n\t\t</div>\r\n\r\n\t\t<div class="gf-form gf-form--grow">\r\n\t\t\t<div class="gf-form-label gf-form-label--grow"></div>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class=gf-form-inline>\r\n\t\t<div class=gf-form>\r\n\t\t\t<label class="gf-form-label query-keyword width-8">\r\n\t\t\t\tTags\r\n\t\t\t\t<info-popover mode=right-normal ng-if="ctrl.tsdbVersion >= 2">\r\n\t\t\t\t\tPlease use filters, tags are deprecated in opentsdb 2.2\r\n\t\t\t\t</info-popover>\r\n\t\t\t</label>\r\n\t\t</div>\r\n\r\n\t\t<div class=gf-form ng-repeat="(key, value) in ctrl.target.tags track by $index" class=gf-form>\r\n\t\t\t<label class=gf-form-label>\r\n\t\t\t\t{{key}}&nbsp;=&nbsp;{{value}}\r\n\t\t\t\t<a ng-click="ctrl.editTag(key, value)">\r\n\t\t\t\t\t<i class="fa fa-pencil"></i>\r\n\t\t\t\t</a>\r\n\t\t\t\t<a ng-click=ctrl.removeTag(key)>\r\n\t\t\t\t\t<i class="fa fa-remove"></i>\r\n\t\t\t\t</a>\r\n\t\t\t</label>\r\n\t\t</div>\r\n\r\n\t\t<div class=gf-form ng-hide=ctrl.addTagMode>\r\n\t\t\t<label class="gf-form-label query-keyword">\r\n\t\t\t\t<a ng-click=ctrl.addTag()><i class="fa fa-plus"></i></a>\r\n\t\t\t</label>\r\n\t\t</div>\r\n\r\n\t\t<div class=gf-form ng-show=ctrl.addTagMode>\r\n\t\t\t<input type=text class=gf-form-input spellcheck=false bs-typeahead=ctrl.suggestTagKeys data-min-length=0 data-items=100 ng-model=ctrl.target.currentTagKey placeholder=key>\r\n\t\t\t\r\n\r\n\t\t\t<input type=text class=gf-form-input spellcheck=false bs-typeahead=ctrl.suggestTagValues data-min-length=0 data-items=100 ng-model=ctrl.target.currentTagValue placeholder=value>\r\n\t\t\t\r\n\r\n\t\t\t<label class=gf-form-label ng-show=ctrl.errors.tags>\r\n\t\t\t\t<a bs-tooltip=ctrl.errors.tags style=color:#e5bd1c>\r\n\t\t\t\t\t<i class="fa fa-warning"></i>\r\n\t\t\t\t</a>\r\n\t\t\t</label>\r\n\t\t\t<label class=gf-form-label>\r\n\t\t\t\t<a ng-click=ctrl.addTag() ng-hide=ctrl.errors.tags>add tag</a>\r\n\t\t\t\t<a ng-click=ctrl.closeAddTagMode()><i class="fa fa-remove"></i></a>\r\n\t\t\t</label>\r\n\t\t</div>\r\n\r\n\t\t<div class="gf-form gf-form--grow">\r\n\t\t\t<div class="gf-form-label gf-form-label--grow"></div>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class=gf-form-inline>\r\n\t\t<gf-form-switch class=gf-form label=Rate label-class="width-8 query-keyword" checked=ctrl.target.shouldComputeRate on-change=ctrl.targetBlur()>\r\n\t\t</gf-form-switch>\r\n\r\n\t\t<gf-form-switch ng-hide=!ctrl.target.shouldComputeRate class=gf-form label=Counter label-class=query-keyword checked=ctrl.target.isCounter on-change=ctrl.targetBlur()>\r\n\t\t</gf-form-switch>\r\n\r\n\r\n\t\t<div class=gf-form ng-hide="!ctrl.target.isCounter || !ctrl.target.shouldComputeRate">\r\n\t\t\t<label class="gf-form-label query-keyword">Counter Max</label>\r\n\t\t\t<input type=text class=gf-form-input ng-disabled=!ctrl.target.shouldComputeRate ng-model=ctrl.target.counterMax spellcheck=false placeholder="max value" ng-model-onblur ng-blur=ctrl.targetBlur()>\r\n\t\t\t\r\n\r\n\t\t\t<label class="gf-form-label query-keyword">Reset Value</label>\r\n\t\t\t<input type=text class="tight-form-input input-small" ng-disabled=!ctrl.target.shouldComputeRate ng-model=ctrl.target.counterResetValue spellcheck=false placeholder="reset value" ng-model-onblur ng-blur=ctrl.targetBlur()>\r\n\t\t\t\r\n\t\t</div>\r\n\r\n\t\t<div class=gf-form ng-if="ctrl.tsdbVersion > 2">\r\n\t\t\t<gf-form-switch class=gf-form label="Explicit tags" label-class="width-8 query-keyword" checked=ctrl.target.explicitTags on-change=ctrl.targetBlur()>\r\n\t\t\t</gf-form-switch>\r\n\t\t</div>\r\n\r\n\t\t<div class="gf-form gf-form--grow">\r\n\t\t\t<div class="gf-form-label gf-form-label--grow"></div>\r\n\t\t</div>\r\n\t</div>\r\n</query-editor-row>\r\n\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/postgres/partials/annotations.editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'\r\n<div class=gf-form-group>\r\n  <div class=gf-form-inline>\r\n\t\t<div class="gf-form gf-form--grow">\r\n\t\t\t<textarea rows=10 class=gf-form-input ng-model=ctrl.annotation.rawQuery spellcheck=false placeholder="query expression" data-min-length=0 data-items=100 ng-model-onblur ng-change=ctrl.panelCtrl.refresh()></textarea>\r\n\t\t</div>\r\n\t</div>\r\n\r\n  <div class=gf-form-inline>\r\n    <div class=gf-form>\r\n      <label class="gf-form-label query-keyword" ng-click="ctrl.showHelp = !ctrl.showHelp">\r\n        Show Help\r\n        <i class="fa fa-caret-down" ng-show=ctrl.showHelp></i>\r\n        <i class="fa fa-caret-right" ng-hide=ctrl.showHelp></i>\r\n      </label>\r\n\t\t</div>\r\n  </div>\r\n\r\n  <div class=gf-form ng-show=ctrl.showHelp>\r\n\t\t<pre class="gf-form-pre alert alert-info"><h6>Annotation Query Format</h6>\r\nAn annotation is an event that is overlaid on top of graphs. The query can have up to three columns per row, the time column is mandatory. Annotation rendering is expensive so it is important to limit the number of rows returned.\r\n\r\n- column with alias: <b>time</b> for the annotation event time. Use epoch time or any native date data type.\r\n- column with alias: <b>text</b> for the annotation text\r\n- column with alias: <b>tags</b> for annotation tags. This is a comma separated string of tags e.g. \'tag1,tag2\'\r\n\r\n\r\nMacros:\r\n- $__time(column) -&gt; column as "time"\r\n- $__timeEpoch -&gt; extract(epoch from column) as "time"\r\n- $__timeFilter(column) -&gt; column BETWEEN \'2017-04-21T05:01:17Z\' AND \'2017-04-21T05:01:17Z\'\r\n- $__unixEpochFilter(column) -&gt;  column &gt;= 1492750877 AND column &lt;= 1492750877\r\n\r\nOr build your own conditionals using these macros which just return the values:\r\n- $__timeFrom() -&gt;  \'2017-04-21T05:01:17Z\'\r\n- $__timeTo() -&gt;  \'2017-04-21T05:01:17Z\'\r\n- $__unixEpochFrom() -&gt;  1492750877\r\n- $__unixEpochTo() -&gt;  1492750877\r\n\t\t</pre>\r\n\t</div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/postgres/partials/config.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'\r\n<h3 class=page-heading>PostgreSQL Connection</h3>\r\n\r\n<div class=gf-form-group>\r\n\t<div class="gf-form max-width-30">\r\n\t\t<span class="gf-form-label width-7">Host</span>\r\n\t\t<input type=text class=gf-form-input ng-model=ctrl.current.url placeholder=localhost:5432 bs-typeahead="{{[\'localhost:5432\', \'localhost:5433\']}}" required>\r\n\t</div>\r\n\r\n\t<div class="gf-form max-width-30">\r\n\t\t<span class="gf-form-label width-7">Database</span>\r\n\t\t<input type=text class=gf-form-input ng-model=ctrl.current.database placeholder="database name" required>\r\n\t</div>\r\n\r\n\t<div class=gf-form-inline>\r\n\t\t<div class="gf-form max-width-15">\r\n\t\t\t<span class="gf-form-label width-7">User</span>\r\n\t\t\t<input type=text class=gf-form-input ng-model=ctrl.current.user placeholder=user>\r\n\t\t</div>\r\n\t\t<div class="gf-form max-width-15" ng-if=!ctrl.current.secureJsonFields.password>\r\n\t\t\t<span class="gf-form-label width-7">Password</span>\r\n\t\t\t<input type=password class=gf-form-input ng-model=ctrl.current.secureJsonData.password placeholder=password>\r\n    </div>\r\n    <div class="gf-form max-width-19" ng-if=ctrl.current.secureJsonFields.password>\r\n      <span class="gf-form-label width-7">Password</span>\r\n      <input type=text class=gf-form-input disabled=disabled value=configured>\r\n      <a class="btn btn-secondary gf-form-btn" href=# ng-click="ctrl.current.secureJsonFields.password = false">reset</a>\r\n    </div>\r\n\t</div>\r\n\t<div class=gf-form>\r\n\t\t<label class="gf-form-label width-7">SSL Mode</label>\r\n\t\t<div class="gf-form-select-wrapper max-width-15 gf-form-select-wrapper--has-help-icon">\r\n\t\t\t<select class=gf-form-input ng-model=ctrl.current.jsonData.sslmode ng-options="mode for mode in [\'disable\', \'require\', \'verify-ca\', \'verify-full\']" ng-init=ctrl.current.jsonData.sslmode></select>\r\n\t\t\t<info-popover mode=right-absolute>\r\n\t\t\t\tThis option determines whether or with what priority a secure SSL TCP/IP connection will be negotiated with the server.\r\n\t\t\t</info-popover>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n\r\n<b>Connection limits</b>\r\n\r\n<div class=gf-form-group>\r\n\t<div class="gf-form max-width-15">\r\n\t\t<span class="gf-form-label width-7">Max open</span>\r\n\t\t<input type=number min=0 class=gf-form-input ng-model=ctrl.current.jsonData.maxOpenConns placeholder=unlimited>\r\n\t\t<info-popover mode=right-absolute>\r\n\t\t\tThe maximum number of open connections to the database. If <i>Max idle connections</i> is greater than 0 and the\r\n\t\t\t<i>Max open connections</i> is less than <i>Max idle connections</i>, then <i>Max idle connections</i> will be\r\n\t\t\treduced to match the <i>Max open connections</i> limit. If set to 0, there is no limit on the number of open\r\n\t\t\tconnections.\r\n\t\t</info-popover>\r\n\t</div>\r\n\t<div class="gf-form max-width-15">\r\n\t\t<span class="gf-form-label width-7">Max idle</span>\r\n\t\t<input type=number min=0 class=gf-form-input ng-model=ctrl.current.jsonData.maxIdleConns placeholder=2>\r\n\t\t<info-popover mode=right-absolute>\r\n\t\t\tThe maximum number of connections in the idle connection pool. If <i>Max open connections</i> is greater than 0 but\r\n\t\t\tless than the <i>Max idle connections</i>, then the <i>Max idle connections</i> will be reduced to match the\r\n\t\t\t<i>Max open connections</i> limit. If set to 0, no idle connections are retained.\r\n\t\t</info-popover>\r\n\t</div>\r\n\t<div class="gf-form max-width-15">\r\n\t\t<span class="gf-form-label width-7">Max lifetime</span>\r\n\t\t<input type=number min=0 class=gf-form-input ng-model=ctrl.current.jsonData.connMaxLifetime placeholder=14400>\r\n\t\t<info-popover mode=right-absolute>\r\n\t\t\tThe maximum amount of time in seconds a connection may be reused. If set to 0, connections are reused forever.\r\n\t\t</info-popover>\r\n\t</div>\r\n</div>\r\n\r\n<h3 class=page-heading>PostgreSQL details</h3>\r\n\r\n<div class=gf-form-group>\r\n\t<div class=gf-form>\r\n\t\t<span class="gf-form-label width-9">\r\n\t\t\tVersion\r\n\t\t\t<info-popover mode=right-normal position="top center">\r\n\t\t\t\tThis option controls what functions are available in the PostgreSQL query builder.\r\n\t\t\t</info-popover>\r\n\t\t</span>\r\n\t\t<span class=gf-form-select-wrapper>\r\n\t\t\t<select class="gf-form-input gf-size-auto" ng-model=ctrl.current.jsonData.postgresVersion ng-options="f.value as f.name for f in ctrl.postgresVersions"></select>\r\n\t\t</span>\r\n\t</div>\r\n\t<div class=gf-form>\r\n\t\t<gf-form-switch class=gf-form label=TimescaleDB label-class=width-9 checked=ctrl.current.jsonData.timescaledb switch-class=max-width-6></gf-form-switch>\r\n    <label class="gf-form-label query-keyword pointer" ng-click=ctrl.toggleTimescaleDBHelp()>\r\n      Help&nbsp;\r\n      <i class="fa fa-caret-down" ng-show=ctrl.showTimescaleDBHelp></i>\r\n      <i class="fa fa-caret-right" ng-hide=ctrl.showTimescaleDBHelp>&nbsp;</i>\r\n    </label>\r\n\t</div>\r\n\r\n\t<div class=gf-form-inline>\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class="gf-form-label width-9">Min time interval</span>\r\n\t\t\t<input type=text class="gf-form-input width-6" ng-model=ctrl.current.jsonData.timeInterval spellcheck=false placeholder=1m>\r\n\t\t\t<info-popover mode=right-absolute>\r\n\t\t\t\tA lower limit for the auto group by time interval. Recommended to be set to write frequency,\r\n\t\t\t\tfor example <code>1m</code> if your data is written every minute.\r\n\t\t\t</info-popover>\r\n\t\t</div>\r\n\t</div>\r\n<div class="grafana-info-box alert alert-info" ng-show=ctrl.showTimescaleDBHelp>\r\n  <div class=alert-body>\r\n    <p>\r\n\t\t\t<a href=https://github.com/timescale/timescaledb class=pointer target=_blank>TimescaleDB</a> is a time-series database built as a PostgreSQL extension. If enabled, Grafana will use <code>time_bucket</code> in the <code>$__timeGroup</code> macro and display TimescaleDB specific aggregate functions in the query builder.\r\n    </p>\r\n  </div>\r\n</div>\r\n\r\n</div>\r\n\r\n\r\n<div class=gf-form-group>\r\n\t<div class=grafana-info-box>\r\n\t\t<h5>User Permission</h5>\r\n\t\t<p>\r\n\t\t\tThe database user should only be granted SELECT permissions on the specified database &amp; tables you want to query.\r\n\t\t\tGrafana does not validate that queries are safe so queries can contain any SQL statement. For example, statements\r\n\t\t\tlike <code>DELETE FROM user;</code> and <code>DROP TABLE user;</code> would be executed. To protect against this we\r\n\t\t\t<strong>Highly</strong> recommmend you create a specific PostgreSQL user with restricted permissions.\r\n\t\t</p>\r\n\t</div>\r\n</div>\r\n\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/postgres/partials/query.editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<query-editor-row query-ctrl=ctrl has-text-edit-mode=true>\r\n\r\n  <div ng-if=ctrl.target.rawQuery>\r\n    <div class=gf-form-inline>\r\n      <div class="gf-form gf-form--grow">\r\n        <code-editor content=ctrl.target.rawSql datasource=ctrl.datasource on-change=ctrl.panelCtrl.refresh() data-mode=sql>\r\n        </code-editor>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <div ng-if=!ctrl.target.rawQuery>\r\n    <div class=gf-form-inline>\r\n      <div class=gf-form>\r\n        <label class="gf-form-label query-keyword width-6">FROM</label>\r\n        <metric-segment segment=ctrl.tableSegment get-options=ctrl.getTableSegments() on-change=ctrl.tableChanged()></metric-segment>\r\n\r\n        <label class="gf-form-label query-keyword width-7">Time column</label>\r\n        <metric-segment segment=ctrl.timeColumnSegment get-options=ctrl.getTimeColumnSegments() on-change=ctrl.timeColumnChanged()></metric-segment>\r\n\r\n        <label class="gf-form-label query-keyword width-9">\r\n          Metric column\r\n          <info-popover mode=right-normal>Column to be used as metric name for the value column.</info-popover>\r\n        </label>\r\n        <metric-segment segment=ctrl.metricColumnSegment get-options=ctrl.getMetricColumnSegments() on-change=ctrl.metricColumnChanged()></metric-segment>\r\n      </div>\r\n\r\n      <div class="gf-form gf-form--grow">\r\n        <div class="gf-form-label gf-form-label--grow"></div>\r\n      </div>\r\n\r\n    </div>\r\n\r\n    <div class=gf-form-inline ng-repeat="selectParts in ctrl.selectParts">\r\n      <div class=gf-form>\r\n        <label class="gf-form-label query-keyword width-6">\r\n          <span ng-show="$index === 0">SELECT</span>&nbsp;\r\n        </label>\r\n      </div>\r\n\r\n      <div class=gf-form ng-repeat="part in selectParts">\r\n        <sql-part-editor class="gf-form-label sql-part" part=part handle-event="ctrl.handleSelectPartEvent(selectParts, part, $event)">\r\n        </sql-part-editor>\r\n      </div>\r\n\r\n      <div class=gf-form>\r\n        <label class=dropdown dropdown-typeahead=ctrl.selectMenu dropdown-typeahead-on-select="ctrl.addSelectPart(selectParts, $item, $subItem)">\r\n        </label>\r\n      </div>\r\n\r\n      <div class="gf-form gf-form--grow">\r\n        <div class="gf-form-label gf-form-label--grow"></div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=gf-form-inline>\r\n      <div class=gf-form>\r\n        <label class="gf-form-label query-keyword width-6">WHERE</label>\r\n      </div>\r\n\r\n      <div class=gf-form ng-repeat="part in ctrl.whereParts">\r\n        <sql-part-editor class="gf-form-label sql-part" part=part handle-event="ctrl.handleWherePartEvent(ctrl.whereParts, part, $event, $index)">\r\n        </sql-part-editor>\r\n      </div>\r\n\r\n      <div class=gf-form>\r\n        <metric-segment segment=ctrl.whereAdd get-options=ctrl.getWhereOptions() on-change="ctrl.addWhereAction(part, $index)"></metric-segment>\r\n      </div>\r\n\r\n      <div class="gf-form gf-form--grow">\r\n        <div class="gf-form-label gf-form-label--grow"></div>\r\n      </div>\r\n\r\n    </div>\r\n\r\n    <div class=gf-form-inline>\r\n      <div class=gf-form>\r\n        <label class="gf-form-label query-keyword width-6">\r\n          <span>GROUP BY</span>\r\n        </label>\r\n\r\n        <sql-part-editor ng-repeat="part in ctrl.groupParts" part=part class="gf-form-label sql-part" handle-event="ctrl.handleGroupPartEvent(part, $index, $event)">\r\n        </sql-part-editor>\r\n      </div>\r\n\r\n      <div class=gf-form>\r\n        <metric-segment segment=ctrl.groupAdd get-options=ctrl.getGroupOptions() on-change="ctrl.addGroupAction(part, $index)"></metric-segment>\r\n      </div>\r\n\r\n      <div class="gf-form gf-form--grow">\r\n        <div class="gf-form-label gf-form-label--grow"></div>\r\n      </div>\r\n    </div>\r\n\r\n  </div>\r\n\r\n  <div class=gf-form-inline>\r\n    <div class=gf-form>\r\n      <label class="gf-form-label query-keyword">Format as</label>\r\n      <div class=gf-form-select-wrapper>\r\n        <select class="gf-form-input gf-size-auto" ng-model=ctrl.target.format ng-options="f.value as f.text for f in ctrl.formats" ng-change=ctrl.refresh()></select>\r\n      </div>\r\n    </div>\r\n    <div class=gf-form>\r\n      <label class="gf-form-label query-keyword pointer" ng-click=ctrl.toggleEditorMode() ng-show="ctrl.panelCtrl.panel.type !== \'table\'">\r\n        <span ng-show=ctrl.target.rawQuery>Query Builder</span>\r\n        <span ng-hide=ctrl.target.rawQuery>Edit SQL</span>\r\n      </label>\r\n    </div>\r\n    <div class=gf-form>\r\n      <label class="gf-form-label query-keyword pointer" ng-click="ctrl.showHelp = !ctrl.showHelp">\r\n        Show Help\r\n        <i class="fa fa-caret-down" ng-show=ctrl.showHelp></i>\r\n        <i class="fa fa-caret-right" ng-hide=ctrl.showHelp></i>\r\n      </label>\r\n    </div>\r\n    <div class=gf-form ng-show=ctrl.lastQueryMeta>\r\n      <label class="gf-form-label query-keyword pointer" ng-click="ctrl.showLastQuerySQL = !ctrl.showLastQuerySQL">\r\n        Generated SQL\r\n        <i class="fa fa-caret-down" ng-show=ctrl.showLastQuerySQL></i>\r\n        <i class="fa fa-caret-right" ng-hide=ctrl.showLastQuerySQL></i>\r\n      </label>\r\n    </div>\r\n    <div class="gf-form gf-form--grow">\r\n      <div class="gf-form-label gf-form-label--grow"></div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=gf-form ng-show=ctrl.showLastQuerySQL>\r\n    <pre class=gf-form-pre>{{ctrl.lastQueryMeta.sql}}</pre>\r\n  </div>\r\n\r\n  <div class=gf-form ng-show=ctrl.showHelp>\r\n    <pre class="gf-form-pre alert alert-info">Time series:\r\n- return column named <i>time</i> (UTC in seconds or timestamp)\r\n- return column(s) with numeric datatype as values\r\nOptional: \r\n  - return column named <i>metric</i> to represent the series name. \r\n  - If multiple value columns are returned the metric column is used as prefix. \r\n  - If no column named metric is found the column name of the value column is used as series name\r\n\r\nResultsets of time series queries need to be sorted by time.\r\n\r\nTable:\r\n- return any set of columns\r\n\r\nMacros:\r\n- $__time(column) -&gt; column as "time"\r\n- $__timeEpoch -&gt; extract(epoch from column) as "time"\r\n- $__timeFilter(column) -&gt; column BETWEEN \'2017-04-21T05:01:17Z\' AND \'2017-04-21T05:01:17Z\'\r\n- $__unixEpochFilter(column) -&gt;  column &gt;= 1492750877 AND column &lt;= 1492750877\r\n- $__timeGroup(column,\'5m\'[, fillvalue]) -&gt; (extract(epoch from column)/300)::bigint*300\r\n     by setting fillvalue grafana will fill in missing values according to the interval\r\n     fillvalue can be either a literal value, NULL or previous; previous will fill in the previous seen value or NULL if none has been seen yet\r\n- $__timeGroupAlias(column,\'5m\') -&gt; (extract(epoch from column)/300)::bigint*300 AS "time"\r\n- $__unixEpochGroup(column,\'5m\') -&gt; floor(column/300)*300\r\n- $__unixEpochGroupAlias(column,\'5m\') -&gt; floor(column/300)*300 AS "time"\r\n\r\nExample of group by and order by with $__timeGroup:\r\nSELECT\r\n  $__timeGroup(date_time_col, \'1h\'),\r\n  sum(value) as value\r\nFROM yourtable\r\nGROUP BY time\r\nORDER BY time\r\n\r\nOr build your own conditionals using these macros which just return the values:\r\n- $__timeFrom() -&gt;  \'2017-04-21T05:01:17Z\'\r\n- $__timeTo() -&gt;  \'2017-04-21T05:01:17Z\'\r\n- $__unixEpochFrom() -&gt;  1492750877\r\n- $__unixEpochTo() -&gt;  1492750877\r\n    </pre>\r\n  </div>\r\n\r\n  \r\n\r\n  <div class=gf-form ng-show=ctrl.lastQueryError>\r\n    <pre class="gf-form-pre alert alert-error">{{ctrl.lastQueryError}}</pre>\r\n  </div>\r\n\r\n</query-editor-row>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/prometheus/partials/annotations.editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=gf-form-group>\r\n\t<div class=gf-form>\r\n\t\t<span class="gf-form-label width-10">Search expression</span>\r\n\t\t<input type=text class=gf-form-input ng-model=ctrl.annotation.expr placeholder=ALERTS>\r\n\t</div>\r\n\t<div class=gf-form>\r\n\t\t<span class="gf-form-label width-10">step</span>\r\n\t\t<input type=text class="gf-form-input max-width-6" ng-model=ctrl.annotation.step placeholder=60s>\r\n\t</div>\r\n</div>\r\n\r\n<div class=gf-form-group>\r\n\t<h5 class=section-heading>Field formats</h5>\r\n\t<div class=gf-form-inline>\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class="gf-form-label width-5">Title</span>\r\n\t\t\t<input type=text class="gf-form-input max-width-9" ng-model=ctrl.annotation.titleFormat placeholder=alertname>\r\n\t\t</div>\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class="gf-form-label width-5">Tags</span>\r\n\t\t\t<input type=text class="gf-form-input max-width-9" ng-model=ctrl.annotation.tagKeys placeholder=label1,label2>\r\n\t\t</div>\r\n\t\t<div class=gf-form-inline>\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<span class="gf-form-label width-5">Text</span>\r\n\t\t\t\t<input type=text class="gf-form-input max-width-9" ng-model=ctrl.annotation.textFormat placeholder=instance>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<h5 class=section-heading>Other options</h5>\r\n\t<div class=gf-form-inline>\r\n\t\t<div class=gf-form>\r\n\t\t\t<gf-form-switch class=gf-form label="Series value as timestamp" label-class=width-14 checked=ctrl.annotation.useValueForTime tooltip="The unit of timestamp is milliseconds. If the unit of the series value is seconds, multiply its range vector by 1000.">\r\n\t\t\t</gf-form-switch>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/prometheus/partials/config.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<datasource-http-settings current=ctrl.current suggest-url=http://localhost:9090>\r\n</datasource-http-settings>\r\n\r\n<div class=gf-form-group>\r\n  <div class=gf-form-inline>\r\n    <div class=gf-form>\r\n      <span class="gf-form-label width-8">Scrape interval</span>\r\n      <input type=text class="gf-form-input width-8" ng-model=ctrl.current.jsonData.timeInterval spellcheck=false placeholder=15s>\r\n      <info-popover mode=right-absolute>\r\n        Set this to your global scrape interval defined in your Prometheus config file. This will be used as a lower limit for the\r\n        Prometheus step query parameter.\r\n      </info-popover>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=gf-form-inline>\r\n    <div class=gf-form>\r\n      <span class="gf-form-label width-8">Query timeout</span>\r\n      <input type=text class="gf-form-input width-8" ng-model=ctrl.current.jsonData.queryTimeout spellcheck=false placeholder=60s>\r\n      <info-popover mode=right-absolute>\r\n        Set the Prometheus query timeout.\r\n      </info-popover>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=gf-form>\r\n    <label class="gf-form-label width-8">HTTP Method</label>\r\n    <div class="gf-form-select-wrapper width-8 gf-form-select-wrapper--has-help-icon">\r\n      <select class=gf-form-input ng-model=ctrl.current.jsonData.httpMethod ng-options="method for method in [\'GET\', \'POST\']"></select>\r\n      <info-popover mode=right-absolute>\r\n        Specify the HTTP Method to query Prometheus. (POST is only available in Prometheus >= v2.1.0)\r\n      </info-popover>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/prometheus/partials/query.editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<query-editor-row query-ctrl=ctrl can-collapse=true has-text-edit-mode=false>\r\n  <div class=gf-form-inline>\r\n    <div class="gf-form gf-form--grow">\r\n      <code-editor content=ctrl.target.expr datasource=ctrl.datasource on-change=ctrl.refreshMetricData() get-completer=ctrl.getCompleter() data-mode=prometheus code-editor-focus=ctrl.isLastQuery>\r\n      </code-editor>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=gf-form-inline>\r\n    <div class="gf-form max-width-26">\r\n      <label class="gf-form-label width-8">Legend format</label>\r\n      <input type=text class=gf-form-input ng-model=ctrl.target.legendFormat spellcheck=false placeholder="legend format" data-min-length=0 data-items=1000 ng-model-onblur ng-change=ctrl.refreshMetricData()>\r\n      \r\n      <info-popover mode=right-absolute>\r\n        Controls the name of the time series, using name or pattern. For example\r\n        <span ng-non-bindable>{{hostname}}</span> will be replaced with label value for the label hostname.\r\n      </info-popover>\r\n    </div>\r\n\r\n    <div class=gf-form>\r\n      <label class="gf-form-label width-6">Min step</label>\r\n      <input type=text class="gf-form-input width-8" ng-model=ctrl.target.interval data-placement=right spellcheck=false placeholder={{ctrl.panelCtrl.interval}} data-min-length=0 data-items=100 ng-model-onblur ng-change=ctrl.refreshMetricData() />\r\n      <info-popover mode=right-absolute>\r\n        Leave blank for auto handling based on time range and panel width. Note that the actual dates used in the query will be adjusted\r\n        to a multiple of the interval step.\r\n      </info-popover>\r\n    </div>\r\n\r\n    <div class=gf-form>\r\n      <label class=gf-form-label>Resolution</label>\r\n      <div class="gf-form-select-wrapper max-width-15">\r\n        <select ng-model=ctrl.target.intervalFactor class=gf-form-input ng-options="r.factor as r.label for r in ctrl.resolutions" ng-change=ctrl.refreshMetricData()>\r\n        </select>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=gf-form>\r\n      <label class="gf-form-label width-6">Format as</label>\r\n      <div class="gf-form-select-wrapper width-8">\r\n        <select class="gf-form-input gf-size-auto" ng-model=ctrl.target.format ng-options="f.value as f.text for f in ctrl.formats" ng-change=ctrl.refresh()></select>\r\n      </div>\r\n      <gf-form-switch class=gf-form label=Instant label-class=width-5 checked=ctrl.target.instant on-change=ctrl.refresh()>\r\n      </gf-form-switch>\r\n      <label class=gf-form-label>\r\n        <a href={{ctrl.linkToPrometheus}} target=_blank bs-tooltip="\'Link to Graph in Prometheus\'">\r\n          <i class="fa fa-share-square-o"></i>\r\n        </a>\r\n      </label>\r\n    </div>\r\n\r\n    <div class="gf-form gf-form--grow">\r\n      <div class="gf-form-label gf-form-label--grow"></div>\r\n    </div>\r\n  </div>\r\n</query-editor-row>')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/stackdriver/partials/annotations.editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<stackdriver-filter target=ctrl.annotation.target refresh=ctrl.refresh() datasource=ctrl.datasource default-dropdown-value=ctrl.defaultDropdownValue default-service-value=ctrl.defaultServiceValue hide-group-bys=true></stackdriver-filter>\r\n\r\n<div class="gf-form gf-form-inline">\r\n  <div class=gf-form>\r\n    <span class="gf-form-label query-keyword width-9">Title</span>\r\n    <input type=text class="gf-form-input width-20" ng-model=ctrl.annotation.target.title />\r\n  </div>\r\n  <div class=gf-form>\r\n    <span class="gf-form-label query-keyword width-9">Text</span>\r\n    <input type=text class="gf-form-input width-20" ng-model=ctrl.annotation.target.text />\r\n  </div>\r\n  <div class="gf-form gf-form--grow">\r\n    <div class="gf-form-label gf-form-label--grow"></div>\r\n  </div>\r\n</div>\r\n\r\n<div class="gf-form grafana-info-box" style=padding:0>\r\n  <pre class="gf-form-pre alert alert-info" style=margin-right:0><h5>Annotation Query Format</h5>\r\nAn annotation is an event that is overlaid on top of graphs. Annotation rendering is expensive so it is important to limit the number of rows returned.\r\n\r\nThe Title and Text fields support templating and can use data returned from the query. For example, the Title field could have the following text:\r\n\r\n<code ng-non-bindable>{{metric.type}} has value: {{metric.value}}</code>\r\n\r\nExample Result: <code ng-non-bindable>monitoring.googleapis.com/uptime_check/http_status has this value: 502</code>\r\n\r\n<label>Patterns:</label>\r\n<code ng-non-bindable>{{metric.value}}</code> = value of the metric/point\r\n<code ng-non-bindable>{{metric.type}}</code> = metric type e.g. compute.googleapis.com/instance/cpu/usage_time\r\n<code ng-non-bindable>{{metric.name}}</code> = name part of metric e.g. instance/cpu/usage_time\r\n<code ng-non-bindable>{{metric.service}}</code> = service part of metric e.g. compute\r\n\r\n<code ng-non-bindable>{{metric.label.label_name}}</code> = Metric label metadata e.g. metric.label.instance_name\r\n<code ng-non-bindable>{{resource.label.label_name}}</code> = Resource label metadata e.g. resource.label.zone\r\n</pre>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/stackdriver/partials/config.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=gf-form-group>\r\n  <div class=grafana-info-box>\r\n    <h4>Stackdriver Authentication</h4>\r\n    <p>There are two ways to authenticate the Stackdriver plugin - either by uploading a Service Account key file, or by\r\n      automatically retrieving credentials from the Google metadata server. The latter option is only available\r\n      when running Grafana on a GCE virtual machine.</p>\r\n\r\n    <h5>Uploading a Service Account Key File</h5>\r\n    <p>\r\n      First you need to create a Google Cloud Platform (GCP) Service Account for\r\n      the Project you want to show data for. A Grafana datasource integrates with one GCP Project. If you want to\r\n      visualize data from multiple GCP Projects then you need to create one datasource per GCP Project.\r\n    </p>\r\n    <p>\r\n      The <strong>Monitoring Viewer</strong> role provides all the permissions that Grafana needs. The following API\r\n      needs to be enabled on GCP for the datasource to work: <a class=external-link target=_blank href=https://console.cloud.google.com/apis/library/monitoring.googleapis.com>Monitoring\r\n        API</a>\r\n    </p>\r\n\r\n    <h5>GCE Default Service Account</h5>\r\n    <p>\r\n      If Grafana is running on a Google Compute Engine (GCE) virtual machine, it is possible for Grafana to\r\n      automatically retrieve the default project id and authentication token from the metadata server. In order for this to\r\n      work, you need to make sure that you have a service account that is setup as the default account for the virtual\r\n      machine and that the service account has been given read access to the Stackdriver Monitoring API.\r\n    </p>\r\n\r\n    <p>Detailed instructions on how to create a Service Account can be found <a class=external-link target=_blank href=http://docs.grafana.org/datasources/stackdriver/ >in\r\n        the documentation.</a>\r\n    </p>\r\n  </div>\r\n</div>\r\n\r\n<div class=gf-form-group>\r\n  <div class=gf-form>\r\n    <h3>Authentication</h3>\r\n    <info-popover mode=header>Upload your Service Account key file or paste in the contents of the file. The file\r\n      contents will be encrypted and saved in the Grafana database.</info-popover>\r\n  </div>\r\n\r\n  <div class=gf-form-inline>\r\n    <div class="gf-form max-width-30">\r\n      <span class="gf-form-label width-10">Authentication Type</span>\r\n      <div class="gf-form-select-wrapper max-width-24">\r\n        <select class=gf-form-input ng-model=ctrl.current.jsonData.authenticationType ng-options="f.key as f.value for f in ctrl.authenticationTypes"></select>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <div ng-if="ctrl.current.jsonData.authenticationType === ctrl.defaultAuthenticationType && !ctrl.current.jsonData.clientEmail && !ctrl.inputDataValid">\r\n    <div class=gf-form-group ng-if=!ctrl.inputDataValid>\r\n      <div class=gf-form>\r\n        <form>\r\n          <dash-upload on-upload=ctrl.onUpload(dash) btn-text="Upload Service Account key file"></dash-upload>\r\n        </form>\r\n      </div>\r\n    </div>\r\n    <div class=gf-form-group>\r\n      <h5 class=section-heading ng-if=!ctrl.inputDataValid>Or paste Service Account key JSON</h5>\r\n      <div class=gf-form ng-if=!ctrl.inputDataValid>\r\n        <textarea rows=10 data-share-panel-url="" class=gf-form-input ng-model=ctrl.jsonText ng-paste=ctrl.onPasteJwt($event)></textarea>\r\n      </div>\r\n      <div ng-repeat="valError in ctrl.validationErrors" class="text-error p-l-1">\r\n        <i class="fa fa-warning"></i>\r\n        {{valError}}\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<div class=gf-form-group ng-if="ctrl.current.jsonData.authenticationType === ctrl.defaultAuthenticationType && (ctrl.inputDataValid || ctrl.current.jsonData.clientEmail)">\r\n  <h6>Uploaded Key Details</h6>\r\n\r\n  <div class=gf-form>\r\n    <span class="gf-form-label width-10">Project</span>\r\n    <input class="gf-form-input width-40" disabled=disabled type=text ng-model=ctrl.current.jsonData.defaultProject />\r\n  </div>\r\n  <div class=gf-form>\r\n    <span class="gf-form-label width-10">Client Email</span>\r\n    <input class="gf-form-input width-40" disabled=disabled type=text ng-model=ctrl.current.jsonData.clientEmail />\r\n  </div>\r\n  <div class=gf-form>\r\n    <span class="gf-form-label width-10">Token URI</span>\r\n    <input class="gf-form-input width-40" disabled=disabled type=text ng-model=ctrl.current.jsonData.tokenUri />\r\n  </div>\r\n  <div class=gf-form ng-if=ctrl.current.secureJsonFields.privateKey>\r\n    <span class="gf-form-label width-10">Private Key</span>\r\n    <input type=text class="gf-form-input max-width-12" disabled=disabled value=configured>\r\n  </div>\r\n\r\n  <div class="gf-form width-18">\r\n    <a class="btn btn-secondary gf-form-btn" href=# ng-click=ctrl.resetValidationMessages()>Reset Service\r\n      Account Key </a>\r\n    <info-popover mode=right-normal>\r\n      Reset to clear the uploaded key and upload a new file.\r\n    </info-popover>\r\n  </div>\r\n</div>\r\n\r\n<p class=gf-form-label ng-hide="ctrl.current.secureJsonFields.privateKey || ctrl.current.jsonData.authenticationType !== ctrl.defaultAuthenticationType"><i class="fa fa-save"></i> Do not forget to save your changes after uploading a file.</p>\r\n\r\n<p class=gf-form-label ng-show="ctrl.current.jsonData.authenticationType !== ctrl.defaultAuthenticationType"><i class="fa fa-save"></i>\r\n  Verify GCE default service account by clicking Save & Test</p>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/stackdriver/partials/query.aggregation.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=gf-form-inline>\r\n  <div class=gf-form>\r\n    <label class="gf-form-label query-keyword width-9">Aggregation</label>\r\n    <div class="gf-form-select-wrapper gf-form-select-wrapper--caret-indent">\r\n      <gf-form-dropdown model=ctrl.target.aggregation.crossSeriesReducer get-options=ctrl.aggOptions class="gf-form width-12" disabled=disabled type=text allow-custom=true lookup-text=true css-class=min-width-12 on-change=refresh()></gf-form-dropdown>\r\n    </div>\r\n  </div>\r\n  <div class="gf-form gf-form--grow">\r\n    <label class="gf-form-label gf-form-label--grow">\r\n      <a ng-click="ctrl.target.showAggregationOptions = !ctrl.target.showAggregationOptions">\r\n        <i class="fa fa-caret-down" ng-show=ctrl.target.showAggregationOptions></i>\r\n        <i class="fa fa-caret-right" ng-hide=ctrl.target.showAggregationOptions></i>\r\n        Advanced Options\r\n      </a>\r\n    </label>\r\n  </div>\r\n</div>\r\n<div class=gf-form-group ng-if=ctrl.target.showAggregationOptions>\r\n  <div class="gf-form offset-width-9">\r\n    <label class="gf-form-label query-keyword width-12">Aligner</label>\r\n    <div class="gf-form-select-wrapper gf-form-select-wrapper--caret-indent">\r\n      <gf-form-dropdown model=ctrl.target.aggregation.perSeriesAligner get-options=ctrl.alignOptions class="gf-form width-12" disabled=disabled type=text allow-custom=true lookup-text=true css-class=min-width-12 on-change=refresh()></gf-form-dropdown>\r\n    </div>\r\n\r\n    <div class="gf-form gf-form--grow">\r\n      <div class="gf-form-label gf-form-label--grow"></div>\r\n    </div>\r\n  </div>\r\n</div>\r\n<div class=gf-form-inline>\r\n  <div class=gf-form>\r\n    <label class="gf-form-label query-keyword width-9">Alignment Period</label>\r\n    <div class="gf-form-select-wrapper gf-form-select-wrapper--caret-indent">\r\n      <gf-form-dropdown model=ctrl.target.aggregation.alignmentPeriod get-options=ctrl.alignmentPeriods class="gf-form width-12" disabled=disabled type=text allow-custom=true lookup-text=true css-class=min-width-12 on-change=refresh()></gf-form-dropdown>\r\n    </div>\r\n  </div>\r\n\r\n  <div class="gf-form gf-form--grow">\r\n    <label ng-if=alignmentPeriod class="gf-form-label gf-form-label--grow">\r\n      {{ctrl.formatAlignmentText()}}\r\n    </label>\r\n  </div>\r\n</div>')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/stackdriver/partials/query.editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<query-editor-row query-ctrl=ctrl has-text-edit-mode=false>\r\n  <stackdriver-filter target=ctrl.target refresh=ctrl.refresh() datasource=ctrl.datasource default-dropdown-value=ctrl.defaultDropdownValue default-service-value=ctrl.defaultServiceValue></stackdriver-filter>\r\n  <stackdriver-aggregation target=ctrl.target alignment-period=ctrl.lastQueryMeta.alignmentPeriod refresh=ctrl.refresh()></stackdriver-aggregation>\r\n  <div class=gf-form-inline>\r\n    <div class=gf-form>\r\n      <span class="gf-form-label query-keyword width-9">Alias By</span>\r\n      <input type=text class="gf-form-input width-30" ng-model=ctrl.target.aliasBy ng-change=ctrl.refresh() ng-model-options="{ debounce: 500 }"/>\r\n    </div>\r\n    <div class="gf-form gf-form--grow">\r\n      <div class="gf-form-label gf-form-label--grow"></div>\r\n    </div>\r\n  </div>\r\n  <div class=gf-form-inline>\r\n    <div class=gf-form>\r\n      <span class="gf-form-label width-9 query-keyword">Project</span>\r\n      <input class=gf-form-input disabled=disabled type=text ng-model=ctrl.target.defaultProject css-class=min-width-12 />\r\n    </div>\r\n    <div class=gf-form>\r\n      <label class="gf-form-label query-keyword" ng-click="ctrl.showHelp = !ctrl.showHelp">\r\n        Show Help\r\n        <i class="fa fa-caret-down" ng-show=ctrl.showHelp></i>\r\n        <i class="fa fa-caret-right" ng-hide=ctrl.showHelp></i>\r\n      </label>\r\n    </div>\r\n    <div class=gf-form ng-show=ctrl.lastQueryMeta>\r\n      <label class="gf-form-label query-keyword" ng-click="ctrl.showLastQuery = !ctrl.showLastQuery">\r\n        Raw Query\r\n        <i class="fa fa-caret-down" ng-show=ctrl.showLastQuery></i>\r\n        <i class="fa fa-caret-right" ng-hide=ctrl.showLastQuery></i>\r\n      </label>\r\n    </div>\r\n    <div class="gf-form gf-form--grow">\r\n      <div class="gf-form-label gf-form-label--grow"></div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=gf-form ng-show=ctrl.showLastQuery>\r\n    <pre class=gf-form-pre>{{ctrl.lastQueryMeta.rawQueryString}}</pre>\r\n  </div>\r\n  <div class="gf-form grafana-info-box" style=padding:0 ng-show=ctrl.showHelp>\r\n    <pre class="gf-form-pre alert alert-info" style=margin-right:0><h5>Alias Patterns</h5>Format the legend keys any way you want by using alias patterns.\r\n\r\n    Format the legend keys any way you want by using alias patterns.<br/> <br/>\r\n\r\n    Example: <code ng-non-bindable>{{metric.name}} - {{metric.label.instance_name}}</code><br/>\r\n    Result: &nbsp;&nbsp;<code ng-non-bindable>cpu/usage_time - server1-europe-west-1</code><br/><br/>\r\n\r\n    <strong>Patterns</strong><br/>\r\n    <ul>\r\n      <li>\r\n        <code ng-non-bindable>{{metric.type}}</code> = metric type e.g. compute.googleapis.com/instance/cpu/usage_time\r\n      </li>\r\n      <li>\r\n        <code ng-non-bindable>{{metric.name}}</code> = name part of metric e.g. instance/cpu/usage_time\r\n      </li>\r\n      <li>\r\n        <code ng-non-bindable>{{metric.service}}</code> = service part of metric e.g. compute\r\n      </li>\r\n      <li>\r\n        <code ng-non-bindable>{{metric.label.label_name}}</code> = Metric label metadata e.g.\r\n        metric.label.instance_name\r\n      </li>\r\n      <li>\r\n        <code ng-non-bindable>{{resource.label.label_name}}</code> = Resource label metadata e.g. resource.label.zone\r\n      </li>\r\n    </ul>\r\n  </pre></div>\r\n  <div class=gf-form ng-show=ctrl.lastQueryError>\r\n    <pre class="gf-form-pre alert alert-error">{{ctrl.lastQueryError}}</pre>\r\n  </div>\r\n</query-editor-row>')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/stackdriver/partials/query.filter.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=gf-form-inline>\r\n  <div class=gf-form>\r\n    <span class="gf-form-label width-9 query-keyword">Service</span>\r\n    <select class="gf-form-input width-12" ng-model=ctrl.service ng-options="f.value as f.text for f in ctrl.services" ng-change=ctrl.onServiceChange(ctrl.service)></select>\r\n  </div>\r\n  <div class=gf-form>\r\n    <span class="gf-form-label width-9 query-keyword">Metric</span>\r\n    <gf-form-dropdown model=ctrl.metricType get-options=ctrl.metrics class=min-width-20 disabled=disabled type=text allow-custom=true lookup-text=true css-class=min-width-12 on-change=ctrl.onMetricTypeChange()></gf-form-dropdown>\r\n  </div>\r\n  <div class="gf-form gf-form--grow"><div class="gf-form-label gf-form-label--grow"></div></div>\r\n</div>\r\n<div class=gf-form-inline>\r\n  <div class=gf-form>\r\n    <span class="gf-form-label query-keyword width-9">Filter</span>\r\n    <div class=gf-form ng-repeat="segment in ctrl.filterSegments.filterSegments">\r\n      <metric-segment segment=segment get-options="ctrl.getFilters(segment, $index)" on-change="ctrl.filterSegmentUpdated(segment, $index)"></metric-segment>\r\n    </div>\r\n  </div>\r\n  <div class="gf-form gf-form--grow"><div class="gf-form-label gf-form-label--grow"></div></div>\r\n</div>\r\n<div class=gf-form-inline ng-hide=ctrl.$scope.hideGroupBys>\r\n  <div class=gf-form>\r\n    <span class="gf-form-label query-keyword width-9">Group By</span>\r\n    <div class=gf-form ng-repeat="segment in ctrl.groupBySegments">\r\n      <metric-segment segment=segment get-options=ctrl.getGroupBys(segment) on-change="ctrl.groupByChanged(segment, $index)"></metric-segment>\r\n    </div>\r\n  </div>\r\n  <div class="gf-form gf-form--grow"><div class="gf-form-label gf-form-label--grow"></div></div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/datasource/testdata/partials/query.editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<query-editor-row query-ctrl=ctrl has-text-edit-mode=false>\r\n\t<div class=gf-form-inline>\r\n\t\t<div class=gf-form>\r\n\t\t\t<label class="gf-form-label query-keyword width-7">Scenario</label>\r\n\t\t\t<div class="gf-form-select-wrapper width-15">\r\n\t\t\t\t<select class=gf-form-input ng-model=ctrl.target.scenarioId ng-options="v.id as v.name for v in ctrl.scenarioList" ng-change=ctrl.scenarioChanged()></select>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class="gf-form gf-form gf-form--grow" ng-if=ctrl.scenario.stringInput>\r\n\t\t\t<label class="gf-form-label query-keyword">String Input</label>\r\n      <input type=text class=gf-form-input placeholder={{ctrl.scenario.stringInput}} ng-model=ctrl.target.stringInput ng-change=ctrl.refresh() ng-model-onblur>\r\n\t\t</div>\r\n\t\t<div class=gf-form>\r\n\t\t\t<label class="gf-form-label query-keyword">Alias</label>\r\n\t\t\t<input type=text class="gf-form-input max-width-7" placeholder=optional ng-model=ctrl.target.alias ng-change=ctrl.refresh() ng-model-onblur>\r\n\t\t</div>\r\n\t\t<div class="gf-form gf-form--grow">\r\n\t\t\t<div class="gf-form-label gf-form-label--grow"></div>\r\n\t\t</div>\r\n\t</div>\r\n\t<div class=gf-form-inline ng-if="ctrl.scenario.id === \'manual_entry\'">\r\n\t\t<div class="gf-form gf-form">\r\n\t\t\t<label class="gf-form-label query-keyword width-7">New value</label>\r\n      <input type=number class="gf-form-input width-15" placeholder=value ng-model=ctrl.newPointValue>\r\n\t\t\t<label class="gf-form-label query-keyword">Time</label>\r\n      <input type=string class="gf-form-input width-12" placeholder=time ng-model=ctrl.newPointTime input-datetime>\r\n\t\t\t<button class="btn btn-secondary gf-form-btn" ng-click=ctrl.addPoint()>Add</button>\r\n\t\t\t<label class="gf-form-label query-keyword">All values</label>\r\n\t\t\t<gf-form-dropdown css-class=width-12 model=ctrl.selectedPoint get-options=ctrl.getPoints() on-change=ctrl.pointSelected($option)>\r\n\t\t\t</gf-form-dropdown>\r\n\t\t</div>\r\n\t\t<div class="gf-form gf-form" ng-if="ctrl.selectedPoint.value !== null">\r\n\t\t\t<button class="btn btn-danger gf-form-btn" ng-click=ctrl.deletePoint()>Delete</button>\r\n\t\t</div>\r\n\t\t<div class="gf-form gf-form--grow">\r\n\t\t\t<div class="gf-form-label gf-form-label--grow"></div>\r\n\t\t</div>\r\n\t</div>\r\n</query-editor-row>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/panel/alertlist/editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div>\r\n  <div class="section gf-form-group">\r\n    <h5 class=section-heading>Options</h5>\r\n    <div class=gf-form>\r\n      <span class="gf-form-label width-8">Show</span>\r\n      <div class="gf-form-select-wrapper max-width-15">\r\n        <select class=gf-form-input ng-model=ctrl.panel.show ng-options="f.value as f.text for f in ctrl.showOptions" ng-change=ctrl.onRefresh()></select>\r\n      </div>\r\n    </div>\r\n    <div class=gf-form>\r\n      <span class="gf-form-label width-8">Max items</span>\r\n      <input type=text class="gf-form-input max-width-15" ng-model=ctrl.panel.limit ng-change=ctrl.onRefresh() />\r\n    </div>\r\n    <div class=gf-form ng-show="ctrl.panel.show === \'current\'">\r\n      <span class="gf-form-label width-8">Sort order</span>\r\n      <div class="gf-form-select-wrapper max-width-15">\r\n        <select class=gf-form-input ng-model=ctrl.panel.sortOrder ng-options="f.value as f.text for f in ctrl.sortOrderOptions" ng-change=ctrl.onRefresh()></select>\r\n      </div>\r\n    </div>\r\n    <gf-form-switch class=gf-form label="Alerts from this dashboard" label-class=width-18 checked=ctrl.panel.onlyAlertsOnDashboard on-change=ctrl.updateStateFilter()></gf-form-switch>\r\n  </div>\r\n  <div class="section gf-form-group" ng-show="ctrl.panel.show === \'current\'">\r\n    <h5 class=section-heading>Filter</h5>\r\n    <div class=gf-form>\r\n      <span class="gf-form-label width-8">Alert name</span>\r\n      <input type=text class="gf-form-input max-width-15" ng-model=ctrl.panel.nameFilter placeholder="Alert name query" ng-change=ctrl.onRefresh() />\r\n    </div>\r\n    <div class=gf-form>\r\n      <span class="gf-form-label width-8">Dashboard title</span>\r\n      <input type=text class=gf-form-input placeholder="Dashboard title query" ng-model=ctrl.panel.dashboardFilter ng-change=ctrl.onRefresh() ng-model-onblur>\r\n    </div>\r\n    <div class=gf-form>\r\n      <folder-picker initial-folder-id=ctrl.panel.folderId on-change=ctrl.onFolderChange($folder) label-class=width-8 initial-title="\'All\'" enable-reset=true>\r\n      </folder-picker>\r\n    </div>\r\n    <div class=gf-form>\r\n        <span class="gf-form-label width-8">Dashboard tags</span>\r\n        <bootstrap-tagsinput ng-model=ctrl.panel.dashboardTags tagclass="label label-tag" placeholder="add tags" on-tags-updated=ctrl.refresh()>\r\n        </bootstrap-tagsinput>\r\n    </div>\r\n  </div>\r\n  <div class="section gf-form-group" ng-show="ctrl.panel.show === \'current\'">\r\n    <h5 class=section-heading>State filter</h5>\r\n    <gf-form-switch class=gf-form label=Ok label-class=width-10 checked="ctrl.stateFilter[\'ok\']" on-change=ctrl.updateStateFilter()></gf-form-switch>\r\n    <gf-form-switch class=gf-form label=Paused label-class=width-10 checked="ctrl.stateFilter[\'paused\']" on-change=ctrl.updateStateFilter()></gf-form-switch>\r\n    <gf-form-switch class=gf-form label="No data" label-class=width-10 checked="ctrl.stateFilter[\'no_data\']" on-change=ctrl.updateStateFilter()></gf-form-switch>\r\n    <gf-form-switch class=gf-form label="Execution error" label-class=width-10 checked="ctrl.stateFilter[\'execution_error\']" on-change=ctrl.updateStateFilter()></gf-form-switch>\r\n    <gf-form-switch class=gf-form label=Alerting label-class=width-10 checked="ctrl.stateFilter[\'alerting\']" on-change=ctrl.updateStateFilter()></gf-form-switch>\r\n    <gf-form-switch class=gf-form label=Pending label-class=width-10 checked="ctrl.stateFilter[\'pending\']" on-change=ctrl.updateStateFilter()></gf-form-switch>\r\n  </div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/panel/alertlist/module.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=panel-alert-list>\r\n  <div class=panel-alert-list__no-alerts ng-show=ctrl.noAlertsMessage>\r\n    {{ctrl.noAlertsMessage}}\r\n  </div>\r\n\r\n  <section ng-if="ctrl.panel.show === \'current\'">\r\n    <ol class=alert-rule-list>\r\n      <li class=alert-rule-item ng-repeat="alert in ctrl.currentAlerts">\r\n        <div class="alert-rule-item__icon {{alert.stateModel.stateClass}}">\r\n          <i class={{alert.stateModel.iconClass}}></i>\r\n        </div>\r\n        <div class=alert-rule-item__body>\r\n          <div class=alert-rule-item__header>\r\n            <p class=alert-rule-item__name>\r\n              <a href="{{alert.url}}?panelId={{alert.panelId}}&fullscreen&edit&tab=alert">\r\n                {{alert.name}}\r\n              </a>\r\n            </p>\r\n            <div class=alert-rule-item__text>\r\n              <span class={{alert.stateModel.stateClass}}>{{alert.stateModel.text}}</span>\r\n              <span class=alert-rule-item__time>for {{alert.newStateDateAgo}}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </li>\r\n    </ol>\r\n  </section>\r\n\r\n  <section ng-if="ctrl.panel.show === \'changes\'">\r\n    <ol class=alert-rule-list>\r\n      <li class=alert-rule-item ng-repeat="al in ctrl.alertHistory">\r\n        <div class="alert-rule-item__icon {{al.stateModel.stateClass}}">\r\n          <i class={{al.stateModel.iconClass}}></i>\r\n        </div>\r\n        <div class=alert-rule-item__body>\r\n          <div class=alert-rule-item__header>\r\n            <p class=alert-rule-item__name>{{al.alertName}}</p>\r\n            <div class=alert-rule-item__text>\r\n              <span class={{al.stateModel.stateClass}}>{{al.stateModel.text}}</span>\r\n            </div>\r\n          </div>\r\n          <span class=alert-rule-item__info>{{al.info}}</span>\r\n        </div>\r\n        <div class=alert-rule-item__time>\r\n          <span>{{al.time}}</span>\r\n        </div>\r\n      </li>\r\n    </ol>\r\n  </section>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/panel/dashlist/editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div>\r\n  <div class="section gf-form-group">\r\n    <h5 class=section-heading>Options</h5>\r\n\r\n    <gf-form-switch class=gf-form label=Starred label-class=width-9 checked=ctrl.panel.starred on-change=ctrl.refresh()></gf-form-switch>\r\n    <gf-form-switch class=gf-form label="Recently viewed" label-class=width-9 checked=ctrl.panel.recent on-change=ctrl.refresh()></gf-form-switch>\r\n    <gf-form-switch class=gf-form label=Search label-class=width-9 checked=ctrl.panel.search on-change=ctrl.refresh()></gf-form-switch>\r\n\r\n    <gf-form-switch class=gf-form label="Show headings" label-class=width-9 checked=ctrl.panel.headings on-change=ctrl.refresh()></gf-form-switch>\r\n\r\n    <div class=gf-form>\r\n      <span class="gf-form-label width-9">Max items</span>\r\n      <input class="gf-form-input max-width-5" type=number ng-model=ctrl.panel.limit ng-model-onblur ng-change=ctrl.refresh()>\r\n    </div>\r\n  </div>\r\n\r\n  <div class="section gf-form-group">\r\n    <h5 class=section-heading>Search</h5>\r\n\r\n    <div class=gf-form>\r\n      <span class="gf-form-label width-6">Query</span>\r\n      <input type=text class=gf-form-input placeholder="title query" ng-model=ctrl.panel.query ng-change=ctrl.refresh() ng-model-onblur>\r\n    </div>\r\n\r\n    <div class=gf-form>\r\n      <folder-picker initial-folder-id=ctrl.panel.folderId on-change=ctrl.onFolderChange($folder) label-class=width-6 initial-title="\'All\'" enable-reset=true>\r\n\t\t\t</folder-picker>\r\n    </div>\r\n\r\n    <div class=gf-form>\r\n      <span class="gf-form-label width-6">Tags</span>\r\n      <bootstrap-tagsinput ng-model=ctrl.panel.tags tagclass="label label-tag" placeholder="add tags" on-tags-updated=ctrl.refresh()>\r\n      </bootstrap-tagsinput>\r\n    </div>\r\n  </div>\r\n\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/panel/dashlist/module.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div>\r\n  <div class=dashlist ng-repeat="group in ctrl.groups">\r\n    <div class=dashlist-section ng-if=group.show>\r\n      <h6 class=dashlist-section-header ng-show=ctrl.panel.headings>\r\n        {{group.header}}\r\n      </h6>\r\n      <div class=dashlist-item ng-repeat="dash in group.list">\r\n        <a class="dashlist-link dashlist-link-{{dash.type}}" href={{dash.url}}>\r\n          <span class=dashlist-title>\r\n            {{dash.title}}\r\n          </span>\r\n          <span class=dashlist-star ng-click="ctrl.starDashboard(dash, $event)">\r\n            <i class=fa ng-class="{\'fa-star\': dash.isStarred, \'fa-star-o\': dash.isStarred === false}"></i>\r\n          </span>\r\n        </a>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/panel/gettingstarted/editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=gf-form-group>\r\n\t<div class=gf-form-inline>\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class="gf-form-label width-10">Mode</span>\r\n\t\t\t<div class="gf-form-select-wrapper max-width-10">\r\n\t\t\t\t<select class=gf-form-input ng-model=ctrl.panel.mode ng-options="f for f in ctrl.modes" ng-change=ctrl.refresh()></select>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class=gf-form ng-show="ctrl.panel.mode === \'recently viewed\'">\r\n\t\t\t<span class=gf-form-label>\r\n\t\t\t\t<i class="grafana-tip fa fa-question-circle ng-scope" bs-tooltip="\'WARNING: This list will be cleared when clearing browser cache\'" data-original-title="" title=""></i>\r\n\t\t\t</span>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class=gf-form-inline ng-if="ctrl.panel.mode === \'search\'">\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class="gf-form-label width-10">Search options</span>\r\n\t\t\t<span class=gf-form-label>Query</span>\r\n\r\n\t\t\t<input type=text class=gf-form-input placeholder="title query" ng-model=ctrl.panel.query ng-change=ctrl.refresh() ng-model-onblur>\r\n\r\n\t\t</div>\r\n\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class=gf-form-label>Tags</span>\r\n\r\n\t\t\t<bootstrap-tagsinput ng-model=ctrl.panel.tags tagclass="label label-tag" placeholder="add tags" on-tags-updated=ctrl.refresh()>\r\n\t\t\t</bootstrap-tagsinput>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class=gf-form-inline>\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class="gf-form-label width-10">Limit number to</span>\r\n\t\t\t<input class=gf-form-input type=number ng-model=ctrl.panel.limit ng-model-onblur ng-change=ctrl.refresh()>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/panel/gettingstarted/module.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=dashlist ng-if=ctrl.checksDone>\r\n  <div class=dashlist-section>\r\n\t\t<button class=dashlist-cta-close-btn ng-click=ctrl.dismiss()>\r\n\t\t\t<i class="fa fa-remove"></i>\r\n\t\t</button>\r\n\t\t<ul class=progress-tracker>\r\n\t\t\t<li class=progress-step ng-repeat="step in ctrl.steps" ng-class=step.cssClass>\r\n\t\t\t\t<a class=progress-link ng-href={{step.href}} target={{step.target}} title={{step.note}}>\r\n\t\t\t\t\t<span class=progress-marker ng-class=step.cssClass><i class={{step.icon}}></i></span>\r\n\t\t\t\t\t<span class=progress-text ng-href={{step.href}} target={{step.target}}>{{step.title}}</span>\r\n\t\t\t\t</a>\r\n\t\t\t\t<a class="btn progress-step-cta" ng-href={{step.href}} target={{step.target}}>{{step.cta}}</a>\r\n\t\t\t</li>\r\n\t\t</ul>\r\n\t</div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/panel/graph/axes_editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=editor-row>\r\n\t<div class="section gf-form-group" ng-repeat="yaxis in ctrl.panel.yaxes">\r\n\r\n\t\t<h5 class=section-heading ng-show="$index === 0">Left Y</h5>\r\n\t\t<h5 class=section-heading ng-show="$index === 1">Right Y</h5>\r\n\r\n\t\t<gf-form-switch class=gf-form label=Show label-class=width-6 checked=yaxis.show on-change=ctrl.render()></gf-form-switch>\r\n\r\n\t\t<div ng-if=yaxis.show>\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<label class="gf-form-label width-6">Unit</label>\r\n\t\t\t\t<div class="gf-form-dropdown-typeahead max-width-20" ng-model=yaxis.format dropdown-typeahead2=ctrl.unitFormats dropdown-typeahead-on-select="ctrl.setUnitFormat(yaxis, $subItem)"></div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<label class="gf-form-label width-6">Scale</label>\r\n\t\t\t\t<div class="gf-form-select-wrapper max-width-20">\r\n\t\t\t\t\t<select class=gf-form-input ng-model=yaxis.logBase ng-options="v as k for (k, v) in ctrl.logScales" ng-change=ctrl.render()></select>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=gf-form-inline>\r\n\t\t\t\t<div class=gf-form>\r\n\t\t\t\t\t<label class="gf-form-label width-6">Y-Min</label>\r\n\t\t\t\t\t<input type=text class="gf-form-input width-5" placeholder=auto empty-to-null ng-model=yaxis.min ng-change=ctrl.render() ng-model-onblur>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=gf-form>\r\n\t\t\t\t\t<label class="gf-form-label width-6">Y-Max</label>\r\n\t\t\t\t\t<input type=text class="gf-form-input width-5" placeholder=auto empty-to-null ng-model=yaxis.max ng-change=ctrl.render() ng-model-onblur>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t<div ng-if=yaxis.show>\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<label class="gf-form-label width-6">Decimals</label>\r\n\t\t\t\t<input type=number class="gf-form-input max-width-20" placeholder=auto empty-to-null bs-tooltip="\'Override automatic decimal precision for y-axis\'" data-placement=right ng-model=yaxis.decimals ng-change=ctrl.render() ng-model-onblur>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<label class="gf-form-label width-6">Label</label>\r\n\t\t\t\t<input type=text class="gf-form-input max-width-20" ng-model=yaxis.label ng-change=ctrl.render() ng-model-onblur>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class="section gf-form-group">\r\n\t\t<h5 class=section-heading>X-Axis</h5>\r\n\t\t<gf-form-switch class=gf-form label=Show label-class=width-6 checked=ctrl.panel.xaxis.show on-change=ctrl.render()></gf-form-switch>\r\n\r\n\t\t<div class=gf-form>\r\n\t\t\t<label class="gf-form-label width-6">Mode</label>\r\n\t\t\t<div class="gf-form-select-wrapper max-width-15">\r\n\t\t\t\t<select class=gf-form-input ng-model=ctrl.panel.xaxis.mode ng-options="v as k for (k, v) in ctrl.xAxisModes" ng-change=ctrl.xAxisModeChanged()> </select>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t\x3c!-- Series mode --\x3e\r\n\t\t<div class=gf-form ng-if="ctrl.panel.xaxis.mode === \'series\'">\r\n\t\t\t<label class="gf-form-label width-6">Value</label>\r\n      <metric-segment-model property=ctrl.panel.xaxis.values[0] options=ctrl.xAxisStatOptions on-change=ctrl.xAxisValueChanged() custom=false css-class=width-10 select-mode=true></metric-segment-model>\r\n\t\t</div>\r\n\r\n\t\t\x3c!-- Histogram mode --\x3e\r\n\t\t<div class=gf-form ng-if="ctrl.panel.xaxis.mode === \'histogram\'">\r\n\t\t\t<label class="gf-form-label width-6">Buckets</label>\r\n\t\t\t<input type=number class="gf-form-input max-width-8" ng-model=ctrl.panel.xaxis.buckets placeholder=auto ng-change=ctrl.render() ng-model-onblur bs-tooltip="\'Number of buckets\'" data-placement=right>\r\n\t\t</div>\r\n\r\n\t\t<div>\r\n\t\t\t<br/>\r\n\t\t\t<h5 class=section-heading>Y-Axes</h5>\r\n\t\t\t<gf-form-switch class=gf-form label=Align tooltip="Align left and right Y-axes" label-class=width-6 switch-class=width-5 checked=ctrl.panel.yaxis.align on-change=ctrl.render()></gf-form-switch>\r\n\t\t\t<div class=gf-form ng-show=ctrl.panel.yaxis.align>\r\n\t\t\t\t<label class="gf-form-label width-6">\r\n\t\t\t\t\tLevel\r\n\t\t\t\t</label>\r\n\t\t\t\t<input type=number class="gf-form-input width-5" placeholder=0 ng-model=ctrl.panel.yaxis.alignLevel ng-change=ctrl.render() ng-model-onblur bs-tooltip="\'Alignment of Y-axes are based on this value, starting from Y=0\'" data-placement=right>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t</div>\r\n\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/panel/graph/tab_display.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=edit-tab-with-sidemenu>\r\n\t<aside class=edit-sidemenu-aside>\r\n\t\t<ul class=edit-sidemenu>\r\n\t\t\t<li ng-class="{active: ctrl.subTabIndex === 0}">\r\n\t\t\t\t<a ng-click="ctrl.subTabIndex = 0">Draw options</a>\r\n\t\t\t</li>\r\n\t\t\t<li ng-class="{active: ctrl.subTabIndex === 1}">\r\n\t\t\t\t<a ng-click="ctrl.subTabIndex = 1">\r\n\t\t\t\t\tSeries overrides <span class=muted>({{ctrl.panel.seriesOverrides.length}})</span>\r\n\t\t\t\t</a>\r\n\t\t\t</li>\r\n\t\t\t<li ng-class="{active: ctrl.subTabIndex === 2}">\r\n\t\t\t\t<a ng-click="ctrl.subTabIndex = 2">\r\n\t\t\t\t\tThresholds <span class=muted>({{ctrl.panel.thresholds.length}})</span>\r\n\t\t\t\t</a>\r\n\t\t\t</li>\r\n\t\t\t<li ng-class="{active: ctrl.subTabIndex === 3}">\r\n\t\t\t\t<a ng-click="ctrl.subTabIndex = 3">\r\n\t\t\t\t\tTime regions <span class=muted>({{ctrl.panel.timeRegions.length}})</span>\r\n\t\t\t\t</a>\r\n\t\t\t</li>\r\n\t\t</ul>\r\n\t</aside>\r\n\r\n\t<div class=edit-tab-content ng-if="ctrl.subTabIndex === 0">\r\n\t\t<div class="section gf-form-group">\r\n\t\t\t<h5 class=section-heading>Draw Modes</h5>\r\n\t\t\t<gf-form-switch class=gf-form label=Bars label-class=width-5 checked=ctrl.panel.bars on-change=ctrl.render()></gf-form-switch>\r\n\t\t\t<gf-form-switch class=gf-form label=Lines label-class=width-5 checked=ctrl.panel.lines on-change=ctrl.render()></gf-form-switch>\r\n\t\t\t<gf-form-switch class=gf-form label=Points label-class=width-5 checked=ctrl.panel.points on-change=ctrl.render()></gf-form-switch>\r\n\t\t</div>\r\n\t\t<div class="section gf-form-group">\r\n\t\t\t<h5 class=section-heading>Mode Options</h5>\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<label class="gf-form-label width-8">Fill</label>\r\n\t\t\t\t<div class="gf-form-select-wrapper max-width-5">\r\n\t\t\t\t\t<select class=gf-form-input ng-model=ctrl.panel.fill ng-options="f for f in [0,1,2,3,4,5,6,7,8,9,10]" ng-change=ctrl.render() ng-disabled=!ctrl.panel.lines></select>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<label class="gf-form-label width-8">Line Width</label>\r\n\t\t\t\t<div class="gf-form-select-wrapper max-width-5">\r\n\t\t\t\t\t<select class=gf-form-input ng-model=ctrl.panel.linewidth ng-options="f for f in [0,1,2,3,4,5,6,7,8,9,10]" ng-change=ctrl.render() ng-disabled=!ctrl.panel.lines></select>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n      <gf-form-switch ng-disabled=!ctrl.panel.lines class=gf-form label=平滑 label-class=width-8 checked=ctrl.panel.smoothLine on-change=ctrl.render()>\r\n\t\t\t</gf-form-switch>\r\n\t\t\t<gf-form-switch ng-disabled=!ctrl.panel.lines class=gf-form label=Staircase label-class=width-8 checked=ctrl.panel.steppedLine on-change=ctrl.render()>\r\n\t\t\t</gf-form-switch>\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<label class="gf-form-label width-8">Point Radius</label>\r\n\t\t\t\t<div class="gf-form-select-wrapper max-width-5">\r\n\t\t\t\t\t<select class=gf-form-input ng-model=ctrl.panel.pointradius ng-options="f for f in [0.5,1,2,3,4,5,6,7,8,9,10]" ng-change=ctrl.render() ng-disabled=!ctrl.panel.points></select>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<label class="gf-form-label width-8">Bars Width</label>\r\n\t\t\t\t<div class="gf-form max-width-5">\r\n\t\t\t\t\t<input type=number ng-model=ctrl.panel.barsWidth ng-blur=ctrl.render() class="gf-form-input max-width-5">\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class="section gf-form-group">\r\n\t\t\t<h5 class=section-heading>Hover tooltip</h5>\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<label class="gf-form-label width-9">Mode</label>\r\n\t\t\t\t<div class="gf-form-select-wrapper max-width-8">\r\n\t\t\t\t\t<select class=gf-form-input ng-model=ctrl.panel.tooltip.shared ng-options="f.value as f.text for f in [{text: \'All series\', value: true}, {text: \'Single\', value: false}]" ng-change=ctrl.render()></select>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<label class="gf-form-label width-9">Sort order</label>\r\n\t\t\t\t<div class="gf-form-select-wrapper max-width-8">\r\n\t\t\t\t\t<select class=gf-form-input ng-model=ctrl.panel.tooltip.sort ng-options="f.value as f.text for f in [{text: \'None\', value: 0}, {text: \'Increasing\', value: 1}, {text: \'Decreasing\', value: 2}]" ng-change=ctrl.render()></select>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class=gf-form ng-show=ctrl.panel.stack>\r\n\t\t\t\t<label class="gf-form-label width-9">Stacked value</label>\r\n\t\t\t\t<div class="gf-form-select-wrapper max-width-8">\r\n\t\t\t\t\t<select class=gf-form-input ng-model=ctrl.panel.tooltip.value_type ng-options="f for f in [\'cumulative\',\'individual\']" ng-change=ctrl.render()></select>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class="section gf-form-group">\r\n\t\t\t<h5 class=section-heading>Stacking & Null value</h5>\r\n\t\t\t<gf-form-switch class=gf-form label=Stack label-class=width-7 checked=ctrl.panel.stack on-change=ctrl.refresh()>\r\n\t\t\t</gf-form-switch>\r\n\t\t\t<gf-form-switch class=gf-form ng-show=ctrl.panel.stack label=Percent label-class=width-7 checked=ctrl.panel.percentage on-change=ctrl.render()>\r\n\t\t\t</gf-form-switch>\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<label class="gf-form-label width-7">Null value</label>\r\n\t\t\t\t<div class=gf-form-select-wrapper>\r\n\t\t\t\t\t<select class="gf-form-input max-width-9" ng-model=ctrl.panel.nullPointMode ng-options="f for f in [\'connected\', \'null\', \'null as zero\']" ng-change=ctrl.render()></select>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class=edit-tab-content ng-if="ctrl.subTabIndex === 1">\r\n\t\t<div class=gf-form-group>\r\n\t\t\t<h5>Series specific overrides <tip>Regex match example: /server[0-3]/i </tip></h5>\r\n\t\t\t<div class=gf-form-inline ng-repeat="override in ctrl.panel.seriesOverrides" ng-controller=SeriesOverridesCtrl>\r\n\t\t\t\t<div class=gf-form>\r\n\t\t\t\t\t<label class=gf-form-label>alias or regex</label>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class="gf-form width-15">\r\n\t\t\t\t\t<input type=text ng-model=override.alias bs-typeahead=getSeriesNames ng-blur=ctrl.render() data-min-length=0 data-items=100 class="gf-form-input width-15">\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=gf-form ng-repeat="option in currentOverrides">\r\n\t\t\t\t\t<label class=gf-form-label>\r\n\t\t\t\t\t\t<i class="pointer fa fa-remove" ng-click=removeOverride(option)></i>\r\n\t\t\t\t\t\t<span ng-show="option.propertyName === \'color\'">\r\n\t\t\t\t\t\t\tColor: <i class="fa fa-circle" ng-style={color:option.value}></i>\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t<span ng-show="option.propertyName !== \'color\'">\r\n\t\t\t\t\t\t\t{{option.name}}: {{option.value}}\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t</label>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=gf-form>\r\n\t\t\t\t\t<span class=dropdown dropdown-typeahead=overrideMenu dropdown-typeahead-on-select="setOverride($item, $subItem)">\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class="gf-form gf-form--grow">\r\n\t\t\t\t\t<div class="gf-form-label gf-form-label--grow"></div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=gf-form>\r\n\t\t\t\t\t<label class=gf-form-label>\r\n\t\t\t\t\t\t<i class="fa fa-trash pointer" ng-click=ctrl.removeSeriesOverride(override)></i>\r\n\t\t\t\t\t</label>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<button class="btn btn-inverse" ng-click=ctrl.addSeriesOverride()>\r\n\t\t\t<i class="fa fa-plus"></i>&nbsp;Add override\r\n\t\t</button>\r\n\t</div>\r\n\r\n\t<div class=edit-tab-content ng-if="ctrl.subTabIndex === 2">\r\n\t\t<graph-threshold-form panel-ctrl=ctrl></graph-threshold-form>\r\n\t</div>\r\n\r\n\t<div class=edit-tab-content ng-if="ctrl.subTabIndex === 3">\r\n\t\t<graph-time-region-form panel-ctrl=ctrl></graph-time-region-form>\r\n\t</div>\r\n\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/panel/graph/tab_legend.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=editor-row>\r\n\t<div class="section gf-form-group">\r\n\t\t<h5 class=section-heading>Options</h5>\r\n\t\t<gf-form-switch class=gf-form label=Show label-class=width-7 checked=ctrl.panel.legend.show on-change=ctrl.refresh()>\r\n\t\t</gf-form-switch>\r\n\t\t<gf-form-switch class=gf-form label="As Table" label-class=width-7 checked=ctrl.panel.legend.alignAsTable on-change=ctrl.render()>\r\n\t\t</gf-form-switch>\r\n\t\t<gf-form-switch class=gf-form label="To the right" label-class=width-7 checked=ctrl.panel.legend.rightSide on-change=ctrl.render()>\r\n\t\t</gf-form-switch>\r\n\t\t<div ng-if=ctrl.panel.legend.rightSide class=gf-form>\r\n\t\t\t<label class="gf-form-label width-7">Width</label>\r\n\t\t\t<input type=number class="gf-form-input max-width-5" placeholder=250 bs-tooltip="\'Set a min-width for the legend side table/block\'" data-placement=right ng-model=ctrl.panel.legend.sideWidth ng-change=ctrl.render() ng-model-onblur>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class="section gf-form-group">\r\n\t\t<h5 class=section-heading>Values</h5>\r\n\r\n\t\t<div class=gf-form-inline>\r\n\t\t\t<gf-form-switch class=gf-form label=Min label-class=width-4 checked=ctrl.panel.legend.min on-change=ctrl.legendValuesOptionChanged()>\r\n\t\t\t</gf-form-switch>\r\n\r\n\t\t\t<gf-form-switch class="gf-form max-width-12" label=Max label-class=width-6 switch-class=max-width-5 checked=ctrl.panel.legend.max on-change=ctrl.legendValuesOptionChanged()>\r\n\t\t\t</gf-form-switch>\r\n\t\t</div>\r\n\r\n\t\t<div class=gf-form-inline>\r\n\t\t\t<gf-form-switch class=gf-form label=Avg label-class=width-4 checked=ctrl.panel.legend.avg on-change=ctrl.legendValuesOptionChanged()>\r\n\t\t\t</gf-form-switch>\r\n\r\n\t\t\t<gf-form-switch class="gf-form max-width-12" label=Current label-class=width-6 switch-class=max-width-5 checked=ctrl.panel.legend.current on-change=ctrl.legendValuesOptionChanged()>\r\n\t\t\t</gf-form-switch>\r\n\t\t</div>\r\n\r\n\t\t<div class=gf-form-inline>\r\n\t\t\t<gf-form-switch class=gf-form label=Total label-class=width-4 checked=ctrl.panel.legend.total on-change=ctrl.legendValuesOptionChanged()>\r\n\t\t\t</gf-form-switch>\r\n\r\n\t\t\t<div class=gf-form>\r\n\t\t\t\t<label class="gf-form-label width-6">Decimals</label>\r\n\t\t\t\t<input type=number class="gf-form-input width-5" placeholder=auto bs-tooltip="\'Override automatic decimal precision for legend and tooltips\'" data-placement=right ng-model=ctrl.panel.decimals ng-change=ctrl.render() ng-model-onblur>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class="section gf-form-group">\r\n\t\t<h5 class=section-heading>Hide series</h5>\r\n\t\t<gf-form-switch class=gf-form label="With only nulls" label-class=width-10 checked=ctrl.panel.legend.hideEmpty on-change=ctrl.render()>\r\n\t\t</gf-form-switch>\r\n\t\t<gf-form-switch class=gf-form label="With only zeros" label-class=width-10 checked=ctrl.panel.legend.hideZero on-change=ctrl.render()>\r\n\t\t</gf-form-switch>\r\n\t</div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/panel/graph/thresholds_form.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,"<div class=gf-form-group>\r\n  <h5>Thresholds</h5>\r\n  <p class=muted ng-show=ctrl.disabled>\r\n    Visual thresholds options <strong>disabled.</strong>\r\n    Visit the Alert tab update your thresholds. <br>\r\n    To re-enable thresholds, the alert rule must be deleted from this panel.\r\n  </p>\r\n  <div ng-class=\"{'thresholds-form-disabled': ctrl.disabled}\">\r\n    <div class=gf-form-inline ng-repeat=\"threshold in ctrl.panel.thresholds\">\r\n      <div class=gf-form>\r\n        <label class=gf-form-label>T{{$index+1}}</label>\r\n      </div>\r\n\r\n      <div class=gf-form>\r\n        <div class=gf-form-select-wrapper>\r\n          <select class=gf-form-input ng-model=threshold.op ng-options=\"f for f in ['gt', 'lt']\" ng-change=ctrl.render() ng-disabled=ctrl.disabled></select>\r\n        </div>\r\n        <input type=text ng-model=threshold.value class=\"gf-form-input width-8\" ng-change=ctrl.render() placeholder=value ng-disabled=ctrl.disabled>\r\n      </div>\r\n\r\n      <div class=gf-form>\r\n        <label class=gf-form-label>Color</label>\r\n        <div class=gf-form-select-wrapper>\r\n          <select class=gf-form-input ng-model=threshold.colorMode ng-options=\"f for f in ['custom', 'critical', 'warning', 'ok']\" ng-change=ctrl.render() ng-disabled=ctrl.disabled>\r\n          </select>\r\n        </div>\r\n      </div>\r\n\r\n      <gf-form-switch class=gf-form label=Fill checked=threshold.fill on-change=ctrl.render() ng-disabled=ctrl.disabled></gf-form-switch>\r\n\r\n      <div class=gf-form ng-if=\"threshold.fill && threshold.colorMode === 'custom'\">\r\n        <label class=gf-form-label>Fill color</label>\r\n        <span class=gf-form-label>\r\n          <color-picker color=threshold.fillColor onchange=ctrl.onFillColorChange($index)></color-picker>\r\n        </span>\r\n      </div>\r\n\r\n      <gf-form-switch class=gf-form label=Line checked=threshold.line on-change=ctrl.render() ng-disabled=ctrl.disabled></gf-form-switch>\r\n\r\n      <div class=gf-form ng-if=\"threshold.line && threshold.colorMode === 'custom'\">\r\n        <label class=gf-form-label>Line color</label>\r\n        <span class=gf-form-label>\r\n          <color-picker color=threshold.lineColor onchange=ctrl.onLineColorChange($index)></color-picker>\r\n        </span>\r\n      </div>\r\n      <gf-form-switch class=gf-form label=显示值 checked=threshold.showValue on-change=ctrl.render() ng-disabled=ctrl.disabled></gf-form-switch>\r\n      <div class=gf-form>\r\n        <label class=gf-form-label>Y-Axis</label>\r\n        <div class=gf-form-select-wrapper>\r\n          <select class=gf-form-input ng-model=threshold.yaxis ng-init=\"threshold.yaxis = threshold.yaxis === 'left' || threshold.yaxis === 'right' ? threshold.yaxis : 'left'\" ng-options=\"f for f in ['left', 'right']\" ng-change=ctrl.render() ng-disabled=ctrl.disabled>\r\n          </select>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=gf-form>\r\n        <label class=gf-form-label>\r\n          <a class=pointer ng-click=ctrl.removeThreshold($index) ng-disabled=ctrl.disabled>\r\n            <i class=\"fa fa-trash\"></i>\r\n          </a>\r\n        </label>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=gf-form-button-row>\r\n      <button class=\"btn btn-inverse\" ng-click=ctrl.addThreshold() ng-disabled=ctrl.disabled>\r\n        <i class=\"fa fa-plus\"></i>&nbsp;Add Threshold\r\n      </button>\r\n    </div>\r\n  </div>\r\n</div>")}]),t.exports=r},function(t,e){var r="public/app/plugins/panel/graph/time_regions_form.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,"<div class=gf-form-group>\r\n  <h5>Time regions <tip>All configured time regions refers to UTC time</tip></h5>\r\n  <div class=gf-form-inline ng-repeat=\"timeRegion in ctrl.panel.timeRegions\">\r\n    <div class=gf-form>\r\n      <label class=gf-form-label>T{{$index+1}}</label>\r\n    </div>\r\n\r\n    <div class=gf-form>\r\n      <label class=gf-form-label>From</label>\r\n      <div class=gf-form-select-wrapper>\r\n        <select class=\"gf-form-input width-6\" ng-model=timeRegion.fromDayOfWeek ng-options=\"f.d as f.value for f in [{d: undefined, value: 'Any'}, {d:1, value: 'Mon'}, {d:2, value: 'Tue'}, {d:3, value: 'Wed'}, {d:4, value: 'Thu'}, {d:5, value: 'Fri'}, {d:6, value: 'Sat'}, {d:7, value: 'Sun'}]\" ng-change=ctrl.render()></select>\r\n      </div>\r\n      <input type=text ng-maxlength=5 ng-model=timeRegion.from class=\"gf-form-input width-5\" ng-change=ctrl.render() placeholder=hh:mm>\r\n      <label class=gf-form-label>To</label>\r\n      <div class=gf-form-select-wrapper>\r\n        <select class=\"gf-form-input width-6\" ng-model=timeRegion.toDayOfWeek ng-options=\"f.d as f.value for f in [{d: undefined, value: 'Any'}, {d:1, value: 'Mon'}, {d:2, value: 'Tue'}, {d:3, value: 'Wed'}, {d:4, value: 'Thu'}, {d:5, value: 'Fri'}, {d:6, value: 'Sat'}, {d:7, value: 'Sun'}]\" ng-change=ctrl.render()></select>\r\n      </div>\r\n      <input type=text ng-maxlength=5 ng-model=timeRegion.to class=\"gf-form-input width-5\" ng-change=ctrl.render() placeholder=hh:mm>\r\n    </div>\r\n\r\n    <div class=gf-form>\r\n      <label class=gf-form-label>Color</label>\r\n      <div class=gf-form-select-wrapper>\r\n        <select class=gf-form-input ng-model=timeRegion.colorMode ng-options=\"f.key as f.value for f in ctrl.colorModes\" ng-change=ctrl.render()>\r\n        </select>\r\n      </div>\r\n    </div>\r\n\r\n    <gf-form-switch class=gf-form label=Fill checked=timeRegion.fill on-change=ctrl.render()></gf-form-switch>\r\n\r\n    <div class=gf-form ng-if=\"timeRegion.fill && timeRegion.colorMode === 'custom'\">\r\n      <label class=gf-form-label>Fill color</label>\r\n      <span class=gf-form-label>\r\n        <color-picker color=timeRegion.fillColor onchange=ctrl.onFillColorChange($index)></color-picker>\r\n      </span>\r\n    </div>\r\n\r\n    <gf-form-switch class=gf-form label=Line checked=timeRegion.line on-change=ctrl.render()></gf-form-switch>\r\n\r\n    <div class=gf-form ng-if=\"timeRegion.line && timeRegion.colorMode === 'custom'\">\r\n      <label class=gf-form-label>Line color</label>\r\n      <span class=gf-form-label>\r\n        <color-picker color=timeRegion.lineColor onchange=ctrl.onLineColorChange($index)></color-picker>\r\n      </span>\r\n    </div>\r\n\r\n    <div class=gf-form>\r\n      <label class=gf-form-label>\r\n        <a class=pointer ng-click=ctrl.removeTimeRegion($index)>\r\n          <i class=\"fa fa-trash\"></i>\r\n        </a>\r\n      </label>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=gf-form-button-row>\r\n    <button class=\"btn btn-inverse\" ng-click=ctrl.addTimeRegion()>\r\n      <i class=\"fa fa-plus\"></i>&nbsp;Add time region\r\n    </button>\r\n  </div>\r\n</div>")}]),t.exports=r},function(t,e){var r="public/app/plugins/panel/heatmap/module.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,"<div class=heatmap-wrapper>\r\n\t<div class=heatmap-canvas-wrapper>\r\n\r\n\t\t<div class=datapoints-warning ng-if=ctrl.dataWarning>\r\n\t\t\t<span class=small bs-tooltip=ctrl.dataWarning.tip>{{ctrl.dataWarning.title}}</span>\r\n\t\t</div>\r\n\r\n\t\t<div class=heatmap-panel ng-dblclick=ctrl.zoomOut()></div>\r\n\t</div>\r\n\t<div class=heatmap-legend-wrapper ng-if=ctrl.panel.legend.show>\r\n\t\t<heatmap-legend></heatmap-legend>\r\n\t</div>\r\n</div>\r\n<div class=clearfix></div>\r\n")}]),t.exports=r},function(t,e){var r="public/app/plugins/panel/heatmap/partials/axes_editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=editor-row>\r\n  <div class="section gf-form-group">\r\n    <h5 class=section-heading>Y Axis</h5>\r\n    <div class=gf-form>\r\n      <label class="gf-form-label width-8">Unit</label>\r\n      <div class="gf-form-dropdown-typeahead width-12" ng-model=ctrl.panel.yAxis.format dropdown-typeahead2=editor.unitFormats dropdown-typeahead-on-select=editor.setUnitFormat($subItem)>\r\n      </div>\r\n    </div>\r\n    <div ng-if="ctrl.panel.dataFormat == \'timeseries\'">\r\n      <div class=gf-form>\r\n        <label class="gf-form-label width-8">Scale</label>\r\n        <div class="gf-form-select-wrapper width-12">\r\n          <select class=gf-form-input ng-model=ctrl.panel.yAxis.logBase ng-options="v as k for (k, v) in editor.logScales" ng-change=ctrl.refresh()></select>\r\n        </div>\r\n      </div>\r\n      <div class=gf-form>\r\n        <label class="gf-form-label width-8">Y-Min</label>\r\n        <input type=text class="gf-form-input width-12" placeholder=auto empty-to-null ng-model=ctrl.panel.yAxis.min ng-change=ctrl.render() ng-model-onblur>\r\n      </div>\r\n      <div class=gf-form>\r\n        <label class="gf-form-label width-8">Y-Max</label>\r\n        <input type=text class="gf-form-input width-12" placeholder=auto empty-to-null ng-model=ctrl.panel.yAxis.max ng-change=ctrl.render() ng-model-onblur>\r\n      </div>\r\n    </div>\r\n    <div class=gf-form>\r\n      <label class="gf-form-label width-8">Decimals</label>\r\n      <input type=number class="gf-form-input width-12" placeholder=auto data-placement=right bs-tooltip="\'Override automatic decimal precision for axis.\'" ng-model=ctrl.panel.yAxis.decimals ng-change=ctrl.render() ng-model-onblur>\r\n    </div>\r\n    <div class=gf-form ng-if="ctrl.panel.dataFormat == \'tsbuckets\'">\r\n      <label class="gf-form-label width-8">Bucket bound</label>\r\n      <div class="gf-form-select-wrapper max-width-12">\r\n        <select class=gf-form-input ng-model=ctrl.panel.yBucketBound ng-options="v as k for (k, v) in editor.yBucketBoundModes" ng-change=ctrl.render() data-placement=right bs-tooltip="\'Use series label as an upper or lower bucket bound.\'">\r\n        </select>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class="section gf-form-group" ng-if="ctrl.panel.dataFormat == \'timeseries\'">\r\n    <h5 class=section-heading>Buckets</h5>\r\n    <div class=gf-form-inline>\r\n      <div class=gf-form>\r\n        <label class="gf-form-label width-5">Y Axis</label>\r\n      </div>\r\n      <div class=gf-form ng-show="ctrl.panel.yAxis.logBase === 1">\r\n        <label class="gf-form-label width-5">Buckets</label>\r\n        <input type=number class="gf-form-input width-5" placeholder=auto data-placement=right bs-tooltip="\'Number of buckets for Y axis.\'" ng-model=ctrl.panel.yBucketNumber ng-change=ctrl.refresh() ng-model-onblur>\r\n      </div>\r\n      <div class=gf-form ng-show="ctrl.panel.yAxis.logBase === 1">\r\n        <label class="gf-form-label width-4">Size</label>\r\n        <input type=number class="gf-form-input width-5" placeholder=auto data-placement=right bs-tooltip="\'Size of bucket. Has priority over Buckets option.\'" ng-model=ctrl.panel.yBucketSize ng-change=ctrl.refresh() ng-model-onblur>\r\n      </div>\r\n      <div class=gf-form ng-show="ctrl.panel.yAxis.logBase !== 1">\r\n        <label class="gf-form-label width-10">Split Factor</label>\r\n        <input type=number class="gf-form-input width-9" placeholder=1 data-placement=right bs-tooltip="\'For log scales only. By default Y values is splitted by integer powers of log base (1, 2, 4, 8, 16, ... for log2). This option allows to split each default bucket into specified number of buckets.\'" ng-model=ctrl.panel.yAxis.splitFactor ng-change=ctrl.refresh() ng-model-onblur>\r\n        \r\n      </div>\r\n    </div>\r\n    <div class=gf-form-inline>\r\n      <div class=gf-form>\r\n        <label class="gf-form-label width-5">X Axis</label>\r\n        <label class="gf-form-label width-5">Buckets</label>\r\n        <input type=number class="gf-form-input width-5" placeholder=auto data-placement=right bs-tooltip="\'Number of buckets for X axis.\'" ng-model=ctrl.panel.xBucketNumber ng-change=ctrl.refresh() ng-model-onblur>\r\n      </div>\r\n      <div class=gf-form>\r\n        <label class="gf-form-label width-4">Size</label>\r\n        <input type=text class="gf-form-input width-5" placeholder=auto data-placement=right bs-tooltip="\'Size of bucket. Number or interval (10s, 5m, 1h, etc). Supported intervals: ms, s, m, h, d, w, M, y. Has priority over Buckets option.\'" ng-model=ctrl.panel.xBucketSize ng-change=ctrl.refresh() ng-model-onblur>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class="section gf-form-group">\r\n    <h5 class=section-heading>Data format</h5>\r\n    <div class=gf-form>\r\n      <label class="gf-form-label width-5">Format</label>\r\n      <div class="gf-form-select-wrapper max-width-15">\r\n        <select class=gf-form-input ng-model=ctrl.panel.dataFormat ng-options="v as k for (k, v) in editor.dataFormats" ng-change=ctrl.render() data-placement=right bs-tooltip="\'Time series: create heatmap from regular time series. <br>Time series buckets: use histogram data returned from data source. Each series represents bucket which upper/lower bound is a series label.\'">\r\n        </select>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/panel/heatmap/partials/display_editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=editor-row>\r\n  <div class="section gf-form-group">\r\n    <h5 class=section-heading>Colors</h5>\r\n    <div class=gf-form>\r\n      <label class="gf-form-label width-9">Mode</label>\r\n      <div class="gf-form-select-wrapper width-8">\r\n        <select class="input-small gf-form-input" ng-model=ctrl.panel.color.mode ng-options="s for s in ctrl.colorModes" ng-change=ctrl.render()></select>\r\n      </div>\r\n    </div>\r\n\r\n    <div ng-show="ctrl.panel.color.mode === \'opacity\'">\r\n      <div class=gf-form>\r\n        <label class="gf-form-label width-9">Color</label>\r\n        <span class=gf-form-label>\r\n          <color-picker color=ctrl.panel.color.cardColor onchange=ctrl.onCardColorChange></color-picker>\r\n        </span>\r\n      </div>\r\n      <div class=gf-form>\r\n        <label class="gf-form-label width-9">Scale</label>\r\n        <div class="gf-form-select-wrapper width-8">\r\n          <select class="input-small gf-form-input" ng-model=ctrl.panel.color.colorScale ng-options="s for s in ctrl.opacityScales" ng-change=ctrl.render()></select>\r\n        </div>\r\n      </div>\r\n      <div class=gf-form ng-if="ctrl.panel.color.colorScale === \'sqrt\'">\r\n        <label class="gf-form-label width-9">Exponent</label>\r\n        <input type=number class="gf-form-input width-8" placeholder=auto data-placement=right bs-tooltip="\'\'" ng-model=ctrl.panel.color.exponent ng-change=ctrl.refresh() ng-model-onblur>\r\n      </div>\r\n    </div>\r\n\r\n    <div ng-show="ctrl.panel.color.mode === \'spectrum\'">\r\n      <div class=gf-form>\r\n        <label class="gf-form-label width-9">Scheme</label>\r\n        <div class="gf-form-select-wrapper width-8">\r\n          <select class="input-small gf-form-input" ng-model=ctrl.panel.color.colorScheme ng-options="s.value as s.name for s in ctrl.colorSchemes" ng-change=ctrl.render()></select>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=gf-form>\r\n      <color-legend></color-legend>\r\n    </div>\r\n  </div>\r\n\r\n  <div class="section gf-form-group">\r\n    <h5 class=section-heading>Color scale</h5>\r\n    <div class=gf-form>\r\n      <label class="gf-form-label width-8">Min</label>\r\n      <input type=number ng-model=ctrl.panel.color.min class="gf-form-input width-5" placeholder=auto data-placement=right bs-tooltip="\'\'" ng-change=ctrl.refresh() ng-model-onblur>\r\n    </div>\r\n    <div class=gf-form>\r\n      <label class="gf-form-label width-8">Max</label>\r\n      <input type=number ng-model=ctrl.panel.color.max class="gf-form-input width-5" placeholder=auto data-placement=right bs-tooltip="\'\'" ng-change=ctrl.refresh() ng-model-onblur>\r\n    </div>\r\n  </div>\r\n\r\n  <div class="section gf-form-group">\r\n    <h5 class=section-heading>Legend</h5>\r\n    <gf-form-switch class=gf-form label-class=width-8 label="Show legend" checked=ctrl.panel.legend.show on-change=ctrl.render()>\r\n    </gf-form-switch>\r\n  </div>\r\n\r\n  <div class="section gf-form-group">\r\n    <h5 class=section-heading>Buckets</h5>\r\n    <div class=gf-form>\r\n      <label class="gf-form-label width-8">Space</label>\r\n      <input type=number class="gf-form-input width-5" placeholder=auto data-placement=right bs-tooltip="\'\'" ng-model=ctrl.panel.cards.cardPadding ng-change=ctrl.refresh() ng-model-onblur>\r\n    </div>\r\n    <div class=gf-form>\r\n      <label class="gf-form-label width-8">Round</label>\r\n      <input type=number class="gf-form-input width-5" placeholder=auto data-placement=right bs-tooltip="\'\'" ng-model=ctrl.panel.cards.cardRound ng-change=ctrl.refresh() ng-model-onblur>\r\n    </div>\r\n  </div>\r\n\r\n  <div class="section gf-form-group">\r\n    <h5 class=section-heading>Tooltip</h5>\r\n    <gf-form-switch class=gf-form label-class=width-8 label="Show tooltip" checked=ctrl.panel.tooltip.show on-change=ctrl.render()>\r\n    </gf-form-switch>\r\n    <div ng-if=ctrl.panel.tooltip.show>\r\n      <gf-form-switch class=gf-form label-class=width-8 label=Histogram checked=ctrl.panel.tooltip.showHistogram on-change=ctrl.render()>\r\n      </gf-form-switch>\r\n      <div class=gf-form>\r\n        <label class="gf-form-label width-8">Decimals</label>\r\n        <input type=number class="gf-form-input width-5" placeholder=auto data-placement=right bs-tooltip="\'Max decimal precision for tooltip.\'" ng-model=ctrl.panel.tooltipDecimals ng-change=ctrl.render() ng-model-onblur>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/panel/pluginlist/editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=gf-form-group>\r\n\t<div class=gf-form-inline>\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class="gf-form-label width-10">Mode</span>\r\n\t\t\t<div class="gf-form-select-wrapper max-width-10">\r\n\t\t\t\t<select class=gf-form-input ng-model=ctrl.panel.mode ng-options="f for f in ctrl.modes" ng-change=ctrl.refresh()></select>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class=gf-form ng-show="ctrl.panel.mode === \'recently viewed\'">\r\n\t\t\t<span class=gf-form-label>\r\n\t\t\t\t<i class="grafana-tip fa fa-question-circle ng-scope" bs-tooltip="\'WARNING: This list will be cleared when clearing browser cache\'" data-original-title="" title=""></i>\r\n\t\t\t</span>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class=gf-form-inline ng-if="ctrl.panel.mode === \'search\'">\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class="gf-form-label width-10">Search options</span>\r\n\t\t\t<span class=gf-form-label>Query</span>\r\n\r\n\t\t\t<input type=text class=gf-form-input placeholder="title query" ng-model=ctrl.panel.query ng-change=ctrl.refresh() ng-model-onblur>\r\n\r\n\t\t</div>\r\n\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class=gf-form-label>Tags</span>\r\n\r\n\t\t\t<bootstrap-tagsinput ng-model=ctrl.panel.tags tagclass="label label-tag" placeholder="add tags" on-tags-updated=ctrl.refresh()>\r\n\t\t\t</bootstrap-tagsinput>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class=gf-form-inline>\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class="gf-form-label width-10">Limit number to</span>\r\n\t\t\t<input class=gf-form-input type=number ng-model=ctrl.panel.limit ng-model-onblur ng-change=ctrl.refresh()>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/panel/pluginlist/module.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=pluginlist>\r\n  <div class=pluginlist-section ng-repeat="category in ctrl.viewModel">\r\n    <h6 class=pluginlist-section-header>\r\n      {{category.header}}\r\n    </h6>\r\n    <div class=pluginlist-item ng-repeat="plugin in category.list">\r\n      <a class="pluginlist-link pluginlist-link-{{plugin.state}} pointer" href={{plugin.defaultNavUrl}}>\r\n        <span>\r\n          <img ng-src={{plugin.info.logos.small}} class=pluginlist-image>\r\n          <span class=pluginlist-title>{{plugin.name}}</span>\r\n          <span class=pluginlist-version>v{{plugin.info.version}}</span>\r\n        </span>\r\n        <span class="pluginlist-message pluginlist-message--update" ng-show=plugin.hasUpdate ng-click="ctrl.updateAvailable(plugin, $event)" bs-tooltip="\'New version: \' + plugin.latestVersion">\r\n          Update available!\r\n        </span>\r\n        <span class="pluginlist-message pluginlist-message--enable" ng-show="!plugin.enabled && !plugin.hasUpdate">\r\n          Enable now\r\n        </span>\r\n        <span class="pluginlist-message pluginlist-message--no-update" ng-show="plugin.enabled && !plugin.hasUpdate">\r\n          Up to date\r\n        </span>\r\n      </a>\r\n    </div>\r\n    <div class=pluginlist-item ng-show="category.list.length === 0">\r\n      <a class="pluginlist-link pluginlist-link-{{plugin.state}}" href=https://grafana.com/plugins>\r\n        <span class=pluginlist-none-installed>None installed. <span class=pluginlist-emphasis>Browse Grafana.com</span></span>\r\n      </a>\r\n    </div>\r\n  </div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/panel/singlestat/editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=editor-row>\r\n  <div class="section gf-form-group">\r\n    <h5 class=section-heading>Value</h5>\r\n\r\n    <div class=gf-form-inline>\r\n      <div class=gf-form ng-show="ctrl.dataType === \'timeseries\'">\r\n        <label class="gf-form-label width-6">Stat</label>\r\n        <div class="gf-form-select-wrapper width-12">\r\n          <select class=gf-form-input ng-model=ctrl.panel.valueName ng-options="f.value as f.text for f in ctrl.valueNameOptions" ng-change=ctrl.refresh()></select>\r\n        </div>\r\n      </div>\r\n      <div class=gf-form ng-show="ctrl.dataType === \'table\'">\r\n        <label class="gf-form-label width-6">Column</label>\r\n        <div class="gf-form-select-wrapper width-12">\r\n          <select class=gf-form-input ng-model=ctrl.panel.tableColumn ng-options="f for f in ctrl.tableColumnOptions" ng-change=ctrl.refresh()></select>\r\n        </div>\r\n      </div>\r\n      <div class=gf-form>\r\n        <label class="gf-form-label width-6">Font size</label>\r\n        <div class=gf-form-select-wrapper>\r\n          <select class=gf-form-input ng-model=ctrl.panel.valueFontSize ng-options="f for f in ctrl.fontSizes" ng-change=ctrl.render()></select>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=gf-form-inline>\r\n      <div class=gf-form>\r\n        <label class="gf-form-label width-6">Prefix</label>\r\n        <input type=text class="gf-form-input width-12" ng-model=ctrl.panel.prefix ng-change=ctrl.render() ng-model-onblur>\r\n        <label class="gf-form-label width-6">Font size</label>\r\n        <div class=gf-form-select-wrapper>\r\n          <select class=gf-form-input ng-model=ctrl.panel.prefixFontSize ng-options="f for f in ctrl.fontSizes" ng-change=ctrl.render() ng-disabled=!ctrl.canModifyText()></select>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=gf-form>\r\n      <label class="gf-form-label width-6">Postfix</label>\r\n      <input type=text class="gf-form-input width-12" ng-model=ctrl.panel.postfix ng-change=ctrl.render() ng-model-onblur>\r\n      <label class="gf-form-label width-6">Font size</label>\r\n      <div class=gf-form-select-wrapper>\r\n        <select class="input-small gf-form-input" ng-model=ctrl.panel.postfixFontSize ng-options="f for f in ctrl.fontSizes" ng-change=ctrl.render() ng-disabled=!ctrl.canModifyText()></select>\r\n      </div>\r\n    </div>\r\n    <div class=gf-form>\r\n      <label class="gf-form-label width-6">Unit</label>\r\n      <div class="gf-form-dropdown-typeahead width-18" ng-model=ctrl.panel.format dropdown-typeahead2=ctrl.unitFormats dropdown-typeahead-on-select=ctrl.setUnitFormat($subItem)></div>\r\n    </div>\r\n    <div class=gf-form>\r\n      <label class="gf-form-label width-6">Decimals</label>\r\n      <input type=number class="gf-form-input width-18" placeholder=auto data-placement=right bs-tooltip="\'Override automatic decimal precision for legend and tooltips\'" ng-model=ctrl.panel.decimals ng-change=ctrl.refresh() ng-model-onblur>\r\n    </div>\r\n  </div>\r\n\r\n  <div class="section gf-form-group" ng-show=!ctrl.panel.ogeAlertEnabled>\r\n    <h5 class=section-heading>Coloring</h5>\r\n    <div class=gf-form-inline>\r\n      <gf-form-switch class=gf-form label-class=width-8 label=Background checked=ctrl.panel.colorBackground on-change=ctrl.render()></gf-form-switch>\r\n      <gf-form-switch class=gf-form label-class=width-6 label=Value checked=ctrl.panel.colorValue on-change=ctrl.render()></gf-form-switch>\r\n    </div>\r\n    <div class=gf-form-inline>\r\n      <gf-form-switch class=gf-form label-class=width-8 label=Prefix checked=ctrl.panel.colorPrefix on-change=ctrl.render() ng-disabled=!ctrl.canModifyText()></gf-form-switch>\r\n      <gf-form-switch class=gf-form label-class=width-6 label=Postfix checked=ctrl.panel.colorPostfix on-change=ctrl.render() ng-disabled=!ctrl.canModifyText()></gf-form-switch>\r\n    </div>\r\n    <div class=gf-form-inline>\r\n      <div class="gf-form max-width-21">\r\n        <label class="gf-form-label width-8">Thresholds\r\n          <tip>Define two threshold values&lt;br /&gt; 50,80 will produce: value &lt; 50 = Green, 50 &lt;= value &lt; 80 = Yellow, value &gt;= 80 = Red</tip>\r\n        </label>\r\n        <input type=text class=gf-form-input ng-model=ctrl.panel.thresholds ng-blur=ctrl.render() placeholder=50,80>\r\n      </div>\r\n    </div>\r\n    <div class=gf-form>\r\n      <label class="gf-form-label width-8">Colors</label>\r\n      <span class=gf-form-label ng-repeat="color in ctrl.panel.colors track by $index">\r\n        <color-picker color=color onchange=ctrl.onColorChange($index)></color-picker>\r\n      </span>\r\n      <span class=gf-form-label>\r\n        <a ng-click=ctrl.invertColorOrder()>\r\n          Invert\r\n        </a>\r\n      </span>\r\n    </div>\r\n  </div>\r\n\r\n  <div class="section gf-form-group">\r\n    <h5 class=section-heading>Spark lines</h5>\r\n    <gf-form-switch class=gf-form label-class=width-9 label=Show checked=ctrl.panel.sparkline.show on-change=ctrl.render()></gf-form-switch>\r\n    <div ng-if=ctrl.panel.sparkline.show>\r\n      <gf-form-switch class=gf-form label-class=width-9 label="Full height" checked=ctrl.panel.sparkline.full on-change=ctrl.render()></gf-form-switch>\r\n      <div class=gf-form>\r\n        <label class="gf-form-label width-9">Line Color</label>\r\n        <span class=gf-form-label>\r\n          <color-picker color=ctrl.panel.sparkline.lineColor onchange=ctrl.onSparklineColorChange></color-picker>\r\n        </span>\r\n      </div>\r\n      <div class=gf-form>\r\n        <label class="gf-form-label width-9">Fill Color</label>\r\n        <span class=gf-form-label>\r\n          <color-picker color=ctrl.panel.sparkline.fillColor onchange=ctrl.onSparklineFillChange></color-picker>\r\n        </span>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class="section gf-form-group">\r\n    <h5 class=section-heading>Gauge</h5>\r\n    <gf-form-switch class=gf-form label-class=width-10 switch-class=max-width-6 label=Show checked=ctrl.panel.gauge.show on-change=ctrl.render()></gf-form-switch>\r\n    <div ng-if=ctrl.panel.gauge.show>\r\n      <div class=gf-form>\r\n        <label class="gf-form-label width-10">Min</label>\r\n        <input type=number class="gf-form-input width-6" placeholder=0 data-placement=right ng-model=ctrl.panel.gauge.minValue ng-change=ctrl.refresh() ng-model-onblur>\r\n        <label class="gf-form-label alert-state-critical" ng-show=ctrl.invalidGaugeRange>\r\n          &nbsp; <i class="fa fa-warning"></i>\r\n          Min value is bigger than max.\r\n        </label>\r\n      </div>\r\n      <div class=gf-form>\r\n        <label class="gf-form-label width-10">Max</label>\r\n        <input type=number class="gf-form-input width-6" placeholder=0 data-placement=right ng-model=ctrl.panel.gauge.maxValue ng-change=ctrl.refresh() ng-model-onblur>\r\n      </div>\r\n      <gf-form-switch class=gf-form label-class=width-10 switch-class=max-width-6 label="Threshold labels" checked=ctrl.panel.gauge.thresholdLabels on-change=ctrl.render()></gf-form-switch>\r\n      <gf-form-switch class=gf-form label-class=width-10 switch-class=max-width-6 label="Threshold markers" checked=ctrl.panel.gauge.thresholdMarkers on-change=ctrl.render()></gf-form-switch>\r\n    </div>\r\n  </div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/panel/singlestat/mappings.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=editor-row>\r\n  <div class=gf-form-group>\r\n    <div class=gf-form>\r\n        <span class=gf-form-label>\r\n          Type\r\n        </span>\r\n        <div class=gf-form-select-wrapper>\r\n          <select class=gf-form-input ng-model=ctrl.panel.mappingType ng-options="f.value as f.name for f in ctrl.panel.mappingTypes" ng-change=ctrl.render()></select>\r\n        </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n<div class=editor-row ng-if="ctrl.panel.mappingType==1">\r\n  <h5 class=page-heading>Set value mappings</h5>\r\n  <div class=gf-form-group>\r\n    <div class=gf-form ng-repeat="map in ctrl.panel.valueMaps">\r\n      <span class=gf-form-label>\r\n        <i class="fa fa-remove pointer" ng-click=ctrl.removeValueMap(map)></i>\r\n      </span>\r\n      <input type=text ng-model=map.value placeholder=value class="gf-form-input max-width-6" ng-blur=ctrl.render()>\r\n      <span class=gf-form-label>\r\n        <i class="fa fa-arrow-right"></i>\r\n      </span>\r\n      <input type=text placeholder=text ng-model=map.text class="gf-form-input max-width-8" ng-blur=ctrl.render()>\r\n    </div>\r\n\r\n    <div class=gf-form-button-row>\r\n      <button class="btn btn-inverse" ng-click=ctrl.addValueMap();>\r\n        <i class="fa fa-plus"></i>\r\n        Add a value mapping\r\n      </button>\r\n    </div>\r\n  </div>\r\n</div>\r\n<div class=editor-row ng-if="ctrl.panel.mappingType==2">\r\n  <h5 class=page-heading>Set range mappings</h5>\r\n  <div class=gf-form-group>\r\n    <div class=gf-form ng-repeat="rangeMap in ctrl.panel.rangeMaps">\r\n        <span class=gf-form-label>\r\n          <i class="fa fa-remove pointer" ng-click=ctrl.removeRangeMap(rangeMap)></i>\r\n        </span>\r\n        <span class=gf-form-label>From</span>\r\n        <input type=text ng-model=rangeMap.from class="gf-form-input max-width-6" ng-blur=ctrl.render()>\r\n        <span class=gf-form-label>To</span>\r\n        <input type=text ng-model=rangeMap.to class="gf-form-input max-width-6" ng-blur=ctrl.render()>\r\n        <span class=gf-form-label>Text</span>\r\n        <input type=text ng-model=rangeMap.text class="gf-form-input max-width-8" ng-blur=ctrl.render()>\r\n    </div>\r\n\r\n    <div class=gf-form-button-row>\r\n      <button class="btn btn-inverse" ng-click=ctrl.addRangeMap()>\r\n        <i class="fa fa-plus"></i>\r\n        Add a range mapping\r\n      </button>\r\n    </div>\r\n  </div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/panel/singlestat/module.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,"<div class=singlestat-panel></div>\r\n<audio class=audio-obj src=./public/vedio/alarm.wav></audio>  \r\n\r\n\r\n\r\n")}]),t.exports=r},function(t,e){var r="public/app/plugins/panel/singlestat/tips.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=editor-row>\r\n  <div class=gf-form-group>\r\n    <div class=gf-form>\r\n      <span class=gf-form-label>\r\n        提示类型\r\n      </span>\r\n      <div class=gf-form-select-wrapper>\r\n        <select class=gf-form-input ng-model=ctrl.panel.tipType ng-options="f.value as f.name for f in ctrl.panel.tipTypes" ng-change=ctrl.render()></select>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=editor-row ng-if="ctrl.panel.tipType==1">\r\n    <h5 class=page-heading>设置文本提示</h5>\r\n    <div class=gf-form-group>\r\n      <div class=gf-form>\r\n        <span class=gf-form-label style=line-height:4>\r\n          <i class="fa fa-remove pointer" ng-click=ctrl.removeTextTip()></i>\r\n        </span>\r\n        <textarea class="gf-form-input width-25" rows=3 ng-model=ctrl.panel.textTips placeholder=文本提示 class="gf-form-input max-width-6" ng-blur="ctrl.render() ">\r\n      </textarea></div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=editor-row ng-if="ctrl.panel.tipType==2">\r\n    <h5 class=page-heading>设置kks提示</h5>\r\n    <div class=gf-form-group>\r\n      <div class=gf-form ng-repeat="tip in ctrl.panel.kksTips">\r\n        <span class=gf-form-label>\r\n          <i class="fa fa-remove pointer" ng-click=ctrl.removeKKSTip(tip)></i>\r\n        </span>\r\n        <input type=text ng-model=tip.value placeholder=kks class="gf-form-input width-25" ng-blur=ctrl.render()>\r\n        <span class=gf-form-label>别名</span>\r\n        <input type=text placeholder=标签 ng-model=tip.alias class="gf-form-input width-10" ng-blur=ctrl.render()>\r\n      </div>\r\n\r\n      <div class=gf-form-button-row>\r\n        <button class="btn btn-inverse" ng-click=ctrl.addKKSTip()>\r\n          <i class="fa fa-plus"></i>\r\n          Add a kks tip\r\n        </button>\r\n      </div>\r\n    </div>\r\n\r\n  </div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/panel/table/column_options.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=edit-tab-with-sidemenu>\r\n  <aside class=edit-sidemenu-aside>\r\n    <ul class=edit-sidemenu>\r\n      <li ng-repeat="style in editor.panel.styles" ng-class="{active: editor.activeStyleIndex === $index}">\r\n        <a ng-click="editor.activeStyleIndex = $index">{{style.pattern || \'New rule\'}}</a>\r\n      </li>\r\n      <li>\r\n        <a class=pointer ng-click=editor.addColumnStyle()>\r\n          <i class="fa fa-plus"></i>&nbsp;Add\r\n        </a>\r\n      </li>\r\n    </ul>\r\n  </aside>\r\n\r\n  <div class=edit-tab-content ng-repeat="style in editor.panel.styles" ng-if="editor.activeStyleIndex === $index" ng-init="styleIndex = $index">\r\n\r\n    <div class="section gf-form-group">\r\n      <h5 class=section-heading>Options</h5>\r\n      <div class=gf-form-inline>\r\n        <div class=gf-form>\r\n          <label class="gf-form-label width-13">Apply to columns named</label>\r\n          <input type=text placeholder="Name or regex" class="gf-form-input width-13" ng-model=style.pattern bs-tooltip="\'Specify regex using /my.*regex/ syntax\'" bs-typeahead=editor.getColumnNames ng-blur=editor.render() data-min-length=0 data-items=100 ng-model-onblur data-placement=right>\r\n        </div>\r\n      </div>\r\n      <div class=gf-form ng-if="style.type !== \'hidden\'">\r\n        <label class="gf-form-label width-13">Column Header</label>\r\n        <input type=text class="gf-form-input width-13" ng-model=style.alias ng-change=editor.render() ng-model-onblur placeholder="Override header label">\r\n      </div>\r\n      <gf-form-switch class=gf-form label-class=width-13 label="Render value as link" checked=style.link change=editor.render()></gf-form-switch>\r\n    </div>\r\n\r\n    <div class="section gf-form-group">\r\n      <h5 class=section-heading>Type</h5>\r\n\r\n      <div class=gf-form>\r\n        <label class="gf-form-label width-11">Type</label>\r\n        <div class="gf-form-select-wrapper width-16">\r\n          <select class=gf-form-input ng-model=style.type ng-options="c.value as c.text for c in editor.columnTypes" ng-change=editor.render()></select>\r\n        </div>\r\n      </div>\r\n      <div class=gf-form ng-if="style.type === \'date\'">\r\n        <label class="gf-form-label width-11">Date Format</label>\r\n        <gf-form-dropdown model=style.dateFormat css-class="gf-form-input width-16" lookup-text=true get-options=editor.dateFormats on-change=editor.render() allow-custom=true>\r\n        </gf-form-dropdown>\r\n      </div>\r\n\r\n      <div ng-if="style.type === \'string\'">\r\n        <gf-form-switch class=gf-form label-class=width-11 ng-if="style.type === \'string\'" label="Sanitize HTML" checked=style.sanitize change=editor.render()></gf-form-switch>\r\n      </div>\r\n      <div ng-if="style.type === \'string\'">\r\n        <gf-form-switch class=gf-form label-class=width-11 ng-if="style.type === \'string\'" label="Preserve Formatting" checked=style.preserveFormat change=editor.render()></gf-form-switch>\r\n      </div>\r\n\r\n      <div ng-if="style.type === \'number\'">\r\n        <div class=gf-form>\r\n          <label class="gf-form-label width-11">Unit</label>\r\n          <div class="gf-form-dropdown-typeahead width-16" ng-model=style.unit dropdown-typeahead2=editor.unitFormats dropdown-typeahead-on-select="editor.setUnitFormat(style, $subItem)"></div>\r\n        </div>\r\n        <div class=gf-form>\r\n          <label class="gf-form-label width-11">Decimals</label>\r\n          <input type=number class="gf-form-input width-4" data-placement=right ng-model=style.decimals ng-change=editor.render() ng-model-onblur>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class="section gf-form-group" ng-if="style.type === \'string\'">\r\n      <h5 class=section-heading>Value Mappings</h5>\r\n      <div class=editor-row>\r\n        <div class=gf-form-group>\r\n          <div class=gf-form>\r\n            <span class=gf-form-label>\r\n              Type\r\n            </span>\r\n            <div class=gf-form-select-wrapper>\r\n              <select class=gf-form-input ng-model=style.mappingType ng-options="c.value as c.text for c in editor.mappingTypes" ng-change=editor.render()></select>\r\n            </div>\r\n          </div>\r\n          <div class=gf-form-group ng-if="style.mappingType==1">\r\n            <div class=gf-form ng-repeat="map in style.valueMaps">\r\n              <span class=gf-form-label>\r\n                <i class="fa fa-remove pointer" ng-click="editor.removeValueMap(style, $index)"></i>\r\n              </span>\r\n              <input type=text class="gf-form-input max-width-6" ng-model=map.value placeholder=Value ng-blur=editor.render()>\r\n              <label class=gf-form-label>\r\n                <i class="fa fa-arrow-right"></i>\r\n              </label>\r\n              <input type=text class="gf-form-input max-width-8" ng-model=map.text placeholder=Text ng-blur=editor.render()>\r\n            </div>\r\n            <div class=gf-form>\r\n              <label class=gf-form-label>\r\n                <a class=pointer ng-click=editor.addValueMap(style)><i class="fa fa-plus"></i></a>\r\n              </label>\r\n            </div>\r\n          </div>\r\n          <div class=gf-form-group ng-if="style.mappingType==2">\r\n            <div class=gf-form ng-repeat="rangeMap in style.rangeMaps">\r\n              <span class=gf-form-label>\r\n                <i class="fa fa-remove pointer" ng-click="editor.removeRangeMap(style, $index)"></i>\r\n              </span>\r\n              <span class=gf-form-label>From</span>\r\n              <input type=text ng-model=rangeMap.from class="gf-form-input max-width-6" ng-blur=editor.render()>\r\n              <span class=gf-form-label>To</span>\r\n              <input type=text ng-model=rangeMap.to class="gf-form-input max-width-6" ng-blur=editor.render()>\r\n              <span class=gf-form-label>Text</span>\r\n              <input type=text ng-model=rangeMap.text class="gf-form-input max-width-8" ng-blur=editor.render()>\r\n            </div>\r\n            <div class=gf-form>\r\n              <label class=gf-form-label>\r\n                <a class=pointer ng-click=editor.addRangeMap(style)><i class="fa fa-plus"></i></a>\r\n              </label>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class="section gf-form-group" ng-if="[\'number\', \'string\'].indexOf(style.type) !== -1">\r\n      <h5 class=section-heading>Thresholds</h5>\r\n      <div class=gf-form>\r\n        <label class="gf-form-label width-8">Thresholds\r\n          <tip>Comma separated values</tip>\r\n        </label>\r\n        <input type=text class="gf-form-input width-10" ng-model=style.thresholds placeholder=50,80 ng-blur=editor.render() array-join>\r\n      </div>\r\n      <div class=gf-form>\r\n        <label class="gf-form-label width-8">Color Mode</label>\r\n        <div class="gf-form-select-wrapper width-10">\r\n          <select class=gf-form-input ng-model=style.colorMode ng-options="c.value as c.text for c in editor.colorModes" ng-change=editor.render()></select>\r\n        </div>\r\n      </div>\r\n      <div class=gf-form>\r\n        <label class="gf-form-label width-8">Colors</label>\r\n        <span class=gf-form-label>\r\n          <color-picker color=style.colors[0] onchange=editor.onColorChange($index,0)></color-picker>\r\n        </span>\r\n        <span class=gf-form-label>\r\n          <color-picker color=style.colors[1] onchange=editor.onColorChange($index,1)></color-picker>\r\n        </span>\r\n        <span class=gf-form-label>\r\n          <color-picker color=style.colors[2] onchange=editor.onColorChange($index,2)></color-picker>\r\n        </span>\r\n        <div class=gf-form-label>\r\n          <a class=pointer ng-click=editor.invertColorOrder($index)>Invert</a>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class="section gf-form-group" ng-if=style.link>\r\n      <h5 class=section-heading>Link</h5>\r\n      <div class=gf-form>\r\n        <label class="gf-form-label width-9">\r\n          Url\r\n          <info-popover mode=right-normal>\r\n            <p>Specify an URL (relative or absolute)</p>\r\n            <span>\r\n              Use special variables to specify cell values:\r\n              <br>\r\n              <em>${__cell}</em> refers to current cell value\r\n              <br>\r\n              <em>${__cell_n}</em> refers to Nth column value in current row. Column indexes are started from 0. For instance,\r\n              <em>${__cell_1}</em> refers to second column\'s value.\r\n              <br>\r\n              <em>${__cell:raw}</em> syntax. By default values are URI encoded. If the value is a complete URL you can disable all encoding using\r\n            </span>\r\n          </info-popover>\r\n        </label>\r\n        <input type=text class="gf-form-input width-29" ng-model=style.linkUrl ng-blur=editor.render() ng-model-onblur data-placement=right>\r\n      </div>\r\n      <div class=gf-form>\r\n        <label class="gf-form-label width-9">\r\n          Tooltip\r\n          <info-popover mode=right-normal>\r\n            <p>Specify text for link tooltip.</p>\r\n            <span>\r\n              This title appears when user hovers pointer over the cell with link. Use the same variables as for URL.\r\n            </span>\r\n          </info-popover></label>\r\n        <input type=text class="gf-form-input width-29" ng-model=style.linkTooltip ng-blur=editor.render() ng-model-onblur data-placement=right>\r\n      </div>\r\n      <gf-form-switch class=gf-form label-class=width-9 label="Open in new tab" checked=style.linkTargetBlank></gf-form-switch>\r\n      <gf-form-switch class=gf-form label-class=width-9 label=超级匹配 checked=style.linkSuperMatch></gf-form-switch>\r\n    </div>\r\n\r\n    <div class="section gf-form-group" ng-if=style.linkSuperMatch>\r\n      <h5 class=section-heading>超级匹配\r\n        <i class="grafana-tip fa fa-question-circle ng-scope" bs-tooltip="\'超级匹配: 可以匹配同一行任意一列的值，作为一个变量($__superM_params_n)传入url或Tooltip中。\'" data-original-title="" title=""></i>\r\n      </h5>\r\n      <div class="section gf-form-group" ng-repeat="matchCol in style.matchCol track by $index" ng-init="matchColIndex = $index">\r\n        <div class=gf-form-inline>\r\n            <div class=gf-form>\r\n              <label class="gf-form-label width-11">匹配列</label>\r\n              <div class="gf-form-select-wrapper width-16">\r\n                <select class=gf-form-input ng-model=matchCol.whichColumn ng-options="c.text as c.title for c in editor.panelCtrl.table.columns" ng-change=editor.render()></select>\r\n              </div>\r\n              <span class=gf-form-label ng-if="style.matchCol.length>1">\r\n                  <i class="fa fa-remove pointer" ng-click="editor.removeMatchColumn(styleIndex, matchColIndex)"></i>&nbsp;删除匹配列\r\n              </span>\r\n              <span class=gf-form-label ng-if="style.matchCol.length-1 === matchColIndex">\r\n                  <i class="fa fa-plus pointer" ng-click=editor.addMatchColumn(styleIndex)></i>&nbsp;增加匹配列\r\n              </span>\r\n            </div>\r\n        </div>\r\n        <div class=gf-form-inline ng-repeat="rule in matchCol.matchItems track by $index+20" ng-init="ruleIndex = $index">\r\n              <div class=gf-form>\r\n                <div class="width-2 gf-form-label gf-form-query-letter-cell">\r\n                  <span class=gf-form-query-letter-cell-letter>{{$index+1}}</span>\r\n                </div>\r\n                <input type=text class="gf-form-input width-15" ng-model=rule.matchVal ng-change=editor.render() ng-model-onblur>\r\n                <span class=gf-form-label>\r\n                  <i class="fa fa-arrow-right"></i>\r\n                </span>\r\n                <input ng-model=rule.ValAs type=text class="gf-form-input ng-pristine ng-untouched ng-valid ng-empty width-12" placeholder=无 empty-to-null=1 ng-change=editor.render();>\r\n                <span class=gf-form-label ng-if="matchCol.matchItems.length>1">\r\n                  <i class="fa fa-remove pointer" ng-click="editor.removeMatchValue(styleIndex, matchColIndex, ruleIndex)"></i>\r\n                </span>\r\n                <span class=gf-form-label ng-if="matchCol.matchItems.length-1 === ruleIndex">\r\n                  <i class="fa fa-plus pointer" ng-click="editor.addMatchValue(styleIndex, matchColIndex)"></i>\r\n                </span>\r\n              </div>      \r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=clearfix></div>\r\n\r\n    <button class="btn btn-danger btn-small" ng-click=editor.removeColumnStyle(style)>\r\n      <i class="fa fa-trash"></i> Remove Rule\r\n    </button>\r\n    <br/>\r\n    <br/>\r\n\r\n  </div>\r\n</div>')}]),t.exports=r},function(t,e){var r="public/app/plugins/panel/table/editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<div class=editor-row>\r\n\t<div class="section gf-form-group">\r\n\t\t<h5 class=section-heading>Data</h5>\r\n    <div class=gf-form>\r\n      <label class="gf-form-label width-10">Table Transform</label>\r\n      <div class="gf-form-select-wrapper max-width-15">\r\n        <select class=gf-form-input ng-model=editor.panel.transform ng-options="k as v.description for (k, v) in editor.transformers" ng-change=editor.transformChanged()></select>\r\n      </div>\r\n    </div>\r\n    <div class=gf-form-inline>\r\n      <div class=gf-form>\r\n        <label class="gf-form-label width-10">Columns</label>\r\n      </div>\r\n\t\t\t<div class=gf-form ng-repeat="column in editor.panel.columns">\r\n\t\t\t\t<label class=gf-form-label>\r\n\t\t\t\t\t<i class="pointer fa fa-remove" ng-click=editor.removeColumn(column)></i>\r\n\t\t\t\t\t<span>{{column.text}}</span>\r\n\t\t\t\t</label>\r\n\t\t\t</div>\r\n\t\t\t<div class=gf-form ng-show=editor.canSetColumns>\r\n\t\t\t\t<metric-segment segment=editor.addColumnSegment get-options=editor.getColumnOptions() on-change=editor.addColumn()></metric-segment>\r\n\t\t\t</div>\r\n\t\t\t<div class=gf-form ng-hide=editor.canSetColumns>\r\n\t\t\t\t<label class=gf-form-label>\r\n\t\t\t\t\tAuto\r\n\t\t\t\t\t<info-popover mode=right-normal ng-if=editor.columnsHelpMessage>\r\n\t\t\t\t\t\t{{editor.columnsHelpMessage}}\r\n\t\t\t\t\t</info-popover>\r\n\t\t\t\t</label>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class="section gf-form-group">\r\n\t\t<h5 class=section-heading>Paging</h5>\r\n    <div class=gf-form>\r\n      <label class="gf-form-label width-8">Rows per page</label>\r\n      <input type=number class="gf-form-input width-7" placeholder=100 data-placement=right ng-model=editor.panel.pageSize ng-change=editor.render() ng-model-onblur>\r\n    </div>\r\n    <gf-form-switch class=gf-form label-class=width-8 switch-class=max-width-7 label=Scroll checked=editor.panel.scroll on-change=editor.render()></gf-form-switch>\r\n    <div class="gf-form max-width-17">\r\n      <label class="gf-form-label width-8">Font size</label>\r\n      <div class="gf-form-select-wrapper width-7">\r\n        <select class=gf-form-input ng-model=editor.panel.fontSize ng-options="f for f in editor.fontSizes" ng-change=editor.render()></select>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/panel/table/module.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'\r\n<div class=table-panel-container>\r\n\t<div class=table-panel-header-bg ng-show=ctrl.table.rows.length></div>\r\n\t<div class=table-panel-scroll ng-show=ctrl.table.rows.length>\r\n\t\t<table class=table-panel-table>\r\n\t\t\t<thead>\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<th ng-repeat="col in ctrl.table.columns" ng-if=!col.hidden>\r\n\t\t\t\t\t\t<div class="table-panel-table-header-inner pointer" ng-click="ctrl.toggleColumnSort(col, $index)">\r\n\t\t\t\t\t\t\t{{col.title}}\r\n\t\t\t\t\t\t\t<span class=table-panel-table-header-controls ng-if=col.sort>\r\n\t\t\t\t\t\t\t\t<i class="fa fa-caret-down" ng-show=col.desc></i>\r\n\t\t\t\t\t\t\t\t<i class="fa fa-caret-up" ng-hide=col.desc></i>\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</th>\r\n\t\t\t\t</tr>\r\n\t\t\t</thead>\r\n\t\t\t<tbody>\r\n\t\t\t</tbody>\r\n\t\t</table>\r\n\t</div>\r\n</div>\r\n<div class=datapoints-warning ng-show="ctrl.table.rows.length===0">\r\n\t<span class=small>\r\n\t\tNo data to show <tip>Nothing returned by data query</tip>\r\n\t</span>\r\n</div>\r\n<div class=table-panel-footer>\r\n</div>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/panel/text/editor.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,"<div class=gf-form-group>\r\n\t<div class=gf-form-inline>\r\n\t\t<div class=gf-form>\r\n\t\t\t<span class=gf-form-label>Mode</span>\r\n\t\t\t<span class=gf-form-select-wrapper>\r\n\t\t\t\t<select class=gf-form-input ng-model=ctrl.panel.mode ng-options=\"f for f in ['html','markdown']\"></select>\r\n\t\t\t</span>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n\r\n<h3 class=page-heading>Content</h3>\r\n\r\n<span ng-show=\"ctrl.panel.mode == 'markdown'\">\r\n\t(This area uses <a target=_blank href=http://en.wikipedia.org/wiki/Markdown>Markdown</a>. HTML is not supported)\r\n</span>\r\n\r\n<div class=gf-form-inline>\r\n\t<div class=\"gf-form gf-form--grow\">\r\n\t\t<code-editor content=ctrl.panel.content on-change=ctrl.render() data-mode=markdown data-max-lines=20 code-editor-focus=true>\r\n\t\t</code-editor>\r\n\t</div>\r\n</div>\r\n")}]),t.exports=r},function(t,e){var r="public/app/plugins/panel/text/module.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,'<p class="markdown-html panel-text-content" ng-bind-html=ctrl.content ng-show=ctrl.content>\r\n</p>\r\n')}]),t.exports=r},function(t,e){var r="public/app/plugins/panel/unknown/module.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(r,"<div class=text-center style=padding-top:2rem>\r\n\tUnknown panel type: <strong>{{ctrl.panel.type}}</strong>\r\n</div>\r\n\r\n\r\n")}]),t.exports=r},,function(t,e){ace.define("ace/theme/grafana-dark",["require","exports","module","ace/lib/dom"],function(t,e,r){"use strict";e.isDark=!0,e.cssClass="gf-code-dark",e.cssText=".gf-code-dark .ace_gutter {  background: #2f3129;  color: #8f908a  }  .gf-code-dark .ace_print-margin {  width: 1px;  background: #555651  }  .gf-code-dark {  background-color: #111;  color: #e0e0e0  }  .gf-code-dark .ace_cursor {  color: #f8f8f0  }  .gf-code-dark .ace_marker-layer .ace_selection {  background: #49483e  }  .gf-code-dark.ace_multiselect .ace_selection.ace_start {  box-shadow: 0 0 3px 0px #272822;  }  .gf-code-dark .ace_marker-layer .ace_step {  background: rgb(102, 82, 0)  }  .gf-code-dark .ace_marker-layer .ace_bracket {  margin: -1px 0 0 -1px;  border: 1px solid #49483e  }  .gf-code-dark .ace_marker-layer .ace_active-line {  background: #202020  }  .gf-code-dark .ace_gutter-active-line {  background-color: #272727  }  .gf-code-dark .ace_marker-layer .ace_selected-word {  border: 1px solid #49483e  }  .gf-code-dark .ace_invisible {  color: #52524d  }  .gf-code-dark .ace_entity.ace_name.ace_tag,  .gf-code-dark .ace_keyword,  .gf-code-dark .ace_meta.ace_tag,  .gf-code-dark .ace_storage {  color: #66d9ef  }  .gf-code-dark .ace_punctuation,  .gf-code-dark .ace_punctuation.ace_tag {  color: #fff  }  .gf-code-dark .ace_constant.ace_character,  .gf-code-dark .ace_constant.ace_language,  .gf-code-dark .ace_constant.ace_numeric,  .gf-code-dark .ace_constant.ace_other {  color: #fe85fc  }  .gf-code-dark .ace_invalid {  color: #f8f8f0;  background-color: #f92672  }  .gf-code-dark .ace_invalid.ace_deprecated {  color: #f8f8f0;  background-color: #ae81ff  }  .gf-code-dark .ace_support.ace_constant,  .gf-code-dark .ace_support.ace_function {  color: #59e6e3  }  .gf-code-dark .ace_fold {  background-color: #a6e22e;  border-color: #f8f8f2  }  .gf-code-dark .ace_storage.ace_type,  .gf-code-dark .ace_support.ace_class,  .gf-code-dark .ace_support.ace_type {  font-style: italic;  color: #66d9ef  }  .gf-code-dark .ace_entity.ace_name.ace_function,  .gf-code-dark .ace_entity.ace_other,  .gf-code-dark .ace_entity.ace_other.ace_attribute-name,  .gf-code-dark .ace_variable {  color: #a6e22e  }  .gf-code-dark .ace_variable.ace_parameter {  font-style: italic;  color: #fd971f  }  .gf-code-dark .ace_string {  color: #74e680  }  .gf-code-dark .ace_paren {    color: #f0a842  }  .gf-code-dark .ace_operator {    color: #FFF  }  .gf-code-dark .ace_comment {  color: #75715e  }  .gf-code-dark .ace_indent-guide {  background: url(data:image/png;base64,ivborw0kggoaaaansuheugaaaaeaaaaccayaaaczgbynaaaaekleqvqimwpq0fd0zxbzd/wpaajvaoxesgneaaaaaelftksuqmcc) right repeat-y  }",t("../lib/dom").importCssString(e.cssText,e.cssClass)})},,,,,,,,,,,,,,,,,,function(t,e){!function(){var t=document,e=t.createElement("STYLE"),r="addEventListener"in t,n=function(e,n){r?t.addEventListener(e,n):t.attachEvent("on"+e,n)},a=function(t){e.styleSheet?e.styleSheet.cssText=t:e.innerHTML=t};t.getElementsByTagName("HEAD")[0].appendChild(e),n("mousedown",function(){a(":focus{outline:0 !important}::-moz-focus-inner{border:0;}")}),n("keydown",function(){a("")})}()},,function(t,e,r){var n,a,i;!function(s){"use strict";a=[r(7)],void 0===(i="function"==typeof(n=function(t,e){var r={beforeShow:u,move:u,change:u,show:u,hide:u,color:!1,flat:!1,showInput:!1,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!0,showInitial:!1,showPalette:!1,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:!1,offset:null},n=[],a=!!/msie/i.exec(window.navigator.userAgent),i=function(){function t(t,e){return!!~(""+t).indexOf(e)}var e=document.createElement("div"),r=e.style;return r.cssText="background-color:rgba(0,0,0,.5)",t(r.backgroundColor,"rgba")||t(r.backgroundColor,"hsla")}(),s=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),o=function(){var t="";if(a)for(var e=1;e<=6;e++)t+="<div class='sp-"+e+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",t,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}();function l(e,r,n,a){for(var s=[],o=0;o<e.length;o++){var l=e[o];if(l){var c=tinycolor(l),u=c.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";u+=tinycolor.equals(r,l)?" sp-thumb-active":"";var d=c.toString(a.preferredFormat||"rgb"),p=i?"background-color:"+c.toRgbString():"filter:"+c.toFilter();s.push('<span title="'+d+'" data-color="'+c.toRgbString()+'" class="'+u+'"><span class="sp-thumb-inner" style="'+p+';" /></span>')}else{s.push(t("<div />").append(t('<span data-color="" style="background-color:transparent;" class="sp-clear-display"></span>').attr("title",a.noColorSelectedText)).html())}}return"<div class='sp-cf "+n+"'>"+s.join("")+"</div>"}function c(c,u){var m=function(e,n){var a=t.extend({},r,e);return a.callbacks={move:p(a.move,n),change:p(a.change,n),show:p(a.show,n),hide:p(a.hide,n),beforeShow:p(a.beforeShow,n)},a}(u,c),g=m.flat,v=m.showSelectionPalette,b=m.localStorageKey,y=m.theme,w=m.callbacks,x=function(t,e,r){var n;return function(){var a=this,i=arguments;r&&clearTimeout(n),!r&&n||(n=setTimeout(function(){n=null,t.apply(a,i)},e))}}(jt,10),S=!1,k=!1,C=0,T=0,E=0,_=0,M=0,A=0,P=0,$=0,D=0,O=0,I=1,N=[],F=[],q={},L=m.selectionPalette.slice(0),R=m.maxSelectionSize,j="sp-dragging",U=null,V=c.ownerDocument,B=(V.body,t(c)),Q=!1,H=t(o,V).addClass(y),z=H.find(".sp-picker-container"),G=H.find(".sp-color"),W=H.find(".sp-dragger"),Y=H.find(".sp-hue"),K=H.find(".sp-slider"),J=H.find(".sp-alpha-inner"),X=H.find(".sp-alpha"),Z=H.find(".sp-alpha-handle"),tt=H.find(".sp-input"),et=H.find(".sp-palette"),rt=H.find(".sp-initial"),nt=H.find(".sp-cancel"),at=H.find(".sp-clear"),it=H.find(".sp-choose"),st=H.find(".sp-palette-toggle"),ot=B.is("input"),lt=ot&&"color"===B.attr("type")&&f(),ct=ot&&!g,ut=ct?t(s).addClass(y).addClass(m.className).addClass(m.replacerClassName):t([]),dt=ct?ut:B,pt=ut.find(".sp-preview-inner"),ht=m.color||ot&&B.val(),ft=!1,mt=m.preferredFormat,gt=mt,vt=!m.showButtons||m.clickoutFiresChange,bt=!ht,yt=m.allowEmpty&&!lt;function wt(){if(m.showPaletteOnly&&(m.showPalette=!0),st.text(m.showPaletteOnly?m.togglePaletteMoreText:m.togglePaletteLessText),m.palette){N=m.palette.slice(0),F=t.isArray(N[0])?N:[N],q={};for(var e=0;e<F.length;e++)for(var r=0;r<F[e].length;r++){var n=tinycolor(F[e][r]).toRgbString();q[n]=!0}}H.toggleClass("sp-flat",g),H.toggleClass("sp-input-disabled",!m.showInput),H.toggleClass("sp-alpha-enabled",m.showAlpha),H.toggleClass("sp-clear-enabled",yt),H.toggleClass("sp-buttons-disabled",!m.showButtons),H.toggleClass("sp-palette-buttons-disabled",!m.togglePaletteOnly),H.toggleClass("sp-palette-disabled",!m.showPalette),H.toggleClass("sp-palette-only",m.showPaletteOnly),H.toggleClass("sp-initial-disabled",!m.showInitial),H.addClass(m.className).addClass(m.containerClassName),jt()}function xt(){if(b&&window.localStorage){try{var e=window.localStorage[b].split(",#");e.length>1&&(delete window.localStorage[b],t.each(e,function(t,e){St(e)}))}catch(t){}try{L=window.localStorage[b].split(";")}catch(t){}}}function St(e){if(v){var r=tinycolor(e).toRgbString();if(!q[r]&&-1===t.inArray(r,L))for(L.push(r);L.length>R;)L.shift();if(b&&window.localStorage)try{window.localStorage[b]=L.join(";")}catch(t){}}}function kt(){var e=Nt(),r=t.map(F,function(t,r){return l(t,e,"sp-palette-row sp-palette-row-"+r,m)});xt(),L&&r.push(l(function(){var t=[];if(m.showPalette)for(var e=0;e<L.length;e++){var r=tinycolor(L[e]).toRgbString();q[r]||t.push(L[e])}return t.reverse().slice(0,m.maxSelectionSize)}(),e,"sp-palette-row sp-palette-row-selection",m)),et.html(r.join(""))}function Ct(){if(m.showInitial){var t=ft,e=Nt();rt.html(l([t,e],e,"sp-palette-row-initial",m))}}function Tt(){(T<=0||C<=0||_<=0)&&jt(),k=!0,H.addClass(j),U=null,B.trigger("dragstart.spectrum",[Nt()])}function Et(){k=!1,H.removeClass(j),B.trigger("dragstop.spectrum",[Nt()])}function _t(){var t=tt.val();if(null!==t&&""!==t||!yt){var e=tinycolor(t);e.isValid()?(It(e),Rt(!0)):tt.addClass("sp-validation-error")}else It(null),Rt(!0)}function Mt(){S?Dt():At()}function At(){var e=t.Event("beforeShow.spectrum");S?jt():(B.trigger(e,[Nt()]),!1===w.beforeShow(Nt())||e.isDefaultPrevented()||(!function(){for(var t=0;t<n.length;t++)n[t]&&n[t].hide()}(),S=!0,t(V).bind("keydown.spectrum",Pt),t(V).bind("click.spectrum",$t),t(window).bind("resize.spectrum",x),ut.addClass("sp-active"),H.removeClass("sp-hidden"),jt(),qt(),ft=Nt(),Ct(),w.show(ft),B.trigger("show.spectrum",[ft])))}function Pt(t){27===t.keyCode&&Dt()}function $t(t){2!=t.button&&(k||(vt?Rt(!0):Ot(),Dt()))}function Dt(){S&&!g&&(S=!1,t(V).unbind("keydown.spectrum",Pt),t(V).unbind("click.spectrum",$t),t(window).unbind("resize.spectrum",x),ut.removeClass("sp-active"),H.addClass("sp-hidden"),w.hide(Nt()),B.trigger("hide.spectrum",[Nt()]))}function Ot(){It(ft,!0)}function It(t,e){var r,n;tinycolor.equals(t,Nt())?qt():(!t&&yt?bt=!0:(bt=!1,r=tinycolor(t),n=r.toHsv(),$=n.h%360/360,D=n.s,O=n.v,I=n.a),qt(),r&&r.isValid()&&!e&&(gt=mt||r.getFormat()))}function Nt(t){return t=t||{},yt&&bt?null:tinycolor.fromRatio({h:$,s:D,v:O,a:Math.round(100*I)/100},{format:t.format||gt})}function Ft(){qt(),w.move(Nt()),B.trigger("move.spectrum",[Nt()])}function qt(){tt.removeClass("sp-validation-error"),Lt();var t=tinycolor.fromRatio({h:$,s:1,v:1});G.css("background-color",t.toHexString());var e=gt;I<1&&(0!==I||"name"!==e)&&("hex"!==e&&"hex3"!==e&&"hex6"!==e&&"name"!==e||(e="rgb"));var r=Nt({format:e}),n="";if(pt.removeClass("sp-clear-display"),pt.css("background-color","transparent"),!r&&yt)pt.addClass("sp-clear-display");else{var s=r.toHexString(),o=r.toRgbString();if(i||1===r.alpha?pt.css("background-color",o):(pt.css("background-color","transparent"),pt.css("filter",r.toFilter())),m.showAlpha){var l=r.toRgb();l.a=0;var c=tinycolor(l).toRgbString(),u="linear-gradient(left, "+c+", "+s+")";a?J.css("filter",tinycolor(c).toFilter({gradientType:1},s)):(J.css("background","-webkit-"+u),J.css("background","-moz-"+u),J.css("background","-ms-"+u),J.css("background","linear-gradient(to right, "+c+", "+s+")"))}n=r.toString(e)}m.showInput&&tt.val(n),m.showPalette&&kt(),Ct()}function Lt(){var t=D,e=O;if(yt&&bt)Z.hide(),K.hide(),W.hide();else{Z.show(),K.show(),W.show();var r=t*C,n=T-e*T;r=Math.max(-E,Math.min(C-E,r-E)),n=Math.max(-E,Math.min(T-E,n-E)),W.css({top:n+"px",left:r+"px"});var a=I*M;Z.css({left:a-A/2+"px"});var i=$*_;K.css({top:i-P+"px"})}}function Rt(t){var e=Nt(),r="",n=!tinycolor.equals(e,ft);e&&(r=e.toString(gt),St(e)),ot&&B.val(r),t&&n&&(w.change(e),B.trigger("change",[e]))}function jt(){C=G.width(),T=G.height(),E=W.height(),Y.width(),_=Y.height(),P=K.height(),M=X.width(),A=Z.width(),g||(H.css("position","absolute"),m.offset?H.offset(m.offset):H.offset(function(e,r){var n=e.outerWidth(),a=e.outerHeight(),i=r.outerHeight(),s=e[0].ownerDocument,o=s.documentElement,l=o.clientWidth+t(s).scrollLeft(),c=o.clientHeight+t(s).scrollTop(),u=r.offset();return u.top+=i,u.left-=Math.min(u.left,u.left+n>l&&l>n?Math.abs(u.left+n-l):0),u.top-=Math.min(u.top,u.top+a>c&&c>a?Math.abs(a+i-0):0),u}(H,dt))),Lt(),m.showPalette&&kt(),B.trigger("reflow.spectrum")}function Ut(){Dt(),Q=!0,B.attr("disabled",!0),dt.addClass("sp-disabled")}!function(){a&&H.find("*:not(input)").attr("unselectable","on");wt(),ct&&B.after(ut).hide();yt||at.hide();if(g)B.after(H).hide();else{var e="parent"===m.appendTo?B.parent():t(m.appendTo);1!==e.length&&(e=t("body")),e.append(H)}xt(),dt.bind("click.spectrum touchstart.spectrum",function(e){Q||Mt(),e.stopPropagation(),t(e.target).is("input")||e.preventDefault()}),(B.is(":disabled")||!0===m.disabled)&&Ut();H.click(d),tt.change(_t),tt.bind("paste",function(){setTimeout(_t,1)}),tt.keydown(function(t){13==t.keyCode&&_t()}),nt.text(m.cancelText),nt.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),Ot(),Dt()}),at.attr("title",m.clearText),at.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),bt=!0,Ft(),g&&Rt(!0)}),it.text(m.chooseText),it.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),a&&tt.is(":focus")&&tt.trigger("change"),tt.hasClass("sp-validation-error")||(Rt(!0),Dt())}),st.text(m.showPaletteOnly?m.togglePaletteMoreText:m.togglePaletteLessText),st.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),m.showPaletteOnly=!m.showPaletteOnly,m.showPaletteOnly||g||H.css("left","-="+(z.outerWidth(!0)+5)),wt()}),h(X,function(t,e,r){I=t/M,bt=!1,r.shiftKey&&(I=Math.round(10*I)/10),Ft()},Tt,Et),h(Y,function(t,e){$=parseFloat(e/_),bt=!1,m.showAlpha||(I=1),Ft()},Tt,Et),h(G,function(t,e,r){if(r.shiftKey){if(!U){var n=D*C,a=T-O*T,i=Math.abs(t-n)>Math.abs(e-a);U=i?"x":"y"}}else U=null;var s=!U||"y"===U;(!U||"x"===U)&&(D=parseFloat(t/C)),s&&(O=parseFloat((T-e)/T)),bt=!1,m.showAlpha||(I=1),Ft()},Tt,Et),ht?(It(ht),qt(),gt=mt||tinycolor(ht).format,St(ht)):qt();g&&At();function r(e){return e.data&&e.data.ignore?(It(t(e.target).closest(".sp-thumb-el").data("color")),Ft()):(It(t(e.target).closest(".sp-thumb-el").data("color")),Ft(),Rt(!0),m.hideAfterPaletteSelect&&Dt()),!1}var n=a?"mousedown.spectrum":"click.spectrum touchstart.spectrum";et.delegate(".sp-thumb-el",n,r),rt.delegate(".sp-thumb-el:nth-child(1)",n,{ignore:!0},r)}();var Vt={show:At,hide:Dt,toggle:Mt,reflow:jt,option:function(r,n){if(r===e)return t.extend({},m);if(n===e)return m[r];m[r]=n,wt()},enable:function(){Q=!1,B.attr("disabled",!1),dt.removeClass("sp-disabled")},disable:Ut,offset:function(t){m.offset=t,jt()},set:function(t){It(t),Rt()},get:Nt,destroy:function(){B.show(),dt.unbind("click.spectrum touchstart.spectrum"),H.remove(),ut.remove(),n[Vt.id]=null},container:H};return Vt.id=n.push(Vt)-1,Vt}function u(){}function d(t){t.stopPropagation()}function p(t,e){var r=Array.prototype.slice,n=r.call(arguments,2);return function(){return t.apply(e,n.concat(r.call(arguments)))}}function h(e,r,n,i){r=r||function(){},n=n||function(){},i=i||function(){};var s=document,o=!1,l={},c=0,u=0,d="ontouchstart"in window,p={};function h(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.returnValue=!1}function f(t){if(o){if(a&&s.documentMode<9&&!t.button)return m();var n=t.originalEvent&&t.originalEvent.touches&&t.originalEvent.touches[0],i=n&&n.pageX||t.pageX,p=n&&n.pageY||t.pageY,f=Math.max(0,Math.min(i-l.left,u)),g=Math.max(0,Math.min(p-l.top,c));d&&h(t),r.apply(e,[f,g,t])}}function m(){o&&(t(s).unbind(p),t(s.body).removeClass("sp-dragging"),setTimeout(function(){i.apply(e,arguments)},0)),o=!1}p.selectstart=h,p.dragstart=h,p["touchmove mousemove"]=f,p["touchend mouseup"]=m,t(e).bind("touchstart mousedown",function(r){(r.which?3==r.which:2==r.button)||o||!1!==n.apply(e,arguments)&&(o=!0,c=t(e).height(),u=t(e).width(),l=t(e).offset(),t(s).bind(p),t(s.body).addClass("sp-dragging"),f(r),h(r))})}function f(){return t.fn.spectrum.inputTypeColorSupport()}t.fn.spectrum=function(e,r){if("string"==typeof e){var a=this,i=Array.prototype.slice.call(arguments,1);return this.each(function(){var r=n[t(this).data("spectrum.id")];if(r){var s=r[e];if(!s)throw new Error("Spectrum: no such method: '"+e+"'");"get"==e?a=r.get():"container"==e?a=r.container:"option"==e?a=r.option.apply(r,i):"destroy"==e?(r.destroy(),t(this).removeData("spectrum.id")):s.apply(r,i)}}),a}return this.spectrum("destroy").each(function(){var r=t.extend({},e,t(this).data()),n=c(this,r);t(this).data("spectrum.id",n.id)})},t.fn.spectrum.load=!0,t.fn.spectrum.loadOpts={},t.fn.spectrum.draggable=h,t.fn.spectrum.defaults=r,t.fn.spectrum.inputTypeColorSupport=function e(){if(void 0===e._cachedResult){var r=t("<input type='color' value='!' />")[0];e._cachedResult="color"===r.type&&"!"!==r.value}return e._cachedResult},t.spectrum={},t.spectrum.localization={},t.spectrum.palettes={},t.fn.spectrum.processNativeColorInputs=function(){var e=t("input[type=color]");e.length&&!f()&&e.spectrum({preferredFormat:"hex6"})},function(){var t=/^[\s,#]+/,e=/\s+$/,r=0,n=Math,a=n.round,i=n.min,s=n.max,o=n.random,l=function(o,c){if(o=o||"",c=c||{},o instanceof l)return o;if(!(this instanceof l))return new l(o,c);var u=function(r){var a={r:0,g:0,b:0},o=1,l=!1,c=!1;"string"==typeof r&&(r=function(r){r=r.replace(t,"").replace(e,"").toLowerCase();var n,a=!1;if(E[r])r=E[r],a=!0;else if("transparent"==r)return{r:0,g:0,b:0,a:0,format:"name"};if(n=I.rgb.exec(r))return{r:n[1],g:n[2],b:n[3]};if(n=I.rgba.exec(r))return{r:n[1],g:n[2],b:n[3],a:n[4]};if(n=I.hsl.exec(r))return{h:n[1],s:n[2],l:n[3]};if(n=I.hsla.exec(r))return{h:n[1],s:n[2],l:n[3],a:n[4]};if(n=I.hsv.exec(r))return{h:n[1],s:n[2],v:n[3]};if(n=I.hsva.exec(r))return{h:n[1],s:n[2],v:n[3],a:n[4]};if(n=I.hex8.exec(r))return{a:function(t){return $(t)/255}(n[1]),r:$(n[2]),g:$(n[3]),b:$(n[4]),format:a?"name":"hex8"};if(n=I.hex6.exec(r))return{r:$(n[1]),g:$(n[2]),b:$(n[3]),format:a?"name":"hex"};if(n=I.hex3.exec(r))return{r:$(n[1]+""+n[1]),g:$(n[2]+""+n[2]),b:$(n[3]+""+n[3]),format:a?"name":"hex"};return!1}(r));"object"==typeof r&&(r.hasOwnProperty("r")&&r.hasOwnProperty("g")&&r.hasOwnProperty("b")?(a=function(t,e,r){return{r:255*A(t,255),g:255*A(e,255),b:255*A(r,255)}}(r.r,r.g,r.b),l=!0,c="%"===String(r.r).substr(-1)?"prgb":"rgb"):r.hasOwnProperty("h")&&r.hasOwnProperty("s")&&r.hasOwnProperty("v")?(r.s=O(r.s),r.v=O(r.v),a=function(t,e,r){t=6*A(t,360),e=A(e,100),r=A(r,100);var a=n.floor(t),i=t-a,s=r*(1-e),o=r*(1-i*e),l=r*(1-(1-i)*e),c=a%6;return{r:255*[r,o,s,s,l,r][c],g:255*[l,r,r,o,s,s][c],b:255*[s,s,l,r,r,o][c]}}(r.h,r.s,r.v),l=!0,c="hsv"):r.hasOwnProperty("h")&&r.hasOwnProperty("s")&&r.hasOwnProperty("l")&&(r.s=O(r.s),r.l=O(r.l),a=function(t,e,r){var n,a,i;function s(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+(e-t)*(2/3-r)*6:t}if(t=A(t,360),e=A(e,100),r=A(r,100),0===e)n=a=i=r;else{var o=r<.5?r*(1+e):r+e-r*e,l=2*r-o;n=s(l,o,t+1/3),a=s(l,o,t),i=s(l,o,t-1/3)}return{r:255*n,g:255*a,b:255*i}}(r.h,r.s,r.l),l=!0,c="hsl"),r.hasOwnProperty("a")&&(o=r.a));return o=M(o),{ok:l,format:r.format||c,r:i(255,s(a.r,0)),g:i(255,s(a.g,0)),b:i(255,s(a.b,0)),a:o}}(o);this._originalInput=o,this._r=u.r,this._g=u.g,this._b=u.b,this._a=u.a,this._roundA=a(100*this._a)/100,this._format=c.format||u.format,this._gradientType=c.gradientType,this._r<1&&(this._r=a(this._r)),this._g<1&&(this._g=a(this._g)),this._b<1&&(this._b=a(this._b)),this._ok=u.ok,this._tc_id=r++};function c(t,e,r){t=A(t,255),e=A(e,255),r=A(r,255);var n,a,o=s(t,e,r),l=i(t,e,r),c=(o+l)/2;if(o==l)n=a=0;else{var u=o-l;switch(a=c>.5?u/(2-o-l):u/(o+l),o){case t:n=(e-r)/u+(e<r?6:0);break;case e:n=(r-t)/u+2;break;case r:n=(t-e)/u+4}n/=6}return{h:n,s:a,l:c}}function u(t,e,r){t=A(t,255),e=A(e,255),r=A(r,255);var n,a,o=s(t,e,r),l=i(t,e,r),c=o,u=o-l;if(a=0===o?0:u/o,o==l)n=0;else{switch(o){case t:n=(e-r)/u+(e<r?6:0);break;case e:n=(r-t)/u+2;break;case r:n=(t-e)/u+4}n/=6}return{h:n,s:a,v:c}}function d(t,e,r,n){var i=[D(a(t).toString(16)),D(a(e).toString(16)),D(a(r).toString(16))];return n&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function p(t,e,r,n){var i=[D(function(t){return Math.round(255*parseFloat(t)).toString(16)}(n)),D(a(t).toString(16)),D(a(e).toString(16)),D(a(r).toString(16))];return i.join("")}function h(t,e){e=0===e?0:e||10;var r=l(t).toHsl();return r.s-=e/100,r.s=P(r.s),l(r)}function f(t,e){e=0===e?0:e||10;var r=l(t).toHsl();return r.s+=e/100,r.s=P(r.s),l(r)}function m(t){return l(t).desaturate(100)}function g(t,e){e=0===e?0:e||10;var r=l(t).toHsl();return r.l+=e/100,r.l=P(r.l),l(r)}function v(t,e){e=0===e?0:e||10;var r=l(t).toRgb();return r.r=s(0,i(255,r.r-a(-e/100*255))),r.g=s(0,i(255,r.g-a(-e/100*255))),r.b=s(0,i(255,r.b-a(-e/100*255))),l(r)}function b(t,e){e=0===e?0:e||10;var r=l(t).toHsl();return r.l-=e/100,r.l=P(r.l),l(r)}function y(t,e){var r=l(t).toHsl(),n=(a(r.h)+e)%360;return r.h=n<0?360+n:n,l(r)}function w(t){var e=l(t).toHsl();return e.h=(e.h+180)%360,l(e)}function x(t){var e=l(t).toHsl(),r=e.h;return[l(t),l({h:(r+120)%360,s:e.s,l:e.l}),l({h:(r+240)%360,s:e.s,l:e.l})]}function S(t){var e=l(t).toHsl(),r=e.h;return[l(t),l({h:(r+90)%360,s:e.s,l:e.l}),l({h:(r+180)%360,s:e.s,l:e.l}),l({h:(r+270)%360,s:e.s,l:e.l})]}function k(t){var e=l(t).toHsl(),r=e.h;return[l(t),l({h:(r+72)%360,s:e.s,l:e.l}),l({h:(r+216)%360,s:e.s,l:e.l})]}function C(t,e,r){e=e||6,r=r||30;var n=l(t).toHsl(),a=360/r,i=[l(t)];for(n.h=(n.h-(a*e>>1)+720)%360;--e;)n.h=(n.h+a)%360,i.push(l(n));return i}function T(t,e){e=e||6;for(var r=l(t).toHsv(),n=r.h,a=r.s,i=r.v,s=[],o=1/e;e--;)s.push(l({h:n,s:a,v:i})),i=(i+o)%1;return s}l.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},setAlpha:function(t){return this._a=M(t),this._roundA=a(100*this._a)/100,this},toHsv:function(){var t=u(this._r,this._g,this._b);return{h:360*t.h,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=u(this._r,this._g,this._b),e=a(360*t.h),r=a(100*t.s),n=a(100*t.v);return 1==this._a?"hsv("+e+", "+r+"%, "+n+"%)":"hsva("+e+", "+r+"%, "+n+"%, "+this._roundA+")"},toHsl:function(){var t=c(this._r,this._g,this._b);return{h:360*t.h,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=c(this._r,this._g,this._b),e=a(360*t.h),r=a(100*t.s),n=a(100*t.l);return 1==this._a?"hsl("+e+", "+r+"%, "+n+"%)":"hsla("+e+", "+r+"%, "+n+"%, "+this._roundA+")"},toHex:function(t){return d(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(){return p(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:a(this._r),g:a(this._g),b:a(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+a(this._r)+", "+a(this._g)+", "+a(this._b)+")":"rgba("+a(this._r)+", "+a(this._g)+", "+a(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:a(100*A(this._r,255))+"%",g:a(100*A(this._g,255))+"%",b:a(100*A(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+a(100*A(this._r,255))+"%, "+a(100*A(this._g,255))+"%, "+a(100*A(this._b,255))+"%)":"rgba("+a(100*A(this._r,255))+"%, "+a(100*A(this._g,255))+"%, "+a(100*A(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(_[d(this._r,this._g,this._b,!0)]||!1)},toFilter:function(t){var e="#"+p(this._r,this._g,this._b,this._a),r=e,n=this._gradientType?"GradientType = 1, ":"";if(t){var a=l(t);r=a.toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+n+"startColorstr="+e+",endColorstr="+r+")"},toString:function(t){var e=!!t;t=t||this._format;var r=!1,n=this._a<1&&this._a>=0,a=!e&&n&&("hex"===t||"hex6"===t||"hex3"===t||"name"===t);return a?"name"===t&&0===this._a?this.toName():this.toRgbString():("rgb"===t&&(r=this.toRgbString()),"prgb"===t&&(r=this.toPercentageRgbString()),"hex"!==t&&"hex6"!==t||(r=this.toHexString()),"hex3"===t&&(r=this.toHexString(!0)),"hex8"===t&&(r=this.toHex8String()),"name"===t&&(r=this.toName()),"hsl"===t&&(r=this.toHslString()),"hsv"===t&&(r=this.toHsvString()),r||this.toHexString())},_applyModification:function(t,e){var r=t.apply(null,[this].concat([].slice.call(e)));return this._r=r._r,this._g=r._g,this._b=r._b,this.setAlpha(r._a),this},lighten:function(){return this._applyModification(g,arguments)},brighten:function(){return this._applyModification(v,arguments)},darken:function(){return this._applyModification(b,arguments)},desaturate:function(){return this._applyModification(h,arguments)},saturate:function(){return this._applyModification(f,arguments)},greyscale:function(){return this._applyModification(m,arguments)},spin:function(){return this._applyModification(y,arguments)},_applyCombination:function(t,e){return t.apply(null,[this].concat([].slice.call(e)))},analogous:function(){return this._applyCombination(C,arguments)},complement:function(){return this._applyCombination(w,arguments)},monochromatic:function(){return this._applyCombination(T,arguments)},splitcomplement:function(){return this._applyCombination(k,arguments)},triad:function(){return this._applyCombination(x,arguments)},tetrad:function(){return this._applyCombination(S,arguments)}},l.fromRatio=function(t,e){if("object"==typeof t){var r={};for(var n in t)t.hasOwnProperty(n)&&(r[n]="a"===n?t[n]:O(t[n]));t=r}return l(t,e)},l.equals=function(t,e){return!(!t||!e)&&l(t).toRgbString()==l(e).toRgbString()},l.random=function(){return l.fromRatio({r:o(),g:o(),b:o()})},l.mix=function(t,e,r){r=0===r?0:r||50;var n,a=l(t).toRgb(),i=l(e).toRgb(),s=r/100,o=2*s-1,c=i.a-a.a,u=1-(n=((n=o*c==-1?o:(o+c)/(1+o*c))+1)/2),d={r:i.r*n+a.r*u,g:i.g*n+a.g*u,b:i.b*n+a.b*u,a:i.a*s+a.a*(1-s)};return l(d)},l.readability=function(t,e){var r=l(t),n=l(e),a=r.toRgb(),i=n.toRgb(),s=r.getBrightness(),o=n.getBrightness(),c=Math.max(a.r,i.r)-Math.min(a.r,i.r)+Math.max(a.g,i.g)-Math.min(a.g,i.g)+Math.max(a.b,i.b)-Math.min(a.b,i.b);return{brightness:Math.abs(s-o),color:c}},l.isReadable=function(t,e){var r=l.readability(t,e);return r.brightness>125&&r.color>500},l.mostReadable=function(t,e){for(var r=null,n=0,a=!1,i=0;i<e.length;i++){var s=l.readability(t,e[i]),o=s.brightness>125&&s.color>500,c=s.brightness/125*3+s.color/500;(o&&!a||o&&a&&c>n||!o&&!a&&c>n)&&(a=o,n=c,r=l(e[i]))}return r};var E=l.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},_=l.hexNames=function(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[t[r]]=r);return e}(E);function M(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function A(t,e){(function(t){return"string"==typeof t&&-1!=t.indexOf(".")&&1===parseFloat(t)})(t)&&(t="100%");var r=function(t){return"string"==typeof t&&-1!=t.indexOf("%")}(t);return t=i(e,s(0,parseFloat(t))),r&&(t=parseInt(t*e,10)/100),n.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function P(t){return i(1,s(0,t))}function $(t){return parseInt(t,16)}function D(t){return 1==t.length?"0"+t:""+t}function O(t){return t<=1&&(t=100*t+"%"),t}var I=function(){var t="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)",e="[\\s|\\(]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")\\s*\\)?",r="[\\s|\\(]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")\\s*\\)?";return{rgb:new RegExp("rgb"+e),rgba:new RegExp("rgba"+r),hsl:new RegExp("hsl"+e),hsla:new RegExp("hsla"+r),hsv:new RegExp("hsv"+e),hsva:new RegExp("hsva"+r),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();window.tinycolor=l}(),t(function(){t.fn.spectrum.load&&t.fn.spectrum.processNativeColorInputs()})})?n.apply(e,a):n)||(t.exports=i)}()},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e){ace.define("ace/mode/prometheus_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/text_highlight_rules"],function(t,e,r){"use strict";var n=t("../lib/oop"),a=t("./text_highlight_rules").TextHighlightRules,i=function(){var t=this.createKeywordMapper({"support.function":"abs|absent|ceil|changes|clamp_max|clamp_min|count_scalar|day_of_month|day_of_week|days_in_month|delta|deriv|drop_common_labels|exp|floor|histogram_quantile|holt_winters|hour|idelta|increase|irate|label_replace|ln|log2|log10|minute|month|predict_linear|rate|resets|round|scalar|sort|sort_desc|sqrt|time|vector|year|avg_over_time|min_over_time|max_over_time|sum_over_time|count_over_time|quantile_over_time|stddev_over_time|stdvar_over_time",keyword:"count|count_values|min|max|avg|sum|stddev|stdvar|bottomk|topk|quantile","constant.language":"true|false|null|__name__|job"},"identifier",!0);this.$rules={start:[{token:"string",regex:/"(?:[^"\\]|\\.)*?"/},{token:"string",regex:"'.*?'"},{token:"constant.numeric",regex:"[-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b"},{token:"constant.language",regex:"\\d+[smhdwy]"},{token:"keyword.operator.binary",regex:"\\+|\\-|\\*|\\/|%|\\^|==|!=|<=|>=|<|>|and|or|unless"},{token:"keyword.other",regex:"keep_common|offset|bool"},{token:"keyword.control",regex:"by|without|on|ignoring|group_left|group_right",next:"start-label-list-matcher"},{token:"variable",regex:"\\$[A-Za-z0-9_]+"},{token:t,regex:"[a-zA-Z_:][a-zA-Z0-9_:]*"},{token:"paren.lparen",regex:"[[(]"},{token:"paren.lparen.label-matcher",regex:"{",next:"start-label-matcher"},{token:"paren.rparen",regex:"[\\])]"},{token:"paren.rparen.label-matcher",regex:"}"},{token:"text",regex:"\\s+"}],"start-label-matcher":[{token:"entity.name.tag.label-matcher",regex:"[a-zA-Z_][a-zA-Z0-9_]*"},{token:"keyword.operator.label-matcher",regex:"=~|=|!~|!="},{token:"string.quoted.label-matcher",regex:"\"[^\"]*\"|'[^']*'"},{token:"punctuation.operator.label-matcher",regex:","},{token:"paren.rparen.label-matcher",regex:"}",next:"start"}],"start-label-list-matcher":[{token:"paren.lparen.label-list-matcher",regex:"[(]"},{token:"entity.name.tag.label-list-matcher",regex:"[a-zA-Z_][a-zA-Z0-9_]*"},{token:"punctuation.operator.label-list-matcher",regex:","},{token:"paren.rparen.label-list-matcher",regex:"[)]",next:"start"}]},this.normalizeRules()};n.inherits(i,a),e.PrometheusHighlightRules=i}),ace.define("ace/mode/prometheus_completions",["require","exports","module","ace/token_iterator","ace/lib/lang"],function(t,e,r){"use strict";var n=t("../lib/lang"),a=["by","without","keep_common","offset","bool","and","or","unless","ignoring","on","group_left","group_right","count","count_values","min","max","avg","sum","stddev","stdvar","bottomk","topk","quantile"].map(function(t){return{caption:t,value:t,meta:"keyword",score:Number.MAX_VALUE}});var i=[{name:"abs()",value:"abs",def:"abs(v instant-vector)",docText:"Returns the input vector with all sample values converted to their absolute value."},{name:"absent()",value:"absent",def:"absent(v instant-vector)",docText:"Returns an empty vector if the vector passed to it has any elements and a 1-element vector with the value 1 if the vector passed to it has no elements. This is useful for alerting on when no time series exist for a given metric name and label combination."},{name:"ceil()",value:"ceil",def:"ceil(v instant-vector)",docText:"Rounds the sample values of all elements in `v` up to the nearest integer."},{name:"changes()",value:"changes",def:"changes(v range-vector)",docText:"For each input time series, `changes(v range-vector)` returns the number of times its value has changed within the provided time range as an instant vector."},{name:"clamp_max()",value:"clamp_max",def:"clamp_max(v instant-vector, max scalar)",docText:"Clamps the sample values of all elements in `v` to have an upper limit of `max`."},{name:"clamp_min()",value:"clamp_min",def:"clamp_min(v instant-vector, min scalar)",docText:"Clamps the sample values of all elements in `v` to have a lower limit of `min`."},{name:"count_scalar()",value:"count_scalar",def:"count_scalar(v instant-vector)",docText:"Returns the number of elements in a time series vector as a scalar. This is in contrast to the `count()` aggregation operator, which always returns a vector (an empty one if the input vector is empty) and allows grouping by labels via a `by` clause."},{name:"day_of_month()",value:"day_of_month",def:"day_of_month(v=vector(time()) instant-vector)",docText:"Returns the day of the month for each of the given times in UTC. Returned values are from 1 to 31."},{name:"day_of_week()",value:"day_of_week",def:"day_of_week(v=vector(time()) instant-vector)",docText:"Returns the day of the week for each of the given times in UTC. Returned values are from 0 to 6, where 0 means Sunday etc."},{name:"days_in_month()",value:"days_in_month",def:"days_in_month(v=vector(time()) instant-vector)",docText:"Returns number of days in the month for each of the given times in UTC. Returned values are from 28 to 31."},{name:"delta()",value:"delta",def:"delta(v range-vector)",docText:"Calculates the difference between the first and last value of each time series element in a range vector `v`, returning an instant vector with the given deltas and equivalent labels. The delta is extrapolated to cover the full time range as specified in the range vector selector, so that it is possible to get a non-integer result even if the sample values are all integers."},{name:"deriv()",value:"deriv",def:"deriv(v range-vector)",docText:"Calculates the per-second derivative of the time series in a range vector `v`, using simple linear regression."},{name:"drop_common_labels()",value:"drop_common_labels",def:"drop_common_labels(instant-vector)",docText:"Drops all labels that have the same name and value across all series in the input vector."},{name:"exp()",value:"exp",def:"exp(v instant-vector)",docText:"Calculates the exponential function for all elements in `v`.\nSpecial cases are:\n* `Exp(+Inf) = +Inf` \n* `Exp(NaN) = NaN`"},{name:"floor()",value:"floor",def:"floor(v instant-vector)",docText:"Rounds the sample values of all elements in `v` down to the nearest integer."},{name:"histogram_quantile()",value:"histogram_quantile",def:"histogram_quantile(φ float, b instant-vector)",docText:"Calculates the φ-quantile (0 ≤ φ ≤ 1) from the buckets `b` of a histogram. The samples in `b` are the counts of observations in each bucket. Each sample must have a label `le` where the label value denotes the inclusive upper bound of the bucket. (Samples without such a label are silently ignored.) The histogram metric type automatically provides time series with the `_bucket` suffix and the appropriate labels."},{name:"holt_winters()",value:"holt_winters",def:"holt_winters(v range-vector, sf scalar, tf scalar)",docText:"Produces a smoothed value for time series based on the range in `v`. The lower the smoothing factor `sf`, the more importance is given to old data. The higher the trend factor `tf`, the more trends in the data is considered. Both `sf` and `tf` must be between 0 and 1."},{name:"hour()",value:"hour",def:"hour(v=vector(time()) instant-vector)",docText:"Returns the hour of the day for each of the given times in UTC. Returned values are from 0 to 23."},{name:"idelta()",value:"idelta",def:"idelta(v range-vector)",docText:"Calculates the difference between the last two samples in the range vector `v`, returning an instant vector with the given deltas and equivalent labels."},{name:"increase()",value:"increase",def:"increase(v range-vector)",docText:"Calculates the increase in the time series in the range vector. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for. The increase is extrapolated to cover the full time range as specified in the range vector selector, so that it is possible to get a non-integer result even if a counter increases only by integer increments."},{name:"irate()",value:"irate",def:"irate(v range-vector)",docText:"Calculates the per-second instant rate of increase of the time series in the range vector. This is based on the last two data points. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for."},{name:"label_replace()",value:"label_replace",def:"label_replace(v instant-vector, dst_label string, replacement string, src_label string, regex string)",docText:"For each timeseries in `v`, `label_replace(v instant-vector, dst_label string, replacement string, src_label string, regex string)`  matches the regular expression `regex` against the label `src_label`.  If it matches, then the timeseries is returned with the label `dst_label` replaced by the expansion of `replacement`. `$1` is replaced with the first matching subgroup, `$2` with the second etc. If the regular expression doesn't match then the timeseries is returned unchanged."},{name:"ln()",value:"ln",def:"ln(v instant-vector)",docText:"calculates the natural logarithm for all elements in `v`.\nSpecial cases are:\n * `ln(+Inf) = +Inf`\n * `ln(0) = -Inf`\n * `ln(x < 0) = NaN`\n * `ln(NaN) = NaN`"},{name:"log2()",value:"log2",def:"log2(v instant-vector)",docText:"Calculates the binary logarithm for all elements in `v`. The special cases are equivalent to those in `ln`."},{name:"log10()",value:"log10",def:"log10(v instant-vector)",docText:"Calculates the decimal logarithm for all elements in `v`. The special cases are equivalent to those in `ln`."},{name:"minute()",value:"minute",def:"minute(v=vector(time()) instant-vector)",docText:"Returns the minute of the hour for each of the given times in UTC. Returned values are from 0 to 59."},{name:"month()",value:"month",def:"month(v=vector(time()) instant-vector)",docText:"Returns the month of the year for each of the given times in UTC. Returned values are from 1 to 12, where 1 means January etc."},{name:"predict_linear()",value:"predict_linear",def:"predict_linear(v range-vector, t scalar)",docText:"Predicts the value of time series `t` seconds from now, based on the range vector `v`, using simple linear regression."},{name:"rate()",value:"rate",def:"rate(v range-vector)",docText:"Calculates the per-second average rate of increase of the time series in the range vector. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for. Also, the calculation extrapolates to the ends of the time range, allowing for missed scrapes or imperfect alignment of scrape cycles with the range's time period."},{name:"resets()",value:"resets",def:"resets(v range-vector)",docText:"For each input time series, `resets(v range-vector)` returns the number of counter resets within the provided time range as an instant vector. Any decrease in the value between two consecutive samples is interpreted as a counter reset."},{name:"round()",value:"round",def:"round(v instant-vector, to_nearest=1 scalar)",docText:"Rounds the sample values of all elements in `v` to the nearest integer. Ties are resolved by rounding up. The optional `to_nearest` argument allows specifying the nearest multiple to which the sample values should be rounded. This multiple may also be a fraction."},{name:"scalar()",value:"scalar",def:"scalar(v instant-vector)",docText:"Given a single-element input vector, `scalar(v instant-vector)` returns the sample value of that single element as a scalar. If the input vector does not have exactly one element, `scalar` will return `NaN`."},{name:"sort()",value:"sort",def:"sort(v instant-vector)",docText:"Returns vector elements sorted by their sample values, in ascending order."},{name:"sort_desc()",value:"sort_desc",def:"sort_desc(v instant-vector)",docText:"Returns vector elements sorted by their sample values, in descending order."},{name:"sqrt()",value:"sqrt",def:"sqrt(v instant-vector)",docText:"Calculates the square root of all elements in `v`."},{name:"time()",value:"time",def:"time()",docText:"Returns the number of seconds since January 1, 1970 UTC. Note that this does not actually return the current time, but the time at which the expression is to be evaluated."},{name:"vector()",value:"vector",def:"vector(s scalar)",docText:"Returns the scalar `s` as a vector with no labels."},{name:"year()",value:"year",def:"year(v=vector(time()) instant-vector)",docText:"Returns the year for each of the given times in UTC."},{name:"avg_over_time()",value:"avg_over_time",def:"avg_over_time(range-vector)",docText:"The average value of all points in the specified interval."},{name:"min_over_time()",value:"min_over_time",def:"min_over_time(range-vector)",docText:"The minimum value of all points in the specified interval."},{name:"max_over_time()",value:"max_over_time",def:"max_over_time(range-vector)",docText:"The maximum value of all points in the specified interval."},{name:"sum_over_time()",value:"sum_over_time",def:"sum_over_time(range-vector)",docText:"The sum of all values in the specified interval."},{name:"count_over_time()",value:"count_over_time",def:"count_over_time(range-vector)",docText:"The count of all values in the specified interval."},{name:"quantile_over_time()",value:"quantile_over_time",def:"quantile_over_time(scalar, range-vector)",docText:"The φ-quantile (0 ≤ φ ≤ 1) of the values in the specified interval."},{name:"stddev_over_time()",value:"stddev_over_time",def:"stddev_over_time(range-vector)",docText:"The population standard deviation of the values in the specified interval."},{name:"stdvar_over_time()",value:"stdvar_over_time",def:"stdvar_over_time(range-vector)",docText:"The population standard variance of the values in the specified interval."}].map(function(t){return{caption:t.name,value:t.value,docHTML:function(t){var e=n.escapeHTML(t.docText);return e=function(t){return t=(t=t.replace(/```(.+)```/,"<pre>$1</pre>")).replace(/`([^`]+)`/,"<code>$1</code>")}(function(t,e){for(var r=[],n=0,a=0,i=e=e||60,s="",o=0;o<t.length;o++)" "===t[o]?n=o:o>=i&&0!=n&&(s=t.slice(a,n),r.push(s),a=n+1,i=o+e,n=0);return s=t.slice(a),r.push(s),r.join("&nbsp<br>")}(e,40)),["<b>",n.escapeHTML(t.def),"</b>","<hr></hr>",e,"<br>&nbsp"].join("")}(t),meta:"function",score:Number.MAX_VALUE}}),s=function(){};(function(){this.getCompletions=function(t,e,r,n,s){var o=e.getTokenAt(r.row,r.column);if("entity.name.tag.label-matcher"===o.type||"string.quoted.label-matcher"===o.type||"entity.name.tag.label-list-matcher"===o.type)return s(null,[]);s(null,a.concat(i))}}).call(s.prototype),e.PrometheusCompletions=s}),ace.define("ace/mode/behaviour/prometheus",["require","exports","module","ace/lib/oop","ace/mode/behaviour","ace/mode/behaviour/cstyle","ace/token_iterator"],function(t,e,r){"use strict";var n=t("../../lib/oop"),a=(t("../behaviour").Behaviour,t("./cstyle").CstyleBehaviour);t("../../token_iterator").TokenIterator;var i=function(){this.inherit(a),this.add("braces","insertion",function(t,e,r,n,i){if("{"==i){var s=r.getSelectionRange(),o=n.doc.getTextRange(s);if(""!==o&&r.getWrapBehavioursEnabled())return function(t,e,r,n){var a=t.end.row-t.start.row;return{text:r+e+n,selection:[0,t.start.column+1,a,t.end.column+(a?0:1)]}}(s,o,"{","}");if(a.isSaneInsertion(r,n))return{text:"{}",selection:[1,1]}}else if("}"==i){var l=r.getCursorPosition(),c=n.doc.getLine(l.row);if("}"==c.substring(l.column,l.column+1))if(null!==n.$findOpeningBracket("}",{column:l.column+1,row:l.row})&&a.isAutoInsertedClosing(l,c,i))return{text:"",selection:[1,1]}}}),this.add("braces","deletion",function(t,e,r,n,a){var i=n.doc.getTextRange(a);if(!a.isMultiLine()&&"{"==i&&"}"==n.doc.getLine(a.start.row).substring(a.start.column+1,a.start.column+2))return a.end.column++,a})};n.inherits(i,a),e.PrometheusBehaviour=i}),ace.define("ace/mode/prometheus",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/prometheus_highlight_rules"],function(t,e,r){"use strict";var n=t("../lib/oop"),a=t("./text").Mode,i=t("./prometheus_highlight_rules").PrometheusHighlightRules,s=t("./prometheus_completions").PrometheusCompletions,o=t("./behaviour/prometheus").PrometheusBehaviour,l=function(){this.HighlightRules=i,this.$behaviour=new o,this.$completer=new s,this.completer=this.$completer};n.inherits(l,a),function(){this.$id="ace/mode/prometheus"}.call(l.prototype),e.Mode=l})},function(t,e){ace.define("ace/snippets/prometheus",["require","exports","module"],function(t,e,r){"use strict";e.snippets=[{content:"rate(${1:metric}[${2:range}])",name:"rate()",scope:"prometheus",tabTrigger:"r"}],e.scope="prometheus"})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e){!function(t){var e=10,r=.95;var n={series:{pie:{show:!1,radius:"auto",innerRadius:0,startAngle:1.5,tilt:1,shadow:{left:5,top:15,alpha:.02},offset:{top:0,left:"auto"},stroke:{color:"#fff",width:1},label:{show:"auto",formatter:function(t,e){return"<div style='font-size:x-small;text-align:center;padding:2px;color:"+e.color+";'>"+t+"<br/>"+Math.round(e.percent)+"%</div>"},radius:1,background:{color:null,opacity:0},threshold:0},combine:{threshold:-1,color:null,label:"Other"},highlight:{opacity:.5}}}};t.plot.plugins.push({init:function(a){var i=null,s=null,o=null,l=null,c=null,u=!1,d=null,p=[];function h(e,r,a){u||(u=!0,i=e.getCanvas(),s=t(i).parent(),n=e.getOptions(),e.setData(function(e){for(var r=0,a=0,i=0,s=n.series.pie.combine.color,o=[],l=0;l<e.length;++l){var c=e[l].data;t.isArray(c)&&1==c.length&&(c=c[0]),t.isArray(c)?!isNaN(parseFloat(c[1]))&&isFinite(c[1])?c[1]=+c[1]:c[1]=0:c=!isNaN(parseFloat(c))&&isFinite(c)?[1,+c]:[1,0],e[l].data=[c]}for(var l=0;l<e.length;++l)r+=e[l].data[0][1];for(var l=0;l<e.length;++l){var c=e[l].data[0][1];c/r<=n.series.pie.combine.threshold&&(a+=c,i++,s||(s=e[l].color))}for(var l=0;l<e.length;++l){var c=e[l].data[0][1];(i<2||c/r>n.series.pie.combine.threshold)&&o.push({data:[[1,c]],color:e[l].color,label:e[l].label,angle:c*Math.PI*2/r,percent:c/(r/100)})}return i>1&&o.push({data:[[1,a]],color:s,label:n.series.pie.combine.label,angle:a*Math.PI*2/r,percent:a/(r/100)}),o}(e.getData())))}function f(a,i){if(s){var p=a.getPlaceholder().width(),h=a.getPlaceholder().height(),f=s.children().filter(".legend").children().width()||0;d=i,u=!1,o=Math.min(p,h/n.series.pie.tilt)/2,c=h/2+n.series.pie.offset.top,l=p/2,"auto"==n.series.pie.offset.left?n.legend.position.match("w")?l+=f/2:l-=f/2:l+=n.series.pie.offset.left,l<o?l=o:l>p-o&&(l=p-o);var g=a.getData(),v=0;do{v>0&&(o*=r),v+=1,b(),n.series.pie.tilt<=.8&&y()}while(!w()&&v<e);v>=e&&(b(),s.prepend("<div class='error'>Could not draw pie with labels contained inside canvas</div>")),a.setSeries&&a.insertLegend&&(a.setSeries(g),a.insertLegend())}function b(){d.clearRect(0,0,p,h),s.children().filter(".pieLabel, .pieLabelBackground").remove()}function y(){var t=n.series.pie.shadow.left,e=n.series.pie.shadow.top,r=n.series.pie.shadow.alpha,a=n.series.pie.radius>1?n.series.pie.radius:o*n.series.pie.radius;if(!(a>=p/2-t||a*n.series.pie.tilt>=h/2-e||a<=10)){d.save(),d.translate(t,e),d.globalAlpha=r,d.fillStyle="#000",d.translate(l,c),d.scale(1,n.series.pie.tilt);for(var i=1;i<=10;i++)d.beginPath(),d.arc(0,0,a,0,2*Math.PI,!1),d.fill(),a-=i;d.restore()}}function w(){var e=Math.PI*n.series.pie.startAngle,r=n.series.pie.radius>1?n.series.pie.radius:o*n.series.pie.radius;d.save(),d.translate(l,c),d.scale(1,n.series.pie.tilt),d.save();for(var a=e,i=0;i<g.length;++i)g[i].startAngle=a,u(g[i].angle,g[i].color,!0);if(d.restore(),n.series.pie.stroke.width>0){for(d.save(),d.lineWidth=n.series.pie.stroke.width,a=e,i=0;i<g.length;++i)u(g[i].angle,n.series.pie.stroke.color,!1);d.restore()}return m(d),d.restore(),!n.series.pie.label.show||function(){for(var r=e,a=n.series.pie.label.radius>1?n.series.pie.label.radius:o*n.series.pie.label.radius,i=0;i<g.length;++i){if(g[i].percent>=100*n.series.pie.label.threshold&&!u(g[i],r,i))return!1;r+=g[i].angle}return!0;function u(e,r,i){if(0==e.data[0][1])return!0;var o,u=n.legend.labelFormatter,d=n.series.pie.label.formatter;o=u?u(e.label,e):e.label,d&&(o=d(o,e));var f=(r+e.angle+r)/2,m=l+Math.round(Math.cos(f)*a),g=c+Math.round(Math.sin(f)*a)*n.series.pie.tilt,v="<span class='pieLabel' id='pieLabel"+i+"' style='position:absolute;top:"+g+"px;left:"+m+"px;'>"+o+"</span>";s.append(v);var b=s.children("#pieLabel"+i),y=g-b.height()/2,w=m-b.width()/2;if(b.css("top",y),b.css("left",w),0-y>0||0-w>0||h-(y+b.height())<0||p-(w+b.width())<0)return!1;if(0!=n.series.pie.label.background.opacity){var x=n.series.pie.label.background.color;null==x&&(x=e.color);var S="top:"+y+"px;left:"+w+"px;";t("<div class='pieLabelBackground' style='position:absolute;width:"+b.width()+"px;height:"+b.height()+"px;"+S+"background-color:"+x+";'></div>").css("opacity",n.series.pie.label.background.opacity).insertBefore(b)}return!0}}();function u(t,e,n){t<=0||isNaN(t)||(n?d.fillStyle=e:(d.strokeStyle=e,d.lineJoin="round"),d.beginPath(),Math.abs(t-2*Math.PI)>1e-9&&d.moveTo(0,0),d.arc(0,0,r,a,a+t/2,!1),d.arc(0,0,r,a+t/2,a+t,!1),d.closePath(),a+=t,n?d.fill():d.stroke())}}}function m(t){if(n.series.pie.innerRadius>0){t.save();var e=n.series.pie.innerRadius>1?n.series.pie.innerRadius:o*n.series.pie.innerRadius;t.globalCompositeOperation="destination-out",t.beginPath(),t.fillStyle=n.series.pie.stroke.color,t.arc(0,0,e,0,2*Math.PI,!1),t.fill(),t.closePath(),t.restore(),t.save(),t.beginPath(),t.strokeStyle=n.series.pie.stroke.color,t.arc(0,0,e,0,2*Math.PI,!1),t.stroke(),t.closePath(),t.restore()}}function g(t,e){for(var r=!1,n=-1,a=t.length,i=a-1;++n<a;i=n)(t[n][1]<=e[1]&&e[1]<t[i][1]||t[i][1]<=e[1]&&e[1]<t[n][1])&&e[0]<(t[i][0]-t[n][0])*(e[1]-t[n][1])/(t[i][1]-t[n][1])+t[n][0]&&(r=!r);return r}function v(t){y("plothover",t)}function b(t){y("plotclick",t)}function y(t,e){var r=a.offset(),i=function(t,e){for(var r,n,i=a.getData(),s=a.getOptions(),u=s.series.pie.radius>1?s.series.pie.radius:o*s.series.pie.radius,p=0;p<i.length;++p){var h=i[p];if(h.pie.show){if(d.save(),d.beginPath(),d.moveTo(0,0),d.arc(0,0,u,h.startAngle,h.startAngle+h.angle/2,!1),d.arc(0,0,u,h.startAngle+h.angle/2,h.startAngle+h.angle,!1),d.closePath(),r=t-l,n=e-c,d.isPointInPath){if(d.isPointInPath(t-l,e-c))return d.restore(),{datapoint:[h.percent,h.data],dataIndex:0,series:h,seriesIndex:p}}else if(g([[0,0],[u*Math.cos(h.startAngle),u*Math.sin(h.startAngle)],[u*Math.cos(h.startAngle+h.angle/4),u*Math.sin(h.startAngle+h.angle/4)],[u*Math.cos(h.startAngle+h.angle/2),u*Math.sin(h.startAngle+h.angle/2)],[u*Math.cos(h.startAngle+h.angle/1.5),u*Math.sin(h.startAngle+h.angle/1.5)],[u*Math.cos(h.startAngle+h.angle),u*Math.sin(h.startAngle+h.angle)]],[r,n]))return d.restore(),{datapoint:[h.percent,h.data],dataIndex:0,series:h,seriesIndex:p};d.restore()}}return null}(parseInt(e.pageX-r.left),parseInt(e.pageY-r.top));if(n.grid.autoHighlight)for(var u=0;u<p.length;++u){var h=p[u];h.auto!=t||i&&h.series==i.series||w(h.series)}i&&function(t,e){var r=x(t);-1==r?(p.push({series:t,auto:e}),a.triggerRedrawOverlay()):e||(p[r].auto=!1)}(i.series,t);var f={pageX:e.pageX,pageY:e.pageY};s.trigger(t,[f,i])}function w(t){null==t&&(p=[],a.triggerRedrawOverlay());var e=x(t);-1!=e&&(p.splice(e,1),a.triggerRedrawOverlay())}function x(t){for(var e=0;e<p.length;++e)if(p[e].series==t)return e;return-1}a.hooks.processOptions.push(function(t,e){e.series.pie.show&&(e.grid.show=!1,"auto"==e.series.pie.label.show&&(e.legend.show?e.series.pie.label.show=!1:e.series.pie.label.show=!0),"auto"==e.series.pie.radius&&(e.series.pie.label.show?e.series.pie.radius=.75:e.series.pie.radius=1),e.series.pie.tilt>1?e.series.pie.tilt=1:e.series.pie.tilt<0&&(e.series.pie.tilt=0))}),a.hooks.bindEvents.push(function(t,e){var r=t.getOptions();r.series.pie.show&&(r.grid.hoverable&&e.unbind("mousemove").mousemove(v),r.grid.clickable&&e.unbind("click").click(b))}),a.hooks.processDatapoints.push(function(t,e,r,n){t.getOptions().series.pie.show&&h(t)}),a.hooks.drawOverlay.push(function(t,e){t.getOptions().series.pie.show&&function(t,e){var r=t.getOptions(),n=r.series.pie.radius>1?r.series.pie.radius:o*r.series.pie.radius;e.save(),e.translate(l,c),e.scale(1,r.series.pie.tilt);for(var a=0;a<p.length;++a)i(p[a].series);function i(t){t.angle<=0||isNaN(t.angle)||(e.fillStyle="rgba(255, 255, 255, "+r.series.pie.highlight.opacity+")",e.beginPath(),Math.abs(t.angle-2*Math.PI)>1e-9&&e.moveTo(0,0),e.arc(0,0,n,t.startAngle,t.startAngle+t.angle/2,!1),e.arc(0,0,n,t.startAngle+t.angle/2,t.startAngle+t.angle,!1),e.closePath(),e.fill())}m(e),e.restore()}(t,e)}),a.hooks.draw.push(function(t,e){t.getOptions().series.pie.show&&f(t,e)})},options:n,name:"pie",version:"1.1"})}(jQuery)},,,,,,,function(t,e){function r(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}r.keys=function(){return[]},r.resolve=r,t.exports=r,r.id=1363},,,,,function(t,e,r){"use strict";tt.$inject=["$route","$location","backendSrv","datasourceSrv","contextSrv"],mt.$inject=["$routeProvider","$locationProvider"],Le.$inject=["instanceSettings","$q","backendSrv","templateSrv"],Ue.$inject=["$compile"],Ve.$inject=["$compile","templateSrv","popoverSrv"],ts.$inject=["element","event","plot"],rs.$inject=["element","event","plot"],ss.$inject=["plot"],ks.$inject=["$sanitize","dashboardSrv","contextSrv","$compile"],Gs.$inject=["timeSrv","popoverSrv","contextSrv"],Ws.$inject=["$scope","$element","popoverSrv"],Vo.$inject=["$q","uiSegmentSrv"],Qo.$inject=["$q","uiSegmentSrv"],vl.$inject=["playlistSrv","contextSrv","$timeout","$rootScope","$location"],Bl.$inject=["$compile","datasourceSrv","$rootScope","$q","$http","$templateCache","$timeout"],Hl.$inject=["templateSrv"],ic.$inject=["$scope","$rootScope","$location","$timeout","timeSrv","templateSrv","linkSrv"],uc.$inject=["$location","$timeout"],mc.$inject=["$rootScope","$q","$location","$timeout","contextSrv","dashboardSrv","$window"],wc.$inject=["timer","$location"],_c.$inject=["variableSrv"],iu.$inject=["$compile","$sanitize","linkSrv"],Eu.$inject=["$routeProvider"],Au.$inject=["$compile"],Ou.$inject=["dynamicDirectiveSrv"],r.r(e);var n={};r.r(n),r.d(n,"PanelCtrl",function(){return Lt}),r.d(n,"MetricsPanelCtrl",function(){return Bt}),r.d(n,"OgeAlertMetricsPanelCtrl",function(){return Qt}),r.d(n,"QueryCtrl",function(){return Ht}),r.d(n,"alertTab",function(){return Kt}),r.d(n,"loadPluginCss",function(){return cl});var a={};r.r(a),r.d(a,"convertSeriesListToCsv",function(){return ve}),r.d(a,"exportSeriesListToCsv",function(){return be}),r.d(a,"convertSeriesListToCsvColumns",function(){return ye}),r.d(a,"exportSeriesListToCsvColumns",function(){return we}),r.d(a,"convertTableDataToCsv",function(){return xe}),r.d(a,"exportTableDataToCsv",function(){return Se}),r.d(a,"saveSaveBlob",function(){return ke}),r.d(a,"exportTableDataToCsvByName",function(){return Ce});var i={};r.r(i),r.d(i,"default",function(){return Te});var s={};r.r(s),r.d(s,"Datasource",function(){return Le}),r.d(s,"QueryCtrl",function(){return tr}),r.d(s,"ConfigCtrl",function(){return rr}),r.d(s,"AnnotationsQueryCtrl",function(){return nr});var o={};r.r(o),r.d(o,"Datasource",function(){return dr}),r.d(o,"QueryCtrl",function(){return pr}),r.d(o,"ConfigCtrl",function(){return hr}),r.d(o,"AnnotationsQueryCtrl",function(){return fr});var l={};r.r(l),r.d(l,"Datasource",function(){return Or}),r.d(l,"QueryCtrl",function(){return Fr}),r.d(l,"ConfigCtrl",function(){return qr}),r.d(l,"AnnotationsQueryCtrl",function(){return Lr});var c={};r.r(c),r.d(c,"Datasource",function(){return Rr}),r.d(c,"QueryCtrl",function(){return jr}),r.d(c,"ConfigCtrl",function(){return Ur}),r.d(c,"AnnotationsQueryCtrl",function(){return Vr});var u={};r.r(u),r.d(u,"GrafanaDatasource",function(){return Br}),r.d(u,"Datasource",function(){return Br}),r.d(u,"QueryCtrl",function(){return Qr}),r.d(u,"AnnotationsQueryCtrl",function(){return Hr});var d={};r.r(d),r.d(d,"Datasource",function(){return on}),r.d(d,"QueryCtrl",function(){return ln}),r.d(d,"ConfigCtrl",function(){return cn}),r.d(d,"AnnotationsQueryCtrl",function(){return un});var p={};r.r(p),r.d(p,"LoggingConfigCtrl",function(){return Kn}),r.d(p,"Datasource",function(){return Pn}),r.d(p,"ConfigCtrl",function(){return Kn}),r.d(p,"ExploreQueryField",function(){return Yn}),r.d(p,"ExploreStartPage",function(){return Fn});var h={};r.r(h),r.d(h,"MixedDatasource",function(){return Jn}),r.d(h,"Datasource",function(){return Jn});var f={};r.r(f),r.d(f,"MysqlDatasource",function(){return ta}),r.d(f,"Datasource",function(){return ta}),r.d(f,"QueryCtrl",function(){return la}),r.d(f,"ConfigCtrl",function(){return ca}),r.d(f,"AnnotationsQueryCtrl",function(){return da});var m={};r.r(m),r.d(m,"PostgresDatasource",function(){return fa}),r.d(m,"Datasource",function(){return fa}),r.d(m,"QueryCtrl",function(){return wa}),r.d(m,"ConfigCtrl",function(){return xa}),r.d(m,"AnnotationsQueryCtrl",function(){return ka});var g={};r.r(g),r.d(g,"Datasource",function(){return Ba}),r.d(g,"QueryCtrl",function(){return Ha}),r.d(g,"ConfigCtrl",function(){return za}),r.d(g,"AnnotationsQueryCtrl",function(){return ii}),r.d(g,"ExploreQueryField",function(){return ai}),r.d(g,"ExploreStartPage",function(){return Ka});var v={};r.r(v),r.d(v,"MssqlDatasource",function(){return oi}),r.d(v,"Datasource",function(){return oi}),r.d(v,"QueryCtrl",function(){return ci}),r.d(v,"ConfigCtrl",function(){return ui}),r.d(v,"AnnotationsQueryCtrl",function(){return pi});var b={};r.r(b),r.d(b,"TestDataDatasource",function(){return hi}),r.d(b,"Datasource",function(){return hi}),r.d(b,"QueryCtrl",function(){return fi}),r.d(b,"AnnotationsQueryCtrl",function(){return mi});var y={};r.r(y),r.d(y,"Datasource",function(){return Di}),r.d(y,"QueryCtrl",function(){return Li}),r.d(y,"ConfigCtrl",function(){return Ri}),r.d(y,"AnnotationsQueryCtrl",function(){return ji}),r.d(y,"VariableQueryEditor",function(){return Vi});var w={};r.r(w),r.d(w,"TextPanelCtrl",function(){return Bi}),r.d(w,"PanelCtrl",function(){return Bi});var x={};r.r(x),r.d(x,"Text2",function(){return Qi}),r.d(x,"PanelComponent",function(){return Qi});var S={};r.r(S),r.d(S,"Graph2",function(){return Xi}),r.d(S,"GraphOptions",function(){return Zi}),r.d(S,"PanelComponent",function(){return Xi}),r.d(S,"PanelOptionsComponent",function(){return Zi});var k={};r.r(k),r.d(k,"GraphCtrl",function(){return to}),r.d(k,"PanelCtrl",function(){return to});var C={};r.r(C),r.d(C,"DashListCtrl",function(){return eo}),r.d(C,"PanelCtrl",function(){return eo});var T={};r.r(T),r.d(T,"PluginListCtrl",function(){return ro}),r.d(T,"PanelCtrl",function(){return ro});var E={};r.r(E),r.d(E,"AlertListPanel",function(){return no}),r.d(E,"PanelCtrl",function(){return no});var _={};r.r(_),r.d(_,"PanelCtrl",function(){return Ro});var M={};r.r(M),r.d(M,"TablePanelCtrl",function(){return zo}),r.d(M,"PanelCtrl",function(){return zo});var A={};r.r(A),r.d(A,"SingleStatCtrl",function(){return Wo}),r.d(A,"PanelCtrl",function(){return Wo}),r.d(A,"getColorForValue",function(){return Yo});var P={};r.r(P),r.d(P,"GettingStartedPanelCtrl",function(){return Ko}),r.d(P,"PanelCtrl",function(){return Ko});var $={};r.r($),r.d($,"GaugePanel",function(){return tl}),r.d($,"PanelComponent",function(){return tl});r(643);var D=r(114),O=r(1),I=r.n(O),N=r(7),F=r.n(N),q=r(6),L=r.n(q),R=(r(849),r(851),r(853),r(855),r(0)),j=r.n(R),U=r(14),V=r.n(U),B=(r(860),r(861),r(862),r(8)),Q=r(4),H=r.n(Q),z=r(5),G=r(13),W=r(55),Y=function(){function t(t,e,r,n,a,i){t.appEvent("dashboard-fetch-start"),e.uid||e.slug?"script"===e.type||"snapshot"===e.type||e.uid?r.loadDashboard(e.type,e.slug,e.uid).then(function(r){if(r.meta.url){var n=W.a.stripBaseFromUrl(r.meta.url);if(n!==a.path())return void a.path(n).replace()}r.meta.autofitpanels=e.autofitpanels,r.meta.kiosk=e.kiosk,t.initDashboard(r,t)}):n.getDashboardBySlug(e.slug).then(function(t){t&&a.path(W.a.stripBaseFromUrl(t.meta.url)).replace()}):n.get("/api/dashboards/home").then(function(e){if(e.redirectUri){var r=W.a.stripBaseFromUrl(e.redirectUri);a.path(r)}else{var n=e.meta;n.canSave=n.canShare=n.canStar=!1,t.initDashboard(e,t)}})}return t.$inject=["$scope","$routeParams","dashboardLoaderSrv","backendSrv","$location","$browser"],t}(),K=function(){function t(t,e){t.initDashboard({meta:{canStar:!1,canShare:!1,isNew:!0,folderId:Number(e.folderId)},dashboard:{title:"新仪表盘",panels:[{type:"add-panel",gridPos:{x:0,y:0,w:12,h:9},title:"面板标题"}]}},t)}return t.$inject=["$scope","$routeParams"],t}();z.c.controller("LoadDashboardCtrl",Y),z.c.controller("NewDashboardCtrl",K);var J=r(2),X=r(21),Z=r(51);function tt(t,e,r,n,a){return{restrict:"E",template:"",link:function(i,s){var o=t.current.locals.roles;o&&o.length&&(o.some(function(t){return a.hasRole(t)})||e.url("/"));var l=t.current.locals.component;l.default&&(l=l.default);var c={backendSrv:r,datasourceSrv:n,routeParams:t.current.params};V.a.render(function(t,e,r){return j.a.createElement(X.a,{store:t},j.a.createElement(e,J.a({},r)))}(Z.b,l,c),s[0]),i.$on("$destroy",function(){V.a.unmountComponentAtNode(s[0])})}}}z.c.directive("reactContainer",tt);var et=[];var rt=r(600),nt=r(602),at=r(604),it=r(608),st=r(609),ot=r(612),lt=r(613),ct=r(614),ut=r(615),dt=r(616),pt=r(617),ht=r(621),ft=r(623);function mt(t,e){e.html5Mode(!0),t.when("/",{templateUrl:"public/app/partials/dashboard.html",controller:"LoadDashboardCtrl",reloadOnSearch:!1,pageClass:"page-dashboard"}).when("/d/:uid/:slug",{templateUrl:"public/app/partials/dashboard.html",controller:"LoadDashboardCtrl",reloadOnSearch:!1,pageClass:"page-dashboard"}).when("/d/:uid",{templateUrl:"public/app/partials/dashboard.html",controller:"LoadDashboardCtrl",reloadOnSearch:!1,pageClass:"page-dashboard"}).when("/dashboard/:type/:slug",{templateUrl:"public/app/partials/dashboard.html",controller:"LoadDashboardCtrl",reloadOnSearch:!1,pageClass:"page-dashboard"}).when("/d-solo/:uid/:slug",{templateUrl:"public/app/features/panel/partials/soloPanel.html",controller:"SoloPanelCtrl",reloadOnSearch:!1,pageClass:"page-dashboard"}).when("/dashboard-solo/:type/:slug",{templateUrl:"public/app/features/panel/partials/soloPanel.html",controller:"SoloPanelCtrl",reloadOnSearch:!1,pageClass:"page-dashboard"}).when("/dashboard/new",{templateUrl:"public/app/partials/dashboard.html",controller:"NewDashboardCtrl",reloadOnSearch:!1,pageClass:"page-dashboard"}).when("/dashboard/import",{templateUrl:"public/app/features/dashboard/partials/dashboard_import.html",controller:"DashboardImportCtrl",controllerAs:"ctrl"}).when("/datasources",{template:"<react-container />",resolve:{component:function(){return ut.a}}}).when("/datasources/edit/:id",{templateUrl:"public/app/features/plugins/partials/ds_edit.html",controller:"DataSourceEditCtrl",controllerAs:"ctrl"}).when("/datasources/edit/:id/dashboards",{template:"<react-container />",resolve:{component:function(){return ht.a}}}).when("/datasources/new",{template:"<react-container />",resolve:{component:function(){return dt.a}}}).when("/dashboards",{templateUrl:"public/app/features/manage-dashboards/partials/dashboard_list.html",controller:"DashboardListCtrl",controllerAs:"ctrl"}).when("/dashboards/folder/new",{templateUrl:"public/app/features/dashboard/partials/create_folder.html",controller:"CreateFolderCtrl",controllerAs:"ctrl"}).when("/dashboards/f/:uid/:slug/permissions",{template:"<react-container />",resolve:{component:function(){return ct.a}}}).when("/dashboards/f/:uid/:slug/settings",{template:"<react-container />",resolve:{component:function(){return lt.a}}}).when("/dashboards/f/:uid/:slug",{templateUrl:"public/app/features/dashboard/partials/folder_dashboards.html",controller:"FolderDashboardsCtrl",controllerAs:"ctrl"}).when("/dashboards/f/:uid",{templateUrl:"public/app/features/dashboard/partials/folder_dashboards.html",controller:"FolderDashboardsCtrl",controllerAs:"ctrl"}).when("/explore",{template:"<react-container />",reloadOnSearch:!1,resolve:{roles:function(){return["Editor","Admin"]},component:function(){return Promise.all([r.e(0),r.e(4)]).then(r.bind(null,1379))}}}).when("/org",{template:"<react-container />",resolve:{component:function(){return ft.a}}}).when("/org/new",{templateUrl:"public/app/features/org/partials/newOrg.html",controller:"NewOrgCtrl"}).when("/org/users",{template:"<react-container />",resolve:{component:function(){return pt.a}}}).when("/org/users/invite",{templateUrl:"public/app/features/org/partials/invite.html",controller:"UserInviteCtrl",controllerAs:"ctrl"}).when("/org/apikeys",{template:"<react-container />",resolve:{roles:function(){return["Editor","Admin"]},component:function(){return st.a}}}).when("/org/teams",{template:"<react-container />",resolve:{roles:function(){return["Editor","Admin"]},component:function(){return it.a}}}).when("/org/teams/new",{templateUrl:"public/app/features/teams/partials/create_team.html",controller:"CreateTeamCtrl",controllerAs:"ctrl"}).when("/org/teams/edit/:id/:page?",{template:"<react-container />",resolve:{roles:function(){return["Admin"]},component:function(){return at.a}}}).when("/profile",{templateUrl:"public/app/features/profile/partials/profile.html",controller:"ProfileCtrl",controllerAs:"ctrl"}).when("/profile/password",{templateUrl:"public/app/features/profile/partials/change_password.html",controller:"ChangePasswordCtrl"}).when("/profile/select-org",{templateUrl:"public/app/features/org/partials/select_org.html",controller:"SelectOrgCtrl"}).when("/admin",{templateUrl:"public/app/features/admin/partials/admin_home.html",controller:"AdminHomeCtrl",controllerAs:"ctrl"}).when("/admin/settings",{templateUrl:"public/app/features/admin/partials/settings.html",controller:"AdminSettingsCtrl",controllerAs:"ctrl"}).when("/admin/users",{templateUrl:"public/app/features/admin/partials/users.html",controller:"AdminListUsersCtrl",controllerAs:"ctrl"}).when("/admin/users/create",{templateUrl:"public/app/features/admin/partials/new_user.html",controller:"AdminEditUserCtrl"}).when("/admin/users/edit/:id",{templateUrl:"public/app/features/admin/partials/edit_user.html",controller:"AdminEditUserCtrl"}).when("/admin/orgs",{templateUrl:"public/app/features/admin/partials/orgs.html",controller:"AdminListOrgsCtrl",controllerAs:"ctrl"}).when("/admin/orgs/edit/:id",{templateUrl:"public/app/features/admin/partials/edit_org.html",controller:"AdminEditOrgCtrl",controllerAs:"ctrl"}).when("/admin/stats",{template:"<react-container />",resolve:{component:function(){return rt.a}}}).when("/login",{templateUrl:"public/app/partials/login.html",controller:"LoginCtrl",pageClass:"login-page sidemenu-hidden"}).when("/invite/:code",{templateUrl:"public/app/partials/signup_invited.html",controller:"InvitedCtrl",pageClass:"sidemenu-hidden"}).when("/signup",{templateUrl:"public/app/partials/signup_step2.html",controller:"SignUpCtrl",pageClass:"sidemenu-hidden"}).when("/user/password/send-reset-email",{templateUrl:"public/app/partials/reset_password.html",controller:"ResetPasswordCtrl",pageClass:"sidemenu-hidden"}).when("/user/password/reset",{templateUrl:"public/app/partials/reset_password.html",controller:"ResetPasswordCtrl",pageClass:"sidemenu-hidden"}).when("/dashboard/snapshots",{templateUrl:"public/app/features/manage-dashboards/partials/snapshot_list.html",controller:"SnapshotListCtrl",controllerAs:"ctrl"}).when("/plugins",{template:"<react-container />",resolve:{component:function(){return ot.a}}}).when("/plugins/:pluginId/edit",{templateUrl:"public/app/features/plugins/partials/plugin_edit.html",controller:"PluginEditCtrl",controllerAs:"ctrl"}).when("/plugins/:pluginId/page/:slug",{templateUrl:"public/app/features/plugins/partials/plugin_page.html",controller:"AppPageCtrl",controllerAs:"ctrl"}).when("/styleguide/:page?",{controller:"StyleGuideCtrl",controllerAs:"ctrl",templateUrl:"public/app/features/admin/partials/styleguide.html"}).when("/alerting",{redirectTo:"/alerting/list"}).when("/alerting/list",{template:"<react-container />",reloadOnSearch:!1,resolve:{component:function(){return nt.a}}}).when("/alerting/notifications",{templateUrl:"public/app/features/alerting/partials/notifications_list.html",controller:"AlertNotificationsListCtrl",controllerAs:"ctrl"}).when("/alerting/notification/new",{templateUrl:"public/app/features/alerting/partials/notification_edit.html",controller:"AlertNotificationEditCtrl",controllerAs:"ctrl"}).when("/alerting/notification/:id/edit",{templateUrl:"public/app/features/alerting/partials/notification_edit.html",controller:"AlertNotificationEditCtrl",controllerAs:"ctrl"}).otherwise({templateUrl:"public/app/partials/error.html",controller:"ErrorCtrl"}),function(t){for(var e=0,r=et;e<r.length;e++)(0,r[e])(t)}(t)}var gt,vt=r(236),bt=r(9),yt=r(60),wt=r.n(yt),xt=r(31),St=r(15),kt=r(12),Ct=r(27),Tt=function(){function t(t,e,r,n,a){var i=this;this.$rootScope=t,this.$timeout=e,this.$location=r,this.timer=n,this.contextSrv=a,this.time={from:"6h",to:"now"},t.$on("zoom-out",this.zoomOut.bind(this)),t.$on("$routeUpdate",this.routeUpdated.bind(this)),document.addEventListener("visibilitychange",function(){i.autoRefreshBlocked&&"visible"===document.visibilityState&&(i.autoRefreshBlocked=!1,i.refreshDashboard())})}return t.$inject=["$rootScope","$timeout","$location","timer","contextSrv"],t.prototype.init=function(t){this.timer.cancelAll(),this.dashboard=t,this.time=t.time,this.refresh=t.refresh,this.initTimeFromUrl(),this.parseTime(),this.timeAtLoad=I.a.cloneDeep(this.time),this.refresh&&this.setAutoRefresh(this.refresh)},t.prototype.parseTime=function(){I.a.isString(this.time.from)&&this.time.from.indexOf("Z")>=0&&(this.time.from=H()(this.time.from).utc()),I.a.isString(this.time.to)&&this.time.to.indexOf("Z")>=0&&(this.time.to=H()(this.time.to).utc())},t.prototype.parseUrlParam=function(t){if(-1!==t.indexOf("now"))return t;if(8===t.length)return H.a.utc(t,"YYYYMMDD");if(15===t.length)return H.a.utc(t,"YYYYMMDDTHHmmss");if(!isNaN(t)){var e=parseInt(t,10);return H.a.utc(e)}return null},t.prototype.initTimeFromUrl=function(){var t=this.$location.search();t.from&&(this.time.from=this.parseUrlParam(t.from)||this.time.from),t.to&&(this.time.to=this.parseUrlParam(t.to)||this.time.to),t.to&&-1===t.to.indexOf("now")&&(this.refresh=!1,this.dashboard.refresh=!1),t.refresh&&(this.refresh=t.refresh||this.refresh)},t.prototype.routeUpdated=function(){var t=this.$location.search(),e=this.timeRangeForUrl();t.from&&t.to?t.from===e.from&&t.to===e.to||(this.initTimeFromUrl(),this.setTime(this.time,!0)):this.timeHasChangedSinceLoad()&&this.setTime(this.timeAtLoad,!0)},t.prototype.timeHasChangedSinceLoad=function(){return this.timeAtLoad&&(this.timeAtLoad.from!==this.time.from||this.timeAtLoad.to!==this.time.to)},t.prototype.setAutoRefresh=function(t){var e=this;if(this.dashboard.refresh=t,this.cancelNextRefresh(),t){var r=kt.a.interval_to_ms(t);this.refreshTimer=this.timer.register(this.$timeout(function(){e.startNextRefreshTimer(r),e.refreshDashboard()},r))}var n=this.$location.search();t?(n.refresh=t,this.$location.search(n)):n.refresh&&(delete n.refresh,this.$location.search(n))},t.prototype.refreshDashboard=function(){this.dashboard.timeRangeUpdated()},t.prototype.startNextRefreshTimer=function(t){var e=this;this.cancelNextRefresh(),this.refreshTimer=this.timer.register(this.$timeout(function(){e.startNextRefreshTimer(t),e.contextSrv.isGrafanaVisible()?e.refreshDashboard():e.autoRefreshBlocked=!0},t))},t.prototype.cancelNextRefresh=function(){this.timer.cancel(this.refreshTimer)},t.prototype.setTime=function(t,e){if(I.a.extend(this.time,t),H.a.isMoment(t.to)?(this.oldRefresh=this.dashboard.refresh||this.oldRefresh,this.setAutoRefresh(!1)):this.oldRefresh&&this.oldRefresh!==this.dashboard.refresh&&(this.setAutoRefresh(this.oldRefresh),this.oldRefresh=null),!0!==e){var r=this.timeRangeForUrl(),n=this.$location.search();n.from=r.from,n.to=r.to,this.$location.search(n)}this.$rootScope.appEvent("time-range-changed",this.time),this.$timeout(this.refreshDashboard.bind(this),0)},t.prototype.timeRangeForUrl=function(){var t=this.timeRange().raw;return H.a.isMoment(t.from)&&(t.from=t.from.valueOf().toString()),H.a.isMoment(t.to)&&(t.to=t.to.valueOf().toString()),t},t.prototype.timeRange=function(){var t={from:H.a.isMoment(this.time.from)?H()(this.time.from):this.time.from,to:H.a.isMoment(this.time.to)?H()(this.time.to):this.time.to},e=this.dashboard&&this.dashboard.getTimezone();return{from:Ct.parse(t.from,!1,e),to:Ct.parse(t.to,!0,e),raw:t}},t.prototype.zoomOut=function(t,e){var r=this.timeRange(),n=r.to.valueOf()-r.from.valueOf(),a=r.to.valueOf()-n/2,i=a+n*e/2,s=a-n*e/2;this.setTime({from:H.a.utc(s),to:H.a.utc(i)})},t}();z.c.service("timeSrv",Tt);var Et=r(122),_t=r.n(Et),Mt=r(84),At=r(40),Pt=r(26),$t=function(t,e,r){if(!1===r)t.removePanel(e);else{var n=e.alert?"面板包含一个警报规则，删除面板也将删除警报规则":null,a=e.alert?"是":null;bt.a.emit("confirm-modal",{title:"删除面板",text:"你确定要删除这个面板?",text2:n,icon:"fa-trash",confirmText:a,yesText:"删除",onConfirm:function(){return $t(t,e,!1)}})}},Dt=function(t,e){t.duplicatePanel(e)},Ot=function(t){At.a.set(Pt.f,JSON.stringify(t.getSaveModel())),bt.a.emit("alert-success",["面板已复制，打开添加面板粘贴"])},It=function(t,e){var r={object:e.getSaveModel(),updateHandler:function(e,r){!function(t,e,r){var n=t.panels.findIndex(function(t){return t.id===r.id}),a=t.panels.splice(n,1);t.events.emit("panel-removed",a),(e=new Mt.a(e)).id=r.id,t.panels.splice(n,0,e),t.sortPanelsByGridPos(),t.events.emit("panel-added",e)}(t,e,r)},enableCopy:!0};bt.a.emit("show-modal",{src:"public/app/partials/edit_json.html",model:r})},Nt=function(t,e){bt.a.emit("show-modal",{src:"public/app/features/dashboard/partials/shareModal.html",model:{dashboard:t,panel:e}})},Ft=r(99),qt=r.n(Ft),Lt=function(){function t(t,e){var r=this;this.$injector=e,this.$location=e.get("$location"),this.$scope=t,this.$timeout=e.get("$timeout"),this.editorTabIndex=0,this.events=this.panel.events,this.timing={};var n=B.a.panels[this.panel.type];n&&(this.pluginId=n.id,this.pluginName=n.name),t.$on("component-did-mount",function(){return r.panelDidMount()})}return t.prototype.panelDidMount=function(){this.events.emit("component-did-mount"),this.dashboard.panelInitialized(this.panel)},t.prototype.renderingCompleted=function(){G.f.renderingCompleted(this.panel.id,this.timing)},t.prototype.refresh=function(){this.panel.refresh()},t.prototype.publishAppEvent=function(t,e){this.$scope.$root.appEvent(t,e)},t.prototype.changeView=function(t,e){this.publishAppEvent("panel-change-view",{fullscreen:t,edit:e,panelId:this.panel.id})},t.prototype.viewPanel=function(){this.changeView(!0,!1)},t.prototype.editPanel=function(){this.changeView(!0,!0)},t.prototype.exitFullscreen=function(){this.changeView(!1,!1)},t.prototype.initEditMode=function(){var t=this;this.editorTabs=[],this.addEditorTab("General","public/app/partials/panelgeneral.html"),this.editModeInitiated=!0,this.events.emit("init-edit-mode",null);var e=(this.$injector.get("$routeParams").tab||"").toLowerCase();e&&this.editorTabs.forEach(function(r,n){r.title.toLowerCase()===e&&(t.editorTabIndex=n)})},t.prototype.changeTab=function(t){this.editorTabIndex=t;var e=this.$injector.get("$route");e.current.params.tab=this.editorTabs[t].title.toLowerCase(),e.updateParams()},t.prototype.addEditorTab=function(t,e,r,n){var a={title:t,directiveFn:e,icon:n};I.a.isString(e)&&(a.directiveFn=function(){return{templateUrl:e}}),r?this.editorTabs.splice(r,0,a):this.editorTabs.push(a)},t.prototype.getMenu=function(){var t=[];t.push({text:"查看",click:"ctrl.viewPanel();",icon:"fa fa-fw fa-eye",shortcut:"v"}),this.dashboard.meta.canEdit&&t.push({text:"编辑",click:"ctrl.editPanel();",role:"Editor",icon:"fa fa-fw fa-edit",shortcut:"e"}),t.push({text:"分享",click:"ctrl.sharePanel();",icon:"fa fa-fw fa-share",shortcut:"p s"}),t.push.apply(t,this.getAdditionalMenuItems());var e=this.getExtendedMenu();return t.push({text:"更多...",click:"",icon:"fa fa-fw fa-cube",submenu:e}),this.dashboard.meta.canEdit&&(t.push({divider:!0,role:"Editor"}),t.push({text:"删除",click:"ctrl.removePanel();",role:"Editor",icon:"fa fa-fw fa-trash",shortcut:"p r"})),t},t.prototype.getExtendedMenu=function(){var t=[];return!this.panel.fullscreen&&this.dashboard.meta.canEdit&&(t.push({text:"复制面板",click:"ctrl.duplicate()",role:"Editor",shortcut:"p d"}),t.push({text:"复制面板信息",click:"ctrl.copyPanel()",role:"Editor"})),t.push({text:"面板JSON",click:"ctrl.editPanelJson(); dismiss();"}),this.events.emit("init-panel-actions",t),t},t.prototype.getAdditionalMenuItems=function(){return[]},t.prototype.otherPanelInFullscreenMode=function(){return this.dashboard.meta.fullscreen&&!this.panel.fullscreen},t.prototype.calculatePanelHeight=function(){if(this.panel.fullscreen){var t=F()(".react-grid-layout").height(),e=Math.floor(.35*t),r=Math.floor(.8*t);this.containerHeight=this.panel.isEditing?e:r}else this.containerHeight=this.panel.gridPos.h*Pt.c+(this.panel.gridPos.h-1)*Pt.d;this.panel.soloMode&&(this.containerHeight=F()(window).height()),this.panel.isEditing&&!this.editModeInitiated&&this.initEditMode(),this.height=this.containerHeight-29},t.prototype.render=function(t){this.timing.renderStart=(new Date).getTime(),this.events.emit("render",t)},t.prototype.duplicate=function(){Dt(this.dashboard,this.panel)},t.prototype.removePanel=function(){this.publishAppEvent("panel-remove",{panelId:this.panel.id})},t.prototype.editPanelJson=function(){It(this.dashboard,this.panel)},t.prototype.copyPanel=function(){Ot(this.panel)},t.prototype.sharePanel=function(){Nt(this.dashboard,this.panel)},t.prototype.getInfoMode=function(){return this.error?"error":this.panel.description?"info":this.panel.links&&this.panel.links.length?"links":""},t.prototype.getInfoContent=function(t){var e=this.panel.description;"tooltip"===t.mode&&(e=this.error||this.panel.description);var r=this.$injector.get("linkSrv"),n=this.$injector.get("$sanitize"),a=this.$injector.get("templateSrv").replace(e,this.panel.scopedVars),i='<div class="markdown-html">';if(i+=(new qt.a).render(a),this.panel.links&&this.panel.links.length>0){i+="<ul>";for(var s=0,o=this.panel.links;s<o.length;s++){var l=o[s],c=r.getPanelLinkAnchorInfo(l,this.panel.scopedVars);i+='<li><a class="panel-menu-link" href="'+c.href+'" target="'+c.target+'">'+c.title+"</a></li>"}i+="</ul>"}return n(i+="</div>")},t.prototype.openInspector=function(){var t=this.$scope.$new();t.panel=this.panel,t.dashboard=this.dashboard,t.panelInfoHtml=this.getInfoContent({mode:"inspector"}),t.inspector=F.a.extend(!0,{},this.inspector),this.publishAppEvent("show-modal",{src:"public/app/features/dashboard/partials/inspector.html",scope:t})},t}(),Rt=r(115),jt=function(){function t(t,e,r,n){this.$sce=e,this.backendSrv=n,this.panelCtrl=t.ctrl,t.ctrl=this,this.panel=this.panelCtrl.panel,this.panel.datasource=this.panel.datasource||null,this.panel.targets=this.panel.targets||[{}];for(var a=26,i=0;i<this.panel.targets.length;i++){var s=this.panel.targets[i];this.panel.targets.length>1&&void 0==s.refId&&(s.refId=a,a++)}this.dashboard=this.panelCtrl.dashboard,this.datasources=r.getMetricSources(),this.panelDsValue=this.panelCtrl.panel.datasource;for(var o=0,l=this.datasources;o<l.length;o++){var c=l[o];c.value===this.panelDsValue&&(this.datasourceInstance=c)}this.addQueryDropdown={text:"Add Query",value:null,fake:!0},this.panelCtrl.nextRefId=this.dashboard.getNextQueryLetter(this.panel),this.updateDatasourceOptions()}return t.$inject=["$scope","$sce","datasourceSrv","backendSrv"],t.prototype.updateDatasourceOptions=function(){this.datasourceInstance&&(this.hasQueryHelp=this.datasourceInstance.meta.hasQueryHelp,this.queryOptions=this.datasourceInstance.meta.queryOptions)},t.prototype.getOptions=function(t){return Promise.resolve(this.datasources.filter(function(e){return t||!e.meta.builtIn}).map(function(t){return{value:t.value,text:t.name,datasource:t}}))},t.prototype.datasourceChanged=function(t){t&&(this.setDatasource(t.datasource),this.updateDatasourceOptions())},t.prototype.setDatasource=function(t){var e=this;t.meta.mixed?I.a.each(this.panel.targets,function(t){t.datasource=e.panel.datasource,t.datasource||(t.datasource=B.a.defaultDatasource)}):this.datasourceInstance&&this.datasourceInstance.meta.mixed&&I.a.each(this.panel.targets,function(t){delete t.datasource}),this.datasourceInstance=t,this.panel.datasource=t.value,this.panel.refresh()},t.prototype.addMixedQuery=function(t){t&&(this.panelCtrl.addQuery({isNew:!0,datasource:t.datasource.name}),this.addQueryDropdown={text:"Add Query",value:null,fake:!0})},t.prototype.addQuery=function(){this.panelCtrl.addQuery({isNew:!0})},t.prototype.toggleHelp=function(){var t=this;this.optionsOpen=!1,this.queryTroubleshooterOpen=!1,this.helpOpen=!this.helpOpen,this.backendSrv.get("/api/plugins/"+this.datasourceInstance.meta.id+"/markdown/query_help").then(function(e){var r=new qt.a;t.helpHtml=t.$sce.trustAsHtml(r.render(e))})},t.prototype.toggleOptions=function(){this.helpOpen=!1,this.queryTroubleshooterOpen=!1,this.optionsOpen=!this.optionsOpen},t.prototype.toggleQueryTroubleshooter=function(){this.helpOpen=!1,this.optionsOpen=!1,this.queryTroubleshooterOpen=!this.queryTroubleshooterOpen},t}();function Ut(){return{restrict:"E",scope:!0,templateUrl:"public/app/features/panel/partials/metrics_tab.html",controller:jt}}z.c.directive("metricsTab",Ut);var Vt={},Bt=function(t){function e(e,r,n){var a=t.call(this,e,r)||this;return a.metricsOptionSettings={showPrecision:!1},a.metricsOptionSettings=I.a.extend(a.metricsOptionSettings,n),a.editorTabIndex=1,a.$q=r.get("$q"),a.datasourceSrv=r.get("datasourceSrv"),a.timeSrv=r.get("timeSrv"),a.templateSrv=r.get("templateSrv"),a.scope=e,a.panel.datasource=a.panel.datasource||null,a.panel.targets||(a.panel.targets=[{}]),a.panel.metricsOptionsAll||(a.panel.metricsOptionsAll=[]),a.events.on("refresh",a.onMetricsPanelRefresh.bind(a)),a.events.on("init-edit-mode",a.onInitMetricsPanelEditMode.bind(a)),a.events.on("panel-teardown",a.onPanelTearDown.bind(a)),a}return J.c(e,t),e.prototype.onPanelTearDown=function(){this.dataSubscription&&(this.dataSubscription.unsubscribe(),this.dataSubscription=null)},e.prototype.onInitMetricsPanelEditMode=function(){this.addEditorTab("Metrics",Ut),this.addEditorTab("Time range","public/app/features/panel/partials/panelTime.html"),this.addEditorTab("Metrics Options","public/app/partials/metrics-options.html")},e.prototype.onMetricsPanelRefresh=function(){var t=this;if(!this.otherPanelInFullscreenMode()){if(this.panel.snapshotData){this.updateTimeRange();var e=this.panel.snapshotData;return I.a.isArray(e)||(e=e.data),void this.events.emit("data-snapshot-load",e)}this.dataStream||(delete this.error,this.loading=!0,this.setTimeQueryStart(),this.datasourceSrv.get(this.panel.datasource).then(this.updateTimeRange.bind(this)).then(this.issueQueries.bind(this)).then(this.handleQueryResult.bind(this)).catch(function(e){e.cancelled?console.log("Panel request cancelled",e):(t.loading=!1,t.error=e.message||"Request Error",t.inspector={error:e},e.data&&(e.data.message&&(t.error=e.data.message),e.data.error&&(t.error=e.data.error)),t.events.emit("data-error",e),console.log("Panel data error:",e))}))}},e.prototype.setTimeQueryStart=function(){this.timing.queryStart=(new Date).getTime()},e.prototype.setTimeQueryEnd=function(){this.timing.queryEnd=(new Date).getTime()},e.prototype.updateTimeRange=function(t){return this.datasource=t||this.datasource,this.range=this.timeSrv.timeRange(),this.applyPanelTimeOverrides(),this.panel.maxDataPoints?this.resolution=this.panel.maxDataPoints:this.resolution=Math.ceil(F()(window).width()*(this.panel.span/12)),this.calculateInterval(),this.datasource},e.prototype.calculateInterval=function(){var t=this.panel.interval;t?t=this.templateSrv.replace(t,this.panel.scopedVars):this.datasource&&this.datasource.interval&&(t=this.datasource.interval);var e=kt.a.calculateInterval(this.range,this.resolution,t);this.interval=e.interval,this.intervalMs=e.intervalMs},e.prototype.applyPanelTimeOverrides=function(){if(this.timeInfo="",this.panel.timeFrom){var t=this.templateSrv.replace(this.panel.timeFrom,this.panel.scopedVars),e=Rt.a(t);if(e.invalid)return void(this.timeInfo="invalid time override");if(I.a.isString(this.range.raw.from)){var r=Ct.parse(e.from);this.timeInfo=e.display,this.range.from=r,this.range.to=Ct.parse(e.to),this.range.raw.from=e.from,this.range.raw.to=e.to}}if(this.panel.timeShift){var n=this.templateSrv.replace(this.panel.timeShift,this.panel.scopedVars);if(Rt.a(n).invalid)return void(this.timeInfo="invalid timeshift");var a="-"+n;this.timeInfo+=" timeshift "+a,this.range.from=Ct.parseDateMath(a,this.range.from,!1),this.range.to=Ct.parseDateMath(a,this.range.to,!0),this.range.raw={from:this.range.from,to:this.range.to}}this.panel.hideTimeOverride&&(this.timeInfo="")},e.prototype.issueQueries=function(t){if(this.datasource=t,!this.panel.targets||0===this.panel.targets.length)return this.$q.when([]);var e=Object.assign({},this.panel.scopedVars,{__interval:{text:this.interval,value:this.interval},__interval_ms:{text:this.intervalMs,value:this.intervalMs}}),r={timezone:this.dashboard.getTimezone(),panelId:this.panel.id,range:this.range,rangeRaw:this.range.raw,interval:this.interval,intervalMs:this.intervalMs,targets:this.panel.targets,format:"png"===this.panel.renderer?"png":"json",maxDataPoints:this.resolution,scopedVars:e,kdm:this.panel.kdm,cacheTimeout:this.panel.cacheTimeout};return t.query(r)},e.prototype.handleQueryResult=function(t){if(this.setTimeQueryEnd(),this.loading=!1,t&&t.subscribe)this.handleDataStream(t);else{this.dashboard.snapshot&&(this.panel.snapshotData=t.data),t&&t.data||(console.log("Data source query result invalid, missing data field:",t),t={data:[]});for(var e=0;e<this.panel.metricsOptionsAll.length;e++){var r=this.panel.metricsOptionsAll[e].metricsOptionLists.targetOne;if("运算"==this.panel.metricsOptionsAll[e].kindOf&&r.indexOf("dataSourIndex")>=0){var n=r.split("_")[1].trim();this.panel.metricsOptionsAll[e].metricsOptionLists.targetOne=t.data[n]&&t.data[n].target?t.data[n].target:r;for(var a=0;a<this.panel.metricsOptionsAll[e].metricsOptionLists.sign.length;a++){var i=this.panel.metricsOptionsAll[e].metricsOptionLists.sign[a].targetTwo;if(i.indexOf("dataSourIndex")>=0){var s=i.split("_")[1].trim();this.panel.metricsOptionsAll[e].metricsOptionLists.sign[a].targetTwo=t.data[s]&&t.data[s].target?t.data[s].target:i}}}}this.panel.targetOrigin=[],this.panel.targetName=[],this.panel.targetNameOrigin&&delete this.panel.targetNameOrigin,Vt={};for(e=0;e<t.data.length;e++)t.data[e]&&t.data[e].target&&(this.panel.targetOrigin.push({text:"",value:""}),this.panel.targetOrigin[e].text=this.panel.targetOrigin[e].value=t.data[e].target,this.panel.targetName.push(t.data[e].target),Vt[t.data[e].target]=t.data[e].datapoints);this.panel.metricsOptionsAll.length>0&&this.processMetricsOptions(t.data),this.events.emit("data-received",t.data)}},e.prototype.intersect=function(t){if(t[0]&&t.length>1){for(var e=t.length,r=[],n=0;n<t[0].length;n++){var a=[],i=t[0][n][1];a.push(t[0][n][1]),a.push(t[0][n][0]);for(var s=1;s<e;s++)for(var o=0;o<t[s].length;o++)if(i===t[s][o][1]){a.push(t[s][o][0]);break}a.length===e+1&&r.push(a)}return r!==[]&&r}return!1},e.prototype.getOneAndTwoVal=function(t){var e=t;return Vt[t]&&(e=Vt[t]),e},e.prototype.processMetricsOptions=function(t){for(var e=0;e<this.panel.metricsOptionsAll.length;e++)if(this.panel.metricsOptionsAll[e].target){for(var r=void 0,n=0;n<t.length;n++)this.panel.metricsOptionsAll[e].target===this.panel.targetName[n]&&(r=t[n]);if(r)if("公式"===this.panel.metricsOptionsAll[e].kindOf){var a=this.panel.metricsOptionsAll[e].metricsOptions;if(!a)continue;if(a.alisa&&(r.target=a.alisa),a.target=r.target,I.a.isEmpty(r.datapoints))continue;var i=I.a.isNumber(a.math_multiply)&&1!==a.math_multiply,s=I.a.isNumber(a.math_add)&&0!==a.math_multiply;if(!i&&!s&&!I.a.isInteger(a.precision))continue;for(var o=0;o<r.datapoints.length;o++){var l=r.datapoints[o];I.a.isNumber(l[0])&&(i&&(l[0]=l[0]*a.math_multiply),s&&(l[0]=l[0]+a.math_add),I.a.isInteger(a.precision)&&(l[0]=I.a.round(l[0],a.precision)))}}else{var c=this.panel.metricsOptionsAll[e].metricsOptionLists.targetOne,u=this.getOneAndTwoVal(c);if(I.a.isEmpty(u)||I.a.isNaN(u))continue;var d=[],p=Array.prototype.isPrototypeOf(u);p&&d.push(u);for(var h=0;h<this.panel.metricsOptionsAll[e].metricsOptionLists.sign.length;h++){var f=this.panel.metricsOptionsAll[e].metricsOptionLists.sign[h].targetTwo,m=this.getOneAndTwoVal(f);Array.prototype.isPrototypeOf(m[0])&&d.push(m)}if(d.length>=2){r.datapoints=[];var g=this.intersect(d);if(g)for(var v=0;v<g.length;v++){var b=g[v],y=1,w=[];w[1]=b[0],p?(S=b[y],y++):S=u;for(var x=0;x<this.panel.metricsOptionsAll[e].metricsOptionLists.sign.length;x++){var S,k,C=this.panel.metricsOptionsAll[e].metricsOptionLists.sign[x].targetTwo,T=this.panel.metricsOptionsAll[e].metricsOptionLists.sign[x],E=this.getOneAndTwoVal(C);switch(Array.prototype.isPrototypeOf(E)?(k=b[y],y++):k=parseInt(E),T.sign){case"+":0===x?w[0]=S+k:w[0]+=k;break;case"-":w[0]=0===x?S-k:w[0]-k;break;case"*":w[0]=0===x?S*k:w[0]*k;break;default:w[0]=0===x?S/k:w[0]/k}}r.datapoints.push(w)}continue}for(var _=0;_<this.panel.metricsOptionsAll[e].metricsOptionLists.sign.length;_++){f=this.panel.metricsOptionsAll[e].metricsOptionLists.sign[_].targetTwo;var M=this.panel.metricsOptionsAll[e].metricsOptionLists.sign[_],A=this.getOneAndTwoVal(f);if(!I.a.isEmpty(r.datapoints)||!I.a.isEmpty(A)&&!I.a.isNaN(A))for(var P=Array.prototype.isPrototypeOf(u),$=Array.prototype.isPrototypeOf(A),D=parseFloat(u),O=parseFloat(A),N=0;N<r.datapoints.length;N++){l=r.datapoints[N];if(P||$)if(P){if(!$){var F=u[N];switch(M.sign){case"+":0===_?l[0]=F[0]+O:l[0]+=O;break;case"-":l[0]=0===_?F[0]-O:l[0]-O;break;case"*":l[0]=0===_?F[0]*O:l[0]*O;break;default:l[0]=0===_?F[0]/O:l[0]/O}}}else{var q=A[N];switch(M.sign){case"+":0===_?l[0]=D+q[0]:l[0]+=q[0];break;case"-":l[0]=0===_?D-q[0]:l[0]-q[0];break;case"*":l[0]=0===_?D*q[0]:l[0]*q[0];break;default:l[0]=0===_?D/q[0]:l[0]/q[0]}}else switch(M.sign){case"+":0===_?l[0]=D+O:l[0]+=O;break;case"-":l[0]=0===_?D-O:l[0]-O;break;case"*":l[0]=0===_?D*O:l[0]*O;break;default:l[0]=0===_?D/O:l[0]/O}}}}}else alert("请选择要计算的值")},e.prototype.getString=function(t){for(var e=t.length,r="[",n=0;n<e;n++)r+="[",r+=t[n][0]+",",r+=t[n][1],r+="]",n<e-1&&(r+=",");return r+="]"},e.prototype.getMetricName=function(t){if(!t)return t;var e=t.lastIndexOf("_");return-1===e?t:t.substring(e+1)},e.prototype.handleDataStream=function(t){var e=this;this.dataStream?console.log("two stream observables!"):(this.dataStream=t,this.dataSubscription=t.subscribe({next:function(t){console.log("dataSubject next!"),t.range&&(e.range=t.range),e.events.emit("data-received",t.data)},error:function(t){e.events.emit("data-error",t),console.log("panel: observer got error")},complete:function(){console.log("panel: observer got complete"),e.dataStream=null}}))},e.prototype.setDatasource=function(t){var e=this;t.meta.mixed?I.a.each(this.panel.targets,function(t){t.datasource=e.panel.datasource,t.datasource||(t.datasource=B.a.defaultDatasource)}):this.datasource&&this.datasource.meta.mixed&&I.a.each(this.panel.targets,function(t){delete t.datasource}),this.panel.datasource=t.value,this.datasourceName=t.name,this.datasource=null,this.refresh()},e.prototype.addQuery=function(t){t.refId=this.dashboard.getNextQueryLetter(this.panel),this.panel.targets.push(t),this.nextRefId=this.dashboard.getNextQueryLetter(this.panel)},e.prototype.removeQuery=function(t){var e=I.a.indexOf(this.panel.targets,t);this.panel.targets.splice(e,1),this.nextRefId=this.dashboard.getNextQueryLetter(this.panel),this.refresh()},e.prototype.moveQuery=function(t,e){var r=I.a.indexOf(this.panel.targets,t);I.a.move(this.panel.targets,r,r+e)},e.prototype.addOneCount=function(t){t.sign.push({sign:"",targetTwo:"1"})},e.prototype.removeOneCount=function(t){var e=t.sign.length-1;t.sign.splice(e,1)},e.prototype.addOneRow=function(){this.panel.metricsOptionsAll.push({target:null,kindOf:"运算",metricsOptions:{alisa:"",math_add:0,math_multiply:1},metricsOptionLists:{targetOne:"1",sign:[]}})},e.prototype.removeOneRow=function(t){this.panel.metricsOptionsAll.splice(t,1)},e}(Lt),Qt=function(t){function e(e,r,n,a){var i=t.call(this,e,r,a)||this;i.ogeAlertConfig={withAlertTab:!0,showCover:!1},i.$q=r.get("$q"),i.ogeAlertSrv=r.get("ogeAlertSrv");return I.a.defaults(i.panel,{ogeAlertEnabled:!0,ogeAlertColorType:"V"}),i.ogeAlertConfig=I.a.extend(i.ogeAlertConfig,n),i.setOgeAlertColorType2Show(),!1!==i.ogeAlertConfig.withAlertTab&&i.events.on("init-edit-mode",i.onOgeAlertInitMetricsPanelEditMode.bind(i)),i}return J.c(e,t),e.prototype.onOgeAlertInitMetricsPanelEditMode=function(){this.addEditorTab("Alert Config","public/app/partials/oge_alert.html")},e.prototype.getAlertLevelColor=function(t){return this.ogeAlertSrv.getLevelColor(t,this.panel.ogeAlertColors)},e.prototype.getAlertLevelName=function(t){return this.ogeAlertSrv.getLevelName(t)},e.prototype.getCoverValue=function(t,e){if(this.panel.ogeAlertEnabled){if(this.panel.ogeAlertNameCoverValue)return this.getAlertLevelName(t.level);if(this.panel.ogeAlertValueCoverValue)return t.value}return e},e.prototype.selectCoverValue=function(t){t?this.panel.ogeAlertValueCoverValue=!1:this.panel.ogeAlertNameCoverValue=!1,this.render()},e.prototype.getCoverTime=function(t,e){return this.panel.ogeAlertEnabled&&this.panel.ogeAlertNameCoverValue?t.time:e},e.prototype.changeOgeAlertColorType=function(t){this.panel.ogeAlertColorType=t,this.setOgeAlertColorType2Show(),this.render()},e.prototype.maxAlertLevelOriginCode=function(t){return this.ogeAlertSrv.maxLevelOriginCode(t)},e.prototype.setOgeAlertColorType2Show=function(){switch(this.ogeAlertColorValue=!1,this.ogeAlertColorBackground=!1,this.ogeAlertColorRow=!1,this.panel.ogeAlertColorType){case"V":this.ogeAlertColorValue=!0;break;case"B":this.ogeAlertColorBackground=!0;break;case"R":this.ogeAlertColorRow=!0}},e}(Bt),Ht=function(){function t(t,e){this.$scope=t,this.$injector=e,this.panel=this.panelCtrl.panel,this.isLastQuery=I.a.indexOf(this.panel.targets,this.target)===this.panel.targets.length-1}return t.prototype.refresh=function(){this.panelCtrl.refresh()},t}(),zt=function(){function t(){}return t.alertToGraphThresholds=function(t){for(var e=0;e<t.alert.conditions.length;e++){var r=t.alert.conditions[e];if("query"===r.type){var n=r.evaluator,a=t.thresholds=[];switch(n.type){case"gt":var i=n.params[0];a.push({value:i,op:"gt"});break;case"lt":i=n.params[0];a.push({value:i,op:"lt"});break;case"outside_range":(s=n.params[0])>(o=n.params[1])?(a.push({value:s,op:"gt"}),a.push({value:o,op:"lt"})):(a.push({value:s,op:"lt"}),a.push({value:o,op:"gt"}));break;case"within_range":var s,o;(s=n.params[0])>(o=n.params[1])?(a.push({value:s,op:"lt"}),a.push({value:o,op:"gt"})):(a.push({value:s,op:"gt"}),a.push({value:o,op:"lt"}))}break}}for(var l=0,c=t.thresholds;l<c.length;l++){var u=c[l];u.fill=!0,u.line=!0,u.colorMode="critical"}return!0},t}(),Gt=r(22),Wt=r(45),Yt=function(){function t(t,e,r,n,a,i){this.$scope=t,this.backendSrv=e,this.dashboardSrv=r,this.uiSegmentSrv=n,this.$q=a,this.datasourceSrv=i,this.panelCtrl=t.ctrl,this.panel=this.panelCtrl.panel,this.$scope.ctrl=this,this.subTabIndex=0,this.evalFunctions=Wt.a.evalFunctions,this.evalOperators=Wt.a.evalOperators,this.conditionTypes=Wt.a.conditionTypes,this.noDataModes=Wt.a.noDataModes,this.executionErrorModes=Wt.a.executionErrorModes,this.appSubUrl=B.a.appSubUrl}return t.$inject=["$scope","backendSrv","dashboardSrv","uiSegmentSrv","$q","datasourceSrv"],t.prototype.$onInit=function(){var t=this;this.addNotificationSegment=this.uiSegmentSrv.newPlusButton();var e=this.graphThresholdChanged.bind(this);return this.panelCtrl.events.on("threshold-changed",e),this.$scope.$on("$destroy",function(){t.panelCtrl.events.off("threshold-changed",e),t.panelCtrl.editingThresholds=!1,t.panelCtrl.render()}),this.notifications=[],this.alertNotifications=[],this.alertHistory=[],this.backendSrv.get("/api/alert-notifications").then(function(e){t.notifications=e,t.initModel(),t.validateModel()})},t.prototype.getAlertHistory=function(){var t=this;this.backendSrv.get("/api/annotations?dashboardId="+this.panelCtrl.dashboard.id+"&panelId="+this.panel.id+"&limit=50&type=alert").then(function(e){t.alertHistory=I.a.map(e,function(e){return e.time=t.dashboardSrv.getCurrent().formatDate(e.time,"MMM D, YYYY HH:mm:ss"),e.stateModel=Wt.a.getStateDisplayModel(e.newState),e.info=Wt.a.getAlertAnnotationInfo(e),e})})},t.prototype.getNotificationIcon=function(t){switch(t){case"email":return"fa fa-envelope";case"slack":return"fa fa-slack";case"victorops":return"fa fa-pagelines";case"webhook":return"fa fa-cubes";case"pagerduty":return"fa fa-bullhorn";case"opsgenie":return"fa fa-bell";case"hipchat":return"fa fa-mail-forward";case"pushover":return"fa fa-mobile";case"kafka":return"fa fa-random";case"teams":return"fa fa-windows"}return"fa fa-bell"},t.prototype.getNotifications=function(){var t=this;return Promise.resolve(this.notifications.map(function(e){return t.uiSegmentSrv.newSegment(e.name)}))},t.prototype.changeTabIndex=function(t){this.subTabIndex=t,2===this.subTabIndex&&this.getAlertHistory()},t.prototype.notificationAdded=function(){var t=I.a.find(this.notifications,{name:this.addNotificationSegment.value});t&&(this.alertNotifications.push({name:t.name,iconClass:this.getNotificationIcon(t.type),isDefault:!1}),this.alert.notifications.push({id:t.id}),this.addNotificationSegment.value=this.uiSegmentSrv.newPlusButton().value,this.addNotificationSegment.html=this.uiSegmentSrv.newPlusButton().html)},t.prototype.removeNotification=function(t){this.alert.notifications.splice(t,1),this.alertNotifications.splice(t,1)},t.prototype.initModel=function(){var t=this,e=this.alert=this.panel.alert;if(e){e.conditions=e.conditions||[],0===e.conditions.length&&e.conditions.push(this.buildDefaultCondition()),e.noDataState=e.noDataState||B.a.alertingNoDataOrNullValues,e.executionErrorState=e.executionErrorState||B.a.alertingErrorOrTimeout,e.frequency=e.frequency||"1m",e.handler=e.handler||1,e.notifications=e.notifications||[],e.for=e.for||"0m";var r=this.panel.title+" alert";e.name=e.name||r,this.conditionModels=I.a.reduce(e.conditions,function(e,r){return e.push(t.buildConditionModel(r)),e},[]),zt.alertToGraphThresholds(this.panel);for(var n=0,a=e.notifications;n<a.length;n++){var i=a[n],s=I.a.find(this.notifications,{id:i.id});s&&!1===s.isDefault&&(s.iconClass=this.getNotificationIcon(s.type),this.alertNotifications.push(s))}for(var o=0,l=this.notifications;o<l.length;o++){var c=l[o];c.isDefault&&(c.iconClass=this.getNotificationIcon(c.type),c.bgColor="#00678b",this.alertNotifications.push(c))}this.panelCtrl.editingThresholds=!0,this.panelCtrl.render()}},t.prototype.graphThresholdChanged=function(t){for(var e=0,r=this.alert.conditions;e<r.length;e++){var n=r[e];if("query"===n.type){n.evaluator.params[t.handleIndex]=t.threshold.value,this.evaluatorParamsChanged();break}}},t.prototype.buildDefaultCondition=function(){return{type:"query",query:{params:["A","5m","now"]},reducer:{type:"avg",params:[]},evaluator:{type:"gt",params:[null]},operator:{type:"and"}}},t.prototype.validateModel=function(){var t=this;if(this.alert)for(var e,r=null,n=0,a=this.alert.conditions;n<a.length;n++){var i=a[n];if("query"===i.type){for(var s=0,o=this.panel.targets;s<o.length;s++){var l=o[s];if(e||(e=l),i.query.params[0]===l.refId){r=l;break}}r||(e?(i.query.params[0]=e.refId,r=e):this.error="无法找到任何度量查询");var c=r.datasource||this.panel.datasource;this.datasourceSrv.get(c).then(function(e){e.meta.alerting?e.targetContainsTemplate(r)?t.error="在警报查询中不支持模板变量":t.error="":t.error="数据源不支持警报查询"})}}},t.prototype.buildConditionModel=function(t){var e={source:t,type:t.type};return e.queryPart=new Gt.a(t.query,Wt.a.alertQueryDef),e.reducerPart=Wt.a.createReducerPart(t.reducer),e.evaluator=t.evaluator,e.operator=t.operator,e},t.prototype.handleQueryPartEvent=function(t,e){var r=this;switch(e.name){case"action-remove-part":break;case"get-part-actions":return this.$q.when([]);case"part-param-changed":this.validateModel();case"get-param-options":var n=this.panel.targets.map(function(t){return r.uiSegmentSrv.newSegment({value:t.refId})});return this.$q.when(n)}},t.prototype.handleReducerPartEvent=function(t,e){switch(e.name){case"action":t.source.reducer.type=e.action.value,t.reducerPart=Wt.a.createReducerPart(t.source.reducer);break;case"get-part-actions":for(var r=[],n=0,a=Wt.a.reducerTypes;n<a.length;n++){var i=a[n];i.value!==t.source.reducer.type&&r.push(i)}return this.$q.when(r)}},t.prototype.addCondition=function(t){var e=this.buildDefaultCondition();this.alert.conditions.push(e),this.conditionModels.push(this.buildConditionModel(e))},t.prototype.removeCondition=function(t){this.alert.conditions.splice(t,1),this.conditionModels.splice(t,1)},t.prototype.delete=function(){var t=this;bt.a.emit("confirm-modal",{title:"删除报警",text:"您确定要删除此警报规则吗?",text2:"您需要先保存仪表盘，删除生效。",icon:"fa-trash",yesText:"删除",onConfirm:function(){delete t.panel.alert,t.alert=null,t.panel.thresholds=[],t.conditionModels=[],t.panelCtrl.alertState=null,t.panelCtrl.render()}})},t.prototype.enable=function(){this.panel.alert={},this.initModel(),this.panel.alert.for="5m"},t.prototype.evaluatorParamsChanged=function(){zt.alertToGraphThresholds(this.panel),this.panelCtrl.render()},t.prototype.evaluatorTypeChanged=function(t){switch(t.type){case"lt":case"gt":t.params=[t.params[0]];break;case"within_range":case"outside_range":t.params=[t.params[0],t.params[1]];break;case"no_value":t.params=[]}this.evaluatorParamsChanged()},t.prototype.clearHistory=function(){var t=this;bt.a.emit("confirm-modal",{title:"删除报警历史",text:"您确定要删除此警报的所有历史记录和注释吗?",icon:"fa-trash",yesText:"是的",onConfirm:function(){t.backendSrv.post("/api/annotations/mass-delete",{dashboardId:t.panelCtrl.dashboard.id,panelId:t.panel.id}).then(function(e){t.alertHistory=[],t.panelCtrl.refresh()})}})},t.prototype.test=function(){var t=this;this.testing=!0,this.testResult=!1;var e={dashboard:this.dashboardSrv.getCurrent().getSaveModelClone(),panelId:this.panelCtrl.panel.id};return this.backendSrv.post("/api/alerts/test",e).then(function(e){t.testResult=e,t.testing=!1})},t}();function Kt(){return{restrict:"E",scope:!0,templateUrl:"public/app/features/alerting/partials/alert_tab.html",controller:Yt}}var Jt=r(118),Xt=r.n(Jt),Zt=r(17),te=r(254),ee=r(175),re=r(63),ne=r(73),ae=r(629),ie="YYYY-MM-DDTHH:mm:ssZ",se=1,oe=0,le=",",ce="\r\n",ue="",de="kam_data_export.csv";function pe(t){return t?t.split(ue).join(ue+ue):t}var he=new DOMParser;function fe(t){if(!t)return t;var e=/&[^;]+;/g;function r(t){return he.parseFromString(t,"text/html").body.textContent}return t.replace(e,r).replace(e,r)}function me(t){return t?"sep="+le+ce:""}function ge(t,e){void 0===e&&(e=!0);for(var r="",n=0;n<t.length;n+=1)Object(O.isBoolean)(t[n])||Object(ae.isNullOrUndefined)(t[n])?r+=t[n]:Object(O.isNumber)(t[n])?r+=t[n].toLocaleString():r+=""+ue+pe(Object(O.unescape)(fe(t[n])))+ue,n<t.length-1&&(r+=le);return e?r+ce:r}function ve(t,e,r){void 0===e&&(e=ie),void 0===r&&(r=!1);for(var n=me(r)+ge(["Series","Time","Value"]),a=0;a<t.length;a+=1)for(var i=0;i<t[a].datapoints.length;i+=1)n+=ge([t[a].alias,H()(t[a].datapoints[i][se]).format(e),t[a].datapoints[i][oe]],i<t[a].datapoints.length-1||a<t.length-1);return n}function be(t,e,r){void 0===e&&(e=ie),void 0===r&&(r=!1),ke(ve(t,e,r),de)}function ye(t,e,r){void 0===e&&(e=ie),void 0===r&&(r=!1);var n=me(r)+ge(["Time"].concat(t.map(function(t){return t.alias})));t=function(t){for(var e=[],r=0;r<t.length;r++)for(var n=t[r].datapoints,a=0;a<n.length;a++)e.push(n[a][se]);e=Object(O.sortedUniq)(e.sort());for(var r=0;r<t.length;r++){for(var n=t[r].datapoints,i=n.map(function(t){return t[se]}),s=[],o=void 0,a=0;a<e.length;a++)-1!==(o=Object(O.sortedIndexOf)(i,e[a]))?s.push(n[o]):s.push([null,e[a]]);t[r].datapoints=s}return t}(t);for(var a=function(r){var a=H()(t[0].datapoints[r][se]).format(e);n+=ge([a].concat(t.map(function(t){return t.datapoints[r][oe]})),r<t[0].datapoints.length-1)},i=0;i<t[0].datapoints.length;i+=1)a(i);return n}function we(t,e,r){void 0===e&&(e=ie),void 0===r&&(r=!1),ke(ye(t,e,r),de)}function xe(t,e){void 0===e&&(e=!1);var r="";r+=ge(t.columns.map(function(t){return t.title||t.text}));for(var n=0;n<t.rows.length;n+=1)r+=ge(t.rows[n],n<t.rows.length-1);return r}function Se(t,e){void 0===e&&(e=!1),ke(xe(t,e),de)}function ke(t,e){var r=new Blob(["\ufeff"+t],{type:"text/plain;charset=utf-8"});Object(D.saveAs)(r,e)}function Ce(t,e){var r=xe(e,!1),n=new Blob(["\ufeff"+r],{type:"text/plain;charset=utf-8"}),a=t+".csv";Object(D.saveAs)(n,a)}function Te(t,e){var r=(e=e||{}).delimiter||".",n=e.maxDepth||3,a=1,i={};return function t(s,o){Object.keys(s).forEach(function(l){var c=s[l],u=e.safe&&Array.isArray(c),d="[object Object]"===Object.prototype.toString.call(c),p=o?o+r+l:l;if(e.maxDepth||(n=a+1),!u&&d&&Object.keys(c).length&&a<n)return++a,t(c,p);i[p]=c})}(t,null),i}var Ee=r(42),_e=r(116),Me=/^(\d+)(?:\.(\d+))?(?:\.(\d+))?(?:-([0-9A-Za-z\.]+))?/,Ae=function(){function t(t){var e=Me.exec(t);e&&(this.major=Number(e[1]),this.minor=Number(e[2]||0),this.patch=Number(e[3]||0),this.meta=e[4])}return t.prototype.isGtOrEq=function(e){var r=new t(e);return!(this.major<r.major||this.minor<r.minor||this.patch<r.patch)},t.prototype.isValid=function(){return I.a.isNumber(this.major)},t}();function Pe(t,e){return new Ae(t).isGtOrEq(e)}var $e={};function De(t){t.params=t.params||[],t.defaultParams=t.defaultParams||[],$e[t.name]=t,t.shortName&&($e[t.shortName]=t)}var Oe=[{name:"other",type:"value_or_series",optional:!0,multiple:!0}];function Ie(t,e){return!t.version||Pe(e,t.version)}De({name:"scaleToSeconds",category:"Transform",params:[{name:"seconds",type:"int"}],defaultParams:[1]}),De({name:"perSecond",category:"Transform",params:[{name:"max value",type:"int",optional:!0}],defaultParams:[]}),De({name:"holtWintersForecast",category:"Calculate"}),De({name:"holtWintersConfidenceBands",category:"Calculate",params:[{name:"delta",type:"int"}],defaultParams:[3]}),De({name:"holtWintersAberration",category:"Calculate",params:[{name:"delta",type:"int"}],defaultParams:[3]}),De({name:"nPercentile",category:"Calculate",params:[{name:"Nth percentile",type:"int"}],defaultParams:[95]}),De({name:"diffSeries",params:Oe,defaultParams:["#A"],category:"Combine"}),De({name:"stddevSeries",params:Oe,defaultParams:[""],category:"Combine"}),De({name:"divideSeries",params:Oe,defaultParams:["#A"],category:"Combine"}),De({name:"multiplySeries",params:Oe,defaultParams:["#A"],category:"Combine"}),De({name:"asPercent",params:Oe,defaultParams:["#A"],category:"Combine"}),De({name:"group",params:Oe,defaultParams:["#A","#B"],category:"Combine"}),De({name:"sumSeries",shortName:"sum",category:"Combine",params:Oe,defaultParams:[""]}),De({name:"averageSeries",shortName:"avg",category:"Combine",params:Oe,defaultParams:[""]}),De({name:"rangeOfSeries",category:"Combine"}),De({name:"percentileOfSeries",category:"Combine",params:[{name:"n",type:"int"},{name:"interpolate",type:"boolean",options:["true","false"]}],defaultParams:[95,"false"]}),De({name:"sumSeriesWithWildcards",category:"Combine",params:[{name:"node",type:"int",multiple:!0}],defaultParams:[3]}),De({name:"maxSeries",shortName:"max",category:"Combine"}),De({name:"minSeries",shortName:"min",category:"Combine"}),De({name:"averageSeriesWithWildcards",category:"Combine",params:[{name:"node",type:"int",multiple:!0}],defaultParams:[3]}),De({name:"alias",category:"Alias",params:[{name:"alias",type:"string"}],defaultParams:["alias"]}),De({name:"aliasSub",category:"Alias",params:[{name:"search",type:"string"},{name:"replace",type:"string"}],defaultParams:["","\\1"]}),De({name:"consolidateBy",category:"Special",params:[{name:"function",type:"string",options:["sum","average","min","max"]}],defaultParams:["max"]}),De({name:"cumulative",category:"Special",params:[],defaultParams:[]}),De({name:"groupByNode",category:"Combine",params:[{name:"node",type:"int",options:[0,1,2,3,4,5,6,7,8,9,10,12]},{name:"function",type:"string",options:["sum","avg","maxSeries"]}],defaultParams:[3,"sum"]}),De({name:"aliasByNode",category:"Alias",params:[{name:"node",type:"int",options:[0,1,2,3,4,5,6,7,8,9,10,12],multiple:!0}],defaultParams:[3]}),De({name:"substr",category:"Special",params:[{name:"start",type:"int",options:[-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10,12]},{name:"stop",type:"int",options:[-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10,12]}],defaultParams:[0,0]}),De({name:"sortByName",category:"Sorting",params:[{name:"natural",type:"boolean",options:["true","false"],optional:!0}],defaultParams:["false"]}),De({name:"sortByMaxima",category:"Sorting"}),De({name:"sortByMinima",category:"Sorting"}),De({name:"sortByTotal",category:"Sorting"}),De({name:"aliasByMetric",category:"Alias"}),De({name:"randomWalk",fake:!0,category:"Special",params:[{name:"name",type:"string"}],defaultParams:["randomWalk"]}),De({name:"countSeries",category:"Combine"}),De({name:"constantLine",category:"Special",params:[{name:"value",type:"int"}],defaultParams:[10]}),De({name:"cactiStyle",category:"Special"}),De({name:"keepLastValue",category:"Transform",params:[{name:"n",type:"int"}],defaultParams:[100]}),De({name:"changed",category:"Special",params:[],defaultParams:[]}),De({name:"scale",category:"Transform",params:[{name:"factor",type:"int"}],defaultParams:[1]}),De({name:"offset",category:"Transform",params:[{name:"amount",type:"int"}],defaultParams:[10]}),De({name:"transformNull",category:"Transform",params:[{name:"amount",type:"int"}],defaultParams:[0]}),De({name:"integral",category:"Transform"}),De({name:"derivative",category:"Transform"}),De({name:"nonNegativeDerivative",category:"Transform",params:[{name:"max value or 0",type:"int",optional:!0}],defaultParams:[""]}),De({name:"timeShift",category:"Transform",params:[{name:"amount",type:"select",options:["1h","6h","12h","1d","2d","7d","14d","30d"]}],defaultParams:["1d"]}),De({name:"timeStack",category:"Transform",params:[{name:"timeShiftUnit",type:"select",options:["1h","6h","12h","1d","2d","7d","14d","30d"]},{name:"timeShiftStart",type:"int"},{name:"timeShiftEnd",type:"int"}],defaultParams:["1d",0,7]}),De({name:"summarize",category:"Transform",params:[{name:"interval",type:"string"},{name:"func",type:"select",options:["sum","avg","min","max","last"]},{name:"alignToFrom",type:"boolean",optional:!0,options:["false","true"]}],defaultParams:["1h","sum","false"]}),De({name:"smartSummarize",category:"Transform",params:[{name:"interval",type:"string"},{name:"func",type:"select",options:["sum","avg","min","max","last"]}],defaultParams:["1h","sum"]}),De({name:"absolute",category:"Transform"}),De({name:"hitcount",category:"Transform",params:[{name:"interval",type:"string"}],defaultParams:["10s"]}),De({name:"log",category:"Transform",params:[{name:"base",type:"int"}],defaultParams:["10"]}),De({name:"averageAbove",category:"Filter Series",params:[{name:"n",type:"int"}],defaultParams:[25]}),De({name:"averageBelow",category:"Filter Series",params:[{name:"n",type:"int"}],defaultParams:[25]}),De({name:"currentAbove",category:"Filter Series",params:[{name:"n",type:"int"}],defaultParams:[25]}),De({name:"currentBelow",category:"Filter Series",params:[{name:"n",type:"int"}],defaultParams:[25]}),De({name:"maximumAbove",category:"Filter Series",params:[{name:"value",type:"int"}],defaultParams:[0]}),De({name:"maximumBelow",category:"Filter Series",params:[{name:"value",type:"int"}],defaultParams:[0]}),De({name:"minimumAbove",category:"Filter Series",params:[{name:"value",type:"int"}],defaultParams:[0]}),De({name:"minimumBelow",category:"Filter Series",params:[{name:"value",type:"int"}],defaultParams:[0]}),De({name:"limit",category:"Filter Series",params:[{name:"n",type:"int"}],defaultParams:[5]}),De({name:"mostDeviant",category:"Filter Series",params:[{name:"n",type:"int"}],defaultParams:[10]}),De({name:"exclude",category:"Filter Series",params:[{name:"exclude",type:"string"}],defaultParams:["exclude"]}),De({name:"highestCurrent",category:"Filter Series",params:[{name:"count",type:"int"}],defaultParams:[5]}),De({name:"highestMax",category:"Filter Series",params:[{name:"count",type:"int"}],defaultParams:[5]}),De({name:"lowestCurrent",category:"Filter Series",params:[{name:"count",type:"int"}],defaultParams:[5]}),De({name:"movingAverage",category:"Calculate",params:[{name:"windowSize",type:"int_or_interval",options:["5","7","10","5min","10min","30min","1hour"]}],defaultParams:[10]}),De({name:"movingMedian",category:"Calculate",params:[{name:"windowSize",type:"int_or_interval",options:["5","7","10","5min","10min","30min","1hour"]}],defaultParams:["5"]}),De({name:"stdev",category:"Calculate",params:[{name:"n",type:"int"},{name:"tolerance",type:"int"}],defaultParams:[5,.1]}),De({name:"highestAverage",category:"Filter Series",params:[{name:"count",type:"int"}],defaultParams:[5]}),De({name:"lowestAverage",category:"Filter Series",params:[{name:"count",type:"int"}],defaultParams:[5]}),De({name:"removeAbovePercentile",category:"Filter Data",params:[{name:"n",type:"int"}],defaultParams:[5]}),De({name:"removeAboveValue",category:"Filter Data",params:[{name:"n",type:"int"}],defaultParams:[5]}),De({name:"removeBelowPercentile",category:"Filter Data",params:[{name:"n",type:"int"}],defaultParams:[5]}),De({name:"removeBelowValue",category:"Filter Data",params:[{name:"n",type:"int"}],defaultParams:[5]}),De({name:"useSeriesAbove",category:"Filter Series",params:[{name:"value",type:"int"},{name:"search",type:"string"},{name:"replace",type:"string"}],defaultParams:[0,"search","replace"]}),De({name:"aggregateLine",category:"Calculate",params:[{name:"func",type:"select",options:["sum","avg","min","max","last"]}],defaultParams:["avg"],version:"1.0"}),De({name:"averageOutsidePercentile",category:"Filter Series",params:[{name:"n",type:"int"}],defaultParams:[95],version:"1.0"}),De({name:"delay",category:"Transform",params:[{name:"steps",type:"int"}],defaultParams:[1],version:"1.0"}),De({name:"exponentialMovingAverage",category:"Calculate",params:[{name:"windowSize",type:"int_or_interval",options:["5","7","10","5min","10min","30min","1hour"]}],defaultParams:[10],version:"1.0"}),De({name:"fallbackSeries",category:"Special",params:[{name:"fallback",type:"string"}],defaultParams:["constantLine(0)"],version:"1.0"}),De({name:"grep",category:"Filter Series",params:[{name:"grep",type:"string"}],defaultParams:["grep"],version:"1.0"}),De({name:"groupByNodes",category:"Combine",params:[{name:"function",type:"string",options:["sum","avg","maxSeries"]},{name:"node",type:"int",options:[0,1,2,3,4,5,6,7,8,9,10,12],multiple:!0}],defaultParams:["sum",3],version:"1.0"}),De({name:"integralByInterval",category:"Transform",params:[{name:"intervalUnit",type:"select",options:["1h","6h","12h","1d","2d","7d","14d","30d"]}],defaultParams:["1d"],version:"1.0"}),De({name:"interpolate",category:"Transform",params:[{name:"limit",type:"int",optional:!0}],defaultParams:[],version:"1.0"}),De({name:"invert",category:"Transform",version:"1.0"}),De({name:"isNonNull",category:"Combine",version:"1.0"}),De({name:"linearRegression",category:"Calculate",params:[{name:"startSourceAt",type:"select",options:["-1h","-6h","-12h","-1d","-2d","-7d","-14d","-30d"],optional:!0},{name:"endSourceAt",type:"select",options:["-1h","-6h","-12h","-1d","-2d","-7d","-14d","-30d"],optional:!0}],defaultParams:[],version:"1.0"}),De({name:"mapSeries",shortName:"map",params:[{name:"node",type:"int"}],defaultParams:[3],category:"Combine",version:"1.0"}),De({name:"movingMin",category:"Calculate",params:[{name:"windowSize",type:"int_or_interval",options:["5","7","10","5min","10min","30min","1hour"]}],defaultParams:[10],version:"1.0"}),De({name:"movingMax",category:"Calculate",params:[{name:"windowSize",type:"int_or_interval",options:["5","7","10","5min","10min","30min","1hour"]}],defaultParams:[10],version:"1.0"}),De({name:"movingSum",category:"Calculate",params:[{name:"windowSize",type:"int_or_interval",options:["5","7","10","5min","10min","30min","1hour"]}],defaultParams:[10],version:"1.0"}),De({name:"multiplySeriesWithWildcards",category:"Combine",params:[{name:"position",type:"int",options:[0,1,2,3,4,5,6,7,8,9,10,12],multiple:!0}],defaultParams:[2],version:"1.0"}),De({name:"offsetToZero",category:"Transform",version:"1.0"}),De({name:"pow",category:"Transform",params:[{name:"factor",type:"int"}],defaultParams:[10],version:"1.0"}),De({name:"powSeries",category:"Transform",params:Oe,defaultParams:[""],version:"1.0"}),De({name:"reduceSeries",shortName:"reduce",params:[{name:"function",type:"string",options:["asPercent","diffSeries","divideSeries"]},{name:"reduceNode",type:"int",options:[0,1,2,3,4,5,6,7,8,9,10,11,12,13]},{name:"reduceMatchers",type:"string",multiple:!0}],defaultParams:["asPercent",2,"used_bytes"],category:"Combine",version:"1.0"}),De({name:"removeBetweenPercentile",category:"Filter Series",params:[{name:"n",type:"int"}],defaultParams:[95],version:"1.0"}),De({name:"removeEmptySeries",category:"Filter Series",version:"1.0"}),De({name:"squareRoot",category:"Transform",version:"1.0"}),De({name:"timeSlice",category:"Transform",params:[{name:"startSliceAt",type:"select",options:["-1h","-6h","-12h","-1d","-2d","-7d","-14d","-30d"]},{name:"endSliceAt",type:"select",options:["-1h","-6h","-12h","-1d","-2d","-7d","-14d","-30d"],optional:!0}],defaultParams:["-1h"],version:"1.0"}),De({name:"weightedAverage",category:"Combine",params:[{name:"other",type:"value_or_series",optional:!0},{name:"node",type:"int",options:[0,1,2,3,4,5,6,7,8,9,10,12]}],defaultParams:["#A",4],version:"1.0"}),De({name:"seriesByTag",category:"Special",params:[{name:"tagExpression",type:"string",multiple:!0}],version:"1.1"}),De({name:"groupByTags",category:"Combine",params:[{name:"function",type:"string",options:["sum","avg","maxSeries"]},{name:"tag",type:"string",multiple:!0}],defaultParams:["sum","tag"],version:"1.1"}),De({name:"aliasByTags",category:"Alias",params:[{name:"tag",type:"string",multiple:!0}],defaultParams:["tag"],version:"1.1"});var Ne=function(){function t(t,e){this.def=t,this.params=[],e&&e.withDefaultParams&&(this.params=t.defaultParams.slice(0)),this.updateText()}return t.prototype.render=function(t){for(var e=this,r=this.def.name+"(",n=I.a.map(this.params,function(t,r){var n;return r<e.def.params.length?n=e.def.params[r].type:I.a.get(I.a.last(e.def.params),"multiple")&&(n=I.a.get(I.a.last(e.def.params),"type")),I.a.includes(["value_or_series","boolean","int","float","node"],n)?t:I.a.includes(["int_or_interval","node_or_tag"],n)&&I.a.isFinite(+t)?I.a.toString(+t):"'"+t+"'"});""===n[n.length-1];)n.pop();return t&&n.unshift(t),r+n.join(", ")+")"},t.prototype._hasMultipleParamsInString=function(t,e){return-1!==t.indexOf(",")&&(!(!this.def.params[e+1]||!this.def.params[e+1].optional)||!!(e+1>=this.def.params.length&&I.a.get(I.a.last(this.def.params),"multiple")))},t.prototype.updateParam=function(t,e){var r=this;this._hasMultipleParamsInString(t,e)?I.a.each(t.split(","),function(t,n){r.updateParam(t.trim(),e+n)}):(""===t&&(e>=this.def.params.length||this.def.params[e].optional)?this.params.splice(e,1):this.params[e]=t,this.updateText())},t.prototype.updateText=function(){if(0!==this.params.length){var t=this.def.name+"(";t+=this.params.join(", "),t+=")",this.text=t}else this.text=this.def.name+"()"},t}();function Fe(t,e){if(!(e||$e)[t])throw{message:"Method not found "+t};return(e||$e)[t]}var qe={createFuncInstance:function(t,e,r){return I.a.isString(t)&&(t=Fe(t,r)),new Ne(t,e)},getFuncDef:Fe,getFuncDefs:function(t,e){var r={};return I.a.forEach(e||$e,function(e){Ie(e,t)&&(r[e.name]=I.a.assign({},e,{params:I.a.filter(e.params,function(e){return Ie(e,t)})}))}),r},parseFuncDefs:function(t){var e={};return I.a.forEach(t||{},function(t,r){if("Graph"!==t.group){var n=t.description;n&&(n=n.replace(/:py:func:`(.+)( <[^>]*>)?`/g,"``$1``").replace(/.. seealso:: /g,"See also: ").replace(/.. code-block *:: *none/g,".. code-block::"));var a={name:t.name,description:n,category:t.group,params:[],defaultParams:[],fake:!1};/^seriesLists?$/.test(I.a.get(t,"params[0].type",""))?t.params[0].multiple?t.params[0].required=!1:t.params.shift():a.fake=!0,I.a.forEach(t.params,function(t){var e={name:t.name,type:"string",optional:!t.required,multiple:!!t.multiple,options:void 0};void 0!==t.default?a.defaultParams.push(I.a.toString(t.default)):t.suggestions?a.defaultParams.push(I.a.toString(t.suggestions[0])):a.defaultParams.push(""),"boolean"===t.type?(e.type="boolean",e.options=["true","false"]):"integer"===t.type?e.type="int":"float"===t.type?e.type="float":"node"===t.type?(e.type="node",e.options=["0","1","2","3","4","5","6","7","8","9","10","11","12"]):"nodeOrTag"===t.type?(e.type="node_or_tag",e.options=["name","0","1","2","3","4","5","6","7","8","9","10","11","12"]):"intOrInterval"===t.type?e.type="int_or_interval":"seriesList"===t.type&&(e.type="value_or_series"),t.options?e.options=I.a.map(t.options,I.a.toString):t.suggestions&&(e.options=I.a.map(t.suggestions,I.a.toString)),a.params.push(e)}),e[r]=a}}),e}};function Le(t,e,r,n){var a=this;this.basicAuth=t.basicAuth,this.url=t.url,this.name=t.name,this.graphiteVersion=t.jsonData.graphiteVersion||"0.9",this.supportsTags=function(t){return Pe(t,"1.1")}(this.graphiteVersion),this.cacheTimeout=t.cacheTimeout,this.withCredentials=t.withCredentials,this.render_method=t.render_method||"POST",this.funcDefs=null,this.funcDefsPromise=null,this.getQueryOptionsInfo=function(){return{maxDataPoints:!0,cacheTimeout:!0,links:[{text:"Help",url:"http://docs.grafana.org/features/datasources/graphite/#using-graphite-in-grafana"}]}},this.query=function(t){var r={from:this.translateTime(t.rangeRaw.from,!1),until:this.translateTime(t.rangeRaw.to,!0),targets:t.targets,format:t.format,cacheTimeout:t.cacheTimeout||this.cacheTimeout,maxDataPoints:t.maxDataPoints},n=this.buildGraphiteParams(r,t.scopedVars);if(0===n.length)return e.when({data:[]});var a={method:"POST",url:"/render",data:n.join("&"),headers:{"Content-Type":"application/x-www-form-urlencoded"}};return this.addTracingHeaders(a,t),t.panelId&&(a.requestId=this.name+".panelId."+t.panelId),this.doGraphiteRequest(a).then(this.convertDataPointsToMs)},this.addTracingHeaders=function(t,e){!this.url.match(/^http/)&&(t.headers["X-Dashboard-Id"]=e.dashboardId,t.headers["X-Panel-Id"]=e.panelId)},this.convertDataPointsToMs=function(t){if(!t||!t.data)return[];for(var e=0;e<t.data.length;e++)for(var r=t.data[e],n=0;n<r.datapoints.length;n++)r.datapoints[n][1]*=1e3;return t},this.parseTags=function(t){var e=[];return 1===(e=t.split(",")).length&&""===(e=t.split(" "))[0]&&(e=[]),e},this.annotationQuery=function(t){var e=this;if(t.annotation.target){var r=n.replace(t.annotation.target,{},"glob"),a={rangeRaw:t.rangeRaw,targets:[{target:r}],format:"json",maxDataPoints:100};return this.query(a).then(function(e){for(var r=[],n=0;n<e.data.length;n++)for(var a=e.data[n],i=0;i<a.datapoints.length;i++){var s=a.datapoints[i];s[0]&&r.push({annotation:t.annotation,time:s[1],title:a.target})}return r})}var i=n.replace(t.annotation.tags);return this.events({range:t.rangeRaw,tags:i}).then(function(r){for(var n=[],a=0;a<r.data.length;a++){var i=r.data[a],s=i.tags;I.a.isString(i.tags)&&(s=e.parseTags(i.tags)),n.push({annotation:t.annotation,time:1e3*i.when,title:i.what,tags:s,text:i.data})}return n})},this.events=function(t){try{var r="";return t.tags&&(r="&tags="+t.tags),this.doGraphiteRequest({method:"GET",url:"/events/get_data?from="+this.translateTime(t.range.from,!1)+"&until="+this.translateTime(t.range.to,!0)+r})}catch(t){return e.reject(t)}},this.targetContainsTemplate=function(t){return n.variableExists(t.target)},this.translateTime=function(t,e){if(I.a.isString(t)){if("now"===t)return"now";if(t.indexOf("now-")>=0&&-1===t.indexOf("/"))return t=(t=(t=t.substring(3)).replace("m","min")).replace("M","mon");t=Ct.parse(t,e)}return e?t.get("s")&&t.add(1,"m"):!1===e&&t.get("s")&&t.subtract(1,"m"),t.unix()},this.metricFindQuery=function(t,e){var r=e||{},a=n.replace(t),i=a.match(/^tag_values\(([^,]+)((, *[^,]+)*)\)$/);if(i){for(var s=[],o=(l=/, *([^,]+)/g).exec(i[2]);null!==o;)s.push(o[1]),o=l.exec(i[2]);return r.limit=1e4,this.getTagValuesAutoComplete(s,i[1],void 0,r)}if(i=a.match(/^tags\(([^,]*)((, *[^,]+)*)\)$/)){s=[];if(i[1]){s.push(i[1]);var l;for(o=(l=/, *([^,]+)/g).exec(i[2]);null!==o;)s.push(o[1]),o=l.exec(i[2])}return r.limit=1e4,this.getTagsAutoComplete(s,void 0,r)}var c={method:"GET",url:"/metrics/find",params:{query:a},requestId:r.requestId};return r.range&&(c.params.from=this.translateTime(r.range.from,!1),c.params.until=this.translateTime(r.range.to,!0)),this.doGraphiteRequest(c).then(function(t){return I.a.map(t.data,function(t){return{text:t.text,expandable:!!t.expandable}})})},this.getTags=function(t){var e=t||{},r={method:"GET",url:"/tags",requestId:e.requestId};return e.range&&(r.params.from=this.translateTime(e.range.from,!1),r.params.until=this.translateTime(e.range.to,!0)),this.doGraphiteRequest(r).then(function(t){return I.a.map(t.data,function(t){return{text:t.tag,id:t.id}})})},this.getTagValues=function(t,e){var r=e||{},a={method:"GET",url:"/tags/"+n.replace(t),requestId:r.requestId};return r.range&&(a.params.from=this.translateTime(r.range.from,!1),a.params.until=this.translateTime(r.range.to,!0)),this.doGraphiteRequest(a).then(function(t){return t.data&&t.data.values?I.a.map(t.data.values,function(t){return{text:t.value,id:t.id}}):[]})},this.getTagsAutoComplete=function(t,e,r){var i=r||{},s={method:"GET",url:"/tags/autoComplete/tags",params:{expr:I.a.map(t,function(t){return n.replace((t||"").trim())})},requestId:i.requestId};return e&&(s.params.tagPrefix=e),i.limit&&(s.params.limit=i.limit),i.range&&(s.params.from=a.translateTime(i.range.from,!1),s.params.until=a.translateTime(i.range.to,!0)),a.doGraphiteRequest(s).then(function(t){return t.data?I.a.map(t.data,function(t){return{text:t}}):[]})},this.getTagValuesAutoComplete=function(t,e,r,i){var s=i||{},o={method:"GET",url:"/tags/autoComplete/values",params:{expr:I.a.map(t,function(t){return n.replace((t||"").trim())}),tag:n.replace((e||"").trim())},requestId:s.requestId};return r&&(o.params.valuePrefix=r),s.limit&&(o.params.limit=s.limit),s.range&&(o.params.from=a.translateTime(s.range.from,!1),o.params.until=a.translateTime(s.range.to,!0)),a.doGraphiteRequest(o).then(function(t){return t.data?I.a.map(t.data,function(t){return{text:t}}):[]})},this.getVersion=function(t){var e={method:"GET",url:"/version",requestId:(t||{}).requestId};return this.doGraphiteRequest(e).then(function(t){return t.data&&new Ae(t.data).isValid()?t.data:""}).catch(function(){return""})},this.createFuncInstance=function(t,e){return qe.createFuncInstance(t,e,this.funcDefs)},this.getFuncDef=function(t){return qe.getFuncDef(t,this.funcDefs)},this.waitForFuncDefsLoaded=function(){return this.getFuncDefs()},this.getFuncDefs=function(){var t=this;if(null!==this.funcDefsPromise)return this.funcDefsPromise;if(!function(t){return Pe(t,"1.1")}(this.graphiteVersion))return this.funcDefs=qe.getFuncDefs(this.graphiteVersion),this.funcDefsPromise=Promise.resolve(this.funcDefs),this.funcDefsPromise;return this.funcDefsPromise=this.doGraphiteRequest({method:"GET",url:"/functions"}).then(function(e){return 200!==e.status||"object"!=typeof e.data?t.funcDefs=qe.getFuncDefs(t.graphiteVersion):t.funcDefs=qe.parseFuncDefs(e.data),t.funcDefs}).catch(function(e){return console.log("Fetching graphite functions error",e),t.funcDefs=qe.getFuncDefs(t.graphiteVersion),t.funcDefs}),this.funcDefsPromise},this.testDatasource=function(){return this.query({panelId:3,rangeRaw:{from:"now-1h",to:"now"},targets:[{target:"constantLine(100)"}],maxDataPoints:300}).then(function(){return{status:"success",message:"Data source is working"}})},this.doGraphiteRequest=function(t){return(this.basicAuth||this.withCredentials)&&(t.withCredentials=!0),this.basicAuth&&(t.headers=t.headers||{},t.headers.Authorization=this.basicAuth),t.url=this.url+t.url,t.inspect={type:"graphite"},r.datasourceRequest(t)},this._seriesRefLetters="ABCDEFGHIJKLMNOPQRSTUVWXYZ",this.buildGraphiteParams=function(t,e){var r,a,i,s=["from","until","rawData","format","maxDataPoints","cacheTimeout"],o=[],l={},c=/\#([A-Z])/g,u=/'(\d+)m'/gi,d=!1;function p(t){return t.replace("m","min").replace("M","mon")}for(t.format="json",i=0;i<t.targets.length;i++)(r=t.targets[i]).target&&(r.refId||(r.refId=this._seriesRefLetters[i]),a=(a=n.replace(r.target,e)).replace(u,p),l[r.refId]=a);function h(t,e){return l[e]||t}for(i=0;i<t.targets.length;i++)(r=t.targets[i]).target&&(a=(a=l[r.refId]).replace(c,h),l[r.refId]=a,r.hide||(d=!0,o.push("target="+encodeURIComponent(a))));return I.a.each(t,function(t,e){-1!==I.a.indexOf(s,e)&&t&&o.push(e+"="+encodeURIComponent(t))}),d?o:[]}}var Re=r(250),je=r.n(Re);function Ue(t){return{link:function(e,r){var n,a=this,i=e.ctrl,s=F()('<input type="text" class="gf-form-input" spellcheck="false" style="display:none"></input>'),o=F()('<a class="gf-form-label query-part dropdown-toggle" tabindex="1" gf-dropdown="functionMenu" data-toggle="dropdown"><i class="fa fa-plus"></i></a>');s.appendTo(r),o.appendTo(r),i.datasource.getFuncDefs().then(function(n){var a=I.a.map(n,"name").sort();e.functionMenu=function(t){var e={};return I.a.forEach(t,function(t){t.category&&(e[t.category]||(e[t.category]=[]),e[t.category].push({text:t.name,click:"ctrl.addFunction('"+t.name+"')"}))}),I.a.sortBy(I.a.map(e,function(t,e){return{text:e,submenu:I.a.sortBy(t,"text")}}),"text")}(n),s.attr("data-provide","typeahead"),s.typeahead({source:a,minLength:1,items:10,updater:function(t){var r=i.datasource.getFuncDef(t);return r||(t=t.toLowerCase(),r=I.a.find(a,function(e){return 0===e.toLowerCase().indexOf(t)}))?(e.$apply(function(){i.addFunction(r)}),s.trigger("blur"),""):""}}),o.click(function(){o.hide(),s.show(),s.focus()}),s.keyup(function(){r.toggleClass("open",""===s.val())}),s.blur(function(){setTimeout(function(){s.val(""),s.hide(),o.show(),r.removeClass("open")},200)}),t(r.contents())(e)});var l=function(){n&&(n.destroy(),n=null)};F()(r).on("mouseenter","ul.dropdown-menu li",function(){var t;l();try{t=i.datasource.getFuncDef(F()("a",a).text())}catch(t){}if(t&&t.description){var e=t.description;e.length>500&&(e=e.substring(0,497)+"...");var r=document.createElement("div");r.innerHTML="<h4>"+t.name+"</h4>"+je()(e),n=new wt.a({target:a,content:r,classes:"drop-popover",openOn:"always",tetherOptions:{attachment:"bottom left",targetAttachment:"bottom right"}})}}).on("mouseout","ul.dropdown-menu li",function(){l()}),e.$on("$destroy",l)}}}function Ve(t,e,r){var n='<input type="text" style="display:none" class="input-small tight-form-func-param"></input>';return{restrict:"A",link:function(a,i){var s=F()('<a ng-click="">{{func.def.name}}</a><span>(</span>'),o=F()('\n    <div class="tight-form-func-controls">\n      <span class="pointer fa fa-arrow-left"></span>\n      <span class="pointer fa fa-question-circle"></span>\n      <span class="pointer fa fa-remove" ></span>\n      <span class="pointer fa fa-arrow-right"></span>\n    </div>'),l=a.ctrl,c=a.func,u=!1,d=0,p=null;function h(t){var e=F()(this),r=e.prev(".comma"),n=e.next();n.val(c.params[t]),r.removeClass("query-part__last"),e.hide(),n.show(),n.focus(),n.select();var a=n.data("typeahead");a&&(n.val(""),a.lookup())}function f(t){return t<c.def.params.length?c.def.params[t]:I.a.last(c.def.params).multiple?I.a.assign({},I.a.last(c.def.params),{optional:!0}):{}}function m(t,r){var n=F()(t);clearTimeout(p),p=null;var i=n.prev(),s=i.prev(".comma"),o=n.val();(""!==o||f(r).optional)&&(c.updateParam(o,r),i.html(o?e.highlightVariablesAsHtml(o):"&nbsp;")),d!==c.params.length&&(u||(u=!0,setTimeout(function(){x(),u=!1},200))),a.$apply(function(){l.targetChanged()}),i.hasClass("query-part__last")&&""===o?s.addClass("query-part__last"):i.removeClass("query-part__last"),n.hide(),i.show()}function g(t){var e=this;p=setTimeout(function(){m(e,t)},200)}function v(t,e){13===e.which&&F()(this).blur()}function b(){this.style.width=8*(3+this.value.length)+"px"}function y(){var t=i.closest(".tight-form");if(i.hasClass("show-function-controls"))return i.removeClass("show-function-controls"),t.removeClass("has-open-function"),void o.hide();i.addClass("show-function-controls"),t.addClass("has-open-function"),o.show()}function w(){o.appendTo(i),s.appendTo(i);for(var r=I.a.clone(c.def.params),l=I.a.last(c.def.params);c.params.length>=r.length&&l&&l.multiple;)r.push(I.a.assign({},l,{optional:!0}));I.a.each(r,function(t,r){if(t.optional&&c.params.length<r)return!1;var a=e.highlightVariablesAsHtml(c.params[r]),s=r>=c.params.length-1&&t.optional&&!a;s&&t.multiple&&(a="+"),r>0&&F()('<span class="comma'+(s?" query-part__last":"")+'">, </span>').appendTo(i);var o=F()('<a ng-click="" class="graphite-func-param-link'+(s?" query-part__last":"")+'">'+(a||"&nbsp;")+"</a>"),l=F()(n);return l.attr("placeholder",t.name),d++,o.appendTo(i),l.appendTo(i),l.blur(I.a.partial(g,r)),l.keyup(b),l.keypress(I.a.partial(v,r)),o.click(I.a.partial(h,r)),t.options&&function(t,e){t.attr("data-provide","typeahead");var r=f(e).options;"int"===f(e).type&&(r=I.a.map(r,function(t){return t.toString()})),t.typeahead({source:r,minLength:0,items:20,updater:function(r){return t.val(r),m(t[0],e),r}}),t.data("typeahead").lookup=function(){return this.query=this.$element.val()||"",this.process(this.source)}}(l,r),!0}),F()("<span>)</span>").appendTo(i),t(i.contents())(a)}function x(){i.children().remove(),w(),a.func.added&&(a.func.added=!1,setTimeout(function(){i.find(".graphite-func-param-link").first().click()},10)),s.click(y),o.click(function(t){var e=F()(t.target);if(e.hasClass("fa-remove"))return y(),void a.$apply(function(){l.removeFunction(a.func)});if(e.hasClass("fa-arrow-left"))a.$apply(function(){I.a.move(l.queryModel.functions,a.$index,a.$index-1),l.targetChanged()});else if(e.hasClass("fa-arrow-right"))a.$apply(function(){I.a.move(l.queryModel.functions,a.$index,a.$index+1),l.targetChanged()});else if(e.hasClass("fa-question-circle")){var n=l.datasource.getFuncDef(c.def.name);n&&n.description?r.show({element:t.target,position:"bottom left",classNames:"drop-popover drop-function-def",template:'\n                  <div style="overflow:auto;max-height:30rem;">\n                    <h4> '+n.name+" </h4>\n                    "+je()(n.description)+"\n                  </div>",openOn:"click"}):window.open("http://graphite.readthedocs.org/en/latest/functions.html#graphite.render.functions."+c.def.name,"_blank")}})}x()}}}z.c.directive("graphiteAddFunc",Ue),z.c.directive("graphiteFuncEditor",Ve);for(var Be=[170,170,181,181,186,186,192,214,216,246,248,705,710,721,736,740,748,748,750,750,880,884,886,887,890,893,902,902,904,906,908,908,910,929,931,1013,1015,1153,1162,1319,1329,1366,1369,1369,1377,1415,1488,1514,1520,1522,1568,1610,1646,1647,1649,1747,1749,1749,1765,1766,1774,1775,1786,1788,1791,1791,1808,1808,1810,1839,1869,1957,1969,1969,1994,2026,2036,2037,2042,2042,2048,2069,2074,2074,2084,2084,2088,2088,2112,2136,2308,2361,2365,2365,2384,2384,2392,2401,2417,2423,2425,2431,2437,2444,2447,2448,2451,2472,2474,2480,2482,2482,2486,2489,2493,2493,2510,2510,2524,2525,2527,2529,2544,2545,2565,2570,2575,2576,2579,2600,2602,2608,2610,2611,2613,2614,2616,2617,2649,2652,2654,2654,2674,2676,2693,2701,2703,2705,2707,2728,2730,2736,2738,2739,2741,2745,2749,2749,2768,2768,2784,2785,2821,2828,2831,2832,2835,2856,2858,2864,2866,2867,2869,2873,2877,2877,2908,2909,2911,2913,2929,2929,2947,2947,2949,2954,2958,2960,2962,2965,2969,2970,2972,2972,2974,2975,2979,2980,2984,2986,2990,3001,3024,3024,3077,3084,3086,3088,3090,3112,3114,3123,3125,3129,3133,3133,3160,3161,3168,3169,3205,3212,3214,3216,3218,3240,3242,3251,3253,3257,3261,3261,3294,3294,3296,3297,3313,3314,3333,3340,3342,3344,3346,3386,3389,3389,3406,3406,3424,3425,3450,3455,3461,3478,3482,3505,3507,3515,3517,3517,3520,3526,3585,3632,3634,3635,3648,3654,3713,3714,3716,3716,3719,3720,3722,3722,3725,3725,3732,3735,3737,3743,3745,3747,3749,3749,3751,3751,3754,3755,3757,3760,3762,3763,3773,3773,3776,3780,3782,3782,3804,3805,3840,3840,3904,3911,3913,3948,3976,3980,4096,4138,4159,4159,4176,4181,4186,4189,4193,4193,4197,4198,4206,4208,4213,4225,4238,4238,4256,4293,4304,4346,4348,4348,4352,4680,4682,4685,4688,4694,4696,4696,4698,4701,4704,4744,4746,4749,4752,4784,4786,4789,4792,4798,4800,4800,4802,4805,4808,4822,4824,4880,4882,4885,4888,4954,4992,5007,5024,5108,5121,5740,5743,5759,5761,5786,5792,5866,5870,5872,5888,5900,5902,5905,5920,5937,5952,5969,5984,5996,5998,6e3,6016,6067,6103,6103,6108,6108,6176,6263,6272,6312,6314,6314,6320,6389,6400,6428,6480,6509,6512,6516,6528,6571,6593,6599,6656,6678,6688,6740,6823,6823,6917,6963,6981,6987,7043,7072,7086,7087,7104,7141,7168,7203,7245,7247,7258,7293,7401,7404,7406,7409,7424,7615,7680,7957,7960,7965,7968,8005,8008,8013,8016,8023,8025,8025,8027,8027,8029,8029,8031,8061,8064,8116,8118,8124,8126,8126,8130,8132,8134,8140,8144,8147,8150,8155,8160,8172,8178,8180,8182,8188,8305,8305,8319,8319,8336,8348,8450,8450,8455,8455,8458,8467,8469,8469,8473,8477,8484,8484,8486,8486,8488,8488,8490,8493,8495,8505,8508,8511,8517,8521,8526,8526,8544,8584,11264,11310,11312,11358,11360,11492,11499,11502,11520,11557,11568,11621,11631,11631,11648,11670,11680,11686,11688,11694,11696,11702,11704,11710,11712,11718,11720,11726,11728,11734,11736,11742,11823,11823,12293,12295,12321,12329,12337,12341,12344,12348,12353,12438,12445,12447,12449,12538,12540,12543,12549,12589,12593,12686,12704,12730,12784,12799,13312,13312,19893,19893,19968,19968,40907,40907,40960,42124,42192,42237,42240,42508,42512,42527,42538,42539,42560,42606,42623,42647,42656,42735,42775,42783,42786,42888,42891,42894,42896,42897,42912,42921,43002,43009,43011,43013,43015,43018,43020,43042,43072,43123,43138,43187,43250,43255,43259,43259,43274,43301,43312,43334,43360,43388,43396,43442,43471,43471,43520,43560,43584,43586,43588,43595,43616,43638,43642,43642,43648,43695,43697,43697,43701,43702,43705,43709,43712,43712,43714,43714,43739,43741,43777,43782,43785,43790,43793,43798,43808,43814,43816,43822,43968,44002,44032,44032,55203,55203,55216,55238,55243,55291,63744,64045,64048,64109,64112,64217,64256,64262,64275,64279,64285,64285,64287,64296,64298,64310,64312,64316,64318,64318,64320,64321,64323,64324,64326,64433,64467,64829,64848,64911,64914,64967,65008,65019,65136,65140,65142,65276,65313,65338,65345,65370,65382,65470,65474,65479,65482,65487,65490,65495,65498,65500,65536,65547,65549,65574,65576,65594,65596,65597,65599,65613,65616,65629,65664,65786,65856,65908,66176,66204,66208,66256,66304,66334,66352,66378,66432,66461,66464,66499,66504,66511,66513,66517,66560,66717,67584,67589,67592,67592,67594,67637,67639,67640,67644,67644,67647,67669,67840,67861,67872,67897,68096,68096,68112,68115,68117,68119,68121,68147,68192,68220,68352,68405,68416,68437,68448,68466,68608,68680,69635,69687,69763,69807,73728,74606,74752,74850,77824,78894,92160,92728,110592,110593,119808,119892,119894,119964,119966,119967,119970,119970,119973,119974,119977,119980,119982,119993,119995,119995,119997,120003,120005,120069,120071,120074,120077,120084,120086,120092,120094,120121,120123,120126,120128,120132,120134,120134,120138,120144,120146,120485,120488,120512,120514,120538,120540,120570,120572,120596,120598,120628,120630,120654,120656,120686,120688,120712,120714,120744,120746,120770,120772,120779,131072,131072,173782,173782,173824,173824,177972,177972,177984,177984,178205,178205,194560,195101],Qe=[],He=0;He<128;He++)Qe[He]=He>=48&&He<=57||36===He||126===He||124===He||He>=65&&He<=90||95===He||45===He||42===He||58===He||91===He||93===He||63===He||37===He||35===He||61===He||He>=97&&He<=122;var ze=Qe;function Ge(t){this.input=t,this.char=1,this.from=1}function We(t){this.expression=t,this.lexer=new Ge(t),this.tokens=this.lexer.tokenize(),this.index=0}Ge.prototype={peek:function(t){return this.input.charAt(t||0)},skip:function(t){t=t||1,this.char+=t,this.input=this.input.slice(t)},tokenize:function(){for(var t=[],e=this.next();e;)t.push(e),e=this.next();return t},next:function(){if(this.from=this.char,/\s/.test(this.peek())){for(;/\s/.test(this.peek());)this.from+=1,this.skip();if(""===this.peek())return null}var t=this.scanStringLiteral();return t||((t=this.scanPunctuator()||this.scanNumericLiteral()||this.scanIdentifier()||this.scanTemplateSequence())?(this.skip(t.value.length),t):null)},scanTemplateSequence:function(){return"["===this.peek()&&"["===this.peek(1)?{type:"templateStart",value:"[[",pos:this.char}:"]"===this.peek()&&"]"===this.peek(1)?{type:"templateEnd",value:"[[",pos:this.char}:null},scanIdentifier:function(){var t,e,r="",n=0;function a(t){for(var e=0;e<Be.length;){if(t<Be[e++])return!1;if(t<=Be[e++])return!0}return!1}function i(t){return/^[0-9a-fA-F]$/.test(t)}var s=I.a.bind(function(){if(n+=1,"u"!==this.peek(n))return null;var t=this.peek(n+1),e=this.peek(n+2),r=this.peek(n+3),s=this.peek(n+4);return i(t)&&i(e)&&i(r)&&i(s)&&a(parseInt(t+e+r+s,16))?(n+=5,"\\u"+t+e+r+s):null},this),o=I.a.bind(function(){var t=this.peek(n),e=t.charCodeAt(0);return"*"===t?(n+=1,t):92===e?s():e<128?Qe[e]?(n+=1,t):null:a(e)?(n+=1,t):null},this),l=I.a.bind(function(){var t=this.peek(n),e=t.charCodeAt(0);return 92===e?s():e<128?ze[e]?(n+=1,t):null:a(e)?(n+=1,t):null},this);if(null===(e=o()))return null;for(r=e;null!==(e=l());)r+=e;switch(r){case"true":case"false":t="bool";break;default:t="identifier"}return{type:t,value:r,pos:this.char}},scanNumericLiteral:function(){var t,e=0,r="",n=this.input.length,a=this.peek(e);function i(t){return/^[0-9]$/.test(t)}function s(t){return/^[0-7]$/.test(t)}function o(t){return/^[0-9a-fA-F]$/.test(t)}function l(t){return"$"===t||"_"===t||"\\"===t||t>="a"&&t<="z"||t>="A"&&t<="Z"}if("-"===a&&(r+=a,e+=1,a=this.peek(e)),"."!==a&&!i(a))return null;if("."!==a){if(r+=this.peek(e),e+=1,a=this.peek(e),"0"===r){if("x"===a||"X"===a){for(e+=1,r+=a;e<n&&o(a=this.peek(e));)r+=a,e+=1;return r.length<=2?{type:"number",value:r,isMalformed:!0,pos:this.char}:e<n&&l(a=this.peek(e))?null:{type:"number",value:r,base:16,isMalformed:!1,pos:this.char}}if(s(a)){for(e+=1,r+=a,t=!1;e<n;){if(i(a=this.peek(e))&&(t=!0),!s(a)){if(!this.isPunctuator(a))return null;break}r+=a,e+=1}return e<n&&l(a=this.peek(e))?null:{type:"number",value:r,base:8,isMalformed:t}}i(a)&&(e+=1,r+=a)}for(;e<n&&i(a=this.peek(e));)r+=a,e+=1}if("."===a)for(r+=a,e+=1;e<n&&i(a=this.peek(e));)r+=a,e+=1;if("e"===a||"E"===a){if(r+=a,e+=1,"+"!==(a=this.peek(e))&&"-"!==a||(r+=this.peek(e),e+=1),!i(a=this.peek(e)))return null;for(r+=a,e+=1;e<n&&i(a=this.peek(e));)r+=a,e+=1}return e<n&&(a=this.peek(e),!this.isPunctuator(a))?null:{type:"number",value:r,base:10,pos:this.char,isMalformed:!isFinite(+r)}},isPunctuator:function(t){switch(t){case".":case"(":case")":case",":case"{":case"}":return!0}return!1},scanPunctuator:function(){var t=this.peek();return this.isPunctuator(t)?{type:t,value:t,pos:this.char}:null},scanStringLiteral:function(){var t=this.peek();if('"'!==t&&"'"!==t)return null;var e="";for(this.skip();this.peek()!==t;){if(""===this.peek())return{type:"string",value:e,isUnclosed:!0,quote:t,pos:this.char};e+=this.peek(),this.skip(1)}return this.skip(),{type:"string",value:e,isUnclosed:!1,quote:t,pos:this.char}}},We.prototype={getAst:function(){return this.start()},start:function(){try{return this.functionCall()||this.metricExpression()}catch(t){return{type:"error",message:t.message,pos:t.pos}}},curlyBraceSegment:function(){if(this.match("identifier","{")||this.match("{")){for(var t="";!this.match("")&&!this.match("}");)t+=this.consumeToken().value;return this.match("}")||this.errorMark("Expected closing '}'"),t+=this.consumeToken().value,this.match("identifier")&&(t+=this.consumeToken().value),{type:"segment",value:t}}return null},metricSegment:function(){var t=this.curlyBraceSegment();if(t)return t;if(this.match("identifier")||this.match("number")){var e=this.consumeToken().value.split(".");return 2===e.length&&(this.tokens.splice(this.index,0,{type:"."}),this.tokens.splice(this.index+1,0,{type:"number",value:e[1]})),{type:"segment",value:e[0]}}this.match("templateStart")||this.errorMark("Expected metric identifier"),this.consumeToken(),this.match("identifier")||this.errorMark("Expected identifier after templateStart");var r={type:"template",value:this.consumeToken().value};return this.match("templateEnd")||this.errorMark("Expected templateEnd"),this.consumeToken(),r},metricExpression:function(){if(!(this.match("templateStart")||this.match("identifier")||this.match("number")||this.match("{")))return null;var t={type:"metric",segments:[]};for(t.segments.push(this.metricSegment());this.match(".");){this.consumeToken();var e=this.metricSegment();e||this.errorMark("Expected metric identifier"),t.segments.push(e)}return t},functionCall:function(){if(!this.match("identifier","("))return null;var t={type:"function",name:this.consumeToken().value};return this.consumeToken(),t.params=this.functionParameters(),this.match(")")||this.errorMark("Expected closing parenthesis"),this.consumeToken(),t},boolExpression:function(){return this.match("bool")?{type:"bool",value:"true"===this.consumeToken().value}:null},functionParameters:function(){if(this.match(")")||this.match(""))return[];var t=this.functionCall()||this.numericLiteral()||this.seriesRefExpression()||this.boolExpression()||this.metricExpression()||this.stringLiteral();return this.match(",")?(this.consumeToken(),[t].concat(this.functionParameters())):[t]},seriesRefExpression:function(){return this.match("identifier")&&this.tokens[this.index].value.match(/\#[A-Z]/)?{type:"series-ref",value:this.consumeToken().value}:null},numericLiteral:function(){return this.match("number")?{type:"number",value:parseFloat(this.consumeToken().value)}:null},stringLiteral:function(){if(!this.match("string"))return null;var t=this.consumeToken();if(t.isUnclosed)throw{message:"Unclosed string parameter",pos:t.pos};return{type:"string",value:t.value}},errorMark:function(t){var e=this.tokens[this.index];throw{message:t+" instead found "+(e?e.type:"end of string"),pos:e?e.pos:this.lexer.char}},consumeToken:function(){return this.index++,this.tokens[this.index-1]},matchToken:function(t,e){var r=this.tokens[this.index+e];return void 0===r&&""===t||r&&r.type===t},match:function(t,e){return this.matchToken(t,0)&&(!e||this.matchToken(e,1))}};var Ye=function(){function t(t,e,r,n){this.datasource=t,this.target=e,this.parseTarget(),this.removeTagValue="-- remove tag --"}return t.$inject=["datasource","target","templateSrv","scopedVars"],t.prototype.parseTarget=function(){if(this.functions=[],this.segments=[],this.tags=[],this.error=null,!this.target.textEditor){var t=new We(this.target.target).getAst();if(null!==t){if("error"===t.type)return this.error=t.message+" at position: "+t.pos,void(this.target.textEditor=!0);try{this.parseTargetRecursive(t,null)}catch(t){console.log("error parsing target:",t.message),this.error=t.message,this.target.textEditor=!0}this.checkOtherSegmentsIndex=this.segments.length-1,this.checkForSeriesByTag()}else this.checkOtherSegmentsIndex=0}},t.prototype.checkForSeriesByTag=function(){var t=I.a.find(this.functions,function(t){return"seriesByTag"===t.def.name});if(t){this.seriesByTagUsed=!0,t.hidden=!0;var e=this.splitSeriesByTagParams(t);this.tags=e}},t.prototype.getSegmentPathUpTo=function(t){var e=this.segments.slice(0,t);return I.a.reduce(e,function(t,e){return t?t+"."+e.value:e.value},"")},t.prototype.parseTargetRecursive=function(t,e){var r=this;if(null===t)return null;switch(t.type){case"function":var n=this.datasource.createFuncInstance(t.name,{withDefaultParams:!1});I.a.each(t.params,function(t){r.parseTargetRecursive(t,n)}),n.updateText(),this.functions.push(n);break;case"series-ref":this.segments.length>0?this.addFunctionParameter(e,t.value):this.segments.push(t);break;case"bool":case"string":case"number":this.addFunctionParameter(e,t.value);break;case"metric":this.segments.length>0?this.addFunctionParameter(e,I.a.join(I.a.map(t.segments,"value"),".")):this.segments=t.segments}},t.prototype.updateSegmentValue=function(t,e){this.segments[e].value=t.value},t.prototype.addSelectMetricSegment=function(){this.segments.push({value:"select metric"})},t.prototype.addFunction=function(t){this.functions.push(t),this.moveAliasFuncLast()},t.prototype.moveAliasFuncLast=function(){var t=I.a.find(this.functions,function(t){return t.def.name.startsWith("alias")});t&&(this.functions=I.a.without(this.functions,t),this.functions.push(t))},t.prototype.addFunctionParameter=function(t,e){if(t.params.length>=t.def.params.length&&!I.a.get(I.a.last(t.def.params),"multiple",!1))throw{message:"too many parameters for function "+t.def.name};t.params.push(e)},t.prototype.removeFunction=function(t){this.functions=I.a.without(this.functions,t)},t.prototype.updateModelTarget=function(t){if(!this.target.textEditor){var e=this.getSegmentPathUpTo(this.segments.length).replace(/\.select metric$/,"");this.target.target=I.a.reduce(this.functions,Ke,e)}this.updateRenderedTarget(this.target,t);for(var r=0,n=t||[];r<n.length;r++){var a=n[r];a.refId!==this.target.refId&&this.updateRenderedTarget(a,t)}},t.prototype.updateRenderedTarget=function(t,e){var r=I.a.keyBy(e,"refId");delete r[t.refId];var n=/\#([A-Z])/g,a=t.target;for(I.a.each(r,function(t,e){!function(t,e){var r=0;I.a.each(t,function(t,a){if(a!==e){var i=n.exec(t.target),s=i&&i.length?i.length-1:0;r+=s}}),t[e].refCount=r}(r,e)});a.match(n);){var i=a.replace(n,function(t,e){var n=r[e];return n?(0===n.refCount&&delete r[e],n.refCount--,n.target):t});if(i===a)break;a=i}delete t.targetFull,t.target!==a&&(t.targetFull=a)},t.prototype.splitSeriesByTagParams=function(t){var e=/([^\!=~]+)(\!?=~?)(.*)/;return I.a.flatten(I.a.map(t.params,function(t){var r=e.exec(t);if(r){var n=r.slice(1);if(3===n.length)return{key:n[0],operator:n[1],value:n[2]}}return[]}))},t.prototype.getSeriesByTagFuncIndex=function(){return I.a.findIndex(this.functions,function(t){return"seriesByTag"===t.def.name})},t.prototype.getSeriesByTagFunc=function(){var t=this.getSeriesByTagFuncIndex();return t>=0?this.functions[t]:void 0},t.prototype.addTag=function(t){var e=Je(t);this.getSeriesByTagFunc().params.push(e),this.tags.push(t)},t.prototype.removeTag=function(t){this.getSeriesByTagFunc().params.splice(t,1),this.tags.splice(t,1)},t.prototype.updateTag=function(t,e){if(this.error=null,t.key!==this.removeTagValue){var r=Je(t);this.getSeriesByTagFunc().params[e]=r,this.tags[e]=t}else this.removeTag(e)},t.prototype.renderTagExpressions=function(t){return void 0===t&&(t=-1),I.a.compact(I.a.map(this.tags,function(e,r){if(r!==t)return e.key+e.operator+e.value}))},t}();function Ke(t,e){return e.render(t)}function Je(t){return t.key+t.operator+t.value}var Xe=["=","!=","=~","!=~"],Ze="tag: ",tr=function(t){function e(e,r,n,a,i){var s=t.call(this,e,r)||this;return s.uiSegmentSrv=n,s.templateSrv=a,s.supportsTags=s.datasource.supportsTags,s.paused=!1,s.target.target=s.target.target||"",s.datasource.waitForFuncDefsLoaded().then(function(){s.queryModel=new Ye(s.datasource,s.target,a),s.buildSegments()}),s.removeTagValue="-- remove tag --",s}return e.$inject=["$scope","$injector","uiSegmentSrv","templateSrv","$timeout"],J.c(e,t),e.prototype.parseTarget=function(){this.queryModel.parseTarget(),this.buildSegments()},e.prototype.toggleEditorMode=function(){this.target.textEditor=!this.target.textEditor,this.parseTarget()},e.prototype.buildSegments=function(){var t=this;this.segments=I.a.map(this.queryModel.segments,function(e){return t.uiSegmentSrv.newSegment(e)});var e=this.queryModel.checkOtherSegmentsIndex||0;this.checkOtherSegments(e),this.queryModel.seriesByTagUsed&&this.fixTagSegments()},e.prototype.addSelectMetricSegment=function(){this.queryModel.addSelectMetricSegment(),this.segments.push(this.uiSegmentSrv.newSelectMetric())},e.prototype.checkOtherSegments=function(t){var e=this;if(1!==this.queryModel.segments.length||"series-ref"!==this.queryModel.segments[0].type){if(0!==t){var r=this.queryModel.getSegmentPathUpTo(t+1);return""===r?Promise.resolve():this.datasource.metricFindQuery(r).then(function(n){if(0===n.length)""!==r&&(e.queryModel.segments=e.queryModel.segments.splice(0,t),e.segments=e.segments.splice(0,t),e.addSelectMetricSegment());else if(n[0].expandable){if(e.segments.length!==t)return e.checkOtherSegments(t+1);e.addSelectMetricSegment()}}).catch(function(t){bt.a.emit("alert-error",["Error",t])})}this.addSelectMetricSegment()}},e.prototype.setSegmentFocus=function(t){I.a.each(this.segments,function(e,r){e.focus=t===r})},e.prototype.getAltSegments=function(t,e){var r=this,n=e&&e.length>0?"*"+e+"*":"*";t>0&&(n=this.queryModel.getSegmentPathUpTo(t)+"."+n);var a={range:this.panelCtrl.range,requestId:"get-alt-segments"};return this.datasource.metricFindQuery(n,a).then(function(n){var a=I.a.map(n,function(t){return r.uiSegmentSrv.newSegment({value:t.text,expandable:t.expandable})});return t>0&&0===a.length?a:(0===t&&I.a.eachRight(r.panelCtrl.panel.targets,function(t){t.refId!==r.queryModel.target.refId&&a.unshift(r.uiSegmentSrv.newSegment({type:"series-ref",value:"#"+t.refId,expandable:!1}))}),I.a.eachRight(r.templateSrv.variables,function(t){a.unshift(r.uiSegmentSrv.newSegment({type:"template",value:"$"+t.name,expandable:!0}))}),a.unshift(r.uiSegmentSrv.newSegment("*")),r.supportsTags&&0===t?(r.removeTaggedEntry(a),r.addAltTagSegments(e,a)):a)}).catch(function(t){return[]})},e.prototype.addAltTagSegments=function(t,e){return this.getTagsAsSegments(t).then(function(t){return t=I.a.map(t,function(t){return t.value=Ze+t.value,t}),e.concat.apply(e,t)})},e.prototype.removeTaggedEntry=function(t){t=I.a.remove(t,function(t){return"_tagged"===t.value})},e.prototype.segmentValueChanged=function(t,e){var r=this;if(this.error=null,this.queryModel.updateSegmentValue(t,e),this.queryModel.functions.length>0&&this.queryModel.functions[0].def.fake&&(this.queryModel.functions=[]),"tag"===t.type){var n=function(t){return t.replace(Ze,"")}(t.value);return this.pause(),void this.addSeriesByTagFunc(n)}if(t.expandable)return this.checkOtherSegments(e+1).then(function(){r.setSegmentFocus(e+1),r.targetChanged()});this.spliceSegments(e+1),this.setSegmentFocus(e+1),this.targetChanged()},e.prototype.spliceSegments=function(t){this.segments=this.segments.splice(0,t),this.queryModel.segments=this.queryModel.segments.splice(0,t)},e.prototype.emptySegments=function(){this.queryModel.segments=[],this.segments=[]},e.prototype.targetTextChanged=function(){this.updateModelTarget(),this.refresh()},e.prototype.updateModelTarget=function(){this.queryModel.updateModelTarget(this.panelCtrl.panel.targets)},e.prototype.targetChanged=function(){if(!this.queryModel.error){var t=this.queryModel.target.target;this.updateModelTarget(),this.queryModel.target===t||this.paused||this.panelCtrl.refresh()}},e.prototype.addFunction=function(t){var e=this.datasource.createFuncInstance(t,{withDefaultParams:!0});e.added=!0,this.queryModel.addFunction(e),this.smartlyHandleNewAliasByNode(e),1===this.segments.length&&this.segments[0].fake&&this.emptySegments(),!e.params.length&&e.added&&this.targetChanged(),"seriesByTag"===e.def.name&&this.parseTarget()},e.prototype.removeFunction=function(t){this.queryModel.removeFunction(t),this.targetChanged()},e.prototype.addSeriesByTagFunc=function(t){var e=this.datasource.createFuncInstance("seriesByTag",{withDefaultParams:!1}),r=t+"=";e.params=[r],this.queryModel.addFunction(e),e.added=!0,this.emptySegments(),this.targetChanged(),this.parseTarget()},e.prototype.smartlyHandleNewAliasByNode=function(t){if("aliasByNode"===t.def.name)for(var e=0;e<this.segments.length;e++)if(this.segments[e].value.indexOf("*")>=0)return t.params[0]=e,t.added=!1,void this.targetChanged()},e.prototype.getAllTags=function(){var t=this;return this.datasource.getTags().then(function(e){var r=I.a.map(e,"text");return r.splice(0,0,t.removeTagValue),er(r)})},e.prototype.getTags=function(t,e){var r=this,n=this.queryModel.renderTagExpressions(t);return this.datasource.getTagsAutoComplete(n,e).then(function(t){var e=I.a.map(t,"text");return e.splice(0,0,r.removeTagValue),er(e)})},e.prototype.getTagsAsSegments=function(t){var e=this,r=this.queryModel.renderTagExpressions();return this.datasource.getTagsAutoComplete(r,t).then(function(t){return I.a.map(t,function(t){return e.uiSegmentSrv.newSegment({value:t.text,type:"tag",expandable:!1})})})},e.prototype.getTagOperators=function(){return er(Xe)},e.prototype.getAllTagValues=function(t){var e=t.key;return this.datasource.getTagValues(e).then(function(t){return er(I.a.map(t,"text"))})},e.prototype.getTagValues=function(t,e,r){var n=this,a=this.queryModel.renderTagExpressions(e),i=t.key;return this.datasource.getTagValuesAutoComplete(a,i,r).then(function(t){var e=I.a.map(t,"text");return I.a.eachRight(n.templateSrv.variables,function(t){e.push("${"+t.name+":regex}")}),er(e)})},e.prototype.tagChanged=function(t,e){this.queryModel.updateTag(t,e),this.targetChanged()},e.prototype.addNewTag=function(t){var e={key:t.value,operator:"=",value:""};this.queryModel.addTag(e),this.targetChanged(),this.fixTagSegments()},e.prototype.removeTag=function(t){this.queryModel.removeTag(t),this.targetChanged()},e.prototype.fixTagSegments=function(){this.addTagSegments=[this.uiSegmentSrv.newPlusButton()]},e.prototype.showDelimiter=function(t){return t!==this.queryModel.tags.length-1},e.prototype.pause=function(){this.paused=!0},e.prototype.unpause=function(){this.paused=!1,this.panelCtrl.refresh()},e.templateUrl="partials/query.editor.html",e}(Ht);function er(t){return I.a.map(t,function(t){return{text:t,value:t}})}var rr=function(){function t(t,e){this.graphiteVersions=[{name:"0.9.x",value:"0.9"},{name:"1.0.x",value:"1.0"},{name:"1.1.x",value:"1.1"}],this.datasourceSrv=e,this.current.jsonData=this.current.jsonData||{},this.current.jsonData.graphiteVersion=this.current.jsonData.graphiteVersion||"0.9",this.autoDetectGraphiteVersion()}return t.$inject=["$scope","datasourceSrv"],t.prototype.autoDetectGraphiteVersion=function(){var t=this;this.current.id&&this.datasourceSrv.loadDatasource(this.current.name).then(function(t){return t.getVersion()}).then(function(e){t.graphiteVersions.push({name:e,value:e}),t.current.jsonData.graphiteVersion=e})},t.templateUrl="public/app/plugins/datasource/graphite/partials/config.html",t}(),nr=function(){function t(){}return t.templateUrl="partials/annotations.editor.html",t}(),ar=function(){return function(){return{templateUrl:"public/app/plugins/datasource/cloudwatch/partials/query.parameter.html",controller:"CloudWatchQueryParameterCtrl",restrict:"E",scope:{target:"=",datasource:"=",onChange:"&"}}}}(),ir=function(){function t(t,e,r,n,a){t.init=function(){var e=t.target;e.namespace=e.namespace||"",e.metricName=e.metricName||"",e.statistics=e.statistics||["Average"],e.dimensions=e.dimensions||{},e.period=e.period||"",e.region=e.region||"default",e.id=e.id||"",e.expression=e.expression||"",e.returnData=e.returnData||!1,e.highResolution=e.highResolution||!1,t.regionSegment=r.getSegmentForValue(t.target.region,"select region"),t.namespaceSegment=r.getSegmentForValue(t.target.namespace,"select namespace"),t.metricSegment=r.getSegmentForValue(t.target.metricName,"select metric"),t.dimSegments=I.a.reduce(t.target.dimensions,function(t,e,n){return t.push(r.newKey(n)),t.push(r.newOperator("=")),t.push(r.newKeyValue(e)),t},[]),t.statSegments=I.a.map(t.target.statistics,function(t){return r.getSegmentForValue(t)}),t.ensurePlusButton(t.statSegments),t.ensurePlusButton(t.dimSegments),t.removeDimSegment=r.newSegment({fake:!0,value:"-- remove dimension --"}),t.removeStatSegment=r.newSegment({fake:!0,value:"-- remove stat --"}),I.a.isEmpty(t.target.region)&&(t.target.region="default"),t.onChange||(t.onChange=function(){})},t.getStatSegments=function(){return a.when(I.a.flatten([L.a.copy(t.removeStatSegment),I.a.map(t.datasource.standardStatistics,function(t){return r.getSegmentForValue(t)}),r.getSegmentForValue("pNN.NN")]))},t.statSegmentChanged=function(e,r){e.value===t.removeStatSegment.value?t.statSegments.splice(r,1):e.type="value",t.target.statistics=I.a.reduce(t.statSegments,function(t,e){return e.fake||t.push(e.value),t},[]),t.ensurePlusButton(t.statSegments),t.onChange()},t.ensurePlusButton=function(t){var e=t.length,n=t[Math.max(e-1,0)];n&&"plus-button"===n.type||t.push(r.newPlusButton())},t.getDimSegments=function(e,r){if("operator"===e.type)return a.when([]);var n=t.target,i=a.when([]);if("key"===e.type||"plus-button"===e.type)i=t.datasource.getDimensionKeys(t.target.namespace,t.target.region);else if("value"===e.type){var s=t.dimSegments[r-2].value;i=t.datasource.getDimensionValues(n.region,n.namespace,n.metricName,s,n.dimensions)}return i.then(t.transformToSegments(!0)).then(function(r){return"key"===e.type&&r.splice(0,0,L.a.copy(t.removeDimSegment)),r})},t.dimSegmentChanged=function(e,n){t.dimSegments[n]=e,e.value===t.removeDimSegment.value?t.dimSegments.splice(n,3):"plus-button"===e.type&&(t.dimSegments.push(r.newOperator("=")),t.dimSegments.push(r.newFake("select dimension value","value","query-segment-value")),e.type="key",e.cssClass="query-segment-key"),t.syncDimSegmentsWithModel(),t.ensurePlusButton(t.dimSegments),t.onChange()},t.syncDimSegmentsWithModel=function(){for(var e={},r=t.dimSegments.length,n=0;n<r-2;n+=3){var a=t.dimSegments[n],i=t.dimSegments[n+2];i.fake||(e[a.value]=i.value)}t.target.dimensions=e},t.getRegions=function(){return t.datasource.metricFindQuery("regions()").then(function(t){return t.unshift({text:"default"}),t}).then(t.transformToSegments(!0))},t.getNamespaces=function(){return t.datasource.metricFindQuery("namespaces()").then(t.transformToSegments(!0))},t.getMetrics=function(){return t.datasource.metricFindQuery("metrics("+t.target.namespace+","+t.target.region+")").then(t.transformToSegments(!0))},t.regionChanged=function(){t.target.region=t.regionSegment.value,t.onChange()},t.namespaceChanged=function(){t.target.namespace=t.namespaceSegment.value,t.onChange()},t.metricChanged=function(){t.target.metricName=t.metricSegment.value,t.onChange()},t.transformToSegments=function(t){return function(n){var a=I.a.map(n,function(t){return r.newSegment({value:t.text,expandable:t.expandable})});return t&&I.a.each(e.variables,function(t){a.unshift(r.newSegment({type:"template",value:"$"+t.name,expandable:!0}))}),a}},t.init()}return t.$inject=["$scope","templateSrv","uiSegmentSrv","datasourceSrv","$q"],t}();z.c.directive("cloudwatchQueryParameter",ar),z.c.controller("CloudWatchQueryParameterCtrl",ir);var sr=r(209),or=/\$(\w+)|\[\[([\s\S]+?)(?::(\w+))?\]\]|\${(\w+)(?::(\w+))?}/g,lr=function(t){return or.lastIndex=0,or.exec(t)},cr={};function ur(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=t[t.length-1];t[0]=I.a.isString(t[0])?t[0]:Object.values(t[0]).join(" ");var n=t.slice(0,-1).join(" ").match(or);return!!(null!==n&&n.find(function(t){var e=lr(t);return null!==e&&e.indexOf(r)>-1}))}var dr=function(){function t(t,e,r,n,a){this.$q=e,this.backendSrv=r,this.templateSrv=n,this.timeSrv=a,this.type="cloudwatch",this.name=t.name,this.proxyUrl=t.url,this.defaultRegion=t.jsonData.defaultRegion,this.instanceSettings=t,this.standardStatistics=["Average","Maximum","Minimum","Sum","SampleCount"]}return t.$inject=["instanceSettings","$q","backendSrv","templateSrv","timeSrv"],t.prototype.query=function(t){var e=this;(t=L.a.copy(t)).targets=this.expandTemplateVariable(t.targets,t.scopedVars,this.templateSrv);var r=I.a.filter(t.targets,function(t){return(""!==t.id||!0!==t.hide)&&(!!t.region&&!!t.namespace&&!!t.metricName&&!I.a.isEmpty(t.statistics)||t.expression.length>0)}).map(function(r){if(r.region=e.templateSrv.replace(e.getActualRegion(r.region),t.scopedVars),r.namespace=e.templateSrv.replace(r.namespace,t.scopedVars),r.metricName=e.templateSrv.replace(r.metricName,t.scopedVars),r.dimensions=e.convertDimensionFormat(r.dimensions,t.scopedVars),r.statistics=r.statistics.map(function(r){return e.templateSrv.replace(r,t.scopedVars)}),r.period=String(e.getPeriod(r,t)),r.id=e.templateSrv.replace(r.id,t.scopedVars),r.expression=e.templateSrv.replace(r.expression,t.scopedVars),r.returnData=void 0===r.hide||!r.hide,r.statistics.some(function(t){if(0===t.indexOf("p")){var e=/^p\d{2}(?:\.\d{1,2})?$/.exec(t);return!e||e[0]!==t}return!1}))throw{message:"Invalid extended statistics"};return I.a.extend({refId:r.refId,intervalMs:t.intervalMs,maxDataPoints:t.maxDataPoints,datasourceId:e.instanceSettings.id,type:"timeSeriesQuery"},r)});if(I.a.isEmpty(r)){var n=this.$q.defer();return n.resolve({data:[]}),n.promise}var a={from:t.range.from.valueOf().toString(),to:t.range.to.valueOf().toString(),queries:r};return this.performTimeSeriesQuery(a)},t.prototype.getPeriod=function(t,e,r){var n,a=this.convertToCloudWatchTime(e.range.from,!1),i=this.convertToCloudWatchTime(e.range.to,!0);r=Math.round((r||Date.now())/1e3);var s=i-a,o=60;return t.period?n=/^\d+$/.test(t.period)?parseInt(t.period,10):kt.a.interval_to_seconds(this.templateSrv.replace(t.period,e.scopedVars)):o=n=r-a<=1296e3?"AWS/EC2"===t.namespace?300:60:r-a<=5443200?300:3600,n<1&&(n=1),!t.highResolution&&s/n>=1440&&(n=Math.ceil(s/1440/o)*o),n},t.prototype.performTimeSeriesQuery=function(t){return this.awsRequest("/api/tsdb/query",t).then(function(t){var e=[];return t.results&&I.a.forEach(t.results,function(t){I.a.forEach(t.series,function(r){var n={target:r.name,datapoints:r.points};t.meta.unit&&(n.unit=t.meta.unit),e.push(n)})}),{data:e}})},t.prototype.transformSuggestDataFromTable=function(t){return I.a.map(t.results.metricFindQuery.tables[0].rows,function(t){return{text:t[0],value:t[1]}})},t.prototype.doMetricQueryRequest=function(t,e){var r=this,n=this.timeSrv.timeRange();return this.awsRequest("/api/tsdb/query",{from:n.from.valueOf().toString(),to:n.to.valueOf().toString(),queries:[I.a.extend({refId:"metricFindQuery",intervalMs:1,maxDataPoints:1,datasourceId:this.instanceSettings.id,type:"metricFindQuery",subtype:t},e)]}).then(function(t){return r.transformSuggestDataFromTable(t)})},t.prototype.getRegions=function(){return this.doMetricQueryRequest("regions",null)},t.prototype.getNamespaces=function(){return this.doMetricQueryRequest("namespaces",null)},t.prototype.getMetrics=function(t,e){return this.doMetricQueryRequest("metrics",{region:this.templateSrv.replace(this.getActualRegion(e)),namespace:this.templateSrv.replace(t)})},t.prototype.getDimensionKeys=function(t,e){return this.doMetricQueryRequest("dimension_keys",{region:this.templateSrv.replace(this.getActualRegion(e)),namespace:this.templateSrv.replace(t)})},t.prototype.getDimensionValues=function(t,e,r,n,a){return this.doMetricQueryRequest("dimension_values",{region:this.templateSrv.replace(this.getActualRegion(t)),namespace:this.templateSrv.replace(e),metricName:this.templateSrv.replace(r),dimensionKey:this.templateSrv.replace(n),dimensions:this.convertDimensionFormat(a,{})})},t.prototype.getEbsVolumeIds=function(t,e){return this.doMetricQueryRequest("ebs_volume_ids",{region:this.templateSrv.replace(this.getActualRegion(t)),instanceId:this.templateSrv.replace(e)})},t.prototype.getEc2InstanceAttribute=function(t,e,r){return this.doMetricQueryRequest("ec2_instance_attribute",{region:this.templateSrv.replace(this.getActualRegion(t)),attributeName:this.templateSrv.replace(e),filters:r})},t.prototype.metricFindQuery=function(t){var e,r,n,a;if(t.match(/^regions\(\)/))return this.getRegions();if(t.match(/^namespaces\(\)/))return this.getNamespaces();var i=t.match(/^metrics\(([^\)]+?)(,\s?([^,]+?))?\)/);if(i)return r=i[1],e=i[3],this.getMetrics(r,e);var s=t.match(/^dimension_keys\(([^\)]+?)(,\s?([^,]+?))?\)/);if(s)return r=s[1],e=s[3],this.getDimensionKeys(r,e);var o=t.match(/^dimension_values\(([^,]+?),\s?([^,]+?),\s?([^,]+?),\s?([^,]+?)(,\s?(.+))?\)/);if(o){e=o[1],r=o[2],n=o[3];var l=o[4];return a={},o[6]&&(a=JSON.parse(this.templateSrv.replace(o[6]))),this.getDimensionValues(e,r,n,l,a)}var c=t.match(/^ebs_volume_ids\(([^,]+?),\s?([^,]+?)\)/);if(c){e=c[1];var u=c[2];return this.getEbsVolumeIds(e,u)}var d=t.match(/^ec2_instance_attribute\(([^,]+?),\s?([^,]+?),\s?(.+?)\)/);if(d){e=d[1];var p=d[2];return a=JSON.parse(this.templateSrv.replace(d[3])),this.getEc2InstanceAttribute(e,p,a)}return this.$q.when([])},t.prototype.annotationQuery=function(t){var e=this,r=t.annotation,n=I.a.map(r.statistics,function(t){return e.templateSrv.replace(t)}),a=r.prefixMatching?"":"300",i=r.period||a;i=parseInt(i,10);var s={prefixMatching:r.prefixMatching,region:this.templateSrv.replace(this.getActualRegion(r.region)),namespace:this.templateSrv.replace(r.namespace),metricName:this.templateSrv.replace(r.metricName),dimensions:this.convertDimensionFormat(r.dimensions,{}),statistics:n,period:i,actionPrefix:r.actionPrefix||"",alarmNamePrefix:r.alarmNamePrefix||""};return this.awsRequest("/api/tsdb/query",{from:t.range.from.valueOf().toString(),to:t.range.to.valueOf().toString(),queries:[I.a.extend({refId:"annotationQuery",intervalMs:1,maxDataPoints:1,datasourceId:this.instanceSettings.id,type:"annotationQuery"},s)]}).then(function(t){return I.a.map(t.results.annotationQuery.tables[0].rows,function(t){return{annotation:r,time:Date.parse(t[0]),title:t[1],tags:[t[2]],text:t[3]}})})},t.prototype.targetContainsTemplate=function(t){var e=this;return this.templateSrv.variableExists(t.region)||this.templateSrv.variableExists(t.namespace)||this.templateSrv.variableExists(t.metricName)||I.a.find(t.dimensions,function(t,r){return e.templateSrv.variableExists(r)||e.templateSrv.variableExists(t)})},t.prototype.testDatasource=function(){var t=this.defaultRegion;return this.getDimensionValues(t,"AWS/Billing","EstimatedCharges","ServiceName",{}).then(function(){return{status:"success",message:"Data source is working"}},function(t){return{status:"error",message:t.message}})},t.prototype.awsRequest=function(t,e){var r={method:"POST",url:t,data:e};return this.backendSrv.datasourceRequest(r).then(function(t){return t.data})},t.prototype.getDefaultRegion=function(){return this.defaultRegion},t.prototype.getActualRegion=function(t){return"default"===t||I.a.isEmpty(t)?this.getDefaultRegion():t},t.prototype.getExpandedVariables=function(t,e,r,n){var a=I.a.find(r.options,{selected:!0,text:"All"}),i=I.a.filter(r.options,function(t){return a?"All"!==t.text:t.selected}),s=I.a.isArray(r.current.value)?r.current.value.map(function(t){return{text:t,value:t}}):[r.current];return(i.some(function(t){return t.value===s[0].value})||"$__all"===s[0].value?i:s).map(function(a){var i=L.a.copy(t),s={};return s[r.name]=a,i.refId=t.refId+"_"+a.value,i.dimensions[e]=n.replace(i.dimensions[e],s),r.multi&&t.id?i.id=t.id+window.btoa(a.value).replace(/=/g,"0"):i.id=t.id,i})},t.prototype.expandTemplateVariable=function(t,e,r){var n=this;return I.a.chain(t).map(function(t){var a=I.a.findKey(t.dimensions,function(t){return r.variableExists(t)&&!I.a.has(e,r.getVariableName(t))});if(a){var i=I.a.find(r.variables,function(e){return ur(t.dimensions[a],e.name)&&e.multi}),s=I.a.find(r.variables,function(e){return ur(t.dimensions[a],e.name)});return n.getExpandedVariables(t,a,i||s,r)}return[t]}).flatten().value()},t.prototype.convertToCloudWatchTime=function(t,e){return I.a.isString(t)&&(t=Ct.parse(t,e)),Math.round(t.valueOf()/1e3)},t.prototype.convertDimensionFormat=function(t,e){var r=this,n={};return I.a.each(t,function(t,a){n[r.templateSrv.replace(a,e)]=r.templateSrv.replace(t,e)}),n},t}(),pr=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.aliasSyntax="{{metric}} {{stat}} {{namespace}} {{region}} {{<dimension name>}}",n}return e.$inject=["$scope","$injector"],J.c(e,t),e.templateUrl="partials/query.editor.html",e}(Ht),hr=function(){function t(t,e){this.accessKeyExist=!1,this.secretKeyExist=!1,this.authTypes=[{name:"Access & secret key",value:"keys"},{name:"Credentials file",value:"credentials"},{name:"ARN",value:"arn"}],this.indexPatternTypes=[{name:"No pattern",value:void 0},{name:"Hourly",value:"Hourly",example:"[logstash-]YYYY.MM.DD.HH"},{name:"Daily",value:"Daily",example:"[logstash-]YYYY.MM.DD"},{name:"Weekly",value:"Weekly",example:"[logstash-]GGGG.WW"},{name:"Monthly",value:"Monthly",example:"[logstash-]YYYY.MM"},{name:"Yearly",value:"Yearly",example:"[logstash-]YYYY"}],this.regions=["ap-northeast-1","ap-northeast-2","ap-northeast-3","ap-south-1","ap-southeast-1","ap-southeast-2","ca-central-1","cn-north-1","cn-northwest-1","eu-central-1","eu-north-1","eu-west-1","eu-west-2","eu-west-3","me-south-1","sa-east-1","us-east-1","us-east-2","us-gov-east-1","us-gov-west-1","us-iso-east-1","us-isob-east-1","us-west-1","us-west-2"],this.current.jsonData.timeField=this.current.jsonData.timeField||"@timestamp",this.current.jsonData.authType=this.current.jsonData.authType||"credentials",this.accessKeyExist=this.current.secureJsonFields.accessKey,this.secretKeyExist=this.current.secureJsonFields.secretKey,this.datasourceSrv=e,this.getRegions()}return t.$inject=["$scope","datasourceSrv"],t.prototype.resetAccessKey=function(){this.accessKeyExist=!1},t.prototype.resetSecretKey=function(){this.secretKeyExist=!1},t.prototype.getRegions=function(){var t=this;this.datasourceSrv.loadDatasource(this.current.name).then(function(t){return t.getRegions()}).then(function(e){t.regions=I.a.map(e,"value")},function(t){console.error("failed to get latest regions")})},t.templateUrl="partials/config.html",t}(),fr=function(){function t(){}return t.templateUrl="partials/annotations.editor.html",t}(),mr=[{text:"Count",value:"count",requiresField:!1},{text:"Average",value:"avg",requiresField:!0,supportsInlineScript:!0,supportsMissing:!0},{text:"Sum",value:"sum",requiresField:!0,supportsInlineScript:!0,supportsMissing:!0},{text:"Max",value:"max",requiresField:!0,supportsInlineScript:!0,supportsMissing:!0},{text:"Min",value:"min",requiresField:!0,supportsInlineScript:!0,supportsMissing:!0},{text:"Extended Stats",value:"extended_stats",requiresField:!0,supportsMissing:!0,supportsInlineScript:!0},{text:"Percentiles",value:"percentiles",requiresField:!0,supportsMissing:!0,supportsInlineScript:!0},{text:"Unique Count",value:"cardinality",requiresField:!0,supportsMissing:!0},{text:"Moving Average",value:"moving_avg",requiresField:!1,isPipelineAgg:!0,minVersion:2},{text:"Derivative",value:"derivative",requiresField:!1,isPipelineAgg:!0,minVersion:2},{text:"Raw Document",value:"raw_document",requiresField:!1},{text:"Bucket Script",value:"bucket_script",requiresField:!1,isPipelineAgg:!0,isDivisionAgg:!0,supportsInlineScript:!0,minVersion:2}],gr=[{text:"Terms",value:"terms",requiresField:!0},{text:"Filters",value:"filters"},{text:"Geo Hash Grid",value:"geohash_grid",requiresField:!0},{text:"Date Histogram",value:"date_histogram",requiresField:!0},{text:"Histogram",value:"histogram",requiresField:!0}],vr=[{text:"Doc Count",value:"_count"},{text:"Term value",value:"_term"}],br=[{text:"Top",value:"desc"},{text:"Bottom",value:"asc"}],yr=[{text:"No limit",value:"0"},{text:"1",value:"1"},{text:"2",value:"2"},{text:"3",value:"3"},{text:"5",value:"5"},{text:"10",value:"10"},{text:"15",value:"15"},{text:"20",value:"20"}],wr=[{text:"Avg",value:"avg"},{text:"Min",value:"min"},{text:"Max",value:"max"},{text:"Sum",value:"sum"},{text:"Count",value:"count"},{text:"Std Dev",value:"std_deviation"},{text:"Std Dev Upper",value:"std_deviation_bounds_upper"},{text:"Std Dev Lower",value:"std_deviation_bounds_lower"}],xr=[{text:"auto",value:"auto"},{text:"10s",value:"10s"},{text:"1m",value:"1m"},{text:"5m",value:"5m"},{text:"10m",value:"10m"},{text:"20m",value:"20m"},{text:"1h",value:"1h"},{text:"1d",value:"1d"}],Sr=[{text:"Simple",value:"simple"},{text:"Linear",value:"linear"},{text:"Exponentially Weighted",value:"ewma"},{text:"Holt Linear",value:"holt"},{text:"Holt Winters",value:"holt_winters"}],kr={moving_avg:[{text:"window",default:5},{text:"model",default:"simple"},{text:"predict",default:void 0},{text:"minimize",default:!1}],derivative:[{text:"unit",default:void 0}],bucket_script:[{text:"predict",default:void 0}]},Cr={simple:[],linear:[],ewma:[{text:"Alpha",value:"alpha",default:void 0}],holt:[{text:"Alpha",value:"alpha",default:void 0},{text:"Beta",value:"beta",default:void 0}],holt_winters:[{text:"Alpha",value:"alpha",default:void 0},{text:"Beta",value:"beta",default:void 0},{text:"Gamma",value:"gamma",default:void 0},{text:"Period",value:"period",default:void 0},{text:"Pad",value:"pad",default:void 0,isCheckbox:!0}]};function Tr(t){return I.a.filter(mr,function(e){return!e.minVersion||e.minVersion<=t})}function Er(t){if(t){var e=kr[t];return null!==e&&void 0!==e}return!1}function _r(t,e){var r=[];return e?(I.a.each(Cr[t],function(t){t.isCheckbox||r.push(t)}),r):Cr[t]}function Mr(t){return""===t.aliasNew||void 0===t.aliasNew?I.a.find(mr,{value:t.type}).text+" "+t.field:t.aliasNew}var Ar=function(){function t(t){this.timeField=t.timeField,this.esVersion=t.esVersion}return t.prototype.getRangeFilter=function(){var t={};return t[this.timeField]={gte:"$timeFrom",lte:"$timeTo",format:"epoch_millis"},t},t.prototype.buildTermsAgg=function(t,e,r){var n,a,i;if(e.terms={field:t.field},!t.settings)return e;if(e.terms.size=0===parseInt(t.settings.size,10)?500:parseInt(t.settings.size,10),void 0!==t.settings.orderBy&&(e.terms.order={},"_term"===t.settings.orderBy&&this.esVersion>=60?e.terms.order._key=t.settings.order:e.terms.order[t.settings.orderBy]=t.settings.order,n=parseInt(t.settings.orderBy,10),!isNaN(n)))for(i=0;i<r.metrics.length;i++)if((a=r.metrics[i]).id===t.settings.orderBy){e.aggs={},e.aggs[a.id]={},e.aggs[a.id][a.type]={field:a.field};break}return void 0!==t.settings.min_doc_count&&(e.terms.min_doc_count=parseInt(t.settings.min_doc_count,10)),t.settings.missing&&(e.terms.missing=t.settings.missing),e},t.prototype.getDateHistogramAgg=function(t){var e={},r=t.settings||{};return e.interval=r.interval,e.field=this.timeField,e.min_doc_count=r.min_doc_count||0,e.extended_bounds={min:"$timeFrom",max:"$timeTo"},e.format="epoch_millis",e.offset=r.offset||"-8h",e.order={_key:r.order||"asc"},"auto"===e.interval&&(e.interval="$__interval"),r.missing&&(e.missing=r.missing),e},t.prototype.getHistogramAgg=function(t){var e={},r=t.settings||{};return e.interval=r.interval,e.field=t.field,e.min_doc_count=r.min_doc_count||0,r.missing&&(e.missing=r.missing),e},t.prototype.getFiltersAgg=function(t){for(var e={},r=0;r<t.settings.filters.length;r++){var n=t.settings.filters[r].query,a=t.settings.filters[r].label;e[a=""===a||void 0===a?n:a]={query_string:{query:n,analyze_wildcard:!0}}}return e},t.prototype.documentQuery=function(t,e){return t.size=e,t.sort={},t.sort[this.timeField]={order:"desc",unmapped_type:"boolean"},this.esVersion<5&&(t.fields=["*","_source"]),t.script_fields={},this.esVersion<5?t.fielddata_fields=[this.timeField]:t.docvalue_fields=[this.timeField],t},t.prototype.addAdhocFilters=function(t,e){var r,n,a,i;if(e)for(r=0;r<e.length;r++)switch((a={})[(n=e[r]).key]=n.value,(i={})[n.key]={query:n.value},n.operator){case"=":t.query.bool.must||(t.query.bool.must=[]),t.query.bool.must.push({match_phrase:i});break;case"!=":t.query.bool.must_not||(t.query.bool.must_not=[]),t.query.bool.must_not.push({match_phrase:i});break;case"<":a[n.key]={lt:n.value},t.query.bool.filter.push({range:a});break;case">":a[n.key]={gt:n.value},t.query.bool.filter.push({range:a});break;case"=~":t.query.bool.filter.push({regexp:a});break;case"!~":t.query.bool.filter.push({bool:{must_not:{regexp:a}}})}},t.prototype.build=function(t,e,r){var n,a,i;t.metrics=t.metrics||[{type:"count",id:"1"}],t.bucketAggs=t.bucketAggs||[{type:"date_histogram",id:"2",settings:{interval:"auto"}}],t.timeField=this.timeField;var s={size:0,query:{bool:{filter:[{range:this.getRangeFilter()},{query_string:{analyze_wildcard:!0,query:r}}]}}};if(this.addAdhocFilters(s,e),0===t.bucketAggs.length){if(!(i=t.metrics[0])||"raw_document"!==i.type)throw{message:"Invalid query"};var o=i.settings&&i.settings.size||500;return this.documentQuery(s,o)}for(a=s,n=0;n<t.bucketAggs.length;n++){var l=t.bucketAggs[n],c={};switch(l.type){case"date_histogram":c.date_histogram=this.getDateHistogramAgg(l);break;case"histogram":c.histogram=this.getHistogramAgg(l);break;case"filters":c.filters={filters:this.getFiltersAgg(l)};break;case"terms":this.buildTermsAgg(l,c,t);break;case"geohash_grid":c.geohash_grid={field:l.field,precision:l.settings.precision}}a.aggs=a.aggs||{},a.aggs[l.id]=c,a=c}for(a.aggs={},n=0;n<t.metrics.length;n++)if("count"!==(i=t.metrics[n]).type){var u={},d=null;if("bucket_script"===i.type){var p=!1;if(void 0===i.ParamNames)continue;for(var h=0;h<i.ParamNames.length;h++)p=!(!i.ParamNames[h].text||!/^\d*$/.test(i.ParamNames[h].text));if(!p)continue;var f={var_1:""};f.var_1=i.pipelineAgg;for(var m=0;m<i.ParamNames.length;m++)f["var_"+(m+2)]=i.ParamNames[m].text;d={buckets_path:f}}else if(Er(i.type)){if(!i.pipelineAgg||!/^\d*$/.test(i.pipelineAgg))continue;d={buckets_path:i.pipelineAgg}}else d={field:i.field};for(var g in i.settings)i.settings.hasOwnProperty(g)&&null!==i.settings[g]&&(d[g]=i.settings[g]);u[i.type]=d,a.aggs[i.id]=u}return s},t.prototype.getTermsQuery=function(t){var e={size:0,query:{bool:{filter:[{range:this.getRangeFilter()}]}}};t.query&&e.query.bool.filter.push({query_string:{analyze_wildcard:!0,query:t.query}});var r=500;return t.size&&(r=t.size),e.aggs={1:{terms:{field:t.field,size:r,order:{_term:"asc"}}}},this.esVersion>=60&&(e.aggs[1].terms.order={_key:"asc"}),e},t}(),Pr={Hourly:{startOf:"hour",amount:"hours"},Daily:{startOf:"day",amount:"days"},Weekly:{startOf:"isoWeek",amount:"weeks"},Monthly:{startOf:"month",amount:"months"},Yearly:{startOf:"year",amount:"years"}},$r=function(){function t(t,e){this.pattern=t,this.interval=e}return t.prototype.getIndexForToday=function(){return this.interval?H.a.utc().format(this.pattern):this.pattern},t.prototype.getIndexList=function(t,e){if(!this.interval)return this.pattern;for(var r=Pr[this.interval],n=H()(t).utc().startOf(r.startOf),a=H()(e).utc().startOf(r.startOf).valueOf(),i=[];n.valueOf()<=a;)i.push(n.format(this.pattern)),n.add(1,r.amount);return i},t}(),Dr=function(){function t(t,e,r,n){this.targets=t,this.response=e,this.timeSrv=r,this.templateSrv=n,this.targets=t,this.response=e,this.timeSrv=r,this.templateSrv=n}return t.prototype.processMetrics=function(t,e,r,n,a){var i,s,o,l,c,u,d;for(s=0;s<r.metrics.length;s++)if(!(i=r.metrics[s]).hide){if("filters"===t.type)return l={datapoints:[],metric:i.type,field:i.field,id:i.id,props:a},u=(c=e.buckets[t.query])[i.id],d=this.timeSrv.timeRange().to.valueOf(),void 0!==u&&l.datapoints.push([u.value,d]),void n.push(l);switch(i.type){case"count":for(l={datapoints:[],metric:"count",id:i.id,props:a},o=0;o<e.buckets.length;o++)u=(c=e.buckets[o]).doc_count,l.datapoints.push([u,c.key]);n.push(l);break;case"percentiles":if(0===e.buckets.length)break;var p=e.buckets[0][i.id].values;for(var h in p){for(l={datapoints:[],metric:"p"+h,props:a,id:i.id,field:i.field},o=0;o<e.buckets.length;o++){var f=(c=e.buckets[o])[i.id].values;l.datapoints.push([f[h],c.key])}n.push(l)}break;case"extended_stats":for(var m in i.meta)if(i.meta[m]){for(l={datapoints:[],metric:m,props:a,id:i.id,field:i.field},o=0;o<e.buckets.length;o++){var g=(c=e.buckets[o])[i.id];g.std_deviation_bounds_upper=g.std_deviation_bounds.upper,g.std_deviation_bounds_lower=g.std_deviation_bounds.lower,l.datapoints.push([g[m],c.key])}n.push(l)}break;default:if(e.buckets.length>=1){for(l={datapoints:[],metric:i.type,field:i.field,id:i.id,props:a},o=0;o<e.buckets.length;o++)void 0!==(u=(c=e.buckets[o])[i.id])&&(u.normalized_value?l.datapoints.push([u.normalized_value,c.key]):l.datapoints.push([u.value,c.key]));n.push(l)}}}},t.prototype.processAggregationDocs=function(t,e,r,n,a){if(0===n.columns.length){for(var i=0,s=I.a.keys(a);i<s.length;i++){var o=s[i];n.addColumn({text:o,filterable:!0})}n.addColumn({text:e.field,filterable:!0})}for(var l=function(t,e,r,a){void 0===a||""===a?n.addColumn({text:e}):n.addColumn({text:a}),t.push(r)},c=0,u=t.buckets;c<u.length;c++){for(var d=u[c],p=[],h=0,f=I.a.values(a);h<f.length;h++){var m=f[h];p.push(m)}p.push(d.key);for(var g=0,v=r.metrics;g<v.length;g++){var b=v[g];switch(b.type){case"count":l(p,this.getMetricName(b.type),d.doc_count,b.aliasNew);break;case"extended_stats":for(var y in b.meta)if(b.meta[y]){var w=d[b.id];w.std_deviation_bounds_upper=w.std_deviation_bounds.upper,w.std_deviation_bounds_lower=w.std_deviation_bounds.lower,l(p,this.getMetricName(y),w[y],b.aliasNew)}break;default:var x=this.getMetricName(b.type);I.a.filter(r.metrics,{id:b.id}).length>1&&(x+=" "+b.field),l(p,x,d[b.id].value,b.aliasNew)}}n.rows.push(p)}},t.prototype.processBuckets=function(t,e,r,n,a,i){var s,o,l,c,u=e.bucketAggs.length-1;for(c in t)if(o=I.a.find(e.bucketAggs,{id:c}),l=t[c],o)if(i===u)"date_histogram"===o.type||"filters"===o.type?this.processMetrics(o,l,e,r,a):this.processAggregationDocs(l,o,e,n,a);else for(var d in l.buckets)s=l.buckets[d],a=I.a.clone(a),void 0!==s.key?a[o.field]=s.key:a.filter=d,s.key_as_string&&(a[o.field]=s.key_as_string),this.processBuckets(s,e,r,n,a,i+1)},t.prototype.getMetricName=function(t){var e=I.a.find(mr,{value:t});return e||(e=I.a.find(wr,{value:t})),e?e.text:t},t.prototype.getSeriesName=function(t,e,r){var n=this.getMetricName(t.metric),a=I.a.find(e.metrics,{id:t.id}),i=!0;if(a||(i=!1),e.alias){return e.alias.indexOf("[[")>=0?this.templateSrv.replace(e.alias):e.alias.replace(/\{\{([\s\S]+?)\}\}/g,function(e,r,a){var i=r||a;return 0===i.indexOf("term ")?t.props[i.substring(5)]:void 0!==t.props[i]?t.props[i]:"metric"===i?n:"field"===i?t.field:e})}if(t.field&&Er(t.metric)){var s=I.a.find(e.metrics,{id:t.field});s?n+=" "+Mr(s):n="Unset"}else t.field&&(n+=" "+t.field);if(i&&""!==a.aliasNew&&void 0!==a.aliasNew)return n=a.aliasNew;if(0===I.a.keys(t.props).length)return n;var o="";for(var l in t.props)o+=t.props[l]+" ";return 1===r?o.trim():o.trim()+" "+n},t.prototype.nameSeries=function(t,e){for(var r=I.a.uniq(I.a.map(t,"metric")).length,n=0;n<t.length;n++){var a=t[n];a.target=this.getSeriesName(a,e,r)}},t.prototype.processHits=function(t,e){var r,n,a,i,s={target:"docs",type:"docs",datapoints:[],total:t.total,filterable:!0};for(i=0;i<t.hits.length;i++){if(a={_id:(n=t.hits[i])._id,_type:n._type,_index:n._index},n._source)for(r in n._source)a[r]=n._source[r];for(r in n.fields)a[r]=n.fields[r];s.datapoints.push(a)}e.push(s)},t.prototype.trimDatapoints=function(t,e){var r=I.a.find(e.bucketAggs,{type:"date_histogram"});if(r&&r.settings&&r.settings.trimEdges){var n=r.settings.trimEdges;for(var a in t){var i=t[a];i.datapoints.length>2*n&&(i.datapoints=i.datapoints.slice(n,i.datapoints.length-n))}}},t.prototype.getErrorFromElasticResponse=function(t,e){var r={};return r.data=JSON.stringify(e,null,4),e.root_cause&&e.root_cause.length>0&&e.root_cause[0].reason?r.message=e.root_cause[0].reason:r.message=e.reason||"Unkown elastic error response",t.$$config&&(r.config=t.$$config),r},t.prototype.getTimeSeries=function(){for(var t=[],e=0;e<this.response.responses.length;e++){var r=this.response.responses[e];if(r.error)throw this.getErrorFromElasticResponse(this.response,r.error);if(r.hits&&r.hits.hits.length>0&&this.processHits(r.hits,t),r.aggregations){var n=r.aggregations,a=this.targets[e],i=[],s=new ne.a;this.processBuckets(n,a,i,s,{},0),this.trimDatapoints(i,a),this.nameSeries(i,a);for(var o=0;o<i.length;o++)t.push(i[o]);s.rows.length>0&&t.push(s)}}return{data:t}},t}(),Or=function(){function t(t,e,r,n,a){this.$q=e,this.backendSrv=r,this.templateSrv=n,this.timeSrv=a,this.basicAuth=t.basicAuth,this.withCredentials=t.withCredentials,this.url=t.url,this.name=t.name,this.index=t.index,this.timeField=t.jsonData.timeField,this.esVersion=t.jsonData.esVersion,this.templateSrv=n,this.indexPattern=new $r(t.index,t.jsonData.interval),this.interval=t.jsonData.timeInterval,this.maxConcurrentShardRequests=t.jsonData.maxConcurrentShardRequests,this.queryBuilder=new Ar({timeField:this.timeField,esVersion:this.esVersion})}return t.$inject=["instanceSettings","$q","backendSrv","templateSrv","timeSrv"],t.prototype.request=function(t,e,r){var n={url:this.url+"/"+e,method:t,data:r};return(this.basicAuth||this.withCredentials)&&(n.withCredentials=!0),this.basicAuth&&(n.headers={Authorization:this.basicAuth}),this.backendSrv.datasourceRequest(n)},t.prototype.get=function(t){var e=this.timeSrv.timeRange(),r=this.indexPattern.getIndexList(e.from.valueOf(),e.to.valueOf());return I.a.isArray(r)&&r.length?this.request("GET",r[0]+t).then(function(t){return t.data.$$config=t.config,t.data}):this.request("GET",this.indexPattern.getIndexForToday()+t).then(function(t){return t.data.$$config=t.config,t.data})},t.prototype.post=function(t,e){return this.request("POST",t,e).then(function(t){return t.data.$$config=t.config,t.data}).catch(function(t){if(t.data&&t.data.error)throw{message:"Elasticsearch error: "+t.data.error.reason,error:t.data.error};throw t})},t.prototype.annotationQuery=function(t){var e=t.annotation,r=e.timeField||"@timestamp",n=e.query||"*",a=e.tagsField||"tags",i=e.textField||null,s={};s[r]={from:t.range.from.valueOf(),to:t.range.to.valueOf(),format:"epoch_millis"};var o={query:{bool:{filter:[{range:s},{query_string:{query:this.templateSrv.replace(n,{},"lucene")}}]}},size:1e4};this.esVersion<5&&(o.fields=[r,"_source"]);var l={search_type:"query_then_fetch",ignore_unavailable:!0};e.index?l.index=e.index:l.index=this.indexPattern.getIndexList(t.range.from,t.range.to);var c=L.a.toJson(l)+"\n"+L.a.toJson(o)+"\n";return this.post("_msearch",c).then(function(t){for(var n=[],s=t.responses[0].hits.hits,o=function(t,e){if(e){for(var r=e.split("."),n=t,a=0;a<r.length;a++)if(!(n=n[r[a]]))return console.log("could not find field in annotation: ",e),"";return n}},l=0;l<s.length;l++){var c=s[l]._source,u=o(c,r);if(void 0!==s[l].fields){var d=s[l].fields;(I.a.isString(d[r])||I.a.isNumber(d[r]))&&(u=d[r])}var p={annotation:e,time:H.a.utc(u).valueOf(),text:o(c,i),tags:o(c,a)};if(e.titleField){var h=o(c,e.titleField);h&&(p.text=h+"\n"+p.text)}"string"==typeof p.tags&&(p.tags=p.tags.split(",")),n.push(p)}return n})},t.prototype.testDatasource=function(){var t=this;return this.timeSrv.setTime({from:"now-1m",to:"now"},!0),this.getFields({type:"date"}).then(function(e){return I.a.find(e,{text:t.timeField})?{status:"success",message:"Index OK. Time field name OK."}:{status:"error",message:"No date field named "+t.timeField+" found"}},function(t){if(console.log(t),t.data&&t.data.error){var e=L.a.toJson(t.data.error);return t.data.error.reason&&(e=t.data.error.reason),{status:"error",message:e}}return{status:"error",message:t.status}})},t.prototype.getQueryHeader=function(t,e,r){var n={search_type:t,ignore_unavailable:!0,index:this.indexPattern.getIndexList(e,r)};return this.esVersion>=56&&(n.max_concurrent_shard_requests=this.maxConcurrentShardRequests),L.a.toJson(n)},t.prototype.query=function(t){for(var e,r="",n=[],a=this.timeSrv,i=this.templateSrv,s=this.templateSrv.getAdhocFilters(this.name),o=0;o<t.targets.length;o++)if(!(e=t.targets[o]).hide){var l=this.templateSrv.replace(e.query||"*",t.scopedVars,"lucene"),c=this.queryBuilder.build(e,s,l),u=L.a.toJson(c),d=0===c.size&&this.esVersion<5?"count":"query_then_fetch";r+=this.getQueryHeader(d,t.range.from,t.range.to)+"\n",r+=u+"\n",n.push(e)}return 0===n.length?this.$q.when([]):(r=(r=r.replace(/\$timeFrom/g,t.range.from.valueOf())).replace(/\$timeTo/g,t.range.to.valueOf()),r=this.templateSrv.replace(r,t.scopedVars),this.post("_msearch",r).then(function(t){return new Dr(n,t,a,i).getTimeSeries()}))},t.prototype.getFields=function(t){return this.get("/_mapping").then(function(e){var r={float:"number",double:"number",integer:"number",long:"number",date:"date",string:"string",text:"string",scaled_float:"number",nested:"nested"};function n(t,e,n){return"_"!==e[0]&&(!n.type||(n.type===t.type||n.type===r[t.type]))}var a=[],i={};function s(e){for(var r in e){var o=e[r];if(I.a.isObject(o.properties)&&(a.push(r),s(o.properties)),I.a.isObject(o.fields)&&(a.push(r),s(o.fields)),I.a.isString(o.type)){var l=a.concat(r).join(".");n(o,r,t)&&(i[l]={text:l,type:o.type})}}a.pop()}for(var o in e){var l=e[o];if(l&&l.mappings){var c=l.mappings;for(var u in c){s(c[u].properties)}}}return I.a.map(i,function(t){return t})})},t.prototype.getTerms=function(t){var e=this.timeSrv.timeRange(),r=this.esVersion>=5?"query_then_fetch":"count",n=this.getQueryHeader(r,e.from,e.to),a=L.a.toJson(this.queryBuilder.getTermsQuery(t));return a=n+"\n"+(a=(a=a.replace(/\$timeFrom/g,e.from.valueOf())).replace(/\$timeTo/g,e.to.valueOf()))+"\n",this.post("_msearch?search_type="+r,a).then(function(t){if(!t.responses[0].aggregations)return[];var e=t.responses[0].aggregations[1].buckets;return I.a.map(e,function(t){return{text:t.key_as_string||t.key,value:t.key}})})},t.prototype.metricFindQuery=function(t){return(t=L.a.fromJson(t))?"fields"===t.find?(t.field=this.templateSrv.replace(t.field,{},"lucene"),this.getFields(t)):"terms"===t.find?(t.field=this.templateSrv.replace(t.field,{},"lucene"),t.query=this.templateSrv.replace(t.query||"*",{},"lucene"),this.getTerms(t)):void 0:this.$q.when([])},t.prototype.getTagKeys=function(){return this.getFields({})},t.prototype.getTagValues=function(t){return this.getTerms({field:t.key,query:"*"})},t.prototype.targetContainsTemplate=function(t){if(this.templateSrv.variableExists(t.query)||this.templateSrv.variableExists(t.alias))return!0;for(var e=0,r=t.bucketAggs;e<r.length;e++){var n=r[e];if(this.templateSrv.variableExists(n.field)||this.objectContainsTemplate(n.settings))return!0}for(var a=0,i=t.metrics;a<i.length;a++){var s=i[a];if(this.templateSrv.variableExists(s.field)||this.objectContainsTemplate(s.settings)||this.objectContainsTemplate(s.meta))return!0}return!1},t.prototype.isPrimitive=function(t){return null===t||void 0===t||!!["string","number","boolean"].some(function(t){return t===typeof!0})},t.prototype.objectContainsTemplate=function(t){if(!t)return!1;for(var e=0,r=Object.keys(t);e<r.length;e++){var n=r[e];if(this.isPrimitive(t[n])){if(this.templateSrv.variableExists(t[n]))return!0}else if(Array.isArray(t[n]))for(var a=0,i=t[n];a<i.length;a++){var s=i[a];if(this.objectContainsTemplate(s))return!0}else if(this.objectContainsTemplate(t[n]))return!0}return!1},t}(),Ir=function(){function t(t,e,r,n){var a=t.target.bucketAggs;t.orderByOptions=[],t.getBucketAggTypes=function(){return gr},t.getOrderOptions=function(){return br},t.getSizeOptions=function(){return yr},n.onAppEvent("elastic-query-updated",function(){t.validateModel()},t),t.init=function(){t.agg=a[t.index],t.validateModel()},t.onChangeInternal=function(){t.onChange()},t.onTypeChanged=function(){switch(t.agg.settings={},t.showOptions=!1,t.agg.type){case"date_histogram":case"histogram":case"terms":delete t.agg.query,t.agg.field="select field";break;case"filters":delete t.agg.field,t.agg.query="*";break;case"geohash_grid":t.agg.settings.precision=3}t.validateModel(),t.onChange()},t.validateModel=function(){t.index=I.a.indexOf(a,t.agg),t.isFirst=0===t.index,t.bucketAggCount=a.length;var e="",r=t.agg.settings||{};switch(t.agg.type){case"terms":r.order=r.order||"desc",r.size=r.size||"10",r.min_doc_count=r.min_doc_count||1,r.orderBy=r.orderBy||"_term","0"!==r.size&&(e=function(t){return I.a.find(br,{value:t}).text}(r.order)+" "+r.size+", "),r.min_doc_count>0&&(e+="Min Doc Count: "+r.min_doc_count+", "),e+="Order by: "+function(t,e){var r=I.a.find(vr,{value:t});if(r)return r.text;var n=I.a.find(e.metrics,{id:t});return n?Mr(n):"metric not found"}(r.orderBy,t.target),"0"===r.size&&(e+=" ("+r.order+")");break;case"filters":r.filters=r.filters||[{query:"*"}],(e=I.a.reduce(r.filters,function(t,e,r){return t+="Q"+(r+1)+"  = "+e.query+" "},"")).length>50&&(e=e.substr(0,50)+"..."),e="Filter Queries ("+r.filters.length+")";break;case"date_histogram":r.interval=r.interval||"auto",r.min_doc_count=r.min_doc_count||0,t.agg.field=t.target.timeField,e="Interval: "+r.interval,r.min_doc_count>0&&(e+=", Min Doc Count: "+r.min_doc_count),(void 0===r.trimEdges||r.trimEdges<0)&&(r.trimEdges=0),r.trimEdges&&r.trimEdges>0&&(e+=", Trim edges: "+r.trimEdges);break;case"histogram":r.interval=r.interval||1e3,r.min_doc_count=I.a.defaultTo(r.min_doc_count,1),e="Interval: "+r.interval,r.min_doc_count>0&&(e+=", Min Doc Count: "+r.min_doc_count);break;case"geohash_grid":r.precision=Math.max(Math.min(r.precision,7),1),e="Precision: "+r.precision}return t.settingsLinkText=e,t.agg.settings=r,!0},t.addFiltersQuery=function(){t.agg.settings.filters.push({query:"*"})},t.removeFiltersQuery=function(e){t.agg.settings.filters=I.a.without(t.agg.settings.filters,e)},t.toggleOptions=function(){t.showOptions=!t.showOptions},t.getOrderByOptions=function(){return function(t){var e=[];return I.a.each(t.metrics,function(t){"count"!==t.type&&e.push({text:Mr(t),value:t.id})}),vr.concat(e)}(t.target)},t.getFieldsInternal=function(){return"date_histogram"===t.agg.type?t.getFields({$fieldType:"date"}):t.getFields()},t.getIntervalOptions=function(){return r.when(e.transformToSegments(!0,"interval")(xr))},t.addBucketAgg=function(){var e=a[a.length-1],r=a.length-1;e&&"date_histogram"===e.type&&(r-=1);var n=I.a.reduce(t.target.bucketAggs.concat(t.target.metrics),function(t,e){return parseInt(e.id,10)>t?parseInt(e.id,10):t},0);a.splice(r,0,{type:"terms",field:"select field",id:(n+1).toString(),fake:!0}),t.onChange()},t.removeBucketAgg=function(){a.splice(t.index,1),t.onChange()},t.init()}return t.$inject=["$scope","uiSegmentSrv","$q","$rootScope"],t}();z.c.directive("elasticBucketAgg",function(){return{templateUrl:"public/app/plugins/datasource/elasticsearch/partials/bucket_agg.html",controller:Ir,restrict:"E",scope:{target:"=",index:"=",onChange:"&",getFields:"&"}}});var Nr=function(){function t(t,e,r,n){var a=t.target.metrics;t.metricAggTypes=Tr(t.esVersion),t.extendedStats=wr,t.pipelineAggOptions=[],t.modelSettingsValues={},t.init=function(){t.agg=a[t.index],t.validateModel(),t.updatePipelineAggOptions()},t.updatePipelineAggOptions=function(){t.pipelineAggOptions=function(t){var e=[];return I.a.each(t.metrics,function(t){Er(t.type)||e.push({text:Mr(t),value:t.id})}),e}(t.target)},n.onAppEvent("elastic-query-updated",function(){t.index=I.a.indexOf(a,t.agg),t.updatePipelineAggOptions(),t.validateModel()},t),t.validateModel=function(){if(t.isFirst=0===t.index,t.isSingle=1===a.length,t.settingsLinkText="",t.aggDef=I.a.find(t.metricAggTypes,{value:t.agg.type}),Er(t.agg.type)){t.agg.pipelineAgg=t.agg.pipelineAgg||"select metric",t.agg.field=t.agg.pipelineAgg;var e=function(t){return Er(t.type)?kr[t.type]:[]}(t.agg);e.length>0&&(I.a.each(e,function(e){t.agg.settings[e.text]=t.agg.settings[e.text]||e.default}),t.settingsLinkText="Options")}else t.agg.field||(t.agg.field="select field");switch(t.agg.type){case"cardinality":var r=t.agg.settings.precision_threshold||"";t.settingsLinkText="Precision threshold: "+r;break;case"percentiles":t.agg.settings.percents=t.agg.settings.percents||[25,50,75,95,99],t.settingsLinkText="Values: "+t.agg.settings.percents.join(",");break;case"extended_stats":0===I.a.keys(t.agg.meta).length&&(t.agg.meta.std_deviation_bounds_lower=!0,t.agg.meta.std_deviation_bounds_upper=!0);var n=I.a.reduce(t.agg.meta,function(e,r,n){if(r){var a=I.a.find(t.extendedStats,{value:n});e.push(a.text)}return e},[]);t.settingsLinkText="Stats: "+n.join(", ");break;case"moving_avg":t.movingAvgModelTypes=Sr,t.modelSettings=_r(t.agg.settings.model,!0),t.updateMovingAvgModelSettings();break;case"raw_document":t.agg.settings.size=t.agg.settings.size||500,t.settingsLinkText="Size: "+t.agg.settings.size,t.target.metrics.splice(0,t.target.metrics.length,t.agg),t.target.bucketAggs=[]}if(t.aggDef.supportsInlineScript){var i=t.agg.inlineScript;i?t.agg.settings.script={inline:i}:delete t.agg.settings.script,""===t.settingsLinkText&&(t.settingsLinkText="Options")}},t.toggleOptions=function(){t.showOptions=!t.showOptions,t.updatePipelineAggOptions()},t.onChangeInternal=function(){t.onChange()},t.updateMovingAvgModelSettings=function(){for(var e=[],r=_r(t.agg.settings.model,!1),n=0;n<r.length;n++)e.push(r[n].value);for(var a in t.agg.settings.settings)null!==t.agg.settings.settings[a]&&-1!==e.indexOf(a)||delete t.agg.settings.settings[a]},t.onChangeClearInternal=function(){delete t.agg.settings.minimize,t.onChange()},t.onTypeChange=function(){t.agg.settings={},t.agg.meta={},t.showOptions=!1,0===t.target.bucketAggs.length&&"raw_document"!==t.agg.type&&(t.target.bucketAggs=[{type:"date_histogram",id:"2",settings:{interval:"auto"}}]),t.updatePipelineAggOptions(),t.onChange()},t.getFieldsInternal=function(){return"cardinality"===t.agg.type?t.getFields():t.getFields({$fieldType:"number"})},t.addMetricAgg=function(){var e=a.length,r=I.a.reduce(t.target.bucketAggs.concat(t.target.metrics),function(t,e){return parseInt(e.id,10)>t?parseInt(e.id,10):t},0);a.splice(e,0,{type:"count",field:"select field",id:(r+1).toString()}),t.onChange()},t.removeMetricAgg=function(){a.splice(t.index,1),t.onChange()},t.toggleShowMetric=function(){t.agg.hide=!t.agg.hide,t.agg.hide||delete t.agg.hide,t.onChange()},t.init()}return t.$inject=["$scope","uiSegmentSrv","$q","$rootScope"],t}();z.c.directive("elasticMetricAgg",function(){return{templateUrl:"public/app/plugins/datasource/elasticsearch/partials/metric_agg.html",controller:Nr,restrict:"E",scope:{target:"=",index:"=",onChange:"&",getFields:"&",esVersion:"="}}});var Fr=function(t){function e(e,r,n,a){var i=t.call(this,e,r)||this;if(i.$rootScope=n,i.uiSegmentSrv=a,i.esVersion=i.datasource.esVersion,i.target=i.target||{},i.target.metrics=i.target.metrics||[{type:"count",id:"1"}],i.target.bucketAggs=i.target.bucketAggs||[{type:"date_histogram",id:"2",settings:{interval:"auto"}}],0===i.target.bucketAggs.length){var s=i.target.metrics[0];s&&"raw_document"===s.type||(i.target.bucketAggs=[{type:"date_histogram",id:"2",settings:{interval:"auto"}}]),i.refresh()}return i.queryUpdated(),i}return e.$inject=["$scope","$injector","$rootScope","uiSegmentSrv"],J.c(e,t),e.prototype.getFields=function(t){var e=L.a.toJson({find:"fields",type:t});return this.datasource.metricFindQuery(e).then(this.uiSegmentSrv.transformToSegments(!1)).catch(this.handleQueryError.bind(this))},e.prototype.queryUpdated=function(){var t=L.a.toJson(this.datasource.queryBuilder.build(this.target),!0);this.rawQueryOld&&t!==this.rawQueryOld&&this.refresh(),this.rawQueryOld=t,this.$rootScope.appEvent("elastic-query-updated")},e.prototype.getCollapsedText=function(){var t=this.target.metrics,e=this.target.bucketAggs,r=Tr(this.esVersion),n=gr,a="";return this.target.query&&(a+="Query: "+this.target.query+", "),a+="Metrics: ",I.a.each(t,function(t,e){var n=I.a.find(r,{value:t.type});a+=n.text+"(",n.requiresField&&(a+=t.field),a+="), "}),I.a.each(e,function(t,e){0===e&&(a+=" Group by: ");var r=I.a.find(n,{value:t.type});a+=r.text+"(",r.requiresField&&(a+=t.field),a+="), "}),this.target.alias&&(a+="Alias: "+this.target.alias),a},e.prototype.handleQueryError=function(t){return this.error=t.message||"Failed to issue metric query",[]},e.templateUrl="partials/query.editor.html",e}(Ht),qr=function(){function t(t){this.indexPatternTypes=[{name:"No pattern",value:void 0},{name:"Hourly",value:"Hourly",example:"[logstash-]YYYY.MM.DD.HH"},{name:"Daily",value:"Daily",example:"[logstash-]YYYY.MM.DD"},{name:"Weekly",value:"Weekly",example:"[logstash-]GGGG.WW"},{name:"Monthly",value:"Monthly",example:"[logstash-]YYYY.MM"},{name:"Yearly",value:"Yearly",example:"[logstash-]YYYY"}],this.esVersions=[{name:"2.x",value:2},{name:"5.x",value:5},{name:"5.6+",value:56},{name:"6.0+",value:60}],this.current.jsonData.timeField=this.current.jsonData.timeField||"@timestamp",this.current.jsonData.esVersion=this.current.jsonData.esVersion||5,this.current.jsonData.maxConcurrentShardRequests=this.current.jsonData.maxConcurrentShardRequests||256}return t.$inject=["$scope"],t.prototype.indexPatternTypeChanged=function(){if(!this.current.database||0===this.current.database.length||this.current.database.startsWith("[logstash-]")){var t=I.a.find(this.indexPatternTypes,{value:this.current.jsonData.interval});this.current.database=t.example||"es-index-name"}},t.templateUrl="public/app/plugins/datasource/elasticsearch/partials/config.html",t}(),Lr=function(){function t(){}return t.templateUrl="partials/annotations.editor.html",t}(),Rr=function(){function t(t,e,r,n){this.$q=e,this.backendSrv=r,this.templateSrv=n,this.type="opentsdb",this.url=t.url,this.name=t.name,this.withCredentials=t.withCredentials,this.basicAuth=t.basicAuth,t.jsonData=t.jsonData||{},this.tsdbVersion=t.jsonData.tsdbVersion||1,this.tsdbResolution=t.jsonData.tsdbResolution||1,this.tagKeys={},this.aggregatorsPromise=null,this.filterTypesPromise=null}return t.$inject=["instanceSettings","$q","backendSrv","templateSrv"],t.prototype.query=function(t){var e=this,r=this.convertToTSDBTime(t.rangeRaw.from,!1),n=this.convertToTSDBTime(t.rangeRaw.to,!0),a=[];I.a.each(t.targets,function(r){r.metric&&a.push(e.convertTargetToQuery(r,t,e.tsdbVersion))});var i=I.a.compact(a);if(I.a.isEmpty(i)){var s=this.$q.defer();return s.resolve({data:[]}),s.promise}var o={};return I.a.each(i,function(t){t.filters&&t.filters.length>0?I.a.each(t.filters,function(t){o[t.tagk]=!0}):I.a.each(t.tags,function(t,e){o[e]=!0})}),t.targets=I.a.filter(t.targets,function(t){return!0!==t.hide}),this.performTimeSeriesQuery(i,r,n).then(function(r){var n=e.mapMetricsToTargets(r.data,t,e.tsdbVersion);return{data:I.a.map(r.data,function(r,a){return-1===(a=n[a])&&(a=0),e._saveTagKeys(r),e.transformMetricData(r,o,t.targets[a],t,e.tsdbResolution)})}})},t.prototype.annotationQuery=function(t){var e=this.convertToTSDBTime(t.rangeRaw.from,!1),r=this.convertToTSDBTime(t.rangeRaw.to,!0),n=[],a=[];n.push({aggregator:"sum",metric:t.annotation.target});var i=I.a.compact(n);return this.performTimeSeriesQuery(i,e,r).then(function(e){if(e.data[0]){var r=e.data[0].annotations;t.annotation.isGlobal&&(r=e.data[0].globalAnnotations),r&&I.a.each(r,function(e){var r={text:e.description,time:1e3*Math.floor(e.startTime),annotation:t.annotation};a.push(r)})}return a})},t.prototype.targetContainsTemplate=function(t){if(t.filters&&t.filters.length>0)for(var e=0;e<t.filters.length;e++)if(this.templateSrv.variableExists(t.filters[e].filter))return!0;if(t.tags&&Object.keys(t.tags).length>0)for(var r in t.tags)if(this.templateSrv.variableExists(t.tags[r]))return!0;return!1},t.prototype.performTimeSeriesQuery=function(t,e,r){var n=!1;2===this.tsdbResolution&&(n=!0);var a={start:e,queries:t,msResolution:n,globalAnnotations:!0};3===this.tsdbVersion&&(a.showQuery=!0),r&&(a.end=r);var i={method:"POST",url:this.url+"/api/query",data:a};return this._addCredentialOptions(i),this.backendSrv.datasourceRequest(i)},t.prototype.suggestTagKeys=function(t){return this.$q.when(this.tagKeys[t]||[])},t.prototype._saveTagKeys=function(t){var e=Object.keys(t.tags);I.a.each(t.aggregateTags,function(t){e.push(t)}),this.tagKeys[t.metric]=e},t.prototype._performSuggestQuery=function(t,e){return this._get("/api/suggest",{type:e,q:t,max:1e3}).then(function(t){return t.data})},t.prototype._performMetricKeyValueLookup=function(t,e){if(!t||!e)return this.$q.when([]);var r=e.split(",").map(function(t){return t.trim()}),n=r[0],a=n+"=*";r.length>1&&(a+=","+r.splice(1).join(","));var i=t+"{"+a+"}";return this._get("/api/search/lookup",{m:i,limit:3e3}).then(function(t){t=t.data.results;var e=[];return I.a.each(t,function(t){-1===e.indexOf(t.tags[n])&&e.push(t.tags[n])}),e})},t.prototype._performMetricKeyLookup=function(t){return t?this._get("/api/search/lookup",{m:t,limit:1e3}).then(function(t){t=t.data.results;var e=[];return I.a.each(t,function(t){I.a.each(t.tags,function(t,r){-1===e.indexOf(r)&&e.push(r)})}),e}):this.$q.when([])},t.prototype._get=function(t,e){var r={method:"GET",url:this.url+t,params:e};return this._addCredentialOptions(r),this.backendSrv.datasourceRequest(r)},t.prototype._addCredentialOptions=function(t){(this.basicAuth||this.withCredentials)&&(t.withCredentials=!0),this.basicAuth&&(t.headers={Authorization:this.basicAuth})},t.prototype.metricFindQuery=function(t){if(!t)return this.$q.when([]);var e;try{e=this.templateSrv.replace(t,{},"distributed")}catch(t){return this.$q.reject(t)}var r=function(t){return I.a.map(t,function(t){return{text:t}})},n=e.match(/metrics\((.*)\)/);if(n)return this._performSuggestQuery(n[1],"metrics").then(r);var a=e.match(/tag_names\((.*)\)/);if(a)return this._performMetricKeyLookup(a[1]).then(r);var i=e.match(/tag_values\((.*?),\s?(.*)\)/);if(i)return this._performMetricKeyValueLookup(i[1],i[2]).then(r);var s=e.match(/suggest_tagk\((.*)\)/);if(s)return this._performSuggestQuery(s[1],"tagk").then(r);var o=e.match(/suggest_tagv\((.*)\)/);return o?this._performSuggestQuery(o[1],"tagv").then(r):this.$q.when([])},t.prototype.testDatasource=function(){return this._performSuggestQuery("cpu","metrics").then(function(){return{status:"success",message:"Data source is working"}})},t.prototype.getAggregators=function(){return this.aggregatorsPromise?this.aggregatorsPromise:(this.aggregatorsPromise=this._get("/api/aggregators").then(function(t){return t.data&&I.a.isArray(t.data)?t.data.sort():[]}),this.aggregatorsPromise)},t.prototype.getFilterTypes=function(){return this.filterTypesPromise?this.filterTypesPromise:(this.filterTypesPromise=this._get("/api/config/filters").then(function(t){return t.data?Object.keys(t.data).sort():[]}),this.filterTypesPromise)},t.prototype.transformMetricData=function(t,e,r,n,a){var i=this.createMetricLabel(t,r,e,n),s=[];return I.a.each(t.dps,function(t,e){2===a?s.push([t,1*e]):s.push([t,1e3*e])}),{target:i,datapoints:s}},t.prototype.createMetricLabel=function(t,e,r,n){if(e.alias){var a=I.a.clone(n.scopedVars||{});return I.a.each(t.tags,function(t,e){a["tag_"+e]={value:t}}),this.templateSrv.replace(e.alias,a)}var i=t.metric,s=[];return I.a.isEmpty(t.tags)||I.a.each(I.a.toPairs(t.tags),function(t){I.a.has(r,t[0])&&s.push(t[0]+"="+t[1])}),I.a.isEmpty(s)||(i+="{"+s.join(", ")+"}"),i},t.prototype.convertTargetToQuery=function(t,e,r){if(!t.metric||t.hide)return null;var n={metric:this.templateSrv.replace(t.metric,e.scopedVars,"pipe"),aggregator:"avg"};if(t.aggregator&&(n.aggregator=this.templateSrv.replace(t.aggregator)),t.shouldComputeRate&&(n.rate=!0,n.rateOptions={counter:!!t.isCounter},t.counterMax&&t.counterMax.length&&(n.rateOptions.counterMax=parseInt(t.counterMax,10)),t.counterResetValue&&t.counterResetValue.length&&(n.rateOptions.resetValue=parseInt(t.counterResetValue,10)),r>=2&&(n.rateOptions.dropResets=!(n.rateOptions.counterMax||n.rateOptions.ResetValue&&0!==n.rateOptions.ResetValue))),!t.disableDownsampling){var a=this.templateSrv.replace(t.downsampleInterval||e.interval);a.match(/\.[0-9]+s/)&&(a=1e3*parseFloat(a)+"ms"),n.downsample=a+"-"+t.downsampleAggregator,t.downsampleFillPolicy&&"none"!==t.downsampleFillPolicy&&(n.downsample+="-"+t.downsampleFillPolicy)}if(t.filters&&t.filters.length>0){if(n.filters=L.a.copy(t.filters),n.filters)for(var i in n.filters)n.filters[i].filter=this.templateSrv.replace(n.filters[i].filter,e.scopedVars,"pipe")}else if(n.tags=L.a.copy(t.tags),n.tags)for(var s in n.tags)n.tags[s]=this.templateSrv.replace(n.tags[s],e.scopedVars,"pipe");return t.explicitTags&&(n.explicitTags=!0),n},t.prototype.mapMetricsToTargets=function(t,e,r){var n,a,i=this;return I.a.map(t,function(t){return 3===r?t.query.index:I.a.findIndex(e.targets,function(r){return r.filters&&r.filters.length>0?r.metric===t.metric:r.metric===t.metric&&I.a.every(r.tags,function(r,s){return n=i.templateSrv.replace(r,e.scopedVars,"pipe"),a=n.split("|"),I.a.includes(a,t.tags[s])||"*"===n})})})},t.prototype.convertToTSDBTime=function(t,e){return"now"===t?null:(t=Ct.parse(t,e)).valueOf()},t}(),jr=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.errors=n.validateTarget(),n.aggregators=["avg","sum","min","max","dev","zimsum","mimmin","mimmax"],n.fillPolicies=["none","nan","null","zero"],n.filterTypes=["wildcard","iliteral_or","not_iliteral_or","not_literal_or","iwildcard","literal_or","regexp"],n.tsdbVersion=n.datasource.tsdbVersion,n.target.aggregator||(n.target.aggregator="sum"),n.target.downsampleAggregator||(n.target.downsampleAggregator="avg"),n.target.downsampleFillPolicy||(n.target.downsampleFillPolicy="none"),n.datasource.getAggregators().then(function(t){0!==t.length&&(n.aggregators=t)}),n.datasource.getFilterTypes().then(function(t){0!==t.length&&(n.filterTypes=t)}),n.suggestMetrics=function(t,e){n.datasource.metricFindQuery("metrics("+t+")").then(n.getTextValues).then(e)},n.suggestTagKeys=function(t,e){n.datasource.suggestTagKeys(n.target.metric).then(e)},n.suggestTagValues=function(t,e){n.datasource.metricFindQuery("suggest_tagv("+t+")").then(n.getTextValues).then(e)},n}return e.$inject=["$scope","$injector"],J.c(e,t),e.prototype.targetBlur=function(){this.errors=this.validateTarget(),this.refresh()},e.prototype.getTextValues=function(t){return I.a.map(t,function(t){return t.text})},e.prototype.addTag=function(){this.target.filters&&this.target.filters.length>0&&(this.errors.tags="请删除筛选器以使用标记，标记和筛选器是互斥的。"),this.addTagMode?(this.target.tags||(this.target.tags={}),this.errors=this.validateTarget(),this.errors.tags||(this.target.tags[this.target.currentTagKey]=this.target.currentTagValue,this.target.currentTagKey="",this.target.currentTagValue="",this.targetBlur()),this.addTagMode=!1):this.addTagMode=!0},e.prototype.removeTag=function(t){delete this.target.tags[t],this.targetBlur()},e.prototype.editTag=function(t,e){this.removeTag(t),this.target.currentTagKey=t,this.target.currentTagValue=e,this.addTag()},e.prototype.closeAddTagMode=function(){this.addTagMode=!1},e.prototype.addFilter=function(){if(this.target.tags&&I.a.size(this.target.tags)>0&&(this.errors.filters="请删除标记以使用筛选器，标记和筛选器是互斥的。"),this.addFilterMode){if(this.target.filters||(this.target.filters=[]),this.target.currentFilterType||(this.target.currentFilterType="iliteral_or"),this.target.currentFilterGroupBy||(this.target.currentFilterGroupBy=!1),this.errors=this.validateTarget(),!this.errors.filters){var t={type:this.target.currentFilterType,tagk:this.target.currentFilterKey,filter:this.target.currentFilterValue,groupBy:this.target.currentFilterGroupBy};this.target.filters.push(t),this.target.currentFilterType="literal_or",this.target.currentFilterKey="",this.target.currentFilterValue="",this.target.currentFilterGroupBy=!1,this.targetBlur()}this.addFilterMode=!1}else this.addFilterMode=!0},e.prototype.removeFilter=function(t){this.target.filters.splice(t,1),this.targetBlur()},e.prototype.editFilter=function(t,e){this.removeFilter(e),this.target.currentFilterKey=t.tagk,this.target.currentFilterValue=t.filter,this.target.currentFilterType=t.type,this.target.currentFilterGroupBy=t.groupBy,this.addFilter()},e.prototype.closeAddFilterMode=function(){this.addFilterMode=!1},e.prototype.validateTarget=function(){var t={};if(this.target.shouldDownsample)try{this.target.downsampleInterval?kt.a.describe_interval(this.target.downsampleInterval):t.downsampleInterval="You must supply a downsample interval (e.g. '1m' or '1h').必须提供降低采样间隔（例如'1m'或'1h')。"}catch(e){t.downsampleInterval=e.message}return this.target.tags&&I.a.has(this.target.tags,this.target.currentTagKey)&&(t.tags="重复标记键 '"+this.target.currentTagKey+"'."),t},e.templateUrl="partials/query.editor.html",e}(Ht),Ur=function(){function t(t){this.tsdbVersions=[{name:"<=2.1",value:1},{name:"==2.2",value:2},{name:"==2.3",value:3}],this.tsdbResolutions=[{name:"second",value:1},{name:"millisecond",value:2}],this.current.jsonData=this.current.jsonData||{},this.current.jsonData.tsdbVersion=this.current.jsonData.tsdbVersion||1,this.current.jsonData.tsdbResolution=this.current.jsonData.tsdbResolution||1}return t.$inject=["$scope"],t.templateUrl="public/app/plugins/datasource/opentsdb/partials/config.html",t}(),Vr=function(){function t(){}return t.templateUrl="partials/annotations.editor.html",t}(),Br=function(){function t(t,e,r){this.backendSrv=t,this.$q=e,this.templateSrv=r}return t.$inject=["backendSrv","$q","templateSrv"],t.prototype.query=function(t){return this.backendSrv.get("/api/tsdb/testdata/random-walk",{from:t.range.from.valueOf(),to:t.range.to.valueOf(),intervalMs:t.intervalMs,maxDataPoints:t.maxDataPoints}).then(function(t){var e=[];return t.results&&I.a.forEach(t.results,function(t){for(var r=0,n=t.series;r<n.length;r++){var a=n[r];e.push({target:a.name,datapoints:a.points})}}),{data:e}})},t.prototype.metricFindQuery=function(t){return this.$q.when({data:[]})},t.prototype.annotationQuery=function(t){var e={from:t.range.from.valueOf(),to:t.range.to.valueOf(),limit:t.annotation.limit,tags:t.annotation.tags,matchAny:t.annotation.matchAny};if("dashboard"===t.annotation.type){if(!t.dashboard.id)return this.$q.when([]);e.dashboardId=t.dashboard.id,delete e.tags}else{if(!I.a.isArray(t.annotation.tags)||0===t.annotation.tags.length)return this.$q.when([]);for(var r=[],n=0,a=e.tags;n<a.length;n++)for(var i=a[n],s=0,o=this.templateSrv.replace(i,{},"pipe").split("|");s<o.length;s++){var l=o[s];r.push(l)}e.tags=r}return this.backendSrv.get("/api/annotations",e)},t}(),Qr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return J.c(e,t),e.templateUrl="partials/query.editor.html",e}(Ht),Hr=function(){function t(){this.types=[{text:"Dashboard",value:"dashboard"},{text:"Tags",value:"tags"}],this.annotation.type=this.annotation.type||"tags",this.annotation.limit=this.annotation.limit||100}return t.templateUrl="partials/annotations.editor.html",t}(),zr=function(){function t(t){this.series=t.series,this.alias=t.alias,this.annotation=t.annotation}return t.prototype.getTimeSeries=function(){var t,e,r=this,n=[];return 0===this.series.length?n:(I.a.each(this.series,function(a){var i=a.columns.length,s=I.a.map(a.tags,function(t,e){return e+": "+t});for(e=1;e<i;e++){var o=a.name,l=a.columns[e];"value"!==l&&(o=o+"."+l),r.alias?o=r._getSeriesName(a,e):a.tags&&(o=o+" {"+s.join(", ")+"}");var c=[];if(a.values)for(t=0;t<a.values.length;t++)c[t]=[a.values[t][e],a.values[t][0]];n.push({target:o,datapoints:c})}}),n)},t.prototype._getSeriesName=function(t,e){var r=t.name.split(".");return this.alias.replace(/\$(\w+)|\[\[([\s\S]+?)\]\]/g,function(n,a,i){var s=a||i,o=parseInt(s,10);if("m"===s||"measurement"===s)return t.name;if("col"===s)return t.columns[e];if(!isNaN(o))return r[o];if(0!==s.indexOf("tag_"))return n;var l=s.replace("tag_","");return t.tags?t.tags[l]:n})},t.prototype.getAnnotations=function(){var t=this,e=[];return I.a.each(this.series,function(r){var n=null,a=null,i=[],s=null;I.a.each(r.columns,function(e,r){"time"!==e?"sequence_number"!==e&&(e!==t.annotation.titleColumn?I.a.includes((t.annotation.tagsColumn||"").replace(" ","").split(","),e)?i.push(r):e!==t.annotation.textColumn?n||s===r||(n=r):s=r:n=r):a=r}),I.a.each(r.values,function(r){var o={annotation:t.annotation,time:+new Date(r[a]),title:r[n],tags:I.a.flatten(i.filter(function(t){return r[t]}).map(function(t){return r[t].split(",")})),text:r[s]};e.push(o)})}),e},t.prototype.getTable=function(){var t,e,r=new ne.a;return 0===this.series.length?r:(I.a.each(this.series,function(n,a){if(0===a)for(e=0,"time"===n.columns[0]&&(r.columns.push({text:"Time",type:"time"}),e++),I.a.each(I.a.keys(n.tags),function(t){r.columns.push({text:t})});e<n.columns.length;e++)r.columns.push({text:n.columns[e]});if(n.values)for(t=0;t<n.values.length;t++){var i=n.values[t],s=[i[0]];if(n.tags)for(var o in n.tags)n.tags.hasOwnProperty(o)&&s.push(n.tags[o]);for(e=1;e<i.length;e++)s.push(i[e]);r.rows.push(s)}}),r)},t}(),Gr=[],Wr={Aggregations:[],Selectors:[],Transformations:[],Predictors:[],Math:[],Aliasing:[],Fields:[]};function Yr(t){var e=Gr[t.type];if(!e)throw{message:"Could not find query part "+t.type};return new Gt.a(t,e)}function Kr(t){Gr[t.type]=new Gt.b(t),t.category.push(Gr[t.type])}var Jr=[];function Xr(t,e){return"*"===t.params[0]?"*":'"'+t.params[0]+'"'}function Zr(t,e){for(var r=0;r<t.length;r++){var n=t[r];if(n.def.category===Wr.Aggregations){if(n.def.type===e.def.type)return;if("count"===n.def.type&&"distinct"===e.def.type)break;if("distinct"===n.def.type){var a=t.length>=r+2;if("count"!==e.def.type&&a)t[r+1].def.category===Wr.Aggregations&&t.splice(r+1,1);else if("count"===e.def.type)return void(a&&"count"===t[r+1].def.type||t.splice(r+1,0,e))}return void(t[r]=e)}if(n.def.category===Wr.Selectors)return void(t[r]=e)}t.splice(1,0,e)}function tn(t,e){var r;for(r=0;r<t.length;r++){var n=t[r];if(n.def.category===Wr.Math||n.def.category===Wr.Aliasing)break}t.splice(r,0,e)}Kr({type:"field",addStrategy:function(t,e,r){var n=I.a.map(t,function(t){return Yr({type:t.def.type,params:I.a.clone(t.params)})});r.selectModels.push(n)},category:Wr.Fields,params:[{type:"field",dynamicLookup:!0}],defaultParams:["value"],renderer:Xr}),Kr({type:"count",addStrategy:Zr,category:Wr.Aggregations,params:[],defaultParams:[],renderer:Gt.c}),Kr({type:"distinct",addStrategy:Zr,category:Wr.Aggregations,params:[],defaultParams:[],renderer:Gt.c}),Kr({type:"integral",addStrategy:Zr,category:Wr.Aggregations,params:[],defaultParams:[],renderer:Gt.c}),Kr({type:"mean",addStrategy:Zr,category:Wr.Aggregations,params:[],defaultParams:[],renderer:Gt.c}),Kr({type:"median",addStrategy:Zr,category:Wr.Aggregations,params:[],defaultParams:[],renderer:Gt.c}),Kr({type:"mode",addStrategy:Zr,category:Wr.Aggregations,params:[],defaultParams:[],renderer:Gt.c}),Kr({type:"sum",addStrategy:Zr,category:Wr.Aggregations,params:[],defaultParams:[],renderer:Gt.c}),Kr({type:"derivative",addStrategy:tn,category:Wr.Transformations,params:[{name:"duration",type:"interval",options:["1s","10s","1m","5m","10m","15m","1h"]}],defaultParams:["10s"],renderer:Gt.c}),Kr({type:"spread",addStrategy:tn,category:Wr.Transformations,params:[],defaultParams:[],renderer:Gt.c}),Kr({type:"non_negative_derivative",addStrategy:tn,category:Wr.Transformations,params:[{name:"duration",type:"interval",options:["1s","10s","1m","5m","10m","15m","1h"]}],defaultParams:["10s"],renderer:Gt.c}),Kr({type:"difference",addStrategy:tn,category:Wr.Transformations,params:[],defaultParams:[],renderer:Gt.c}),Kr({type:"non_negative_difference",addStrategy:tn,category:Wr.Transformations,params:[],defaultParams:[],renderer:Gt.c}),Kr({type:"moving_average",addStrategy:tn,category:Wr.Transformations,params:[{name:"window",type:"int",options:[5,10,20,30,40]}],defaultParams:[10],renderer:Gt.c}),Kr({type:"cumulative_sum",addStrategy:tn,category:Wr.Transformations,params:[],defaultParams:[],renderer:Gt.c}),Kr({type:"stddev",addStrategy:tn,category:Wr.Transformations,params:[],defaultParams:[],renderer:Gt.c}),Kr({type:"time",category:Jr,params:[{name:"interval",type:"time",options:["$__interval","1s","10s","1m","5m","10m","15m","1h"]}],defaultParams:["$__interval"],renderer:Gt.c}),Kr({type:"fill",category:Jr,params:[{name:"fill",type:"string",options:["none","null","0","previous","linear"]}],defaultParams:["null"],renderer:Gt.c}),Kr({type:"elapsed",addStrategy:tn,category:Wr.Transformations,params:[{name:"duration",type:"interval",options:["1s","10s","1m","5m","10m","15m","1h"]}],defaultParams:["10s"],renderer:Gt.c}),Kr({type:"holt_winters",addStrategy:tn,category:Wr.Predictors,params:[{name:"number",type:"int",options:[5,10,20,30,40]},{name:"season",type:"int",options:[0,1,2,5,10]}],defaultParams:[10,2],renderer:Gt.c}),Kr({type:"holt_winters_with_fit",addStrategy:tn,category:Wr.Predictors,params:[{name:"number",type:"int",options:[5,10,20,30,40]},{name:"season",type:"int",options:[0,1,2,5,10]}],defaultParams:[10,2],renderer:Gt.c}),Kr({type:"bottom",addStrategy:Zr,category:Wr.Selectors,params:[{name:"count",type:"int"}],defaultParams:[3],renderer:Gt.c}),Kr({type:"first",addStrategy:Zr,category:Wr.Selectors,params:[],defaultParams:[],renderer:Gt.c}),Kr({type:"last",addStrategy:Zr,category:Wr.Selectors,params:[],defaultParams:[],renderer:Gt.c}),Kr({type:"max",addStrategy:Zr,category:Wr.Selectors,params:[],defaultParams:[],renderer:Gt.c}),Kr({type:"min",addStrategy:Zr,category:Wr.Selectors,params:[],defaultParams:[],renderer:Gt.c}),Kr({type:"percentile",addStrategy:Zr,category:Wr.Selectors,params:[{name:"nth",type:"int"}],defaultParams:[95],renderer:Gt.c}),Kr({type:"top",addStrategy:Zr,category:Wr.Selectors,params:[{name:"count",type:"int"}],defaultParams:[3],renderer:Gt.c}),Kr({type:"tag",category:Jr,params:[{name:"tag",type:"string",dynamicLookup:!0}],defaultParams:["tag"],renderer:Xr}),Kr({type:"math",addStrategy:function(t,e){var r=t.length;if(r>0){if("math"===t[r-1].def.type)return void(t[r-1]=e);if(r>1&&"math"===t[r-2].def.type)return void(t[r-2]=e);if("alias"===t[r-1].def.type)return void t.splice(r-1,0,e)}t.push(e)},category:Wr.Math,params:[{name:"expr",type:"string"}],defaultParams:[" / 100"],renderer:Gt.d}),Kr({type:"alias",addStrategy:function(t,e){var r=t.length;r>0&&"alias"===t[r-1].def.type?t[r-1]=e:t.push(e)},category:Wr.Aliasing,params:[{name:"name",type:"string",quote:"double"}],defaultParams:["alias"],renderMode:"suffix",renderer:function(t,e){return e+' AS "'+t.params[0]+'"'}});var en={create:Yr,getCategories:function(){return Wr},replaceAggregationAdd:Zr},rn=function(){function t(t,e,r){this.target=t,this.templateSrv=e,this.scopedVars=r,t.policy=t.policy||"default",t.resultFormat=t.resultFormat||"time_series",t.orderByTime=t.orderByTime||"ASC",t.tags=t.tags||[],t.groupBy=t.groupBy||[{type:"time",params:["$__interval"]},{type:"fill",params:["null"]}],t.select=t.select||[[{type:"field",params:["value"]},{type:"mean",params:[]}]],this.updateProjection()}return t.$inject=["target","templateSrv","scopedVars"],t.prototype.updateProjection=function(){this.selectModels=I.a.map(this.target.select,function(t){return I.a.map(t,en.create)}),this.groupByParts=I.a.map(this.target.groupBy,en.create)},t.prototype.updatePersistedParts=function(){this.target.select=I.a.map(this.selectModels,function(t){return I.a.map(t,function(t){return{type:t.def.type,params:t.params}})})},t.prototype.hasGroupByTime=function(){return I.a.find(this.target.groupBy,function(t){return"time"===t.type})},t.prototype.hasFill=function(){return I.a.find(this.target.groupBy,function(t){return"fill"===t.type})},t.prototype.addGroupBy=function(t){var e=t.match(/^(\w+)\((.*)\)$/),r=e[1],n=e[2],a=en.create({type:r,params:[n]}),i=this.target.groupBy.length;0===i?this.target.groupBy.push(a.part):"time"===r?this.target.groupBy.splice(0,0,a.part):"tag"===r&&"fill"===this.target.groupBy[i-1].type?this.target.groupBy.splice(i-1,0,a.part):this.target.groupBy.push(a.part),this.updateProjection()},t.prototype.removeGroupByPart=function(t,e){var r=en.getCategories();"time"===t.def.type&&(this.target.groupBy=I.a.filter(this.target.groupBy,function(t){return"fill"!==t.type}),this.target.select=I.a.map(this.target.select,function(t){return I.a.filter(t,function(t){var e=en.create(t);return e.def.category!==r.Aggregations&&e.def.category!==r.Selectors})})),this.target.groupBy.splice(e,1),this.updateProjection()},t.prototype.removeSelect=function(t){this.target.select.splice(t,1),this.updateProjection()},t.prototype.removeSelectPart=function(t,e){if("field"===e.def.type){if(this.selectModels.length>1){var r=I.a.indexOf(this.selectModels,t);this.selectModels.splice(r,1)}}else{var n=I.a.indexOf(t,e);t.splice(n,1)}this.updatePersistedParts()},t.prototype.addSelectPart=function(t,e){var r=en.create({type:e});r.def.addStrategy(t,r,this),this.updatePersistedParts()},t.prototype.renderTagCondition=function(t,e,r){var n="",a=t.operator,i=t.value;return e>0&&(n=(t.condition||"AND")+" "),a||(a=/^\/.*\/$/.test(i)?"=~":"="),"=~"!==a&&"!~"!==a?(r&&(i=this.templateSrv.replace(i,this.scopedVars)),">"!==a&&"<"!==a&&(i="'"+i.replace(/\\/g,"\\\\")+"'")):r&&(i=this.templateSrv.replace(i,this.scopedVars,"regex")),n+'"'+t.key+'" '+a+" "+i},t.prototype.getMeasurementAndPolicy=function(t){var e=this.target.policy,r=this.target.measurement||"measurement";return r.match("^/.*/$")?t&&(r=this.templateSrv.replace(r,this.scopedVars,"regex")):r='"'+r+'"',(e="default"!==e?'"'+this.target.policy+'".':"")+r},t.prototype.interpolateQueryStr=function(t,e,r){return e.multi||e.includeAll?"string"==typeof t?kt.a.regexEscape(t):"("+I.a.map(t,kt.a.regexEscape).join("|")+")":t},t.prototype.render=function(t){var e=this,r=this.target;if(r.rawQuery)return t?this.templateSrv.replace(r.query,this.scopedVars,this.interpolateQueryStr):r.query;var n,a,i="SELECT ";for(n=0;n<this.selectModels.length;n++){var s=this.selectModels[n],o="";for(a=0;a<s.length;a++){o=(u=s[a]).render(o)}n>0&&(i+=", "),i+=o}i+=" FROM "+this.getMeasurementAndPolicy(t)+" WHERE ";var l=I.a.map(r.tags,function(r,n){return e.renderTagCondition(r,n,t)});l.length>0&&(i+="("+l.join(" ")+") AND "),i+="$timeFilter";var c="";for(n=0;n<this.groupByParts.length;n++){var u=this.groupByParts[n];n>0&&(c+="fill"===u.def.type?" ":", "),c+=u.render("")}return c.length&&(i+=" GROUP BY "+c),r.fill&&(i+=" fill("+r.fill+")"),"DESC"===r.orderByTime&&(i+=" ORDER BY time DESC"),r.limit&&(i+=" LIMIT "+r.limit),r.slimit&&(i+=" SLIMIT "+r.slimit),i},t.prototype.renderAdhocFilters=function(t){var e=this;return I.a.map(t,function(t,r){return e.renderTagCondition(t,r,!1)}).join(" ")},t}(),nn=function(){function t(){}return t.prototype.parse=function(t,e){if(!e||0===e.results.length)return[];var r=e.results[0];if(!r.series)return[];var n=t.toLowerCase(),a=n.indexOf("show field keys")>=0||n.indexOf("show retention policies")>=0,i={};return I.a.each(r.series,function(t){I.a.each(t.values,function(t){I.a.isArray(t)?a?an(i,t[0]):void 0!==t[1]?an(i,t[1]):an(i,t[0]):an(i,t)})}),I.a.map(i,function(t){return{text:t.toString()}})},t}();function an(t,e){t[e]=e}var sn=function(){function t(t,e){this.target=t,this.database=e}return t.prototype.buildExploreQuery=function(t,e,r){var n,a,i;if("TAG_KEYS"===t)n="SHOW TAG KEYS",a=this.target.measurement,i=this.target.policy;else if("TAG_VALUES"===t)n="SHOW TAG VALUES",a=this.target.measurement,i=this.target.policy;else if("MEASUREMENTS"===t)n="SHOW MEASUREMENTS",r&&(n+=" WITH MEASUREMENT =~ /"+r+"/");else{if("FIELDS"===t)return a=this.target.measurement,i=this.target.policy,a.match("^/.*/")||(a='"'+a+'"',i&&"default"!==i&&(a=(i='"'+i+'"')+"."+a)),"SHOW FIELD KEYS FROM "+a;if("RETENTION POLICIES"===t)return n='SHOW RETENTION POLICIES on "'+this.database+'"'}if(a&&(a.match("^/.*/")||a.match(/^merge\(.*\)/)||(a='"'+a+'"'),i&&"default"!==i&&(a=(i='"'+i+'"')+"."+a),n+=" FROM "+a),e&&(n+=' WITH KEY = "'+e+'"'),this.target.tags&&this.target.tags.length>0){var s=I.a.reduce(this.target.tags,function(t,r){return r.key===e?t:(t.push(function(t,e){var r="",n=t.operator,a=t.value;return e>0&&(r=(t.condition||"AND")+" "),n||(n=/^\/.*\/$/.test(t.value)?"=~":"="),"=~"!==n&&"!~"!==n&&isNaN(+a)&&(a="'"+a+"'"),r+'"'+t.key+'" '+n+" "+a}(r,t.length)),t)},[]);s.length>0&&(n+=" WHERE "+s.join(" "))}return"MEASUREMENTS"===t&&(n+=" LIMIT 100"),n},t}(),on=function(){function t(t,e,r,n){this.$q=e,this.backendSrv=r,this.templateSrv=n,this.type="influxdb",this.urls=I.a.map(t.url.split(","),function(t){return t.trim()}),this.username=t.username,this.password=t.password,this.name=t.name,this.database=t.database,this.basicAuth=t.basicAuth,this.withCredentials=t.withCredentials,this.interval=(t.jsonData||{}).timeInterval,this.responseParser=new nn}return t.$inject=["instanceSettings","$q","backendSrv","templateSrv"],t.prototype.query=function(t){var e,r,n,a=this,i=this.getTimeFilter(t),s=t.scopedVars,o=I.a.cloneDeep(t.targets),l=[],c=I.a.map(o,function(t){return t.hide?"":(l.push(t),s.interval=s.__interval,(e=new rn(t,a.templateSrv,s)).render(!0))}).reduce(function(t,e){return""!==e&&(t+=";"+e),t});if(""===c)return this.$q.when({data:[]});var u=this.templateSrv.getAdhocFilters(this.name);return u.length>0&&(i+=" AND "+e.renderAdhocFilters(u)),s.timeFilter={value:i},c=this.templateSrv.replace(c,s),this._seriesQuery(c,t).then(function(e){if(!e||!e.results)return[];var i=[];for(r=0;r<e.results.length;r++){var s=e.results[r];if(s&&s.series){var o=l[r],c=o.alias;c&&(c=a.templateSrv.replace(o.alias,t.scopedVars));var u=new zr({series:e.results[r].series,alias:c});switch(o.resultFormat){case"table":i.push(u.getTable());break;default:var d=u.getTimeSeries();for(n=0;n<d.length;n++)i.push(d[n])}}}return{data:i}})},t.prototype.annotationQuery=function(t){if(!t.annotation.query)return this.$q.reject({message:"Query missing in annotation definition"});var e=this.getTimeFilter({rangeRaw:t.rangeRaw}),r=t.annotation.query.replace("$timeFilter",e);return r=this.templateSrv.replace(r,null,"regex"),this._seriesQuery(r,t).then(function(e){if(!e||!e.results||!e.results[0])throw{message:"No results in response from InfluxDB"};return new zr({series:e.results[0].series,annotation:t.annotation}).getAnnotations()})},t.prototype.targetContainsTemplate=function(t){for(var e=0,r=t.groupBy;e<r.length;e++)for(var n=0,a=r[e].params;n<a.length;n++){var i=a[n];if(this.templateSrv.variableExists(i))return!0}for(var s in t.tags)if(this.templateSrv.variableExists(t.tags[s].value))return!0;return!1},t.prototype.metricFindQuery=function(t,e){var r=this.templateSrv.replace(t,null,"regex");return this._seriesQuery(r,e).then(I.a.curry(this.responseParser.parse)(t))},t.prototype.getTagKeys=function(t){var e=new sn({measurement:"",tags:[]},this.database).buildExploreQuery("TAG_KEYS");return this.metricFindQuery(e,t)},t.prototype.getTagValues=function(t){var e=new sn({measurement:"",tags:[]},this.database).buildExploreQuery("TAG_VALUES",t.key);return this.metricFindQuery(e,t)},t.prototype._seriesQuery=function(t,e){if(!t)return this.$q.when({results:[]});if(e&&e.range){var r=this.getTimeFilter({rangeRaw:e.range});t=t.replace("$timeFilter",r)}return this._influxRequest("GET","/query",{q:t,epoch:"ms"},e)},t.prototype.serializeParams=function(t){return t?I.a.reduce(t,function(t,e,r){return null===e||void 0===e?t:(t.push(encodeURIComponent(r)+"="+encodeURIComponent(e)),t)},[]).join("&"):""},t.prototype.testDatasource=function(){var t=new sn({measurement:"",tags:[]},this.database).buildExploreQuery("RETENTION POLICIES");return this._seriesQuery(t).then(function(t){var e=I.a.get(t,"results[0].error");return e?{status:"error",message:e}:{status:"success",message:"Data source is working"}}).catch(function(t){return{status:"error",message:t.message}})},t.prototype._influxRequest=function(t,e,r,n){var a=this.urls.shift();this.urls.push(a);var i={};this.username&&(i.u=this.username,i.p=this.password),n&&n.database?i.db=n.database:this.database&&(i.db=this.database),"GET"===t&&(I.a.extend(i,r),r=null);var s={method:t,url:a+e,params:i,data:r,precision:"ms",inspect:{type:"influxdb"},paramSerializer:this.serializeParams};return s.headers=s.headers||{},(this.basicAuth||this.withCredentials)&&(s.withCredentials=!0),this.basicAuth&&(s.headers.Authorization=this.basicAuth),this.backendSrv.datasourceRequest(s).then(function(t){return t.data},function(t){if(0!==t.status||t.status>=300)throw t.data&&t.data.error?{message:"InfluxDB Error: "+t.data.error,data:t.data,config:t.config}:{message:"Network Error: "+t.statusText+"("+t.status+")",data:t.data,config:t.config}})},t.prototype.getTimeFilter=function(t){var e=this.getInfluxTime(t.rangeRaw.from,!1),r=this.getInfluxTime(t.rangeRaw.to,!0),n="ms"===e[e.length-1];return"now()"!==r||n?"time >= "+e+" and time <= "+r:"time >= "+e},t.prototype.getInfluxTime=function(t,e){if(I.a.isString(t)){if("now"===t)return"now()";var r=/^now-(\d+)([d|h|m|s])$/.exec(t);if(r)return"now() - "+parseInt(r[1],10)+r[2];t=Ct.parse(t,e)}return t.valueOf()+"ms"},t}(),ln=function(t){function e(e,r,n,a,i){var s=t.call(this,e,r)||this;s.templateSrv=n,s.$q=a,s.uiSegmentSrv=i,s.target=s.target,s.queryModel=new rn(s.target,n,s.panel.scopedVars),s.queryBuilder=new sn(s.target,s.datasource.database),s.groupBySegment=s.uiSegmentSrv.newPlusButton(),s.resultFormats=[{text:"Time series",value:"time_series"},{text:"Table",value:"table"}],s.policySegment=i.newSegment(s.target.policy),s.target.measurement?s.measurementSegment=i.newSegment(s.target.measurement):s.measurementSegment=i.newSelectMeasurement(),s.tagSegments=[];for(var o=0,l=s.target.tags;o<l.length;o++){var c=l[o];c.operator||(/^\/.*\/$/.test(c.value)?c.operator="=~":c.operator="="),c.condition&&s.tagSegments.push(i.newCondition(c.condition)),s.tagSegments.push(i.newKey(c.key)),s.tagSegments.push(i.newOperator(c.operator)),s.tagSegments.push(i.newKeyValue(c.value))}return s.fixTagSegments(),s.buildSelectMenu(),s.removeTagFilterSegment=i.newSegment({fake:!0,value:"-- remove tag filter --"}),s}return e.$inject=["$scope","$injector","templateSrv","$q","uiSegmentSrv"],J.c(e,t),e.prototype.removeOrderByTime=function(){this.target.orderByTime="ASC"},e.prototype.buildSelectMenu=function(){var t=en.getCategories();this.selectMenu=I.a.reduce(t,function(t,e,r){var n={text:r,submenu:e.map(function(t){return{text:t.type,value:t.type}})};return t.push(n),t},[])},e.prototype.getGroupByOptions=function(){var t=this,e=this.queryBuilder.buildExploreQuery("TAG_KEYS");return this.datasource.metricFindQuery(e).then(function(e){var r=[];t.queryModel.hasFill()||r.push(t.uiSegmentSrv.newSegment({value:"fill(null)"})),t.target.limit||r.push(t.uiSegmentSrv.newSegment({value:"LIMIT"})),t.target.slimit||r.push(t.uiSegmentSrv.newSegment({value:"SLIMIT"})),"ASC"===t.target.orderByTime&&r.push(t.uiSegmentSrv.newSegment({value:"ORDER BY time DESC"})),t.queryModel.hasGroupByTime()||r.push(t.uiSegmentSrv.newSegment({value:"time($interval)"}));for(var n=0,a=e;n<a.length;n++){var i=a[n];r.push(t.uiSegmentSrv.newSegment({value:"tag("+i.text+")"}))}return r}).catch(this.handleQueryError.bind(this))},e.prototype.groupByAction=function(){switch(this.groupBySegment.value){case"LIMIT":this.target.limit=10;break;case"SLIMIT":this.target.slimit=10;break;case"ORDER BY time DESC":this.target.orderByTime="DESC";break;default:this.queryModel.addGroupBy(this.groupBySegment.value)}var t=this.uiSegmentSrv.newPlusButton();this.groupBySegment.value=t.value,this.groupBySegment.html=t.html,this.panelCtrl.refresh()},e.prototype.addSelectPart=function(t,e,r){this.queryModel.addSelectPart(t,r.value),this.panelCtrl.refresh()},e.prototype.handleSelectPartEvent=function(t,e,r){switch(r.name){case"get-param-options":var n=this.queryBuilder.buildExploreQuery("FIELDS");return this.datasource.metricFindQuery(n).then(this.transformToSegments(!0)).catch(this.handleQueryError.bind(this));case"part-param-changed":this.panelCtrl.refresh();break;case"action":this.queryModel.removeSelectPart(t,e),this.panelCtrl.refresh();break;case"get-part-actions":return this.$q.when([{text:"Remove",value:"remove-part"}])}},e.prototype.handleGroupByPartEvent=function(t,e,r){switch(r.name){case"get-param-options":var n=this.queryBuilder.buildExploreQuery("TAG_KEYS");return this.datasource.metricFindQuery(n).then(this.transformToSegments(!0)).catch(this.handleQueryError.bind(this));case"part-param-changed":this.panelCtrl.refresh();break;case"action":this.queryModel.removeGroupByPart(t,e),this.panelCtrl.refresh();break;case"get-part-actions":return this.$q.when([{text:"Remove",value:"remove-part"}])}},e.prototype.fixTagSegments=function(){var t=this.tagSegments.length,e=this.tagSegments[Math.max(t-1,0)];e&&"plus-button"===e.type||this.tagSegments.push(this.uiSegmentSrv.newPlusButton())},e.prototype.measurementChanged=function(){this.target.measurement=this.measurementSegment.value,this.panelCtrl.refresh()},e.prototype.getPolicySegments=function(){var t=this.queryBuilder.buildExploreQuery("RETENTION POLICIES");return this.datasource.metricFindQuery(t).then(this.transformToSegments(!1)).catch(this.handleQueryError.bind(this))},e.prototype.policyChanged=function(){this.target.policy=this.policySegment.value,this.panelCtrl.refresh()},e.prototype.toggleEditorMode=function(){try{this.target.query=this.queryModel.render(!1)}catch(t){console.log("query render error")}this.target.rawQuery=!this.target.rawQuery},e.prototype.getMeasurements=function(t){var e=this.queryBuilder.buildExploreQuery("MEASUREMENTS",void 0,t);return this.datasource.metricFindQuery(e).then(this.transformToSegments(!0)).catch(this.handleQueryError.bind(this))},e.prototype.handleQueryError=function(t){return this.error=t.message||"Failed to issue metric query",[]},e.prototype.transformToSegments=function(t){var e=this;return function(r){var n=I.a.map(r,function(t){return e.uiSegmentSrv.newSegment({value:t.text,expandable:t.expandable})});if(t)for(var a=0,i=e.templateSrv.variables;a<i.length;a++){var s=i[a];n.unshift(e.uiSegmentSrv.newSegment({type:"value",value:"/^$"+s.name+"$/",expandable:!0}))}return n}},e.prototype.getTagsOrValues=function(t,e){var r,n,a=this;if("condition"===t.type)return this.$q.when([this.uiSegmentSrv.newSegment("AND"),this.uiSegmentSrv.newSegment("OR")]);if("operator"===t.type){var i=this.tagSegments[e+1].value;return/^\/.*\/$/.test(i)?this.$q.when(this.uiSegmentSrv.newOperators(["=~","!~"])):this.$q.when(this.uiSegmentSrv.newOperators(["=","!=","<>","<",">"]))}return"key"===t.type||"plus-button"===t.type?(r=this.queryBuilder.buildExploreQuery("TAG_KEYS"),n=!1):"value"===t.type&&(r=this.queryBuilder.buildExploreQuery("TAG_VALUES",this.tagSegments[e-2].value),n=!0),this.datasource.metricFindQuery(r).then(this.transformToSegments(n)).then(function(e){return"key"===t.type&&e.splice(0,0,L.a.copy(a.removeTagFilterSegment)),e}).catch(this.handleQueryError.bind(this))},e.prototype.getFieldSegments=function(){var t=this.queryBuilder.buildExploreQuery("FIELDS");return this.datasource.metricFindQuery(t).then(this.transformToSegments(!1)).catch(this.handleQueryError)},e.prototype.tagSegmentUpdated=function(t,e){this.tagSegments[e]=t,t.value===this.removeTagFilterSegment.value?(this.tagSegments.splice(e,3),0===this.tagSegments.length?this.tagSegments.push(this.uiSegmentSrv.newPlusButton()):this.tagSegments.length>2&&(this.tagSegments.splice(Math.max(e-1,0),1),"plus-button"!==this.tagSegments[this.tagSegments.length-1].type&&this.tagSegments.push(this.uiSegmentSrv.newPlusButton()))):("plus-button"===t.type&&(e>2&&this.tagSegments.splice(e,0,this.uiSegmentSrv.newCondition("AND")),this.tagSegments.push(this.uiSegmentSrv.newOperator("=")),this.tagSegments.push(this.uiSegmentSrv.newFake("select tag value","value","query-segment-value")),t.type="key",t.cssClass="query-segment-key"),e+1===this.tagSegments.length&&this.tagSegments.push(this.uiSegmentSrv.newPlusButton())),this.rebuildTargetTagConditions()},e.prototype.rebuildTargetTagConditions=function(){var t=this,e=[],r=0,n="";I.a.each(this.tagSegments,function(a,i){"key"===a.type?(0===e.length&&e.push({}),e[r].key=a.value):"value"===a.type?((n=t.getTagValueOperator(a.value,e[r].operator))&&(t.tagSegments[i-1]=t.uiSegmentSrv.newOperator(n),e[r].operator=n),e[r].value=a.value):"condition"===a.type?(e.push({condition:a.value}),r+=1):"operator"===a.type&&(e[r].operator=a.value)}),this.target.tags=e,this.panelCtrl.refresh()},e.prototype.getTagValueOperator=function(t,e){return"=~"!==e&&"!~"!==e&&/^\/.*\/$/.test(t)?"=~":"=~"!==e&&"!~"!==e||!/^(?!\/.*\/$)/.test(t)?null:"="},e.prototype.getCollapsedText=function(){return this.queryModel.render(!1)},e.templateUrl="partials/query.editor.html",e}(Ht),cn=function(){function t(){}return t.templateUrl="partials/config.html",t}(),un=function(){function t(){}return t.templateUrl="partials/annotations.editor.html",t}(),dn=r(142),pn=function(){return function(){}}(),hn=["1m","5m","10m","30m","1h"];var fn=/\{[^}]*?\}/,mn=/\b(\w+)(!?=~?)("[^"\n]*?")/g;function gn(t,e){if(void 0===e&&(e=1),!t.match(fn)){if(t.match(/^[A-Za-z:][\w:]*$/))return{selector:'{__name__="'+t+'"}',labelKeys:["__name__"]};throw new Error("Query must contain a selector: "+t)}var r=t.slice(0,e),n=r.lastIndexOf("{"),a=r.lastIndexOf("}");if(-1===n)throw new Error("Not inside selector, missing open brace: "+r);if(a>-1&&a>n)throw new Error("Not inside selector, previous selector already closed: "+r);var i=t.slice(e),s=i.indexOf("}")+e,o=i.indexOf("{"),l=o+e;if(-1===s)throw new Error("Not inside selector, missing closing brace in suffix: "+i);if(o>-1&&l<s)throw new Error("Not inside selector, next selector opens before this one closed: "+i);var c={};t.slice(n,s).replace(mn,function(t,e,r,n){return c[e]={value:n,operator:r},""});var u=t.slice(0,n).match(/[A-Za-z:][\w:]*$/);u&&(c.__name__={value:'"'+u[0]+'"',operator:"="});var d=Object.keys(c).sort();return{labelKeys:d,selector:["{",d.map(function(t){return""+t+c[t].operator+c[t].value}).join(","),"}"].join("")}}var vn=[{label:"sum",insertText:"sum",documentation:"Calculate sum over dimensions"},{label:"min",insertText:"min",documentation:"Select minimum over dimensions"},{label:"max",insertText:"max",documentation:"Select maximum over dimensions"},{label:"avg",insertText:"avg",documentation:"Calculate the average over dimensions"},{label:"stddev",insertText:"stddev",documentation:"Calculate population standard deviation over dimensions"},{label:"stdvar",insertText:"stdvar",documentation:"Calculate population standard variance over dimensions"},{label:"count",insertText:"count",documentation:"Count number of elements in the vector"},{label:"count_values",insertText:"count_values",documentation:"Count number of elements with the same value"},{label:"bottomk",insertText:"bottomk",documentation:"Smallest k elements by sample value"},{label:"topk",insertText:"topk",documentation:"Largest k elements by sample value"},{label:"quantile",insertText:"quantile",documentation:"Calculate φ-quantile (0 ≤ φ ≤ 1) over dimensions"}].concat([{insertText:"abs",label:"abs",detail:"abs(v instant-vector)",documentation:"Returns the input vector with all sample values converted to their absolute value."},{insertText:"absent",label:"absent",detail:"absent(v instant-vector)",documentation:"Returns an empty vector if the vector passed to it has any elements and a 1-element vector with the value 1 if the vector passed to it has no elements. This is useful for alerting on when no time series exist for a given metric name and label combination."},{insertText:"ceil",label:"ceil",detail:"ceil(v instant-vector)",documentation:"Rounds the sample values of all elements in `v` up to the nearest integer."},{insertText:"changes",label:"changes",detail:"changes(v range-vector)",documentation:"For each input time series, `changes(v range-vector)` returns the number of times its value has changed within the provided time range as an instant vector."},{insertText:"clamp_max",label:"clamp_max",detail:"clamp_max(v instant-vector, max scalar)",documentation:"Clamps the sample values of all elements in `v` to have an upper limit of `max`."},{insertText:"clamp_min",label:"clamp_min",detail:"clamp_min(v instant-vector, min scalar)",documentation:"Clamps the sample values of all elements in `v` to have a lower limit of `min`."},{insertText:"count_scalar",label:"count_scalar",detail:"count_scalar(v instant-vector)",documentation:"Returns the number of elements in a time series vector as a scalar. This is in contrast to the `count()` aggregation operator, which always returns a vector (an empty one if the input vector is empty) and allows grouping by labels via a `by` clause."},{insertText:"day_of_month",label:"day_of_month",detail:"day_of_month(v=vector(time()) instant-vector)",documentation:"Returns the day of the month for each of the given times in UTC. Returned values are from 1 to 31."},{insertText:"day_of_week",label:"day_of_week",detail:"day_of_week(v=vector(time()) instant-vector)",documentation:"Returns the day of the week for each of the given times in UTC. Returned values are from 0 to 6, where 0 means Sunday etc."},{insertText:"days_in_month",label:"days_in_month",detail:"days_in_month(v=vector(time()) instant-vector)",documentation:"Returns number of days in the month for each of the given times in UTC. Returned values are from 28 to 31."},{insertText:"delta",label:"delta",detail:"delta(v range-vector)",documentation:"Calculates the difference between the first and last value of each time series element in a range vector `v`, returning an instant vector with the given deltas and equivalent labels. The delta is extrapolated to cover the full time range as specified in the range vector selector, so that it is possible to get a non-integer result even if the sample values are all integers."},{insertText:"deriv",label:"deriv",detail:"deriv(v range-vector)",documentation:"Calculates the per-second derivative of the time series in a range vector `v`, using simple linear regression."},{insertText:"drop_common_labels",label:"drop_common_labels",detail:"drop_common_labels(instant-vector)",documentation:"Drops all labels that have the same name and value across all series in the input vector."},{insertText:"exp",label:"exp",detail:"exp(v instant-vector)",documentation:"Calculates the exponential function for all elements in `v`.\nSpecial cases are:\n* `Exp(+Inf) = +Inf` \n* `Exp(NaN) = NaN`"},{insertText:"floor",label:"floor",detail:"floor(v instant-vector)",documentation:"Rounds the sample values of all elements in `v` down to the nearest integer."},{insertText:"histogram_quantile",label:"histogram_quantile",detail:"histogram_quantile(φ float, b instant-vector)",documentation:"Calculates the φ-quantile (0 ≤ φ ≤ 1) from the buckets `b` of a histogram. The samples in `b` are the counts of observations in each bucket. Each sample must have a label `le` where the label value denotes the inclusive upper bound of the bucket. (Samples without such a label are silently ignored.) The histogram metric type automatically provides time series with the `_bucket` suffix and the appropriate labels."},{insertText:"holt_winters",label:"holt_winters",detail:"holt_winters(v range-vector, sf scalar, tf scalar)",documentation:"Produces a smoothed value for time series based on the range in `v`. The lower the smoothing factor `sf`, the more importance is given to old data. The higher the trend factor `tf`, the more trends in the data is considered. Both `sf` and `tf` must be between 0 and 1."},{insertText:"hour",label:"hour",detail:"hour(v=vector(time()) instant-vector)",documentation:"Returns the hour of the day for each of the given times in UTC. Returned values are from 0 to 23."},{insertText:"idelta",label:"idelta",detail:"idelta(v range-vector)",documentation:"Calculates the difference between the last two samples in the range vector `v`, returning an instant vector with the given deltas and equivalent labels."},{insertText:"increase",label:"increase",detail:"increase(v range-vector)",documentation:"Calculates the increase in the time series in the range vector. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for. The increase is extrapolated to cover the full time range as specified in the range vector selector, so that it is possible to get a non-integer result even if a counter increases only by integer increments."},{insertText:"irate",label:"irate",detail:"irate(v range-vector)",documentation:"Calculates the per-second instant rate of increase of the time series in the range vector. This is based on the last two data points. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for."},{insertText:"label_replace",label:"label_replace",detail:"label_replace(v instant-vector, dst_label string, replacement string, src_label string, regex string)",documentation:"For each timeseries in `v`, `label_replace(v instant-vector, dst_label string, replacement string, src_label string, regex string)`  matches the regular expression `regex` against the label `src_label`.  If it matches, then the timeseries is returned with the label `dst_label` replaced by the expansion of `replacement`. `$1` is replaced with the first matching subgroup, `$2` with the second etc. If the regular expression doesn't match then the timeseries is returned unchanged."},{insertText:"ln",label:"ln",detail:"ln(v instant-vector)",documentation:"calculates the natural logarithm for all elements in `v`.\nSpecial cases are:\n * `ln(+Inf) = +Inf`\n * `ln(0) = -Inf`\n * `ln(x < 0) = NaN`\n * `ln(NaN) = NaN`"},{insertText:"log2",label:"log2",detail:"log2(v instant-vector)",documentation:"Calculates the binary logarithm for all elements in `v`. The special cases are equivalent to those in `ln`."},{insertText:"log10",label:"log10",detail:"log10(v instant-vector)",documentation:"Calculates the decimal logarithm for all elements in `v`. The special cases are equivalent to those in `ln`."},{insertText:"minute",label:"minute",detail:"minute(v=vector(time()) instant-vector)",documentation:"Returns the minute of the hour for each of the given times in UTC. Returned values are from 0 to 59."},{insertText:"month",label:"month",detail:"month(v=vector(time()) instant-vector)",documentation:"Returns the month of the year for each of the given times in UTC. Returned values are from 1 to 12, where 1 means January etc."},{insertText:"predict_linear",label:"predict_linear",detail:"predict_linear(v range-vector, t scalar)",documentation:"Predicts the value of time series `t` seconds from now, based on the range vector `v`, using simple linear regression."},{insertText:"rate",label:"rate",detail:"rate(v range-vector)",documentation:"Calculates the per-second average rate of increase of the time series in the range vector. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for. Also, the calculation extrapolates to the ends of the time range, allowing for missed scrapes or imperfect alignment of scrape cycles with the range's time period."},{insertText:"resets",label:"resets",detail:"resets(v range-vector)",documentation:"For each input time series, `resets(v range-vector)` returns the number of counter resets within the provided time range as an instant vector. Any decrease in the value between two consecutive samples is interpreted as a counter reset."},{insertText:"round",label:"round",detail:"round(v instant-vector, to_nearest=1 scalar)",documentation:"Rounds the sample values of all elements in `v` to the nearest integer. Ties are resolved by rounding up. The optional `to_nearest` argument allows specifying the nearest multiple to which the sample values should be rounded. This multiple may also be a fraction."},{insertText:"scalar",label:"scalar",detail:"scalar(v instant-vector)",documentation:"Given a single-element input vector, `scalar(v instant-vector)` returns the sample value of that single element as a scalar. If the input vector does not have exactly one element, `scalar` will return `NaN`."},{insertText:"sort",label:"sort",detail:"sort(v instant-vector)",documentation:"Returns vector elements sorted by their sample values, in ascending order."},{insertText:"sort_desc",label:"sort_desc",detail:"sort_desc(v instant-vector)",documentation:"Returns vector elements sorted by their sample values, in descending order."},{insertText:"sqrt",label:"sqrt",detail:"sqrt(v instant-vector)",documentation:"Calculates the square root of all elements in `v`."},{insertText:"time",label:"time",detail:"time()",documentation:"Returns the number of seconds since January 1, 1970 UTC. Note that this does not actually return the current time, but the time at which the expression is to be evaluated."},{insertText:"vector",label:"vector",detail:"vector(s scalar)",documentation:"Returns the scalar `s` as a vector with no labels."},{insertText:"year",label:"year",detail:"year(v=vector(time()) instant-vector)",documentation:"Returns the year for each of the given times in UTC."},{insertText:"avg_over_time",label:"avg_over_time",detail:"avg_over_time(range-vector)",documentation:"The average value of all points in the specified interval."},{insertText:"min_over_time",label:"min_over_time",detail:"min_over_time(range-vector)",documentation:"The minimum value of all points in the specified interval."},{insertText:"max_over_time",label:"max_over_time",detail:"max_over_time(range-vector)",documentation:"The maximum value of all points in the specified interval."},{insertText:"sum_over_time",label:"sum_over_time",detail:"sum_over_time(range-vector)",documentation:"The sum of all values in the specified interval."},{insertText:"count_over_time",label:"count_over_time",detail:"count_over_time(range-vector)",documentation:"The count of all values in the specified interval."},{insertText:"quantile_over_time",label:"quantile_over_time",detail:"quantile_over_time(scalar, range-vector)",documentation:"The φ-quantile (0 ≤ φ ≤ 1) of the values in the specified interval."},{insertText:"stddev_over_time",label:"stddev_over_time",detail:"stddev_over_time(range-vector)",documentation:"The population standard deviation of the values in the specified interval."},{insertText:"stdvar_over_time",label:"stdvar_over_time",detail:"stdvar_over_time(range-vector)",documentation:"The population standard variance of the values in the specified interval."}]),bn={comment:{pattern:/(^|[^\n])#.*/,lookbehind:!0},"context-aggregation":{pattern:/((by|without)\s*)\([^)]*\)/,lookbehind:!0,inside:{"label-key":{pattern:/[^,\s][^,]*[^,\s]*/,alias:"attr-name"}}},"context-labels":{pattern:/\{[^}]*(?=})/,inside:{"label-key":{pattern:/[a-z_]\w*(?=\s*(=|!=|=~|!~))/,alias:"attr-name"},"label-value":{pattern:/"(?:\\.|[^\\"])*"/,greedy:!0,alias:"attr-value"}}},function:new RegExp("\\b(?:"+vn.map(function(t){return t.label}).join("|")+")(?=\\s*\\()","i"),"context-range":[{pattern:/\[[^\]]*(?=])/,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}},{pattern:/(offset\s+)\w+/,lookbehind:!0,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}}],number:/\b-?\d+((\.\d*)?([eE][+-]?\d+)?)?\b/,operator:new RegExp("/[-+*/=%^~]|&&?|\\|?\\||!=?|<(?:=>?|<|>)?|>[>=]?|\\b(?:"+["by","group_left","group_right","ignoring","on","offset","without"].join("|")+")\\b","i"),punctuation:/[{};()`,.]/},yn=["job","namespace"],wn=864e5,xn=function(t){return{label:t}};var Sn=function(t){function e(e,r){var n=t.call(this)||this;return n.cleanText=function(t){return t.replace(/[{}[\]="(),!~+\-*/^%]/g,"").trim()},n.request=function(t){return n.datasource.metadataRequest(t)},n.start=function(){return n.startTask||(n.startTask=n.fetchLogLabels()),n.startTask},n.datasource=e,n.labelKeys={},n.labelValues={},Object.assign(n,r),n}return J.c(e,t),e.prototype.getSyntax=function(){return bn},e.prototype.provideCompletionItems=function(t,e){var r=t.prefix,n=t.wrapperClasses,a=t.text,i=n.length>3;return I.a.includes(n,"context-labels")?this.getLabelCompletionItems.apply(this,arguments):r&&!i||""===r&&!a.match(/^[\]})\s]+$/)||a.match(/[+\-*/^%]/)?this.getEmptyCompletionItems(e||{}):{suggestions:[]}},e.prototype.getEmptyCompletionItems=function(t){var e=t.history,r=[];if(e&&e.length>0){var n=I.a.chain(e).uniqBy("query").take(10).map(function(t){return t.query}).map(xn).map(function(t){return function(t,e){var r=Date.now()-wn,n=e.filter(function(e){return e.ts>r&&e.query===t.label}),a=n.length,i=n[0],s="Queried "+a+" times in the last 24h.";return i&&(s=s+" Last queried "+H()(i.ts).fromNow()+"."),J.a({},t,{documentation:s})}(t,e)}).value();r.push({prefixMatch:!0,skipSort:!0,label:"History",items:n})}return{suggestions:r}},e.prototype.getLabelCompletionItems=function(t){var e,r,n=t.text,a=t.wrapperClasses,i=t.labelKey,s=t.value,o=null,l=[],c=s.anchorBlock.getText(),u=s.anchorOffset;try{r=gn(c,u)}catch(t){}var d=r?r.labelKeys:[];if(n&&n.match(/^!?=~?/)||I.a.includes(a,"attr-value")){if(i&&this.labelValues["{}"]){var p=this.labelValues["{}"][i];p?(e="context-label-values",l.push({label:'Label values for "'+i+'"',items:p.map(xn)})):o=this.fetchLabelValues(i)}}else{var h=this.labelKeys["{}"]||yn;if(h){var f=I.a.difference(h,d);f.length>0&&(e="context-labels",l.push({label:"Labels",items:f.map(xn)}))}}return{context:e,refresher:o,suggestions:l}},e.prototype.importQueries=function(t,e){return J.b(this,void 0,Promise,function(){var r=this;return J.d(this,function(n){return"prometheus"===e?[2,Promise.all(t.map(function(t){return J.b(r,void 0,void 0,function(){var e;return J.d(this,function(r){switch(r.label){case 0:return[4,this.importPrometheusQuery(t.expr)];case 1:return e=r.sent(),[2,J.a({},t,{expr:e})]}})})}))]:[2,t.map(function(t){return J.a({},t,{expr:""})})]})})},e.prototype.importPrometheusQuery=function(t){return J.b(this,void 0,Promise,function(){var e,r,n,a,i,s;return J.d(this,function(o){switch(o.label){case 0:return(e=t.match(fn))?(r=e[0],n={},r.replace(mn,function(t,e,r,a){return n[e]={value:a,operator:r},""}),[4,this.start()]):[3,2];case 1:for(i in o.sent(),a={},n)this.labelKeys["{}"].indexOf(i)>-1&&(a[i]=n[i]);return s=Object.keys(a).sort(),[2,["{",s.map(function(t){return""+t+a[t].operator+a[t].value}).join(","),"}"].join("")];case 2:return[2,""]}})})},e.prototype.fetchLogLabels=function(){return J.b(this,void 0,void 0,function(){var t,e,r,n,a,i,s=this;return J.d(this,function(o){switch(o.label){case 0:e="/api/prom/label",o.label=1;case 1:return o.trys.push([1,4,,5]),[4,this.request(e)];case 2:return[4,(r=o.sent()).data||r.json()];case 3:return n=o.sent(),a=n.data.slice().sort(),this.labelKeys=J.a({},this.labelKeys,((t={})["{}"]=a,t)),this.logLabelOptions=a.map(function(t){return{label:t,value:t,isLeaf:!1}}),[2,a.filter(function(t){return yn.indexOf(t)>-1}).map(function(t){return s.fetchLabelValues(t)})];case 4:return i=o.sent(),console.error(i),[3,5];case 5:return[2,[]]}})})},e.prototype.fetchLabelValues=function(t){return J.b(this,void 0,void 0,function(){var e,r,n,a,i,s,o,l,c;return J.d(this,function(u){switch(u.label){case 0:n="/api/prom/label/"+t+"/values",u.label=1;case 1:return u.trys.push([1,4,,5]),[4,this.request(n)];case 2:return[4,(a=u.sent()).data||a.json()];case 3:return i=u.sent(),s=i.data.slice().sort(),this.logLabelOptions=this.logLabelOptions.map(function(e){return e.value===t?J.a({},e,{children:s.map(function(t){return{label:t,value:t}})}):e}),o=this.labelValues["{}"],l=J.a({},o,((e={})[t]=s,e)),this.labelValues=J.a({},this.labelValues,((r={})["{}"]=l,r)),[3,5];case 4:return c=u.sent(),console.error(c),[3,5];case 5:return[2]}})})},e}(pn);var kn=/\b(\w+)(!?=~?)("[^"\n]*?")/g;function Cn(t,e){return void 0===e&&(e=""),t&&0!==Object.keys(t).length?["{",Object.keys(t).sort().map(function(e){return e+"="+t[e]}).join(", "),"}"].join(""):e}function Tn(t,e,r,n){var a=t.line,i=t.timestamp,s="EK"+i+e,o=H()(i),l=o.valueOf(),c=o.fromNow(),u=o.format("YYYY-MM-DD HH:mm:ss");return{key:s,labels:e,logLevel:function(t){return t?(Object.keys(dn.a).forEach(function(r){e||new RegExp("\\b"+r+"\\b","i").test(t)&&(e=dn.a[r])}),e||(e=dn.a.none),e):dn.a.none;var e}(a),timeFromNow:c,timeEpochMs:l,timeLocal:u,uniqueLabels:r,entry:a,searchWords:n?[n]:[],timestamp:i}}function En(t,e){void 0===e&&(e=_n);var r=function(t){return t.reduce(function(t,e){if(!e)throw new Error("Need parsed labels to find common labels.");return t?(Object.keys(e).forEach(function(r){void 0!==t[r]&&t[r]===e[r]||delete t[r]}),Object.keys(t).forEach(function(r){void 0===e[r]&&delete t[r]})):t=J.a({},e),t},void 0)}((t=t.map(function(t){return J.a({},t,{parsedLabels:function(t){var e={};return t.replace(kn,function(t,r,n,a){return e[r]=a,""}),e}(t.labels)})})).map(function(t){return t.parsedLabels}));t=t.map(function(t){return J.a({},t,{uniqueLabels:Cn(function(t,e){var r=J.a({},t);return Object.keys(e).forEach(function(t){delete r[t]}),r}(t.parsedLabels,r))})});var n=I.a.chain(t).reduce(function(t,e){return t.concat(e.entries.map(function(t){return Tn(t,e.labels,e.uniqueLabels,e.search)}))},[]).sortBy("timestamp").reverse().value(),a=[];return I.a.size(r)>0&&a.push({label:"Common labels",value:Cn(r)}),e&&a.push({label:"Limit",value:e+" ("+n.length+" returned)"}),{meta:a,rows:n}}var _n=1e3,Mn={direction:"BACKWARD",limit:_n,regexp:"",query:""},An=/({\w+="[^"]+"})?\s*(\w[^{]+)?\s*({\w+="[^"]+"})?/;var Pn=function(){function t(t,e,r){this.instanceSettings=t,this.backendSrv=e,this.templateSrv=r,this.languageProvider=new Sn(this)}return t.$inject=["instanceSettings","backendSrv","templateSrv"],t.prototype._request=function(t,e,r){var n=""+this.instanceSettings.url+t+"?"+(e?function(t){return Object.keys(t).map(function(e){var r=t[e];return encodeURIComponent(e)+"="+encodeURIComponent(r)}).join("&")}(e):""),a=J.a({},r,{url:n});return this.backendSrv.datasourceRequest(a)},t.prototype.mergeStreams=function(t,e){var r=En(t);return r.series=Object(dn.d)(r.rows,e),r},t.prototype.prepareQueryTarget=function(t,e){var r=this.templateSrv.replace(t.expr),n=this.getTime(e.range.from,!1),a=this.getTime(e.range.to,!0);return J.a({},Mn,function(t){var e=t.match(An),r="",n="";return e&&(e[1]&&(r=e[1]),e[2]&&(n=e[2].trim()),e[3]&&(r=e[1]?e[1].slice(0,-1)+","+e[3].slice(1):e[3])),{query:r,regexp:n}}(r),{start:n,end:a})},t.prototype.query=function(t){var e=this,r=t.targets.filter(function(t){return t.expr}).map(function(r){return e.prepareQueryTarget(r,t)});if(0===r.length)return Promise.resolve({data:[]});var n=r.map(function(t){return e._request("/api/prom/query",t)});return Promise.all(n).then(function(t){return{data:t.reduce(function(t,e,n){var a=e.data.streams||[],i=r[n].regexp;return a.forEach(function(t){t.search=i}),t.concat(a)},[])}})},t.prototype.importQueries=function(t,e){return J.b(this,void 0,Promise,function(){return J.d(this,function(r){return[2,this.languageProvider.importQueries(t,e.id)]})})},t.prototype.metadataRequest=function(t){var e=t.replace("v1","prom");return this._request(e,{silent:!0}).then(function(t){return{data:{data:t.data.values||[]}}})},t.prototype.getTime=function(t,e){return I.a.isString(t)&&(t=Ct.parse(t,e)),Math.ceil(1e6*t.valueOf())},t.prototype.testDatasource=function(){return this._request("/api/prom/label").then(function(t){return t&&t.data&&t.data.values&&t.data.values.length>0?{status:"success",message:"Data source connected and labels found."}:{status:"error",message:"Data source connected, but no labels received. Verify that logging is configured properly."}}).catch(function(t){return{status:"error",message:t.message}})},t}(),$n=r(16),Dn=r.n($n),On=[{title:"Logs From a Job",expression:'{job="default/prometheus"}',label:"Returns all log lines emitted by instances of this job."},{title:"Search For Text",expression:'{app="cassandra"} Maximum memory usage',label:"Returns all log lines for the selector and highlights the given text in the results."}],In=function(t){return j.a.createElement("div",null,j.a.createElement("h1",null,"Logging Cheat Sheet"),On.map(function(e){return j.a.createElement("div",{className:"cheat-sheet-item",key:e.expression},j.a.createElement("div",{className:"cheat-sheet-item__title"},e.title),j.a.createElement("div",{className:"cheat-sheet-item__expression",onClick:function(r){return t.onClickQuery(e.expression)}},j.a.createElement("code",null,e.expression)),j.a.createElement("div",{className:"cheat-sheet-item__label"},e.label))}))},Nn=[{text:"Start",id:"start",icon:"fa fa-rocket"}],Fn=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={active:"start"},e.onClickTab=function(t){e.setState({active:t})},e}return J.c(e,t),e.prototype.render=function(){var t=this,e=this.state.active;return j.a.createElement("div",{style:{margin:"45px 0",border:"1px solid #ddd",borderRadius:5}},j.a.createElement("div",{className:"page-header-canvas"},j.a.createElement("div",{className:"page-container"},j.a.createElement("div",{className:"page-header"},j.a.createElement("nav",null,j.a.createElement("ul",{className:"gf-tabs "},Nn.map(function(r,n){var a=Dn()({"gf-tabs-link":!0,active:r.id===e});return j.a.createElement("li",{className:"gf-tabs-item",key:r.id},j.a.createElement("a",{className:a,onClick:function(){return t.onClickTab(r.id)}},j.a.createElement("i",{className:r.icon}),r.text))})))))),j.a.createElement("div",{className:"page-container page-body"},"start"===e&&j.a.createElement(In,{onClickQuery:this.props.onClickQuery})))},e}(R.PureComponent),qn=r(253),Ln=r(251),Rn=r.n(Ln);function jn(t,e){for(var r,n=t.parentElement.previousSibling;n;){if(r=n.querySelector(e))return r;n=n.previousSibling}}function Un(t){void 0===t&&(t=window);var e=t.getSelection();if(!e.anchorNode)return null;var r=e.getRangeAt(0),n=e.anchorNode.textContent,a=r.startOffset;return n.substr(a,1)}"Element"in window&&!Element.prototype.closest&&(Element.prototype.closest=function(t){var e,r=(this.document||this.ownerDocument).querySelectorAll(t),n=this;do{for(e=r.length;--e>=0&&r.item(e)!==n;);n=n.parentElement}while(e<0&&n);return n});var Vn={"[":"]","{":"}","(":")"},Bn=/ (?![^}]+})/;function Qn(){return{onKeyDown:function(t,e){var r=e.value;if(r.isCollapsed)switch(t.key){case"{":case"[":return t.preventDefault(),e.insertText(""+t.key+Vn[t.key]).move(-1).focus(),!0;case"(":t.preventDefault();var n=r.anchorText.text,a=r.anchorOffset,i=n.slice(a).search(Bn),s=(i>-1?i+a:n.length)-a;return e.insertText(t.key).move(s).insertText(Vn[t.key]).move(-1-s).focus(),!0;case"Backspace":var o=(n=r.anchorText.text)[(a=r.anchorOffset)-1],l=n[a];if(Vn[o]&&Vn[o]===l)return t.preventDefault(),e.deleteBackward().deleteForward().focus(),!0}}}}function Hn(t){var e=t.handler;return{onKeyDown:function(t){if(e&&"Enter"===t.key&&!t.shiftKey)return t.preventDefault(),e(t),!0}}}var zn=r(241),Gn="promql";function Wn(t,e){var r=e.typeaheadContext,n=e.typeaheadText;switch(r){case"context-labels":var a=Un();a&&"}"!==a&&","!==a||(t+="=");break;case"context-label-values":n.match(/^(!?=~?"|")/)||(t='"'+t),'"'!==Un()&&(t+='"')}return t}var Yn=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.loadOptions=function(t){var e=t[t.length-1];n.setState(function(t){return{logLabelOptions:t.logLabelOptions.map(function(t){return t.value===e.value?J.a({},t,{loading:!0}):t})}}),n.languageProvider.fetchLabelValues(e.value).then(n.onUpdateLanguage).catch(function(){})},n.onChangeLogLabels=function(t,e){if(2===e.length){var r="{"+e[0].value+'="'+e[1].value+'"}';n.onChangeQuery(r,!0)}},n.onChangeQuery=function(t,e){var r=n.props.onQueryChange;r&&r(t,e)},n.onClickHintFix=function(){var t=n.props,e=t.hint,r=t.onClickHintFix;r&&e&&e.fix&&r(e.fix.action)},n.onUpdateLanguage=function(){Xt.a.languages[Gn]=n.languageProvider.getSyntax();var t=n.languageProvider.logLabelOptions;n.setState({logLabelOptions:t,syntaxLoaded:!0})},n.onTypeahead=function(t){if(!n.languageProvider)return{suggestions:[]};var e=n.props.history,r=t.prefix,a=t.text,i=t.value,s=t.wrapperNode,o=Array.from(s.classList),l=jn(s,".attr-name"),c=l&&l.textContent,u=Un(),d=n.languageProvider.provideCompletionItems({text:a,value:i,prefix:r,wrapperClasses:o,labelKey:c},{history:e});return console.log("handleTypeahead",o,a,r,u,c,d.context),d},e.datasource.languageProvider&&(n.languageProvider=e.datasource.languageProvider),n.plugins=[Qn(),Hn({handler:e.onPressEnter}),Rn()({onlyIn:function(t){return"code_block"===t.type},getSyntax:function(t){return"promql"}})],n.state={logLabelOptions:[],syntaxLoaded:!1},n}return J.c(e,t),e.prototype.componentDidMount=function(){var t=this;this.languageProvider&&this.languageProvider.start().then(function(e){e.map(function(e){return e.then(t.onUpdateLanguage).catch(function(){})})}).then(function(){return t.onUpdateLanguage()})},e.prototype.render=function(){var t=this.props,e=t.error,r=t.hint,n=t.initialQuery,a=this.state,i=a.logLabelOptions,s=a.syntaxLoaded,o=this.languageProvider?this.languageProvider.cleanText:void 0,l=s?"日志标签":"加载标签中...";return j.a.createElement("div",{className:"prom-query-field"},j.a.createElement("div",{className:"prom-query-field-tools"},j.a.createElement(qn.a,{options:i,onChange:this.onChangeLogLabels,loadData:this.loadOptions},j.a.createElement("button",{className:"btn navbar-button navbar-button--tight",disabled:!s},l))),j.a.createElement("div",{className:"prom-query-field-wrapper"},j.a.createElement(zn.a,{additionalPlugins:this.plugins,cleanText:o,initialValue:n,onTypeahead:this.onTypeahead,onWillApplySuggestion:Wn,onValueChanged:this.onChangeQuery,placeholder:"输入一个PromQL查询",portalOrigin:"prometheus",syntaxLoaded:s}),e?j.a.createElement("div",{className:"prom-query-field-info text-error"},e):null,r?j.a.createElement("div",{className:"prom-query-field-info text-warning"},r.label," ",r.fix?j.a.createElement("a",{className:"text-link muted",onClick:this.onClickHintFix},r.fix.label):null):null))},e}(j.a.PureComponent),Kn=function(){function t(){}return t.templateUrl="partials/config.html",t}(),Jn=function(){function t(t,e){this.$q=t,this.datasourceSrv=e}return t.$inject=["$q","datasourceSrv"],t.prototype.query=function(t){var e=L.a.copy(t.targets);if(t.targets.length>1){e.sort(function(t,e){return t.refId<e.refId?-1:1});var r=e[0],n=null,a=this;if("A"===r.refId)return this.datasourceSrv.get(r.datasource).then(function(i){if("oge-kdm"===i.type){n=r.kdm;for(var s=1;s<e.length;s++)(r=e[s]).kdm&&(r.kdm=n)}return a.queryTargets(t,e)})}return this.queryTargets(t,e)},t.prototype.queryTargets=function(t,e){var r=this,n=I.a.groupBy(e,"datasource"),a=I.a.map(n,function(e){var n=e[0].datasource;return"-- Mixed --"===n?r.$q([]):r.datasourceSrv.get(n).then(function(r){var n=L.a.copy(t);return n.targets=e,r.query(n)})});return this.$q.all(a).then(function(t){return{data:I.a.flatten(I.a.map(t,"data"))}})},t}(),Xn=function(){function t(t){this.$q=t}return t.prototype.processQueryResult=function(t){var e=[];if(!t.data.results)return{data:e};for(var r in t.data.results){var n=t.data.results[r];if(n.series)for(var a=0,i=n.series;a<i.length;a++){var s=i[a];e.push({target:s.name,datapoints:s.points,refId:n.refId,meta:n.meta})}if(n.tables)for(var o=0,l=n.tables;o<l.length;o++){var c=l[o];c.type="table",c.refId=n.refId,c.meta=n.meta,e.push(c)}}return{data:e}},t.prototype.parseMetricFindQueryResult=function(t,e){if(!e||0===e.data.length||0===e.data.results[t].meta.rowCount)return[];var r=e.data.results[t].tables[0].columns,n=e.data.results[t].tables[0].rows,a=this.findColIndex(r,"__text"),i=this.findColIndex(r,"__value");return 2===r.length&&-1!==a&&-1!==i?this.transformToKeyValueList(n,a,i):this.transformToSimpleList(n)},t.prototype.transformToKeyValueList=function(t,e,r){for(var n=[],a=0;a<t.length;a++)this.containsKey(n,t[a][e])||n.push({text:t[a][e],value:t[a][r]});return n},t.prototype.transformToSimpleList=function(t){for(var e=[],r=0;r<t.length;r++)for(var n=0;n<t[r].length;n++){var a=t[r][n];-1===e.indexOf(a)&&e.push(a)}return I.a.map(e,function(t){return{text:t}})},t.prototype.findColIndex=function(t,e){for(var r=0;r<t.length;r++)if(t[r].text===e)return r;return-1},t.prototype.containsKey=function(t,e){for(var r=0;r<t.length;r++)if(t[r].text===e)return!0;return!1},t.prototype.transformAnnotationResponse=function(t,e){for(var r=e.data.results[t.annotation.name].tables[0],n=-1,a=-1,i=-1,s=0;s<r.columns.length;s++)if("time_sec"===r.columns[s].text||"time"===r.columns[s].text)n=s;else{if("title"===r.columns[s].text)return this.$q.reject({message:"The title column for annotations is deprecated, now only a column named text is returned"});"text"===r.columns[s].text?a=s:"tags"===r.columns[s].text&&(i=s)}if(-1===n)return this.$q.reject({message:"Missing mandatory time column (with time_sec column alias) in annotation query."});var o=[];for(s=0;s<r.rows.length;s++){var l=r.rows[s];o.push({annotation:t.annotation,time:Math.floor(l[n]),text:l[a]?l[a].toString():"",tags:l[i]?l[i].trim().split(/\s*,\s*/):[]})}return o},t}(),Zn=function(){function t(t,e,r){this.target=t,this.templateSrv=e,this.scopedVars=r,t.format=t.format||"time_series",t.timeColumn=t.timeColumn||"time",t.metricColumn=t.metricColumn||"none",t.group=t.group||[],t.where=t.where||[{type:"macro",name:"$__timeFilter",params:[]}],t.select=t.select||[[{type:"column",params:["value"]}]],"rawQuery"in this.target||(t.rawQuery="rawSql"in t),this.interpolateQueryStr=this.interpolateQueryStr.bind(this)}return t.$inject=["target","templateSrv","scopedVars"],t.prototype.unquoteIdentifier=function(t){return'"'===t[0]&&'"'===t[t.length-1]?t.substring(1,t.length-1).replace(/""/g,'"'):t},t.prototype.quoteIdentifier=function(t){return'"'+t.replace(/"/g,'""')+'"'},t.prototype.quoteLiteral=function(t){return"'"+t.replace(/'/g,"''")+"'"},t.prototype.escapeLiteral=function(t){return t.replace(/'/g,"''")},t.prototype.hasTimeGroup=function(){return I.a.find(this.target.group,function(t){return"time"===t.type})},t.prototype.hasMetricColumn=function(){return"none"!==this.target.metricColumn},t.prototype.interpolateQueryStr=function(t,e,r){return e.multi||e.includeAll?"string"==typeof t?this.quoteLiteral(t):I.a.map(t,this.quoteLiteral).join(","):this.escapeLiteral(t)},t.prototype.render=function(t){var e=this.target;return this.target.rawQuery||"table"in this.target?(e.rawQuery||(e.rawSql=this.buildQuery()),t?this.templateSrv.replace(e.rawSql,this.scopedVars,this.interpolateQueryStr):e.rawSql):""},t.prototype.hasUnixEpochTimecolumn=function(){return["int","bigint","double"].indexOf(this.target.timeColumnType)>-1},t.prototype.buildTimeColumn=function(t){void 0===t&&(t=!0);var e,r=this.hasTimeGroup(),n="$__timeGroup";if(r){var a=void 0;a=r.params.length>1&&"none"!==r.params[1]?r.params.join(","):r.params[0],this.hasUnixEpochTimecolumn()&&(n="$__unixEpochGroup"),t&&(n+="Alias"),e=n+"("+this.target.timeColumn+","+a+")"}else e=this.target.timeColumn,t&&(e+=' AS "time"');return e},t.prototype.buildMetricColumn=function(){return this.hasMetricColumn()?this.target.metricColumn+" AS metric":""},t.prototype.buildValueColumns=function(){for(var t="",e=0,r=this.target.select;e<r.length;e++){var n=r[e];t+=",\n  "+this.buildValueColumn(n)}return t},t.prototype.buildValueColumn=function(t){var e="";e=I.a.find(t,function(t){return"column"===t.type}).params[0];var r=I.a.find(t,function(t){return"aggregate"===t.type});r&&(e=r.params[0]+"("+e+")");var n=I.a.find(t,function(t){return"alias"===t.type});return n&&(e+=" AS "+this.quoteIdentifier(n.params[0])),e},t.prototype.buildWhereClause=function(){var t=this,e="",r=I.a.map(this.target.where,function(e,r){switch(e.type){case"macro":return e.name+"("+t.target.timeColumn+")";case"expression":return e.params.join(" ")}});return r.length>0&&(e="\nWHERE\n  "+r.join(" AND\n  ")),e},t.prototype.buildGroupClause=function(){for(var t="",e="",r=0;r<this.target.group.length;r++){var n=this.target.group[r];r>0&&(e+=", "),"time"===n.type?e+="1":e+=n.params[0]}return e.length&&(t="\nGROUP BY "+e,this.hasMetricColumn()&&(t+=",2")),t},t.prototype.buildQuery=function(){var t="SELECT";return t+="\n  "+this.buildTimeColumn(),this.hasMetricColumn()&&(t+=",\n  "+this.buildMetricColumn()),t+=this.buildValueColumns(),t+="\nFROM "+this.target.table,t+=this.buildWhereClause(),t+=this.buildGroupClause(),t+="\nORDER BY "+this.buildTimeColumn(!1)},t}(),ta=function(){function t(t,e,r,n,a){var i=this;this.backendSrv=e,this.$q=r,this.templateSrv=n,this.timeSrv=a,this.interpolateVariable=function(t,e){return"string"==typeof t?e.multi||e.includeAll?i.queryModel.quoteLiteral(t):t:"number"==typeof t?t:I.a.map(t,function(t){return i.queryModel.quoteLiteral(t)}).join(",")},this.name=t.name,this.id=t.id,this.responseParser=new Xn(this.$q),this.queryModel=new Zn({}),this.interval=(t.jsonData||{}).timeInterval}return t.$inject=["instanceSettings","backendSrv","$q","templateSrv","timeSrv"],t.prototype.query=function(t){var e=this,r=I.a.filter(t.targets,function(t){return!0!==t.hide}).map(function(r){var n=new Zn(r,e.templateSrv,t.scopedVars);return{refId:r.refId,intervalMs:t.intervalMs,maxDataPoints:t.maxDataPoints,datasourceId:e.id,rawSql:n.render(e.interpolateVariable),format:r.format}});return 0===r.length?this.$q.when({data:[]}):this.backendSrv.datasourceRequest({url:"/api/tsdb/query",method:"POST",data:{from:t.range.from.valueOf().toString(),to:t.range.to.valueOf().toString(),queries:r}}).then(this.responseParser.processQueryResult)},t.prototype.annotationQuery=function(t){var e=this;if(!t.annotation.rawQuery)return this.$q.reject({message:"Query missing in annotation definition"});var r={refId:t.annotation.name,datasourceId:this.id,rawSql:this.templateSrv.replace(t.annotation.rawQuery,t.scopedVars,this.interpolateVariable),format:"table"};return this.backendSrv.datasourceRequest({url:"/api/tsdb/query",method:"POST",data:{from:t.range.from.valueOf().toString(),to:t.range.to.valueOf().toString(),queries:[r]}}).then(function(r){return e.responseParser.transformAnnotationResponse(t,r)})},t.prototype.metricFindQuery=function(t,e){var r=this,n="tempvar";e&&e.variable&&e.variable.name&&(n=e.variable.name);var a={refId:n,datasourceId:this.id,rawSql:this.templateSrv.replace(t,{},this.interpolateVariable),format:"table"},i=this.timeSrv.timeRange(),s={queries:[a],from:i.from.valueOf().toString(),to:i.to.valueOf().toString()};return e&&e.range&&e.range.from&&(s.from=e.range.from.valueOf().toString()),e&&e.range&&e.range.to&&(s.to=e.range.to.valueOf().toString()),this.backendSrv.datasourceRequest({url:"/api/tsdb/query",method:"POST",data:s}).then(function(t){return r.responseParser.parseMetricFindQueryResult(n,t)})},t.prototype.testDatasource=function(){return this.backendSrv.datasourceRequest({url:"/api/tsdb/query",method:"POST",data:{from:"5m",to:"now",queries:[{refId:"A",intervalMs:1,maxDataPoints:1,datasourceId:this.id,rawSql:"SELECT 1",format:"table"}]}}).then(function(t){return{status:"success",message:"Database Connection OK"}}).catch(function(t){return console.log(t),t.data&&t.data.message?{status:"error",message:t.data.message}:{status:"error",message:t.status}})},t}(),ea=function(){function t(t,e){this.target=t,this.queryModel=e}return t.prototype.getOperators=function(t){switch(t){case"double":case"float":return["=","!=","<","<=",">",">="];case"text":case"tinytext":case"mediumtext":case"longtext":case"varchar":case"char":return["=","!=","<","<=",">",">=","IN","NOT IN","LIKE","NOT LIKE"];default:return["=","!=","<","<=",">",">=","IN","NOT IN"]}},t.prototype.quoteIdentAsLiteral=function(t){return this.queryModel.quoteLiteral(this.queryModel.unquoteIdentifier(t))},t.prototype.findMetricTable=function(){return"\n  SELECT\n    table_name as table_name,\n    ( SELECT\n        column_name as column_name\n      FROM information_schema.columns c\n      WHERE\n        c.table_schema = t.table_schema AND\n        c.table_name = t.table_name AND\n        c.data_type IN ('timestamp', 'datetime')\n      ORDER BY ordinal_position LIMIT 1\n    ) AS time_column,\n    ( SELECT\n        column_name AS column_name\n      FROM information_schema.columns c\n      WHERE\n        c.table_schema = t.table_schema AND\n        c.table_name = t.table_name AND\n        c.data_type IN('float', 'int', 'bigint')\n      ORDER BY ordinal_position LIMIT 1\n    ) AS value_column\n  FROM information_schema.tables t\n  WHERE\n    t.table_schema = database() AND\n    EXISTS\n    ( SELECT 1\n      FROM information_schema.columns c\n      WHERE\n        c.table_schema = t.table_schema AND\n        c.table_name = t.table_name AND\n        c.data_type IN ('timestamp', 'datetime')\n    ) AND\n    EXISTS\n    ( SELECT 1\n      FROM information_schema.columns c\n      WHERE\n        c.table_schema = t.table_schema AND\n        c.table_name = t.table_name AND\n        c.data_type IN('float', 'int', 'bigint')\n    )\n  LIMIT 1\n;"},t.prototype.buildTableConstraint=function(t){var e="";if(t.includes(".")){var r=t.split(".");return e="table_schema = "+this.quoteIdentAsLiteral(r[0]),e+=" AND table_name = "+this.quoteIdentAsLiteral(r[1])}return e="table_schema = database() AND table_name = "+this.quoteIdentAsLiteral(t)},t.prototype.buildTableQuery=function(){return"SELECT table_name FROM information_schema.tables WHERE table_schema = database() ORDER BY table_name"},t.prototype.buildColumnQuery=function(t){var e="SELECT column_name FROM information_schema.columns WHERE ";switch(e+=this.buildTableConstraint(this.target.table),t){case"time":e+=" AND data_type IN ('timestamp','datetime','bigint','int','double','float')";break;case"metric":e+=" AND data_type IN ('text','tinytext','mediumtext','longtext','varchar','char')";break;case"value":e+=" AND data_type IN ('bigint','int','smallint','mediumint','tinyint','double','decimal','float')",e+=" AND column_name <> "+this.quoteIdentAsLiteral(this.target.timeColumn);break;case"group":e+=" AND data_type IN ('text','tinytext','mediumtext','longtext','varchar','char')"}return e+=" ORDER BY column_name"},t.prototype.buildValueQuery=function(t){var e="SELECT DISTINCT QUOTE("+t+")";return e+=" FROM "+this.target.table,e+=" WHERE $__timeFilter("+this.target.timeColumn+")",e+=" ORDER BY 1 LIMIT 100"},t.prototype.buildDatatypeQuery=function(t){var e="\nSELECT data_type\nFROM information_schema.columns\nWHERE ";return e+=" table_name = "+this.quoteIdentAsLiteral(this.target.table),e+=" AND column_name = "+this.quoteIdentAsLiteral(t)},t}(),ra=function(){return function(t){this.type=t.type,t.label?this.label=t.label:this.label=this.type[0].toUpperCase()+this.type.substring(1)+":",this.style=t.style,"function"===this.style?(this.wrapOpen="(",this.wrapClose=")",this.separator=", "):(this.wrapOpen=" ",this.wrapClose=" ",this.separator=" "),this.params=t.params,this.defaultParams=t.defaultParams}}(),na=function(){function t(t,e){if(this.part=t,this.def=e,!this.def)throw{message:"找不到sql部分 "+t.type};this.datatype=t.datatype,t.name?(this.name=t.name,this.label=e.label+" "+t.name):(this.name="",this.label=e.label),t.params=t.params||I.a.clone(this.def.defaultParams),this.params=t.params}return t.prototype.updateParam=function(t,e){""===t&&this.def.params[e].optional?this.params.splice(e,1):this.params[e]=t,this.part.params=this.params},t}(),aa=[];function ia(t){aa[t.type]=new ra(t)}ia({type:"column",style:"label",params:[{type:"column",dynamicLookup:!0}],defaultParams:["value"]}),ia({type:"expression",style:"expression",label:"Expr:",params:[{name:"left",type:"string",dynamicLookup:!0},{name:"op",type:"string",dynamicLookup:!0},{name:"right",type:"string",dynamicLookup:!0}],defaultParams:["value","=","value"]}),ia({type:"macro",style:"label",label:"Macro:",params:[],defaultParams:[]}),ia({type:"aggregate",style:"label",params:[{name:"name",type:"string",options:["avg","count","min","max","sum","stddev","variance"]}],defaultParams:["avg"]}),ia({type:"alias",style:"label",params:[{name:"name",type:"string",quote:"double"}],defaultParams:["alias"]}),ia({type:"time",style:"function",label:"time",params:[{name:"interval",type:"interval",options:["$__interval","1s","10s","1m","5m","10m","15m","1h"]},{name:"fill",type:"string",options:["none","NULL","previous","0"]}],defaultParams:["$__interval","none"]});var sa={create:function(t){var e=aa[t.type];return e?new na(t,e):null}},oa="SELECT\n  UNIX_TIMESTAMP(<time_column>) as time_sec,\n  <value column> as value,\n  <series name column> as metric\nFROM <table name>\nWHERE $__timeFilter(time_column)\nORDER BY <time_column> ASC\n",la=function(t){function e(e,r,n,a,i){var s=t.call(this,e,r)||this;return s.templateSrv=n,s.$q=a,s.uiSegmentSrv=i,s.target=s.target,s.queryModel=new Zn(s.target,n,s.panel.scopedVars),s.metaBuilder=new ea(s.target,s.queryModel),s.updateProjection(),s.formats=[{text:"Time series",value:"time_series"},{text:"Table",value:"table"}],s.target.rawSql||("table"===s.panelCtrl.panel.type?(s.target.format="table",s.target.rawSql="SELECT 1",s.target.rawQuery=!0):(s.target.rawSql=oa,s.datasource.metricFindQuery(s.metaBuilder.findMetricTable()).then(function(t){if(t.length>0){s.target.table=t[0].text;var e=s.uiSegmentSrv.newSegment(s.target.table);s.tableSegment.html=e.html,s.tableSegment.value=e.value,s.target.timeColumn=t[1].text,e=s.uiSegmentSrv.newSegment(s.target.timeColumn),s.timeColumnSegment.html=e.html,s.timeColumnSegment.value=e.value,s.target.timeColumnType="timestamp",s.target.select=[[{type:"column",params:[t[2].text]}]],s.updateProjection(),s.panelCtrl.refresh()}}))),s.target.table?s.tableSegment=i.newSegment(s.target.table):s.tableSegment=i.newSegment({value:"select table",fake:!0}),s.timeColumnSegment=i.newSegment(s.target.timeColumn),s.metricColumnSegment=i.newSegment(s.target.metricColumn),s.buildSelectMenu(),s.whereAdd=s.uiSegmentSrv.newPlusButton(),s.groupAdd=s.uiSegmentSrv.newPlusButton(),s.panelCtrl.events.on("data-received",s.onDataReceived.bind(s),e),s.panelCtrl.events.on("data-error",s.onDataError.bind(s),e),s}return e.$inject=["$scope","$injector","templateSrv","$q","uiSegmentSrv"],J.c(e,t),e.prototype.updateProjection=function(){this.selectParts=I.a.map(this.target.select,function(t){return I.a.map(t,sa.create).filter(function(t){return t})}),this.whereParts=I.a.map(this.target.where,sa.create).filter(function(t){return t}),this.groupParts=I.a.map(this.target.group,sa.create).filter(function(t){return t})},e.prototype.updatePersistedParts=function(){this.target.select=I.a.map(this.selectParts,function(t){return I.a.map(t,function(t){return{type:t.def.type,datatype:t.datatype,params:t.params}})}),this.target.where=I.a.map(this.whereParts,function(t){return{type:t.def.type,datatype:t.datatype,name:t.name,params:t.params}}),this.target.group=I.a.map(this.groupParts,function(t){return{type:t.def.type,datatype:t.datatype,params:t.params}})},e.prototype.buildSelectMenu=function(){this.selectMenu=[];this.selectMenu.push({text:"Aggregate Functions",value:"aggregate",submenu:[{text:"Average",value:"avg"},{text:"Count",value:"count"},{text:"Maximum",value:"max"},{text:"Minimum",value:"min"},{text:"Sum",value:"sum"},{text:"Standard deviation",value:"stddev"},{text:"Variance",value:"variance"}]}),this.selectMenu.push({text:"Alias",value:"alias"}),this.selectMenu.push({text:"Column",value:"column"})},e.prototype.toggleEditorMode=function(){var t=this;this.target.rawQuery?bt.a.emit("confirm-modal",{title:"Warning",text2:"Switching to query builder may overwrite your raw SQL.",icon:"fa-exclamation",yesText:"Switch",onConfirm:function(){t.target.rawQuery=!t.target.rawQuery}}):this.target.rawQuery=!this.target.rawQuery},e.prototype.resetPlusButton=function(t){var e=this.uiSegmentSrv.newPlusButton();t.html=e.html,t.value=e.value},e.prototype.getTableSegments=function(){return this.datasource.metricFindQuery(this.metaBuilder.buildTableQuery()).then(this.transformToSegments({})).catch(this.handleQueryError.bind(this))},e.prototype.tableChanged=function(){var t=this;this.target.table=this.tableSegment.value,this.target.where=[],this.target.group=[],this.updateProjection();var e=this.uiSegmentSrv.newSegment("none");this.metricColumnSegment.html=e.html,this.metricColumnSegment.value=e.value,this.target.metricColumn="none";var r=this.datasource.metricFindQuery(this.metaBuilder.buildColumnQuery("time")).then(function(e){if(e.length>0&&!I.a.find(e,function(e){return e.text===t.target.timeColumn})){var r=t.uiSegmentSrv.newSegment(e[0].text);t.timeColumnSegment.html=r.html,t.timeColumnSegment.value=r.value}return t.timeColumnChanged(!1)}),n=this.datasource.metricFindQuery(this.metaBuilder.buildColumnQuery("value")).then(function(e){e.length>0&&(t.target.select=[[{type:"column",params:[e[0].text]}]],t.updateProjection())});this.$q.all([r,n]).then(function(){t.panelCtrl.refresh()})},e.prototype.getTimeColumnSegments=function(){return this.datasource.metricFindQuery(this.metaBuilder.buildColumnQuery("time")).then(this.transformToSegments({})).catch(this.handleQueryError.bind(this))},e.prototype.timeColumnChanged=function(t){var e=this;return this.target.timeColumn=this.timeColumnSegment.value,this.datasource.metricFindQuery(this.metaBuilder.buildDatatypeQuery(this.target.timeColumn)).then(function(r){if(1===r.length){e.target.timeColumnType!==r[0].text&&(e.target.timeColumnType=r[0].text);var n=void 0;n=e.queryModel.hasUnixEpochTimecolumn()?sa.create({type:"macro",name:"$__unixEpochFilter",params:[]}):sa.create({type:"macro",name:"$__timeFilter",params:[]}),e.whereParts.length>=1&&"macro"===e.whereParts[0].def.type?e.whereParts[0]=n:e.whereParts.splice(0,0,n)}e.updatePersistedParts(),!1!==t&&e.panelCtrl.refresh()})},e.prototype.getMetricColumnSegments=function(){return this.datasource.metricFindQuery(this.metaBuilder.buildColumnQuery("metric")).then(this.transformToSegments({addNone:!0})).catch(this.handleQueryError.bind(this))},e.prototype.metricColumnChanged=function(){this.target.metricColumn=this.metricColumnSegment.value,this.panelCtrl.refresh()},e.prototype.onDataReceived=function(t){this.lastQueryMeta=null,this.lastQueryError=null;var e=I.a.find(t,{refId:this.target.refId});e&&(this.lastQueryMeta=e.meta)},e.prototype.onDataError=function(t){if(t.data&&t.data.results){var e=t.data.results[this.target.refId];e&&(this.lastQueryMeta=e.meta,this.lastQueryError=e.error)}},e.prototype.transformToSegments=function(t){var e=this;return function(r){var n=I.a.map(r,function(t){return e.uiSegmentSrv.newSegment({value:t.text,expandable:t.expandable})});if(t.addTemplateVars)for(var a=0,i=e.templateSrv.variables;a<i.length;a++){var s=i[a],o=void 0;o="$"+s.name,t.templateQuoter&&!1===s.multi&&(o=t.templateQuoter(o)),n.unshift(e.uiSegmentSrv.newSegment({type:"template",value:o,expandable:!0}))}return t.addNone&&n.unshift(e.uiSegmentSrv.newSegment({type:"template",value:"none",expandable:!0})),n}},e.prototype.findAggregateIndex=function(t){return I.a.findIndex(t,function(t){return"aggregate"===t.def.type||"percentile"===t.def.type})},e.prototype.findWindowIndex=function(t){return I.a.findIndex(t,function(t){return"window"===t.def.type||"moving_window"===t.def.type})},e.prototype.addSelectPart=function(t,e,r){var n=e.value;r&&r.type&&(n=r.type);var a=sa.create({type:n});r&&(a.params[0]=r.value);var i=!1;switch(n){case"column":var s=I.a.map(t,function(t){return sa.create({type:t.def.type,params:I.a.clone(t.params)})});this.selectParts.push(s);break;case"percentile":case"aggregate":0===this.target.group.length&&this.addGroup("time","$__interval");var o=this.findAggregateIndex(t);-1!==o?t[o]=a:t.splice(1,0,a),I.a.find(t,function(t){return"alias"===t.def.type})||(i=!0);break;case"moving_window":case"window":var l=this.findWindowIndex(t);if(-1!==l)t[l]=a;else{var c=this.findAggregateIndex(t);-1!==c?t.splice(c+1,0,a):t.splice(1,0,a)}I.a.find(t,function(t){return"alias"===t.def.type})||(i=!0);break;case"alias":i=!0}i&&(a=sa.create({type:"alias",params:[t[0].params[0].replace(/"/g,"")]}),"alias"===t[t.length-1].def.type?t[t.length-1]=a:t.push(a)),this.updatePersistedParts(),this.panelCtrl.refresh()},e.prototype.removeSelectPart=function(t,e){if("column"===e.def.type){if(this.selectParts.length>1){var r=I.a.indexOf(this.selectParts,t);this.selectParts.splice(r,1)}}else{var n=I.a.indexOf(t,e);t.splice(n,1)}this.updatePersistedParts()},e.prototype.handleSelectPartEvent=function(t,e,r){switch(r.name){case"get-param-options":switch(e.def.type){case"column":return this.datasource.metricFindQuery(this.metaBuilder.buildColumnQuery("value")).then(this.transformToSegments({})).catch(this.handleQueryError.bind(this))}case"part-param-changed":this.updatePersistedParts(),this.panelCtrl.refresh();break;case"action":this.removeSelectPart(t,e),this.panelCtrl.refresh();break;case"get-part-actions":return this.$q.when([{text:"Remove",value:"remove-part"}])}},e.prototype.handleGroupPartEvent=function(t,e,r){switch(r.name){case"get-param-options":return this.datasource.metricFindQuery(this.metaBuilder.buildColumnQuery()).then(this.transformToSegments({})).catch(this.handleQueryError.bind(this));case"part-param-changed":this.updatePersistedParts(),this.panelCtrl.refresh();break;case"action":this.removeGroup(t,e),this.panelCtrl.refresh();break;case"get-part-actions":return this.$q.when([{text:"Remove",value:"remove-part"}])}},e.prototype.addGroup=function(t,e){var r=[e];"time"===t&&(r=["$__interval","none"]);var n=sa.create({type:t,params:r});"time"===t?this.groupParts.splice(0,0,n):this.groupParts.push(n);for(var a=0,i=this.selectParts;a<i.length;a++){var s=i[a];if(!s.some(function(t){return"aggregate"===t.def.type})){var o=sa.create({type:"aggregate",params:["avg"]});if(s.splice(1,0,o),!s.some(function(t){return"alias"===t.def.type})){var l=sa.create({type:"alias",params:[s[0].part.params[0]]});s.push(l)}}}this.updatePersistedParts()},e.prototype.removeGroup=function(t,e){"time"===t.def.type&&(this.selectParts=I.a.map(this.selectParts,function(t){return I.a.filter(t,function(t){return"aggregate"!==t.def.type&&"percentile"!==t.def.type})})),this.groupParts.splice(e,1),this.updatePersistedParts()},e.prototype.handleWherePartEvent=function(t,e,r,n){var a=this;switch(r.name){case"get-param-options":switch(r.param.name){case"left":return this.datasource.metricFindQuery(this.metaBuilder.buildColumnQuery()).then(this.transformToSegments({})).catch(this.handleQueryError.bind(this));case"right":return["int","bigint","double","datetime"].indexOf(e.datatype)>-1?this.$q.when([]):this.datasource.metricFindQuery(this.metaBuilder.buildValueQuery(e.params[0])).then(this.transformToSegments({addTemplateVars:!0,templateQuoter:function(t){return a.queryModel.quoteLiteral(t)}})).catch(this.handleQueryError.bind(this));case"op":return this.$q.when(this.uiSegmentSrv.newOperators(this.metaBuilder.getOperators(e.datatype)));default:return this.$q.when([])}case"part-param-changed":this.updatePersistedParts(),this.datasource.metricFindQuery(this.metaBuilder.buildDatatypeQuery(e.params[0])).then(function(t){1===t.length&&(e.datatype=t[0].text)}),this.panelCtrl.refresh();break;case"action":t.splice(n,1),this.updatePersistedParts(),this.panelCtrl.refresh();break;case"get-part-actions":return this.$q.when([{text:"Remove",value:"remove-part"}])}},e.prototype.getWhereOptions=function(){var t=[];return this.queryModel.hasUnixEpochTimecolumn()?t.push(this.uiSegmentSrv.newSegment({type:"macro",value:"$__unixEpochFilter"})):t.push(this.uiSegmentSrv.newSegment({type:"macro",value:"$__timeFilter"})),t.push(this.uiSegmentSrv.newSegment({type:"expression",value:"Expression"})),this.$q.when(t)},e.prototype.addWhereAction=function(t,e){switch(this.whereAdd.type){case"macro":var r=sa.create({type:"macro",name:this.whereAdd.value,params:[]});this.whereParts.length>=1&&"macro"===this.whereParts[0].def.type?this.whereParts[0]=r:this.whereParts.splice(0,0,r);break;default:this.whereParts.push(sa.create({type:"expression",params:["value","=","value"]}))}this.updatePersistedParts(),this.resetPlusButton(this.whereAdd),this.panelCtrl.refresh()},e.prototype.getGroupOptions=function(){var t=this;return this.datasource.metricFindQuery(this.metaBuilder.buildColumnQuery("group")).then(function(e){var r=[];t.queryModel.hasTimeGroup()||r.push(t.uiSegmentSrv.newSegment({type:"time",value:"time($__interval,none)"}));for(var n=0,a=e;n<a.length;n++){var i=a[n];r.push(t.uiSegmentSrv.newSegment({type:"column",value:i.text}))}return r}).catch(this.handleQueryError.bind(this))},e.prototype.addGroupAction=function(){this.groupAdd.value,this.addGroup(this.groupAdd.type,this.groupAdd.value),this.resetPlusButton(this.groupAdd),this.panelCtrl.refresh()},e.prototype.handleQueryError=function(t){return this.error=t.message||"Failed to issue metric query",[]},e.templateUrl="partials/query.editor.html",e}(Ht),ca=function(){function t(){}return t.templateUrl="partials/config.html",t}(),ua="SELECT\n    UNIX_TIMESTAMP(<time_column>) as time_sec,\n    <text_column> as text,\n    <tags_column> as tags\n  FROM <table name>\n  WHERE $__timeFilter(time_column)\n  ORDER BY <time_column> ASC\n  LIMIT 100\n  ",da=function(){function t(){this.annotation.rawQuery=this.annotation.rawQuery||ua}return t.templateUrl="partials/annotations.editor.html",t}(),pa=function(){function t(t){this.$q=t}return t.prototype.processQueryResult=function(t){var e=[];if(!t.data.results)return{data:e};for(var r in t.data.results){var n=t.data.results[r];if(n.series)for(var a=0,i=n.series;a<i.length;a++){var s=i[a];e.push({target:s.name,datapoints:s.points,refId:n.refId,meta:n.meta})}if(n.tables)for(var o=0,l=n.tables;o<l.length;o++){var c=l[o];c.type="table",c.refId=n.refId,c.meta=n.meta,e.push(c)}}return{data:e}},t.prototype.parseMetricFindQueryResult=function(t,e){if(!e||0===e.data.length||0===e.data.results[t].meta.rowCount)return[];var r=e.data.results[t].tables[0].columns,n=e.data.results[t].tables[0].rows,a=this.findColIndex(r,"__text"),i=this.findColIndex(r,"__value");return 2===r.length&&-1!==a&&-1!==i?this.transformToKeyValueList(n,a,i):this.transformToSimpleList(n)},t.prototype.transformToKeyValueList=function(t,e,r){for(var n=[],a=0;a<t.length;a++)this.containsKey(n,t[a][e])||n.push({text:t[a][e],value:t[a][r]});return n},t.prototype.transformToSimpleList=function(t){for(var e=[],r=0;r<t.length;r++)for(var n=0;n<t[r].length;n++){var a=t[r][n];-1===e.indexOf(a)&&e.push(a)}return I.a.map(e,function(t){return{text:t}})},t.prototype.findColIndex=function(t,e){for(var r=0;r<t.length;r++)if(t[r].text===e)return r;return-1},t.prototype.containsKey=function(t,e){for(var r=0;r<t.length;r++)if(t[r].text===e)return!0;return!1},t.prototype.transformAnnotationResponse=function(t,e){for(var r=e.data.results[t.annotation.name].tables[0],n=-1,a=-1,i=-1,s=0;s<r.columns.length;s++)"time"===r.columns[s].text?n=s:"text"===r.columns[s].text?a=s:"tags"===r.columns[s].text&&(i=s);if(-1===n)return this.$q.reject({message:"Missing mandatory time column in annotation query."});var o=[];for(s=0;s<r.rows.length;s++){var l=r.rows[s];o.push({annotation:t.annotation,time:Math.floor(l[n]),title:l[-1],text:l[a],tags:l[i]?l[i].trim().split(/\s*,\s*/):[]})}return o},t}(),ha=function(){function t(t,e,r){this.target=t,this.templateSrv=e,this.scopedVars=r,t.format=t.format||"time_series",t.timeColumn=t.timeColumn||"time",t.metricColumn=t.metricColumn||"none",t.group=t.group||[],t.where=t.where||[{type:"macro",name:"$__timeFilter",params:[]}],t.select=t.select||[[{type:"column",params:["value"]}]],"rawQuery"in this.target||(t.rawQuery="rawSql"in t),this.interpolateQueryStr=this.interpolateQueryStr.bind(this)}return t.$inject=["target","templateSrv","scopedVars"],t.prototype.unquoteIdentifier=function(t){return'"'===t[0]&&'"'===t[t.length-1]?t.substring(1,t.length-1).replace(/""/g,'"'):t},t.prototype.quoteIdentifier=function(t){return'"'+String(t).replace(/"/g,'""')+'"'},t.prototype.quoteLiteral=function(t){return"'"+String(t).replace(/'/g,"''")+"'"},t.prototype.escapeLiteral=function(t){return String(t).replace(/'/g,"''")},t.prototype.hasTimeGroup=function(){return I.a.find(this.target.group,function(t){return"time"===t.type})},t.prototype.hasMetricColumn=function(){return"none"!==this.target.metricColumn},t.prototype.interpolateQueryStr=function(t,e,r){return e.multi||e.includeAll?"string"==typeof t?this.quoteLiteral(t):I.a.map(t,this.quoteLiteral).join(","):this.escapeLiteral(t)},t.prototype.render=function(t){var e=this.target;return this.target.rawQuery||"table"in this.target?(e.rawQuery||(e.rawSql=this.buildQuery()),t?this.templateSrv.replace(e.rawSql,this.scopedVars,this.interpolateQueryStr):e.rawSql):""},t.prototype.hasUnixEpochTimecolumn=function(){return["int4","int8","float4","float8","numeric"].indexOf(this.target.timeColumnType)>-1},t.prototype.buildTimeColumn=function(t){void 0===t&&(t=!0);var e,r=this.hasTimeGroup(),n="$__timeGroup";if(r){var a=void 0;a=r.params.length>1&&"none"!==r.params[1]?r.params.join(","):r.params[0],this.hasUnixEpochTimecolumn()&&(n="$__unixEpochGroup"),t&&(n+="Alias"),e=n+"("+this.target.timeColumn+","+a+")"}else e=this.target.timeColumn,t&&(e+=' AS "time"');return e},t.prototype.buildMetricColumn=function(){return this.hasMetricColumn()?this.target.metricColumn+" AS metric":""},t.prototype.buildValueColumns=function(){for(var t="",e=0,r=this.target.select;e<r.length;e++){var n=r[e];t+=",\n  "+this.buildValueColumn(n)}return t},t.prototype.buildValueColumn=function(t){var e="";e=I.a.find(t,function(t){return"column"===t.type}).params[0];var r=I.a.find(t,function(t){return"aggregate"===t.type||"percentile"===t.type}),n=I.a.find(t,function(t){return"window"===t.type||"moving_window"===t.type});if(r){var a=r.params[0];switch(r.type){case"aggregate":e="first"===a||"last"===a?a+"("+e+","+this.target.timeColumn+")":a+"("+e+")";break;case"percentile":e=a+"("+r.params[1]+") WITHIN GROUP (ORDER BY "+e+")"}}if(n){var i=[];this.hasMetricColumn()&&i.push("PARTITION BY "+this.target.metricColumn),i.push("ORDER BY "+this.buildTimeColumn(!1));var s=i.join(" "),o=void 0,l=void 0;switch(n.type){case"window":switch(n.params[0]){case"delta":e=(o=e)+" - "+(l="lag("+o+") OVER ("+s+")");break;case"increase":e="(CASE WHEN "+(o=e)+" >= "+(l="lag("+o+") OVER ("+s+")")+" THEN "+o+" - "+l,e+=" WHEN "+l+" IS NULL THEN NULL ELSE "+o+" END)";break;case"rate":var c=this.target.timeColumn;r&&(c="min("+c+")"),e="(CASE WHEN "+(o=e)+" >= "+(l="lag("+o+") OVER ("+s+")")+" THEN "+o+" - "+l,e+=" WHEN "+l+" IS NULL THEN NULL ELSE "+o+" END)",e+="/extract(epoch from "+c+" - lag("+c+") OVER ("+s+"))";break;default:e=n.params[0]+"("+e+") OVER ("+s+")"}break;case"moving_window":e=n.params[0]+"("+e+") OVER ("+s+" ROWS "+n.params[1]+" PRECEDING)"}}var u=I.a.find(t,function(t){return"alias"===t.type});return u&&(e+=" AS "+this.quoteIdentifier(u.params[0])),e},t.prototype.buildWhereClause=function(){var t=this,e="",r=I.a.map(this.target.where,function(e,r){switch(e.type){case"macro":return e.name+"("+t.target.timeColumn+")";case"expression":return e.params.join(" ")}});return r.length>0&&(e="\nWHERE\n  "+r.join(" AND\n  ")),e},t.prototype.buildGroupClause=function(){for(var t="",e="",r=0;r<this.target.group.length;r++){var n=this.target.group[r];r>0&&(e+=", "),"time"===n.type?e+="1":e+=n.params[0]}return e.length&&(t="\nGROUP BY "+e,this.hasMetricColumn()&&(t+=",2")),t},t.prototype.buildQuery=function(){var t="SELECT";return t+="\n  "+this.buildTimeColumn(),this.hasMetricColumn()&&(t+=",\n  "+this.buildMetricColumn()),t+=this.buildValueColumns(),t+="\nFROM "+this.target.table,t+=this.buildWhereClause(),t+=this.buildGroupClause(),t+="\nORDER BY 1",this.hasMetricColumn()&&(t+=",2"),t},t}(),fa=function(){function t(t,e,r,n,a){var i=this;this.backendSrv=e,this.$q=r,this.templateSrv=n,this.timeSrv=a,this.interpolateVariable=function(t,e){return"string"==typeof t?e.multi||e.includeAll?i.queryModel.quoteLiteral(t):t:"number"==typeof t?t:I.a.map(t,function(t){return i.queryModel.quoteLiteral(t)}).join(",")},this.name=t.name,this.id=t.id,this.jsonData=t.jsonData,this.responseParser=new pa(this.$q),this.queryModel=new ha({}),this.interval=(t.jsonData||{}).timeInterval}return t.$inject=["instanceSettings","backendSrv","$q","templateSrv","timeSrv"],t.prototype.query=function(t){var e=this,r=I.a.filter(t.targets,function(t){return!0!==t.hide}).map(function(r){var n=new ha(r,e.templateSrv,t.scopedVars);return{refId:r.refId,intervalMs:t.intervalMs,maxDataPoints:t.maxDataPoints,datasourceId:e.id,rawSql:n.render(e.interpolateVariable),format:r.format}});return 0===r.length?this.$q.when({data:[]}):this.backendSrv.datasourceRequest({url:"/api/tsdb/query",method:"POST",data:{from:t.range.from.valueOf().toString(),to:t.range.to.valueOf().toString(),queries:r}}).then(this.responseParser.processQueryResult)},t.prototype.annotationQuery=function(t){var e=this;if(!t.annotation.rawQuery)return this.$q.reject({message:"Query missing in annotation definition"});var r={refId:t.annotation.name,datasourceId:this.id,rawSql:this.templateSrv.replace(t.annotation.rawQuery,t.scopedVars,this.interpolateVariable),format:"table"};return this.backendSrv.datasourceRequest({url:"/api/tsdb/query",method:"POST",data:{from:t.range.from.valueOf().toString(),to:t.range.to.valueOf().toString(),queries:[r]}}).then(function(r){return e.responseParser.transformAnnotationResponse(t,r)})},t.prototype.metricFindQuery=function(t,e){var r=this,n="tempvar";e&&e.variable&&e.variable.name&&(n=e.variable.name);var a={refId:n,datasourceId:this.id,rawSql:this.templateSrv.replace(t,{},this.interpolateVariable),format:"table"},i=this.timeSrv.timeRange(),s={queries:[a],from:i.from.valueOf().toString(),to:i.to.valueOf().toString()};return this.backendSrv.datasourceRequest({url:"/api/tsdb/query",method:"POST",data:s}).then(function(t){return r.responseParser.parseMetricFindQueryResult(n,t)})},t.prototype.getVersion=function(){return this.metricFindQuery("SELECT current_setting('server_version_num')::int/100",{})},t.prototype.getTimescaleDBVersion=function(){return this.metricFindQuery("SELECT extversion FROM pg_extension WHERE extname = 'timescaledb'",{})},t.prototype.testDatasource=function(){return this.metricFindQuery("SELECT 1",{}).then(function(t){return{status:"success",message:"Database Connection OK"}}).catch(function(t){return console.log(t),t.data&&t.data.message?{status:"error",message:t.data.message}:{status:"error",message:t.status}})},t}(),ma=function(){function t(t,e){this.target=t,this.queryModel=e}return t.prototype.getOperators=function(t){switch(t){case"float4":case"float8":return["=","!=","<","<=",">",">="];case"text":case"varchar":case"char":return["=","!=","<","<=",">",">=","IN","NOT IN","LIKE","NOT LIKE","~","~*","!~","!~*"];default:return["=","!=","<","<=",">",">=","IN","NOT IN"]}},t.prototype.quoteIdentAsLiteral=function(t){return this.queryModel.quoteLiteral(this.queryModel.unquoteIdentifier(t))},t.prototype.findMetricTable=function(){var t="\nSELECT\n\tquote_ident(table_name) as table_name,\n\t( SELECT\n\t    quote_ident(column_name) as column_name\n\t  FROM information_schema.columns c\n    WHERE\n      c.table_schema = t.table_schema AND\n      c.table_name = t.table_name AND\n      udt_name IN ('timestamptz','timestamp')\n    ORDER BY ordinal_position LIMIT 1\n  ) AS time_column,\n  ( SELECT\n      quote_ident(column_name) AS column_name\n    FROM information_schema.columns c\n    WHERE\n      c.table_schema = t.table_schema AND\n      c.table_name = t.table_name AND\n      udt_name='float8'\n    ORDER BY ordinal_position LIMIT 1\n  ) AS value_column\nFROM information_schema.tables t\nWHERE ";return t+=this.buildSchemaConstraint(),t+=" AND\n  EXISTS\n  ( SELECT 1\n    FROM information_schema.columns c\n    WHERE\n      c.table_schema = t.table_schema AND\n      c.table_name = t.table_name AND\n      udt_name IN ('timestamptz','timestamp')\n  ) AND\n  EXISTS\n  ( SELECT 1\n    FROM information_schema.columns c\n    WHERE\n      c.table_schema = t.table_schema AND\n      c.table_name = t.table_name AND\n      udt_name='float8'\n  )\nLIMIT 1\n;"},t.prototype.buildSchemaConstraint=function(){return"\ntable_schema IN (\n  SELECT\n    CASE WHEN trim(s[i]) = '\"$user\"' THEN user ELSE trim(s[i]) END\n  FROM\n    generate_series(\n      array_lower(string_to_array(current_setting('search_path'),','),1),\n      array_upper(string_to_array(current_setting('search_path'),','),1)\n    ) as i,\n    string_to_array(current_setting('search_path'),',') s\n)"},t.prototype.buildTableConstraint=function(t){var e="";if(t.includes(".")){var r=t.split(".");return e="table_schema = "+this.quoteIdentAsLiteral(r[0]),e+=" AND table_name = "+this.quoteIdentAsLiteral(r[1])}return e=this.buildSchemaConstraint(),e+=" AND table_name = "+this.quoteIdentAsLiteral(t)},t.prototype.buildTableQuery=function(){var t="SELECT quote_ident(table_name) FROM information_schema.tables WHERE ";return t+=this.buildSchemaConstraint(),t+=" ORDER BY table_name"},t.prototype.buildColumnQuery=function(t){var e="SELECT quote_ident(column_name) FROM information_schema.columns WHERE ";switch(e+=this.buildTableConstraint(this.target.table),t){case"time":e+=" AND data_type IN ('timestamp without time zone','timestamp with time zone','bigint','integer','double precision','real')";break;case"metric":e+=" AND data_type IN ('text','character','character varying')";break;case"value":e+=" AND data_type IN ('bigint','integer','double precision','real')",e+=" AND column_name <> "+this.quoteIdentAsLiteral(this.target.timeColumn);break;case"group":e+=" AND data_type IN ('text','character','character varying')"}return e+=" ORDER BY column_name"},t.prototype.buildValueQuery=function(t){var e="SELECT DISTINCT quote_literal("+t+")";return e+=" FROM "+this.target.table,e+=" WHERE $__timeFilter("+this.target.timeColumn+")",e+=" AND "+t+" IS NOT NULL",e+=" ORDER BY 1 LIMIT 100"},t.prototype.buildDatatypeQuery=function(t){var e="SELECT udt_name FROM information_schema.columns WHERE ";return e+=this.buildTableConstraint(this.target.table),e+=" AND column_name = "+this.quoteIdentAsLiteral(t)},t.prototype.buildAggregateQuery=function(){var t="SELECT DISTINCT proname FROM pg_aggregate ";return t+="INNER JOIN pg_proc ON pg_aggregate.aggfnoid = pg_proc.oid ",t+="INNER JOIN pg_type ON pg_type.oid=pg_proc.prorettype ",t+="WHERE pronargs=1 AND typname IN ('float8') AND aggkind='n' ORDER BY 1"},t}(),ga=[];function va(t){ga[t.type]=new ra(t)}va({type:"column",style:"label",params:[{type:"column",dynamicLookup:!0}],defaultParams:["value"]}),va({type:"expression",style:"expression",label:"Expr:",params:[{name:"left",type:"string",dynamicLookup:!0},{name:"op",type:"string",dynamicLookup:!0},{name:"right",type:"string",dynamicLookup:!0}],defaultParams:["value","=","value"]}),va({type:"macro",style:"label",label:"Macro:",params:[],defaultParams:[]}),va({type:"aggregate",style:"label",params:[{name:"name",type:"string",options:["avg","count","min","max","sum","stddev","variance"]}],defaultParams:["avg"]}),va({type:"percentile",label:"Aggregate:",style:"label",params:[{name:"name",type:"string",options:["percentile_cont","percentile_disc"]},{name:"fraction",type:"number",options:["0.5","0.75","0.9","0.95","0.99"]}],defaultParams:["percentile_cont","0.95"]}),va({type:"alias",style:"label",params:[{name:"name",type:"string",quote:"double"}],defaultParams:["alias"]}),va({type:"time",style:"function",label:"time",params:[{name:"interval",type:"interval",options:["$__interval","1s","10s","1m","5m","10m","15m","1h"]},{name:"fill",type:"string",options:["none","NULL","previous","0"]}],defaultParams:["$__interval","none"]}),va({type:"window",style:"label",params:[{name:"function",type:"string",options:["delta","increase","rate","sum"]}],defaultParams:["increase"]}),va({type:"moving_window",style:"label",label:"Moving Window:",params:[{name:"function",type:"string",options:["avg"]},{name:"window_size",type:"number",options:["3","5","7","10","20"]}],defaultParams:["avg","5"]});var ba={create:function(t){var e=ga[t.type];return e?new na(t,e):null}},ya="SELECT\n  $__time(time_column),\n  value1\nFROM\n  metric_table\nWHERE\n  $__timeFilter(time_column)\n",wa=function(t){function e(e,r,n,a,i){var s=t.call(this,e,r)||this;return s.templateSrv=n,s.$q=a,s.uiSegmentSrv=i,s.target=s.target,s.queryModel=new ha(s.target,n,s.panel.scopedVars),s.metaBuilder=new ma(s.target,s.queryModel),s.updateProjection(),s.formats=[{text:"Time series",value:"time_series"},{text:"Table",value:"table"}],s.target.rawSql||("table"===s.panelCtrl.panel.type?(s.target.format="table",s.target.rawSql="SELECT 1",s.target.rawQuery=!0):(s.target.rawSql=ya,s.datasource.metricFindQuery(s.metaBuilder.findMetricTable()).then(function(t){if(t.length>0){s.target.table=t[0].text;var e=s.uiSegmentSrv.newSegment(s.target.table);s.tableSegment.html=e.html,s.tableSegment.value=e.value,s.target.timeColumn=t[1].text,e=s.uiSegmentSrv.newSegment(s.target.timeColumn),s.timeColumnSegment.html=e.html,s.timeColumnSegment.value=e.value,s.target.timeColumnType="timestamp",s.target.select=[[{type:"column",params:[t[2].text]}]],s.updateProjection(),s.panelCtrl.refresh()}}))),s.target.table?s.tableSegment=i.newSegment(s.target.table):s.tableSegment=i.newSegment({value:"select table",fake:!0}),s.timeColumnSegment=i.newSegment(s.target.timeColumn),s.metricColumnSegment=i.newSegment(s.target.metricColumn),s.buildSelectMenu(),s.whereAdd=s.uiSegmentSrv.newPlusButton(),s.groupAdd=s.uiSegmentSrv.newPlusButton(),s.panelCtrl.events.on("data-received",s.onDataReceived.bind(s),e),s.panelCtrl.events.on("data-error",s.onDataError.bind(s),e),s}return e.$inject=["$scope","$injector","templateSrv","$q","uiSegmentSrv"],J.c(e,t),e.prototype.updateProjection=function(){this.selectParts=I.a.map(this.target.select,function(t){return I.a.map(t,ba.create).filter(function(t){return t})}),this.whereParts=I.a.map(this.target.where,ba.create).filter(function(t){return t}),this.groupParts=I.a.map(this.target.group,ba.create).filter(function(t){return t})},e.prototype.updatePersistedParts=function(){this.target.select=I.a.map(this.selectParts,function(t){return I.a.map(t,function(t){return{type:t.def.type,datatype:t.datatype,params:t.params}})}),this.target.where=I.a.map(this.whereParts,function(t){return{type:t.def.type,datatype:t.datatype,name:t.name,params:t.params}}),this.target.group=I.a.map(this.groupParts,function(t){return{type:t.def.type,datatype:t.datatype,params:t.params}})},e.prototype.buildSelectMenu=function(){this.selectMenu=[];var t={text:"Aggregate Functions",value:"aggregate",submenu:[{text:"Average",value:"avg"},{text:"Count",value:"count"},{text:"Maximum",value:"max"},{text:"Minimum",value:"min"},{text:"Sum",value:"sum"},{text:"Standard deviation",value:"stddev"},{text:"Variance",value:"variance"}]};if(!0===this.datasource.jsonData.timescaledb&&(t.submenu.push({text:"First",value:"first"}),t.submenu.push({text:"Last",value:"last"})),this.selectMenu.push(t),this.datasource.jsonData.postgresVersion>=904){this.selectMenu.push({text:"Ordered-Set Aggregate Functions",value:"percentile",submenu:[{text:"Percentile (continuous)",value:"percentile_cont"},{text:"Percentile (discrete)",value:"percentile_disc"}]})}this.selectMenu.push({text:"Window Functions",value:"window",submenu:[{text:"Delta",value:"delta"},{text:"Increase",value:"increase"},{text:"Rate",value:"rate"},{text:"Sum",value:"sum"},{text:"Moving Average",value:"avg",type:"moving_window"}]}),this.selectMenu.push({text:"Alias",value:"alias"}),this.selectMenu.push({text:"Column",value:"column"})},e.prototype.toggleEditorMode=function(){var t=this;this.target.rawQuery?bt.a.emit("confirm-modal",{title:"Warning",text2:"Switching to query builder may overwrite your raw SQL.",icon:"fa-exclamation",yesText:"Switch",onConfirm:function(){t.target.rawQuery=!t.target.rawQuery}}):this.target.rawQuery=!this.target.rawQuery},e.prototype.resetPlusButton=function(t){var e=this.uiSegmentSrv.newPlusButton();t.html=e.html,t.value=e.value},e.prototype.getTableSegments=function(){return this.datasource.metricFindQuery(this.metaBuilder.buildTableQuery()).then(this.transformToSegments({})).catch(this.handleQueryError.bind(this))},e.prototype.tableChanged=function(){var t=this;this.target.table=this.tableSegment.value,this.target.where=[],this.target.group=[],this.updateProjection();var e=this.uiSegmentSrv.newSegment("none");this.metricColumnSegment.html=e.html,this.metricColumnSegment.value=e.value,this.target.metricColumn="none";var r=this.datasource.metricFindQuery(this.metaBuilder.buildColumnQuery("time")).then(function(e){if(e.length>0&&!I.a.find(e,function(e){return e.text===t.target.timeColumn})){var r=t.uiSegmentSrv.newSegment(e[0].text);t.timeColumnSegment.html=r.html,t.timeColumnSegment.value=r.value}return t.timeColumnChanged(!1)}),n=this.datasource.metricFindQuery(this.metaBuilder.buildColumnQuery("value")).then(function(e){e.length>0&&(t.target.select=[[{type:"column",params:[e[0].text]}]],t.updateProjection())});this.$q.all([r,n]).then(function(){t.panelCtrl.refresh()})},e.prototype.getTimeColumnSegments=function(){return this.datasource.metricFindQuery(this.metaBuilder.buildColumnQuery("time")).then(this.transformToSegments({})).catch(this.handleQueryError.bind(this))},e.prototype.timeColumnChanged=function(t){var e=this;return this.target.timeColumn=this.timeColumnSegment.value,this.datasource.metricFindQuery(this.metaBuilder.buildDatatypeQuery(this.target.timeColumn)).then(function(r){if(1===r.length){e.target.timeColumnType!==r[0].text&&(e.target.timeColumnType=r[0].text);var n=void 0;n=e.queryModel.hasUnixEpochTimecolumn()?ba.create({type:"macro",name:"$__unixEpochFilter",params:[]}):ba.create({type:"macro",name:"$__timeFilter",params:[]}),e.whereParts.length>=1&&"macro"===e.whereParts[0].def.type?e.whereParts[0]=n:e.whereParts.splice(0,0,n)}e.updatePersistedParts(),!1!==t&&e.panelCtrl.refresh()})},e.prototype.getMetricColumnSegments=function(){return this.datasource.metricFindQuery(this.metaBuilder.buildColumnQuery("metric")).then(this.transformToSegments({addNone:!0})).catch(this.handleQueryError.bind(this))},e.prototype.metricColumnChanged=function(){this.target.metricColumn=this.metricColumnSegment.value,this.panelCtrl.refresh()},e.prototype.onDataReceived=function(t){this.lastQueryMeta=null,this.lastQueryError=null;var e=I.a.find(t,{refId:this.target.refId});e&&(this.lastQueryMeta=e.meta)},e.prototype.onDataError=function(t){if(t.data&&t.data.results){var e=t.data.results[this.target.refId];e&&(this.lastQueryMeta=e.meta,this.lastQueryError=e.error)}},e.prototype.transformToSegments=function(t){var e=this;return function(r){var n=I.a.map(r,function(t){return e.uiSegmentSrv.newSegment({value:t.text,expandable:t.expandable})});if(t.addTemplateVars)for(var a=0,i=e.templateSrv.variables;a<i.length;a++){var s=i[a],o=void 0;o="$"+s.name,t.templateQuoter&&!1===s.multi&&(o=t.templateQuoter(o)),n.unshift(e.uiSegmentSrv.newSegment({type:"template",value:o,expandable:!0}))}return t.addNone&&n.unshift(e.uiSegmentSrv.newSegment({type:"template",value:"none",expandable:!0})),n}},e.prototype.findAggregateIndex=function(t){return I.a.findIndex(t,function(t){return"aggregate"===t.def.type||"percentile"===t.def.type})},e.prototype.findWindowIndex=function(t){return I.a.findIndex(t,function(t){return"window"===t.def.type||"moving_window"===t.def.type})},e.prototype.addSelectPart=function(t,e,r){var n=e.value;r&&r.type&&(n=r.type);var a=ba.create({type:n});r&&(a.params[0]=r.value);var i=!1;switch(n){case"column":var s=I.a.map(t,function(t){return ba.create({type:t.def.type,params:I.a.clone(t.params)})});this.selectParts.push(s);break;case"percentile":case"aggregate":0===this.target.group.length&&this.addGroup("time","$__interval");var o=this.findAggregateIndex(t);-1!==o?t[o]=a:t.splice(1,0,a),I.a.find(t,function(t){return"alias"===t.def.type})||(i=!0);break;case"moving_window":case"window":var l=this.findWindowIndex(t);if(-1!==l)t[l]=a;else{var c=this.findAggregateIndex(t);-1!==c?t.splice(c+1,0,a):t.splice(1,0,a)}I.a.find(t,function(t){return"alias"===t.def.type})||(i=!0);break;case"alias":i=!0}i&&(a=ba.create({type:"alias",params:[t[0].params[0].replace(/"/g,"")]}),"alias"===t[t.length-1].def.type?t[t.length-1]=a:t.push(a)),this.updatePersistedParts(),this.panelCtrl.refresh()},e.prototype.removeSelectPart=function(t,e){if("column"===e.def.type){if(this.selectParts.length>1){var r=I.a.indexOf(this.selectParts,t);this.selectParts.splice(r,1)}}else{var n=I.a.indexOf(t,e);t.splice(n,1)}this.updatePersistedParts()},e.prototype.handleSelectPartEvent=function(t,e,r){switch(r.name){case"get-param-options":switch(e.def.type){case"aggregate":return this.datasource.metricFindQuery(this.metaBuilder.buildAggregateQuery()).then(this.transformToSegments({})).catch(this.handleQueryError.bind(this));case"column":return this.datasource.metricFindQuery(this.metaBuilder.buildColumnQuery("value")).then(this.transformToSegments({})).catch(this.handleQueryError.bind(this))}case"part-param-changed":this.updatePersistedParts(),this.panelCtrl.refresh();break;case"action":this.removeSelectPart(t,e),this.panelCtrl.refresh();break;case"get-part-actions":return this.$q.when([{text:"Remove",value:"remove-part"}])}},e.prototype.handleGroupPartEvent=function(t,e,r){switch(r.name){case"get-param-options":return this.datasource.metricFindQuery(this.metaBuilder.buildColumnQuery()).then(this.transformToSegments({})).catch(this.handleQueryError.bind(this));case"part-param-changed":this.updatePersistedParts(),this.panelCtrl.refresh();break;case"action":this.removeGroup(t,e),this.panelCtrl.refresh();break;case"get-part-actions":return this.$q.when([{text:"Remove",value:"remove-part"}])}},e.prototype.addGroup=function(t,e){var r=[e];"time"===t&&(r=["$__interval","none"]);var n=ba.create({type:t,params:r});"time"===t?this.groupParts.splice(0,0,n):this.groupParts.push(n);for(var a=0,i=this.selectParts;a<i.length;a++){var s=i[a];if(!s.some(function(t){return"aggregate"===t.def.type})){var o=ba.create({type:"aggregate",params:["avg"]});if(s.splice(1,0,o),!s.some(function(t){return"alias"===t.def.type})){var l=ba.create({type:"alias",params:[s[0].part.params[0]]});s.push(l)}}}this.updatePersistedParts()},e.prototype.removeGroup=function(t,e){"time"===t.def.type&&(this.selectParts=I.a.map(this.selectParts,function(t){return I.a.filter(t,function(t){return"aggregate"!==t.def.type&&"percentile"!==t.def.type})})),this.groupParts.splice(e,1),this.updatePersistedParts()},e.prototype.handleWherePartEvent=function(t,e,r,n){var a=this;switch(r.name){case"get-param-options":switch(r.param.name){case"left":return this.datasource.metricFindQuery(this.metaBuilder.buildColumnQuery()).then(this.transformToSegments({})).catch(this.handleQueryError.bind(this));case"right":return["int4","int8","float4","float8","timestamp","timestamptz"].indexOf(e.datatype)>-1?this.$q.when([]):this.datasource.metricFindQuery(this.metaBuilder.buildValueQuery(e.params[0])).then(this.transformToSegments({addTemplateVars:!0,templateQuoter:function(t){return a.queryModel.quoteLiteral(t)}})).catch(this.handleQueryError.bind(this));case"op":return this.$q.when(this.uiSegmentSrv.newOperators(this.metaBuilder.getOperators(e.datatype)));default:return this.$q.when([])}case"part-param-changed":this.updatePersistedParts(),this.datasource.metricFindQuery(this.metaBuilder.buildDatatypeQuery(e.params[0])).then(function(t){1===t.length&&(e.datatype=t[0].text)}),this.panelCtrl.refresh();break;case"action":t.splice(n,1),this.updatePersistedParts(),this.panelCtrl.refresh();break;case"get-part-actions":return this.$q.when([{text:"Remove",value:"remove-part"}])}},e.prototype.getWhereOptions=function(){var t=[];return this.queryModel.hasUnixEpochTimecolumn()?t.push(this.uiSegmentSrv.newSegment({type:"macro",value:"$__unixEpochFilter"})):t.push(this.uiSegmentSrv.newSegment({type:"macro",value:"$__timeFilter"})),t.push(this.uiSegmentSrv.newSegment({type:"expression",value:"Expression"})),this.$q.when(t)},e.prototype.addWhereAction=function(t,e){switch(this.whereAdd.type){case"macro":var r=ba.create({type:"macro",name:this.whereAdd.value,params:[]});this.whereParts.length>=1&&"macro"===this.whereParts[0].def.type?this.whereParts[0]=r:this.whereParts.splice(0,0,r);break;default:this.whereParts.push(ba.create({type:"expression",params:["value","=","value"]}))}this.updatePersistedParts(),this.resetPlusButton(this.whereAdd),this.panelCtrl.refresh()},e.prototype.getGroupOptions=function(){var t=this;return this.datasource.metricFindQuery(this.metaBuilder.buildColumnQuery("group")).then(function(e){var r=[];t.queryModel.hasTimeGroup()||r.push(t.uiSegmentSrv.newSegment({type:"time",value:"time($__interval,none)"}));for(var n=0,a=e;n<a.length;n++){var i=a[n];r.push(t.uiSegmentSrv.newSegment({type:"column",value:i.text}))}return r}).catch(this.handleQueryError.bind(this))},e.prototype.addGroupAction=function(){this.groupAdd.value,this.addGroup(this.groupAdd.type,this.groupAdd.value),this.resetPlusButton(this.groupAdd),this.panelCtrl.refresh()},e.prototype.handleQueryError=function(t){return this.error=t.message||"Failed to issue metric query",[]},e.templateUrl="partials/query.editor.html",e}(Ht),xa=function(){function t(t,e){this.postgresVersions=[{name:"9.3",value:903},{name:"9.4",value:904},{name:"9.5",value:905},{name:"9.6",value:906},{name:"10",value:1e3}],this.datasourceSrv=e,this.current.jsonData.sslmode=this.current.jsonData.sslmode||"verify-full",this.current.jsonData.postgresVersion=this.current.jsonData.postgresVersion||903,this.showTimescaleDBHelp=!1,this.autoDetectFeatures()}return t.$inject=["$scope","datasourceSrv"],t.prototype.autoDetectFeatures=function(){var t=this;this.current.id&&this.datasourceSrv.loadDatasource(this.current.name).then(function(e){return e.getVersion().then(function(r){(r=Number(r[0].text))>=906&&e.getTimescaleDBVersion().then(function(e){1===e.length&&(t.current.jsonData.timescaledb=!0)});var n=Math.trunc(r/100),a=r%100,i=String(n);r<1e3&&(i=String(n)+"."+String(a)),I.a.find(t.postgresVersions,function(t){return t.value===r})||t.postgresVersions.push({name:i,value:r}),t.current.jsonData.postgresVersion=r})})},t.prototype.toggleTimescaleDBHelp=function(){this.showTimescaleDBHelp=!this.showTimescaleDBHelp},t.templateUrl="partials/config.html",t}(),Sa="SELECT\n  extract(epoch from time_column) AS time,\n  text_column as text,\n  tags_column as tags\nFROM\n  metric_table\nWHERE\n  $__timeFilter(time_column)\n",ka=function(){function t(){this.annotation.rawQuery=this.annotation.rawQuery||Sa}return t.templateUrl="partials/annotations.editor.html",t}(),Ca=function(){function t(t,e,r){this.datasource=t,this.query=e,this.range=r.timeRange()}return t.prototype.process=function(){var t=this.query.match(/^label_values\((?:(.+),\s*)?([a-zA-Z_][a-zA-Z0-9_]*)\)\s*$/);if(t)return t[1]?this.labelValuesQuery(t[2],t[1]):this.labelValuesQuery(t[2],null);var e=this.query.match(/^metrics\((.+)\)\s*$/);if(e)return this.metricNameQuery(e[1]);var r=this.query.match(/^query_result\((.+)\)\s*$/);return r?this.queryResultQuery(r[1]):this.metricNameAndLabelsQuery(this.query)},t.prototype.labelValuesQuery=function(t,e){var r;if(e){var n=this.datasource.getPrometheusTime(this.range.from,!1),a=this.datasource.getPrometheusTime(this.range.to,!0);return r="/api/v1/series?match[]="+encodeURIComponent(e)+"&start="+n+"&end="+a,this.datasource.metadataRequest(r).then(function(e){var r=I.a.map(e.data.data,function(e){return e[t]||""}).filter(function(t){return""!==t});return I.a.uniq(r).map(function(t){return{text:t,expandable:!0}})})}return r="/api/v1/label/"+t+"/values",this.datasource.metadataRequest(r).then(function(t){return I.a.map(t.data.data,function(t){return{text:t}})})},t.prototype.metricNameQuery=function(t){return this.datasource.metadataRequest("/api/v1/label/__name__/values").then(function(e){return I.a.chain(e.data.data).filter(function(e){return new RegExp(t).test(e)}).map(function(t){return{text:t,expandable:!0}}).value()})},t.prototype.queryResultQuery=function(t){var e=this.datasource.getPrometheusTime(this.range.to,!0);return this.datasource.performInstantQuery({expr:t},e).then(function(t){return I.a.map(t.data.data.result,function(t){var e=t.metric.__name__||"";return delete t.metric.__name__,e+="{"+I.a.map(t.metric,function(t,e){return e+'="'+t+'"'}).join(",")+"}",{text:e+=" "+t.value[1]+" "+1e3*t.value[0],expandable:!0}})})},t.prototype.metricNameAndLabelsQuery=function(t){var e=this.datasource.getPrometheusTime(this.range.from,!1),r=this.datasource.getPrometheusTime(this.range.to,!0),n="/api/v1/series?match[]="+encodeURIComponent(t)+"&start="+e+"&end="+r,a=this;return this.datasource.metadataRequest(n).then(function(t){return I.a.map(t.data.data,function(t){return{text:a.datasource.getOriginalMetricName(t),expandable:!0}})})},t}(),Ta=function(){function t(t){this.templateSrv=t}return t.prototype.transform=function(t,e){var r=t.data.data.result;if("table"===e.format)return[this.transformMetricDataToTable(r,e.responseListLength,e.refId,e.valueWithRefId)];if("heatmap"===e.format){var n=[];r.sort(Ea);for(var a=0,i=r;a<i.length;a++){var s=i[a];n.push(this.transformMetricData(s,e,e.start,e.end))}return n=this.transformToHistogramOverTime(n)}n=[];for(var o=0,l=r;o<l.length;o++){s=l[o];"matrix"===t.data.data.resultType?n.push(this.transformMetricData(s,e,e.start,e.end)):"vector"===t.data.data.resultType&&n.push(this.transformInstantMetricData(s,e))}return n},t.prototype.transformMetricData=function(t,e,r,n){var a,i=[];a=this.createMetricLabel(t.metric,e);var s=1e3*parseInt(e.step,10),o=1e3*r;if(void 0===t.values)throw new Error("Prometheus heatmap error: data should be a time series");for(var l=0,c=t.values;l<c.length;l++){var u=c[l],d=parseFloat(u[1]);I.a.isNaN(d)&&(d=null);for(var p=1e3*parseFloat(u[0]),h=o;h<p;h+=s)i.push([null,h]);o=p+s,i.push([d,p])}var f=1e3*n;for(h=o;h<=f;h+=s)i.push([null,h]);return{datapoints:i,query:e.query,target:a}},t.prototype.transformMetricDataToTable=function(t,e,r,n){var a,i,s=new ne.a,o={};if(0===t.length)return s;I.a.each(t,function(t){for(var e in t.metric)o.hasOwnProperty(e)||(o[e]=1)});var l=I.a.keys(o).sort();s.columns.push({text:"Time",type:"time"}),I.a.each(l,function(t,e){o[t]=e+1,s.columns.push({text:t,filterable:!t.startsWith("__")})});var c=e>1||n?"Value #"+r:"Value";return s.columns.push({text:c}),I.a.each(t,function(t){if(t.value&&(t.values=[t.value]),t.values)for(a=0;a<t.values.length;a++){var e=t.values[a],r=[1e3*e[0]];if(t.metric)for(i=0;i<l.length;i++){var n=l[i];t.metric.hasOwnProperty(n)?r.push(t.metric[n]):r.push("")}r.push(parseFloat(e[1])),s.rows.push(r)}}),s},t.prototype.transformInstantMetricData=function(t,e){var r,n=[];return r=this.createMetricLabel(t.metric,e),n.push([parseFloat(t.value[1]),1e3*t.value[0]]),{target:r,datapoints:n,labels:t.metric}},t.prototype.createMetricLabel=function(t,e){var r="";return(r=I.a.isUndefined(e)||I.a.isEmpty(e.legendFormat)?this.getOriginalMetricName(t):this.renderTemplate(this.templateSrv.replace(e.legendFormat),t))&&"{}"!==r||(r=e.query),r},t.prototype.renderTemplate=function(t,e){return t.replace(/\{\{\s*(.+?)\s*\}\}/g,function(t,r){return e[r]?e[r]:r})},t.prototype.getOriginalMetricName=function(t){var e=t.__name__||"";return delete t.__name__,e+"{"+I.a.map(I.a.toPairs(t),function(t){return t[0]+'="'+t[1]+'"'}).join(",")+"}"},t.prototype.transformToHistogramOverTime=function(t){for(var e=t.length-1;e>0;e--){var r=t[e].datapoints,n=t[e-1].datapoints;if(!r||!n)throw new Error("Prometheus heatmap transform error: data should be a time series");for(var a=0;a<r.length;a++){var i=n[a]||[0];r[a][0]-=i[0]}}return t},t}();function Ea(t,e){var r,n;try{r=_a(t.metric.le),n=_a(e.metric.le)}catch(t){return console.log(t),0}return r>n?1:r<n?-1:0}function _a(t){return"+Inf"===t?1/0:Number(t)}var Ma=["job","instance"],Aa=864e5,Pa=function(t){return{label:t}},$a=function(t){return t.kind="function",t};var Da=function(t){function e(e,r){var n=t.call(this)||this;return n.cleanText=function(t){return t.replace(/[{}[\]="(),!~+\-*/^%]/g,"").trim()},n.request=function(t){return n.datasource.metadataRequest(t)},n.start=function(){return n.startTask||(n.startTask=n.fetchMetricNames().then(function(){return[n.fetchHistogramMetrics()]})),n.startTask},n.datasource=e,n.histogramMetrics=[],n.labelKeys={},n.labelValues={},n.metrics=[],Object.assign(n,r),n}return J.c(e,t),e.prototype.getSyntax=function(){return bn},e.prototype.provideCompletionItems=function(t,e){var r=t.prefix,n=t.wrapperClasses,a=t.text,i=t.value,s=0===i.document.text.length,o=i.document.getTextsAtRangeAsArray(i.selection),l=1===o.length?o[0]:null,c=l?l.text[i.selection.anchorOffset]:null,u=n.length>3,d=r&&!u,p=!c||")"===c,h=""===r&&!a.match(/^[\]})\s]+$/)&&p,f=a.match(/[+\-*/^%]/);return I.a.includes(n,"context-range")?this.getRangeCompletionItems():I.a.includes(n,"context-labels")?this.getLabelCompletionItems.apply(this,arguments):I.a.includes(n,"context-aggregation")?this.getAggregationCompletionItems.apply(this,arguments):s?this.getEmptyCompletionItems(e||{}):d||h||f?this.getTermCompletionItems():{suggestions:[]}},e.prototype.getEmptyCompletionItems=function(t){var e=t.history,r=[];if(e&&e.length>0){var n=I.a.chain(e).uniqBy("query").take(5).map(function(t){return t.query}).map(Pa).map(function(t){return function(t,e){var r=Date.now()-Aa,n=e.filter(function(e){return e.ts>r&&e.query===t.label}),a=n.length,i=n[0],s="Queried "+a+" times in the last 24h.";return i&&(s=s+" Last queried "+H()(i.ts).fromNow()+"."),J.a({},t,{documentation:s})}(t,e)}).value();r.push({prefixMatch:!0,skipSort:!0,label:"History",items:n})}var a=this.getTermCompletionItems();return{suggestions:r=r.concat(a.suggestions)}},e.prototype.getTermCompletionItems=function(){var t=this.metrics,e=[];return e.push({prefixMatch:!0,label:"Functions",items:vn.map($a)}),t&&t.length>0&&e.push({label:"Metrics",items:t.map(Pa)}),{suggestions:e}},e.prototype.getRangeCompletionItems=function(){return{context:"context-range",suggestions:[{label:"Range vector",items:hn.slice().map(Pa)}]}},e.prototype.getAggregationCompletionItems=function(t){var e,r=t.value,n=[],a=r.document.getBlocks().reduce(function(t,n){var a=n.getText();return r.anchorBlock.key===n.key&&(e=r.anchorOffset+t.length),t+=a},""),i=a.lastIndexOf("(",e),s=a.lastIndexOf("(",i-1),o=a.indexOf(")",s);if(-1===s){var l=a.indexOf(")",e);o=a.indexOf(")",l+1),s=a.lastIndexOf("(",o)}var c={refresher:null,suggestions:n,context:"context-aggregation"};if(-1===s)return c;var u=a.slice(s+1,o),d=gn(u=u.replace(/\[[^\]]+\]$/,""),u.length-2).selector,p=this.labelKeys[d];return p?n.push({label:"Labels",items:p.map(Pa)}):c.refresher=this.fetchSeriesLabels(d),c},e.prototype.getLabelCompletionItems=function(t){var e,r,n,a=this,i=t.text,s=t.wrapperClasses,o=t.labelKey,l=t.value,c=null,u=[],d=l.anchorBlock.getText(),p=l.anchorOffset;try{r=(n=gn(d,p)).selector}catch(t){r="{}"}var h=r.indexOf("__name__=")>-1,f=n?n.labelKeys:[];if(i&&i.match(/^!?=~?/)||I.a.includes(s,"attr-value")){if(o&&this.labelValues[r]&&this.labelValues[r][o]){var m=this.labelValues[r][o];e="context-label-values",u.push({label:'Label values for "'+o+'"',items:m.map(Pa)})}}else{var g=this.labelKeys[r]||(h?null:Ma);if(g){var v=I.a.difference(g,f);v.length>0&&(e="context-labels",u.push({label:"Labels",items:v.map(Pa)}))}}return r&&!this.labelValues[r]&&(c="{}"===r?Promise.all(Ma.map(function(t){return a.fetchLabelValues(t)})):this.fetchSeriesLabels(r,!h)),{context:e,refresher:c,suggestions:u}},e.prototype.fetchMetricNames=function(){return J.b(this,void 0,void 0,function(){var t,e,r,n;return J.d(this,function(a){switch(a.label){case 0:t="/api/v1/label/__name__/values",a.label=1;case 1:return a.trys.push([1,4,,5]),[4,this.request(t)];case 2:return[4,(e=a.sent()).data||e.json()];case 3:return r=a.sent(),this.metrics=r.data,[3,5];case 4:return n=a.sent(),console.error(n),[3,5];case 5:return[2]}})})},e.prototype.fetchHistogramMetrics=function(){return J.b(this,void 0,void 0,function(){var t;return J.d(this,function(e){switch(e.label){case 0:return[4,this.fetchSeriesLabels('{le!=""}',!0)];case 1:return e.sent(),(t=this.labelValues['{le!=""}'])&&t.__name__&&(this.histogramMetrics=t.__name__.slice().sort()),[2]}})})},e.prototype.fetchLabelValues=function(t){return J.b(this,void 0,void 0,function(){var e,r,n,a,i,s,o,l;return J.d(this,function(c){switch(c.label){case 0:n="/api/v1/label/"+t+"/values",c.label=1;case 1:return c.trys.push([1,4,,5]),[4,this.request(n)];case 2:return[4,(a=c.sent()).data||a.json()];case 3:return i=c.sent(),s=this.labelValues["{}"],o=J.a({},s,((e={})[t]=i.data,e)),this.labelValues=J.a({},this.labelValues,((r={})["{}"]=o,r)),[3,5];case 4:return l=c.sent(),console.error(l),[3,5];case 5:return[2]}})})},e.prototype.fetchSeriesLabels=function(t,e){return J.b(this,void 0,void 0,function(){var r,n,a,i,s,o,l,c,u;return J.d(this,function(d){switch(d.label){case 0:a="/api/v1/series?match[]="+t,d.label=1;case 1:return d.trys.push([1,4,,5]),[4,this.request(a)];case 2:return[4,(i=d.sent()).data||i.json()];case 3:return s=d.sent(),o=function(t,e){void 0===e&&(e=!1);var r={};return t.forEach(function(t){var n=t.__name__,a=J.e(t,["__name__"]);e&&(r.__name__=r.__name__||[],-1===r.__name__.indexOf(n)&&r.__name__.push(n)),Object.keys(a).forEach(function(t){r[t]||(r[t]=[]),-1===r[t].indexOf(a[t])&&r[t].push(a[t])})}),{values:r,keys:Object.keys(r)}}(s.data,e),l=o.keys,c=o.values,this.labelKeys=J.a({},this.labelKeys,((r={})[t]=l,r)),this.labelValues=J.a({},this.labelValues,((n={})[t]=c,n)),[3,5];case 4:return u=d.sent(),console.error(u),[3,5];case 5:return[2]}})})},e}(pn),Oa="by|without|on|ignoring|group_left|group_right",Ia=[Oa,"count|count_values|min|max|avg|sum|stddev|stdvar|bottomk|topk|quantile","true|false|null|__name__|job","abs|absent|ceil|changes|clamp_max|clamp_min|count_scalar|day_of_month|day_of_week|days_in_month|delta|deriv","drop_common_labels|exp|floor|histogram_quantile|holt_winters|hour|idelta|increase|irate|label_replace|ln|log2","log10|minute|month|predict_linear|rate|resets|round|scalar|sort|sort_desc|sqrt|time|vector|year|avg_over_time","min_over_time|max_over_time|sum_over_time|count_over_time|quantile_over_time|stddev_over_time|stdvar_over_time"].join("|").split("|"),Na=/([A-Za-z:][\w:]*)\b(?![\(\]{=!",])/g,Fa=/{([^{]*)}/g;var qa=/(\w+)\s*(=|!=|=~|!~)\s*("[^"]*")/g;function La(t,e,r,n){var a=[];if(t)for(var i=qa.exec(t);i;)a.push({key:i[1],operator:i[2],value:i[3]}),i=qa.exec(t);var s=n||"=";return a.push({key:e,operator:s,value:'"'+r+'"'}),I.a.chain(a).uniqWith(I.a.isEqual).compact().sortBy("key").map(function(t){return""+t.key+t.operator+t.value}).value().join(",")}var Ra=function(t,e,r,n){if(!e||!r)throw new Error("Need label to add to query.");var a;t=t.replace(Na,function(e,r,n){var i=function(t,e,r,n){var a=t.slice(e).indexOf(r),i=t.slice(e).indexOf(n);return i>-1&&(-1===a||a>i)}(t,n,"{","}"),s=a&&Oa.split("|").indexOf(a)>-1;return a=r,i||s||-1!==Ia.indexOf(r)?r:r+"{}"});for(var i=Fa.exec(t),s=[],o=0,l="";i;){var c=t.slice(o,i.index),u=La(i[1],e,r,n);o=i.index+i[1].length+2,l=t.slice(i.index+i[0].length),s.push(c,"{",u,"}"),i=Fa.exec(t)}return s.push(l),s.join("")},ja=20;function Ua(t){return"string"==typeof t?t.replace(/'/g,"\\\\'"):t}function Va(t){return"string"==typeof t?Ua(t.replace(/\\/g,"\\\\\\\\").replace(/[$^*{}\[\]+?.()]/g,"\\\\$&")):t}var Ba=function(){function t(t,e,r,n,a){this.$q=e,this.backendSrv=r,this.templateSrv=n,this.timeSrv=a,this.type="prometheus",this.editorSrc="app/features/prometheus/partials/query.editor.html",this.name=t.name,this.url=t.url,this.directUrl=t.directUrl,this.basicAuth=t.basicAuth,this.withCredentials=t.withCredentials,this.interval=t.jsonData.timeInterval||"15s",this.queryTimeout=t.jsonData.queryTimeout,this.httpMethod=t.jsonData.httpMethod||"GET",this.resultTransformer=new Ta(n),this.ruleMappings={},this.languageProvider=new Da(this)}return t.$inject=["instanceSettings","$q","backendSrv","templateSrv","timeSrv"],t.prototype.init=function(){this.loadRules()},t.prototype._request=function(t,e,r){return"GET"===(r=I.a.defaults(r||{},{url:this.url+t,method:this.httpMethod})).method?I.a.isEmpty(e)||(r.url=r.url+"?"+I.a.map(e,function(t,e){return encodeURIComponent(e)+"="+encodeURIComponent(t)}).join("&")):(r.headers={"Content-Type":"application/x-www-form-urlencoded"},r.transformRequest=function(t){return F.a.param(t)},r.data=e),(this.basicAuth||this.withCredentials)&&(r.withCredentials=!0),this.basicAuth&&(r.headers={Authorization:this.basicAuth}),this.backendSrv.datasourceRequest(r)},t.prototype.metadataRequest=function(t){return this._request(t,null,{method:"GET",silent:!0})},t.prototype.interpolateQueryExpr=function(t,e,r){return e.multi||e.includeAll?"string"==typeof t?Va(t):I.a.map(t,Va).join("|"):Ua(t)},t.prototype.targetContainsTemplate=function(t){return this.templateSrv.variableExists(t.expr)},t.prototype.query=function(t){for(var e=this,r=this.getPrometheusTime(t.range.from,!1),n=this.getPrometheusTime(t.range.to,!0),a=[],i=[],s=0,o=(t=I.a.clone(t)).targets;s<o.length;s++){var l=o[s];l.expr&&!l.hide&&(i.push(l),a.push(this.createQuery(l,t,r,n)))}if(I.a.isEmpty(a))return this.$q.when({data:[]});var c=I.a.map(a,function(t){return t.instant?e.performInstantQuery(t,n):e.performTimeSeriesQuery(t,t.start,t.end)});return this.$q.all(c).then(function(t){var r=[];return I.a.each(t,function(n,s){if("error"===n.status)throw J.a({index:s},n.error);var o={format:i[s].format,step:a[s].step,legendFormat:i[s].legendFormat,start:a[s].start,end:a[s].end,query:a[s].expr,responseListLength:t.length,refId:i[s].refId,valueWithRefId:i[s].valueWithRefId},l=e.resultTransformer.transform(n,o);r=r.concat(l)}),{data:r}})},t.prototype.createQuery=function(t,e,r,n){var a={hinting:t.hinting,instant:t.instant},i=Math.ceil(n-r),s=kt.a.interval_to_seconds(e.interval),o=kt.a.interval_to_seconds(this.templateSrv.replace(t.interval,e.scopedVars)||e.interval),l=t.intervalFactor||1,c=this.adjustInterval(s,o,i,l),u=J.a({},e.scopedVars,this.getRangeScopedVars());s!==c&&(s=c,u=Object.assign({},e.scopedVars,J.a({__interval:{text:s+"s",value:s+"s"},__interval_ms:{text:1e3*s,value:1e3*s}},this.getRangeScopedVars()))),a.step=s;var d=t.expr;d=this.templateSrv.getAdhocFilters(this.name).reduce(function(t,e){var r=e.key,n=e.operator,a=e.value;return"=~"!==n&&"!~"!==n||(a=Va(a)),Ra(t,r,a,n)},d),a.expr=this.templateSrv.replace(d,u,this.interpolateQueryExpr),a.requestId=e.panelId+t.refId;var p=function(t,e,r){return{end:Math.ceil(e/r)*r,start:Math.floor(t/r)*r}}(r,n,a.step);return a.start=p.start,a.end=p.end,a},t.prototype.adjustInterval=function(t,e,r,n){return 0!==t&&r/n/t>11e3&&(t=Math.ceil(r/n/11e3)),Math.max(t*n,e,1)},t.prototype.performTimeSeriesQuery=function(t,e,r){if(e>r)throw{message:"Invalid time range"};var n={query:t.expr,start:e,end:r,step:t.step};return this.queryTimeout&&(n.timeout=this.queryTimeout),this._request("/api/v1/query_range",n,{requestId:t.requestId})},t.prototype.performInstantQuery=function(t,e){var r={query:t.expr,time:e};return this.queryTimeout&&(r.timeout=this.queryTimeout),this._request("/api/v1/query",r,{requestId:t.requestId})},t.prototype.performSuggestQuery=function(t,e){var r=this;void 0===e&&(e=!1);return e&&this.metricsNameCache&&this.metricsNameCache.expire>Date.now()?this.$q.when(I.a.filter(this.metricsNameCache.data,function(e){return 1!==e.indexOf(t)})):this.metadataRequest("/api/v1/label/__name__/values").then(function(e){return r.metricsNameCache={data:e.data.data,expire:Date.now()+6e4},I.a.filter(e.data.data,function(e){return 1!==e.indexOf(t)})})},t.prototype.metricFindQuery=function(t){if(!t)return this.$q.when([]);var e=J.a({__interval:{text:this.interval,value:this.interval},__interval_ms:{text:kt.a.interval_to_ms(this.interval),value:kt.a.interval_to_ms(this.interval)}},this.getRangeScopedVars()),r=this.templateSrv.replace(t,e,this.interpolateQueryExpr);return new Ca(this,r,this.timeSrv).process()},t.prototype.getRangeScopedVars=function(){var t=this.timeSrv.timeRange(),e=t.to.diff(t.from),r=Math.round(e/1e3),n=kt.a.secondsToHms(e/1e3);return{__range_ms:{text:e,value:e},__range_s:{text:r,value:r},__range:{text:n,value:n}}},t.prototype.annotationQuery=function(t){var e=t.annotation,r=e.expr||"",n=e.tagKeys||"",a=e.titleFormat||"",i=e.textFormat||"";if(!r)return this.$q.when([]);var s=e.step||"60s",o=this.getPrometheusTime(t.range.from,!1),l=this.getPrometheusTime(t.range.to,!0),c=J.a({},t,{interval:"0s"}),u=this.createQuery({expr:r,interval:s},c,o,l),d=this;return this.performTimeSeriesQuery(u,u.start,u.end).then(function(t){var r=[];return n=n.split(","),I.a.each(t.data.data.result,function(t){for(var s=I.a.chain(t.metric).filter(function(t,e){return I.a.includes(n,e)}).value(),o=0,l=t.values;o<l.length;o++){var c=l[o];if("1"===c[1]||e.useValueForTime){var u={annotation:e,title:d.resultTransformer.renderTemplate(a,t.metric),tags:s,text:d.resultTransformer.renderTemplate(i,t.metric)};e.useValueForTime?u.time=Math.floor(parseFloat(c[1])):u.time=1e3*Math.floor(parseFloat(c[0])),r.push(u)}}}),r})},t.prototype.testDatasource=function(){var t=(new Date).getTime();return this.performInstantQuery({expr:"1+1"},t/1e3).then(function(t){return"success"===t.data.status?{status:"success",message:"Data source is working"}:{status:"error",message:t.error}})},t.prototype.getExploreState=function(t){var e=this,r={};if(t&&t.length>0){var n=t.map(function(t){return{query:e.templateSrv.replace(t.expr,{},e.interpolateQueryExpr),format:t.format}});r=J.a({},r,{queries:n,datasource:this.name})}return r},t.prototype.getQueryHints=function(t,e){return function(t,e,r){var n=[];if(t.trim().match(/^\w+_bucket$/)){var a="Time series has buckets, you probably wanted a histogram.";n.push({type:"HISTOGRAM_QUANTILE",label:a,fix:{label:"Fix by adding histogram_quantile().",action:{type:"ADD_HISTOGRAM_QUANTILE",query:t}}})}if(e&&e.length>0&&e.forEach(function(e){var r=e.datapoints;if(-1===t.indexOf("rate(")&&r.length>1){var a=!1,i=r.filter(function(t){return null!==t[0]}),s=i.every(function(t,e){return 0===e||(a=a||t[0]>i[e-1][0],t[0]>=i[e-1][0])});if(a&&s){var o="Time series is monotonously increasing.",l=void 0;t.trim().match(/^\w+$/)?l={label:"Fix by adding rate().",action:{type:"ADD_RATE",query:t}}:o+=" Try applying a rate() function.",n.push({type:"APPLY_RATE",label:o,fix:l})}}}),r&&r.ruleMappings){var i=r.ruleMappings,s=Object.keys(i).reduce(function(e,r){var n;return t.search(r)>-1?J.a({},e,((n={})[r]=i[r],n)):e},{});I.a.size(s)>0&&(a="Query contains recording rules.",n.push({type:"EXPAND_RULES",label:a,fix:{label:"Expand rules",action:{type:"EXPAND_RULES",query:t,mapping:s}}}))}return e.length>=ja&&t.trim().match(/^\w+$/)&&n.push({type:"ADD_SUM",label:"Many time series results returned.",fix:{label:"Consider aggregating with sum().",action:{type:"ADD_SUM",query:t,preventSubmit:!0}}}),n.length>0?n:null}(t,e,this)},t.prototype.loadRules=function(){var t=this;this.metadataRequest("/api/v1/rules").then(function(t){return t.data||t.json()}).then(function(e){var r=I.a.get(e,["data","groups"]);r&&(t.ruleMappings=function(t){return t.reduce(function(t,e){return e.rules.filter(function(t){return"recording"===t.type}).reduce(function(t,e){var r;return J.a({},t,((r={})[e.name]=e.query,r))},t)},{})}(r))}).catch(function(t){console.log("Rules API is experimental. Ignore next error."),console.error(t)})},t.prototype.modifyQuery=function(t,e){switch(e.type){case"ADD_FILTER":return Ra(t,e.key,e.value);case"ADD_HISTOGRAM_QUANTILE":return"histogram_quantile(0.95, sum(rate("+t+"[5m])) by (le))";case"ADD_RATE":return"rate("+t+"[5m])";case"ADD_SUM":return"sum("+t.trim()+") by ($1)";case"EXPAND_RULES":if(e.mapping)return function(t,e){var r=Object.keys(e),n=new RegExp("(\\s|^)("+r.join("|")+")(\\s|$|\\(|\\[|\\{)","ig");return t.replace(n,function(t,r,n,a){return""+r+e[n]+a})}(t,e.mapping);default:return t}},t.prototype.getPrometheusTime=function(t,e){return I.a.isString(t)&&(t=Ct.parse(t,e)),Math.ceil(t.valueOf()/1e3)},t.prototype.getTimeRange=function(){var t=this.timeSrv.timeRange();return{start:this.getPrometheusTime(t.from,!1),end:this.getPrometheusTime(t.to,!0)}},t.prototype.getOriginalMetricName=function(t){return this.resultTransformer.getOriginalMetricName(t)},t}(),Qa=function(){function t(t,e){this.datasource=t,this.templateSrv=e,this.identifierRegexps=[/\[/,/[a-zA-Z0-9_:]/],this.labelQueryCache={},this.labelNameCache={},this.labelValueCache={},this.templateVariableCompletions=this.templateSrv.variables.map(function(t){return{caption:"$"+t.name,value:"$"+t.name,meta:"variable",score:Number.MAX_VALUE}})}return t.prototype.getCompletions=function(t,e,r,n,a){var i=this,s=function(t,e){return e=e.concat(i.templateVariableCompletions),a(t,e)},o=e.getTokenAt(r.row,r.column);switch(o.type){case"entity.name.tag.label-matcher":return void this.getCompletionsForLabelMatcherName(e,r).then(function(t){s(null,t)});case"string.quoted.label-matcher":return void this.getCompletionsForLabelMatcherValue(e,r).then(function(t){s(null,t)});case"entity.name.tag.label-list-matcher":return void this.getCompletionsForBinaryOperator(e,r).then(function(t){s(null,t)})}if("paren.lparen"===o.type&&"["===o.value){for(var l=[],c=0,u=["s","m","h"];c<u.length;c++)for(var d=u[c],p=0,h=[1,5,10,30];p<h.length;p++){var f=h[p];l.push({caption:f+d,value:"["+f+d,meta:"range vector"})}return l.unshift({caption:"$__interval_ms",value:"[$__interval_ms",meta:"range vector"}),l.unshift({caption:"$__interval",value:"[$__interval",meta:"range vector"}),void s(null,l)}var m=n;return this.datasource.performSuggestQuery(m,!0).then(function(t){s(null,t.map(function(t){var e=t;return"("===n&&(e="("+t),{caption:t,value:e,meta:"metric"}}))})},t.prototype.getCompletionsForLabelMatcherName=function(t,e){var r=this,n=this.findMetricName(t,e.row,e.column);return n?this.labelNameCache[n]?Promise.resolve(this.labelNameCache[n]):this.getLabelNameAndValueForExpression(n,"metricName").then(function(t){var e=r.transformToCompletions(I.a.uniq(I.a.flatten(t.map(function(t){return Object.keys(t)}))),"label name");return r.labelNameCache[n]=e,Promise.resolve(e)}):Promise.resolve(this.transformToCompletions(["__name__","instance","job"],"label name"))},t.prototype.getCompletionsForLabelMatcherValue=function(t,e){var r=this,n=this.findMetricName(t,e.row,e.column);if(!n)return Promise.resolve([]);var a=this.findToken(t,e.row,e.column,"entity.name.tag.label-matcher",null,"paren.lparen.label-matcher");if(!a)return Promise.resolve([]);var i=a.value;return this.labelValueCache[n]&&this.labelValueCache[n][i]?Promise.resolve(this.labelValueCache[n][i]):this.getLabelNameAndValueForExpression(n,"metricName").then(function(t){var e=r.transformToCompletions(I.a.uniq(t.map(function(t){return t[i]})),"label value");return r.labelValueCache[n]=r.labelValueCache[n]||{},r.labelValueCache[n][i]=e,Promise.resolve(e)})},t.prototype.getCompletionsForBinaryOperator=function(t,e){var r,n,a=this,i=this.findToken(t,e.row,e.column,"keyword.control",null,"identifier");if(!i)return Promise.resolve([]);switch(i.value){case"by":case"without":return(r=this.findToken(t,i.row,i.column,"paren.rparen",null,"identifier"))?""===(n=this.findExpressionMatchedParen(t,r.row,r.column))?Promise.resolve([]):this.getLabelNameAndValueForExpression(n,"expression").then(function(t){var e=a.transformToCompletions(I.a.uniq(I.a.flatten(t.map(function(t){return Object.keys(t)}))),"label name");return a.labelNameCache[n]=e,e}):Promise.resolve([]);case"on":case"ignoring":case"group_left":case"group_right":var s=this.findToken(t,i.row,i.column,"keyword.operator.binary",null,"identifier");if(!s)return Promise.resolve([]);if(r=this.findToken(t,s.row,s.column,"paren.rparen",null,"identifier"))return""===(n=this.findExpressionMatchedParen(t,r.row,r.column))?Promise.resolve([]):this.getLabelNameAndValueForExpression(n,"expression").then(function(t){var e=a.transformToCompletions(I.a.uniq(I.a.flatten(t.map(function(t){return Object.keys(t)}))),"label name");return a.labelNameCache[n]=e,e});var o=this.findMetricName(t,s.row,s.column);return this.getLabelNameAndValueForExpression(o,"metricName").then(function(t){var e=a.transformToCompletions(I.a.uniq(I.a.flatten(t.map(function(t){return Object.keys(t)}))),"label name");return a.labelNameCache[o]=e,Promise.resolve(e)})}return Promise.resolve([])},t.prototype.getLabelNameAndValueForExpression=function(t,e){var r=this;if(this.labelQueryCache[t])return Promise.resolve(this.labelQueryCache[t]);var n=t;if("metricName"===e){var a="=~";/[a-zA-Z_:][a-zA-Z0-9_:]*/.test(t)&&(a="="),n="{__name__"+a+'"'+t+'"}'}var i=this.datasource.getTimeRange(),s=i.start,o=i.end,l="/api/v1/series?match[]="+encodeURIComponent(n)+"&start="+s+"&end="+o;return this.datasource.metadataRequest(l).then(function(e){return r.labelQueryCache[t]=e.data.data,e.data.data})},t.prototype.transformToCompletions=function(t,e){return t.map(function(t){return{caption:t,value:t,meta:e,score:Number.MAX_VALUE}})},t.prototype.findMetricName=function(t,e,r){var n="",a=this.findToken(t,e,r,"entity.name.tag.label-matcher","__name__","paren.lparen.label-matcher");if(a){var i=t.getTokens(a.row)[a.index+2];i&&"string.quoted.label-matcher"===i.type&&(n=i.value.slice(1,-1))}else{var s=this.findToken(t,e,r,"identifier",null,null);s&&(t.getTokens(s.row),n=s.value)}return n},t.prototype.findToken=function(t,e,r,n,a,i){for(var s,o,l=e;l>=0;l--){var c=void 0;if(s=t.getTokens(l),l===e)for(c=0,o=0;o<s.length;o++){var u=c+s[o].value.length;if(u>=r)break;c=u}else o=s.length-1,c=I.a.sum(s.map(function(t){return t.value.length}))-s[s.length-1].value.length;for(;o>=0;o--){if(s[o].type===i)return null;if(s[o].type===n&&(!a||s[o].value===a))return s[o].row=l,s[o].column=c,s[o].index=o,s[o];c-=s[o].value.length}}return null},t.prototype.findExpressionMatchedParen=function(t,e,r){for(var n,a,i=1,s=")",o=e;o>=0;o--){if(n=t.getTokens(o),o===e){var l=0;for(a=0;a<n.length&&!((l+=n[a].value.length)>=r);a++);}else a=n.length-1;for(;a>=0;a--)if(s=n[a].value+s,"paren.rparen"===n[a].type)i++;else if("paren.lparen"===n[a].type&&0===--i)return s}return s},t}(),Ha=(r(1286),r(1287),function(t){function e(e,r,n){var a=t.call(this,e,r)||this;a.templateSrv=n;var i=a.target;return i.expr=i.expr||"",i.intervalFactor=i.intervalFactor||1,i.format=i.format||a.getDefaultFormat(),a.metric="",a.resolutions=I.a.map([1,2,3,4,5,10],function(t){return{factor:t,label:"1/"+t}}),a.formats=[{text:"Time series",value:"time_series"},{text:"Table",value:"table"},{text:"Heatmap",value:"heatmap"}],a.instant=!1,a.updateLink(),a}return e.$inject=["$scope","$injector","templateSrv"],J.c(e,t),e.prototype.getCompleter=function(t){return new Qa(this.datasource,this.templateSrv)},e.prototype.getDefaultFormat=function(){return"table"===this.panelCtrl.panel.type?"table":"heatmap"===this.panelCtrl.panel.type?"heatmap":"time_series"},e.prototype.refreshMetricData=function(){I.a.isEqual(this.oldTarget,this.target)||(this.oldTarget=L.a.copy(this.target),this.panelCtrl.refresh(),this.updateLink())},e.prototype.updateLink=function(){var t=this.panelCtrl.range;if(t){var e=Math.ceil((t.to.valueOf()-t.from.valueOf())/1e3),r=t.to.utc().format("YYYY-MM-DD HH:mm"),n={"g0.expr":this.templateSrv.replace(this.target.expr,this.panelCtrl.panel.scopedVars,this.datasource.interpolateQueryExpr),"g0.range_input":e+"s","g0.end_input":r,"g0.step_input":this.target.step,"g0.stacked":this.panelCtrl.panel.stack?1:0,"g0.tab":0},a=I.a.map(n,function(t,e){return e+"="+encodeURIComponent(t)}).join("&");this.linkToPrometheus=this.datasource.directUrl+"/graph?"+a}},e.prototype.getCollapsedText=function(){return this.target.expr},e.templateUrl="partials/query.editor.html",e}(Ht)),za=function(){function t(t){this.current.jsonData.httpMethod=this.current.jsonData.httpMethod||"GET"}return t.$inject=["$scope"],t.templateUrl="public/app/plugins/datasource/prometheus/partials/config.html",t}(),Ga=[{title:"Request Rate",expression:"rate(http_request_total[5m])",label:"Given an HTTP request counter, this query calculates the per-second average request rate over the last 5 minutes."},{title:"95th Percentile of Request Latencies",expression:"histogram_quantile(0.95, sum(rate(prometheus_http_request_duration_seconds_bucket[5m])) by (le))",label:"Calculates the 95th percentile of HTTP request rate over 5 minute windows."},{title:"Alerts Firing",expression:'sort_desc(sum(sum_over_time(ALERTS{alertstate="firing"}[24h])) by (alertname))',label:"Sums up the alerts that have been firing over the last 24 hours."}],Wa=function(t){return j.a.createElement("div",null,j.a.createElement("h1",null,"PromQL Cheat Sheet"),Ga.map(function(e){return j.a.createElement("div",{className:"cheat-sheet-item",key:e.expression},j.a.createElement("div",{className:"cheat-sheet-item__title"},e.title),j.a.createElement("div",{className:"cheat-sheet-item__expression",onClick:function(r){return t.onClickQuery(e.expression)}},j.a.createElement("code",null,e.expression)),j.a.createElement("div",{className:"cheat-sheet-item__label"},e.label))}))},Ya=[{text:"Start",id:"start",icon:"fa fa-rocket"}],Ka=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={active:"start"},e.onClickTab=function(t){e.setState({active:t})},e}return J.c(e,t),e.prototype.render=function(){var t=this,e=this.state.active;return j.a.createElement("div",{style:{margin:"45px 0",border:"1px solid #ddd",borderRadius:5}},j.a.createElement("div",{className:"page-header-canvas"},j.a.createElement("div",{className:"page-container"},j.a.createElement("div",{className:"page-header"},j.a.createElement("nav",null,j.a.createElement("ul",{className:"gf-tabs "},Ya.map(function(r,n){var a=Dn()({"gf-tabs-link":!0,active:r.id===e});return j.a.createElement("li",{className:"gf-tabs-item",key:r.id},j.a.createElement("a",{className:a,onClick:function(){return t.onClickTab(r.id)}},j.a.createElement("i",{className:r.icon}),r.text))})))))),j.a.createElement("div",{className:"page-container page-body"},"start"===e&&j.a.createElement(Wa,{onClickQuery:this.props.onClickQuery})))},e}(R.PureComponent),Ja="__histograms__",Xa="metric",Za="promql",ti="__recording_rules__";function ei(t,e){var r=e.typeaheadContext,n=e.typeaheadText;switch(r){case"context-labels":var a=Un();a&&"}"!==a&&","!==a||(t+="=");break;case"context-label-values":n.match(/^(!?=~?"|")/)||(t='"'+t),'"'!==Un()&&(t+='"')}return t}var ri,ni,ai=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.onChangeMetrics=function(t,e){var r;if(1===e.length){if(0!==e[0].children.length)return;r=e[0].value}else{var a=e[0].value,i=e[1].value;r=a===Ja?"histogram_quantile(0.95, sum(rate("+i+"[5m])) by (le))":i}n.onChangeQuery(r,!0)},n.onChangeQuery=function(t,e){var r=n.props.onQueryChange;r&&r(t,e)},n.onClickHintFix=function(){var t=n.props,e=t.hint,r=t.onClickHintFix;r&&e&&e.fix&&r(e.fix.action)},n.onUpdateLanguage=function(){var t=n.languageProvider,e=t.histogramMetrics,r=t.metrics;if(r){Xt.a.languages[Za]=n.languageProvider.getSyntax(),Xt.a.languages[Za][Xa]={alias:"variable",pattern:new RegExp("(?:^|\\s)("+r.join("|")+")(?:$|\\s)")};var a=function(t,e){void 0===e&&(e="_");var r=/:\w+:/,n=t.filter(function(t){return r.test(t)}),a={label:"Recording rules",value:ti,children:n.slice().sort().map(function(t){return{label:t,value:t}})},i=n.length>0?[a]:[],s=I.a.chain(t).filter(function(t){return!r.test(t)}).groupBy(function(t){return t.split(e)[0]}).map(function(t,e){return{children:1===t.length&&t[0]===e?[]:t.sort().map(function(t){return{label:t,value:t}}),label:e,value:e}}).sortBy("label").value();return i.concat(s)}(r),i=e.map(function(t){return{label:t,value:t}}),s=e.length>0?[{label:"Histograms",value:Ja,children:i,isLeaf:!1}].concat(a):a;n.setState({metricsOptions:s,syntaxLoaded:!0})}},n.onTypeahead=function(t){if(!n.languageProvider)return{suggestions:[]};var e=n.props.history,r=t.prefix,a=t.text,i=t.value,s=t.wrapperNode,o=Array.from(s.classList),l=jn(s,".attr-name"),c=l&&l.textContent,u=Un(),d=n.languageProvider.provideCompletionItems({text:a,value:i,prefix:r,wrapperClasses:o,labelKey:c},{history:e});return console.log("handleTypeahead",o,a,r,u,c,d.context),d},e.datasource.languageProvider&&(n.languageProvider=e.datasource.languageProvider),n.plugins=[Qn(),Hn({handler:e.onPressEnter}),Rn()({onlyIn:function(t){return"code_block"===t.type},getSyntax:function(t){return"promql"}})],n.state={metricsByPrefix:[],metricsOptions:[],syntaxLoaded:!1},n}return J.c(e,t),e.prototype.componentDidMount=function(){var t=this;this.languageProvider&&this.languageProvider.start().then(function(e){e.map(function(e){return e.then(t.onUpdateLanguage).catch(function(){})})}).then(function(){return t.onUpdateLanguage()})},e.prototype.render=function(){var t=this.props,e=t.error,r=t.hint,n=t.initialQuery,a=this.state,i=a.metricsOptions,s=a.syntaxLoaded,o=this.languageProvider?this.languageProvider.cleanText:void 0,l=s?"Metrics":"matrics加载中...";return j.a.createElement("div",{className:"prom-query-field"},j.a.createElement("div",{className:"prom-query-field-tools"},j.a.createElement(qn.a,{options:i,onChange:this.onChangeMetrics},j.a.createElement("button",{className:"btn navbar-button navbar-button--tight",disabled:!s},l))),j.a.createElement("div",{className:"prom-query-field-wrapper"},j.a.createElement(zn.a,{additionalPlugins:this.plugins,cleanText:o,initialValue:n,onTypeahead:this.onTypeahead,onWillApplySuggestion:ei,onValueChanged:this.onChangeQuery,placeholder:"输入一个PromQL查询",portalOrigin:"prometheus",syntaxLoaded:s}),e?j.a.createElement("div",{className:"prom-query-field-info text-error"},e):null,r?j.a.createElement("div",{className:"prom-query-field-info text-warning"},r.label," ",r.fix?j.a.createElement("a",{className:"text-link muted",onClick:this.onClickHintFix},r.fix.label):null):null))},e}(j.a.PureComponent),ii=function(){function t(){}return t.templateUrl="partials/annotations.editor.html",t}(),si=function(){function t(t){this.$q=t}return t.prototype.processQueryResult=function(t){var e=[];if(!t.data.results)return{data:e};for(var r in t.data.results){var n=t.data.results[r];if(n.series)for(var a=0,i=n.series;a<i.length;a++){var s=i[a];e.push({target:s.name,datapoints:s.points,refId:n.refId,meta:n.meta})}if(n.tables)for(var o=0,l=n.tables;o<l.length;o++){var c=l[o];c.type="table",c.refId=n.refId,c.meta=n.meta,e.push(c)}}return{data:e}},t.prototype.parseMetricFindQueryResult=function(t,e){if(!e||0===e.data.length||0===e.data.results[t].meta.rowCount)return[];var r=e.data.results[t].tables[0].columns,n=e.data.results[t].tables[0].rows,a=this.findColIndex(r,"__text"),i=this.findColIndex(r,"__value");return 2===r.length&&-1!==a&&-1!==i?this.transformToKeyValueList(n,a,i):this.transformToSimpleList(n)},t.prototype.transformToKeyValueList=function(t,e,r){for(var n=[],a=0;a<t.length;a++)this.containsKey(n,t[a][e])||n.push({text:t[a][e],value:t[a][r]});return n},t.prototype.transformToSimpleList=function(t){for(var e=[],r=0;r<t.length;r++)for(var n=0;n<t[r].length;n++){var a=t[r][n];-1===e.indexOf(a)&&e.push(a)}return I.a.map(e,function(t){return{text:t}})},t.prototype.findColIndex=function(t,e){for(var r=0;r<t.length;r++)if(t[r].text===e)return r;return-1},t.prototype.containsKey=function(t,e){for(var r=0;r<t.length;r++)if(t[r].text===e)return!0;return!1},t.prototype.transformAnnotationResponse=function(t,e){for(var r=e.data.results[t.annotation.name].tables[0],n=-1,a=-1,i=-1,s=0;s<r.columns.length;s++)"time"===r.columns[s].text?n=s:"text"===r.columns[s].text?a=s:"tags"===r.columns[s].text&&(i=s);if(-1===n)return this.$q.reject({message:"Missing mandatory time column (with time column alias) in annotation query."});var o=[];for(s=0;s<r.rows.length;s++){var l=r.rows[s];o.push({annotation:t.annotation,time:Math.floor(l[n]),text:l[a],tags:l[i]?l[i].trim().split(/\s*,\s*/):[]})}return o},t}(),oi=function(){function t(t,e,r,n){this.backendSrv=e,this.$q=r,this.templateSrv=n,this.name=t.name,this.id=t.id,this.responseParser=new si(this.$q),this.interval=(t.jsonData||{}).timeInterval}return t.$inject=["instanceSettings","backendSrv","$q","templateSrv"],t.prototype.interpolateVariable=function(t,e){return"string"==typeof t?e.multi||e.includeAll?"'"+t.replace(/'/g,"''")+"'":t:"number"==typeof t?t:I.a.map(t,function(e){return"number"==typeof t?t:"'"+e.replace(/'/g,"''")+"'"}).join(",")},t.prototype.query=function(t){var e=this,r=I.a.filter(t.targets,function(t){return!0!==t.hide}).map(function(r){return{refId:r.refId,intervalMs:t.intervalMs,maxDataPoints:t.maxDataPoints,datasourceId:e.id,rawSql:e.templateSrv.replace(r.rawSql,t.scopedVars,e.interpolateVariable),format:r.format}});return 0===r.length?this.$q.when({data:[]}):this.backendSrv.datasourceRequest({url:"/api/tsdb/query",method:"POST",data:{from:t.range.from.valueOf().toString(),to:t.range.to.valueOf().toString(),queries:r}}).then(this.responseParser.processQueryResult)},t.prototype.annotationQuery=function(t){var e=this;if(!t.annotation.rawQuery)return this.$q.reject({message:"Query missing in annotation definition"});var r={refId:t.annotation.name,datasourceId:this.id,rawSql:this.templateSrv.replace(t.annotation.rawQuery,t.scopedVars,this.interpolateVariable),format:"table"};return this.backendSrv.datasourceRequest({url:"/api/tsdb/query",method:"POST",data:{from:t.range.from.valueOf().toString(),to:t.range.to.valueOf().toString(),queries:[r]}}).then(function(r){return e.responseParser.transformAnnotationResponse(t,r)})},t.prototype.metricFindQuery=function(t,e){var r=this,n="tempvar";e&&e.variable&&e.variable.name&&(n=e.variable.name);var a={refId:n,datasourceId:this.id,rawSql:this.templateSrv.replace(t,{},this.interpolateVariable),format:"table"};return this.backendSrv.datasourceRequest({url:"/api/tsdb/query",method:"POST",data:{queries:[a]}}).then(function(t){return r.responseParser.parseMetricFindQueryResult(n,t)})},t.prototype.testDatasource=function(){return this.backendSrv.datasourceRequest({url:"/api/tsdb/query",method:"POST",data:{from:"5m",to:"now",queries:[{refId:"A",intervalMs:1,maxDataPoints:1,datasourceId:this.id,rawSql:"SELECT 1",format:"table"}]}}).then(function(t){return{status:"success",message:"Database Connection OK"}}).catch(function(t){return console.log(t),t.data&&t.data.message?{status:"error",message:t.data.message}:{status:"error",message:t.status}})},t}(),li="SELECT\n  $__timeEpoch(<time_column>),\n  <value column> as value,\n  <series name column> as metric\nFROM\n  <table name>\nWHERE\n  $__timeFilter(time_column)\nORDER BY\n  <time_column> ASC",ci=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.target.format=n.target.format||"time_series",n.target.alias="",n.formats=[{text:"Time series",value:"time_series"},{text:"Table",value:"table"}],n.target.rawSql||("table"===n.panelCtrl.panel.type?(n.target.format="table",n.target.rawSql="SELECT 1"):n.target.rawSql=li),n.panelCtrl.events.on("data-received",n.onDataReceived.bind(n),e),n.panelCtrl.events.on("data-error",n.onDataError.bind(n),e),n}return e.$inject=["$scope","$injector"],J.c(e,t),e.prototype.onDataReceived=function(t){this.lastQueryMeta=null,this.lastQueryError=null;var e=I.a.find(t,{refId:this.target.refId});e&&(this.lastQueryMeta=e.meta)},e.prototype.onDataError=function(t){if(t.data&&t.data.results){var e=t.data.results[this.target.refId];e&&(this.lastQueryMeta=e.meta,this.lastQueryError=e.error)}},e.templateUrl="partials/query.editor.html",e}(Ht),ui=function(){function t(t){this.current.jsonData.encrypt=this.current.jsonData.encrypt||"false"}return t.$inject=["$scope"],t.templateUrl="partials/config.html",t}(),di="SELECT\n    <time_column> as time,\n    <text_column> as text,\n    <tags_column> as tags\n  FROM\n    <table name>\n  WHERE\n    $__timeFilter(time_column)\n  ORDER BY\n    <time_column> ASC",pi=function(){function t(){this.annotation.rawQuery=this.annotation.rawQuery||di}return t.templateUrl="partials/annotations.editor.html",t}(),hi=function(){function t(t,e,r){this.backendSrv=e,this.$q=r,this.id=t.id}return t.$inject=["instanceSettings","backendSrv","$q"],t.prototype.query=function(t){var e=this,r=I.a.filter(t.targets,function(t){return!0!==t.hide}).map(function(r){return{refId:r.refId,scenarioId:r.scenarioId,intervalMs:t.intervalMs,maxDataPoints:t.maxDataPoints,stringInput:r.stringInput,points:r.points,alias:r.alias,datasourceId:e.id}});return 0===r.length?this.$q.when({data:[]}):this.backendSrv.datasourceRequest({method:"POST",url:"/api/tsdb/query",data:{from:t.range.from.valueOf().toString(),to:t.range.to.valueOf().toString(),queries:r}}).then(function(t){var e=[];return t.data.results&&I.a.forEach(t.data.results,function(t){if(t.tables)for(var r=0,n=t.tables;r<n.length;r++){var a=n[r],i=new ne.a;i.rows=a.rows,i.columns=a.columns,e.push(i)}for(var s=0,o=t.series;s<o.length;s++){var l=o[s];e.push({target:l.name,datapoints:l.points})}}),{data:e}})},t.prototype.annotationQuery=function(t){for(var e=t.range.from.valueOf(),r=[],n=(t.range.to.valueOf()-e)/10,a=0;a<10;a++)r.push({annotation:t.annotation,time:e,text:'This is the text, <a href="https://grafana.com">Grafana.com</a>',tags:["text","server"]}),e+=n;return this.$q.when(r)},t}(),fi=function(t){function e(e,r,n){var a=t.call(this,e,r)||this;return a.backendSrv=n,a.target.scenarioId=a.target.scenarioId||"random_walk",a.scenarioList=[],a.newPointTime=H()(),a.selectedPoint={text:"Select point",value:null},a}return e.$inject=["$scope","$injector","backendSrv"],J.c(e,t),e.prototype.getPoints=function(){return I.a.map(this.target.points,function(t,e){return{text:H()(t[1]).format("MMMM Do YYYY, H:mm:ss")+" : "+t[0],value:e}})},e.prototype.pointSelected=function(t){this.selectedPoint=t},e.prototype.deletePoint=function(){this.target.points.splice(this.selectedPoint.value,1),this.selectedPoint={text:"Select point",value:null},this.refresh()},e.prototype.addPoint=function(){this.target.points=this.target.points||[],this.target.points.push([this.newPointValue,this.newPointTime.valueOf()]),this.target.points=I.a.sortBy(this.target.points,function(t){return t[1]}),this.refresh()},e.prototype.$onInit=function(){var t=this;return this.backendSrv.get("/api/tsdb/testdata/scenarios").then(function(e){t.scenarioList=e,t.scenario=I.a.find(t.scenarioList,{id:t.target.scenarioId})})},e.prototype.scenarioChanged=function(){this.scenario=I.a.find(this.scenarioList,{id:this.target.scenarioId}),this.target.stringInput=this.scenario.stringInput,"manual_entry"===this.target.scenarioId?this.target.points=this.target.points||[]:delete this.target.points,this.refresh()},e.templateUrl="partials/query.editor.html",e}(Ht),mi=function(){function t(){}return t.template="<h2>Annotation scenario</h2>",t}();!function(t){t.METRIC_KIND_UNSPECIFIED="METRIC_KIND_UNSPECIFIED",t.GAUGE="GAUGE",t.DELTA="DELTA",t.CUMULATIVE="CUMULATIVE"}(ri||(ri={})),function(t){t.VALUE_TYPE_UNSPECIFIED="VALUE_TYPE_UNSPECIFIED",t.BOOL="BOOL",t.INT64="INT64",t.DOUBLE="DOUBLE",t.STRING="STRING",t.DISTRIBUTION="DISTRIBUTION",t.MONEY="MONEY"}(ni||(ni={}));var gi,vi=[{text:"delta",value:"ALIGN_DELTA",valueTypes:[ni.INT64,ni.DOUBLE,ni.MONEY,ni.DISTRIBUTION],metricKinds:[ri.CUMULATIVE,ri.DELTA]},{text:"rate",value:"ALIGN_RATE",valueTypes:[ni.INT64,ni.DOUBLE,ni.MONEY],metricKinds:[ri.CUMULATIVE,ri.DELTA]},{text:"interpolate",value:"ALIGN_INTERPOLATE",valueTypes:[ni.INT64,ni.DOUBLE,ni.MONEY],metricKinds:[ri.GAUGE]},{text:"next older",value:"ALIGN_NEXT_OLDER",valueTypes:[ni.INT64,ni.DOUBLE,ni.MONEY,ni.DISTRIBUTION,ni.STRING,ni.VALUE_TYPE_UNSPECIFIED,ni.BOOL],metricKinds:[ri.GAUGE]},{text:"min",value:"ALIGN_MIN",valueTypes:[ni.INT64,ni.DOUBLE,ni.MONEY],metricKinds:[ri.GAUGE,ri.DELTA]},{text:"max",value:"ALIGN_MAX",valueTypes:[ni.INT64,ni.DOUBLE,ni.MONEY],metricKinds:[ri.GAUGE,ri.DELTA]},{text:"mean",value:"ALIGN_MEAN",valueTypes:[ni.INT64,ni.DOUBLE,ni.MONEY],metricKinds:[ri.GAUGE,ri.DELTA]},{text:"count",value:"ALIGN_COUNT",valueTypes:[ni.INT64,ni.DOUBLE,ni.MONEY,ni.BOOL],metricKinds:[ri.GAUGE,ri.DELTA]},{text:"sum",value:"ALIGN_SUM",valueTypes:[ni.INT64,ni.DOUBLE,ni.MONEY,ni.DISTRIBUTION],metricKinds:[ri.GAUGE,ri.DELTA]},{text:"stddev",value:"ALIGN_STDDEV",valueTypes:[ni.INT64,ni.DOUBLE,ni.MONEY],metricKinds:[ri.GAUGE,ri.DELTA]},{text:"count true",value:"ALIGN_COUNT_TRUE",valueTypes:[ni.BOOL],metricKinds:[ri.GAUGE]},{text:"count false",value:"ALIGN_COUNT_FALSE",valueTypes:[ni.BOOL],metricKinds:[ri.GAUGE]},{text:"fraction true",value:"ALIGN_FRACTION_TRUE",valueTypes:[ni.BOOL],metricKinds:[ri.GAUGE]},{text:"percentile 99",value:"ALIGN_PERCENTILE_99",valueTypes:[ni.DISTRIBUTION],metricKinds:[ri.GAUGE,ri.DELTA]},{text:"percentile 95",value:"ALIGN_PERCENTILE_95",valueTypes:[ni.DISTRIBUTION],metricKinds:[ri.GAUGE,ri.DELTA]},{text:"percentile 50",value:"ALIGN_PERCENTILE_50",valueTypes:[ni.DISTRIBUTION],metricKinds:[ri.GAUGE,ri.DELTA]},{text:"percentile 05",value:"ALIGN_PERCENTILE_05",valueTypes:[ni.DISTRIBUTION],metricKinds:[ri.GAUGE,ri.DELTA]},{text:"percent change",value:"ALIGN_PERCENT_CHANGE",valueTypes:[ni.INT64,ni.DOUBLE,ni.MONEY],metricKinds:[ri.GAUGE,ri.DELTA]}],bi=[{text:"none",value:"REDUCE_NONE",valueTypes:[ni.INT64,ni.DOUBLE,ni.MONEY,ni.DISTRIBUTION,ni.BOOL,ni.STRING],metricKinds:[ri.GAUGE,ri.DELTA,ri.CUMULATIVE,ri.METRIC_KIND_UNSPECIFIED]},{text:"mean",value:"REDUCE_MEAN",valueTypes:[ni.INT64,ni.DOUBLE,ni.MONEY],metricKinds:[ri.GAUGE,ri.DELTA]},{text:"min",value:"REDUCE_MIN",valueTypes:[ni.INT64,ni.DOUBLE,ni.MONEY],metricKinds:[ri.GAUGE,ri.DELTA]},{text:"max",value:"REDUCE_MAX",valueTypes:[ni.INT64,ni.DOUBLE,ni.MONEY],metricKinds:[ri.GAUGE,ri.DELTA]},{text:"sum",value:"REDUCE_SUM",valueTypes:[ni.INT64,ni.DOUBLE,ni.MONEY,ni.DISTRIBUTION],metricKinds:[ri.GAUGE,ri.DELTA]},{text:"std. dev.",value:"REDUCE_STDDEV",valueTypes:[ni.INT64,ni.DOUBLE,ni.MONEY,ni.DISTRIBUTION],metricKinds:[ri.GAUGE,ri.DELTA]},{text:"count",value:"REDUCE_COUNT",valueTypes:[ni.INT64,ni.DOUBLE,ni.MONEY,ni.DISTRIBUTION,ni.BOOL,ni.STRING],metricKinds:[ri.GAUGE,ri.DELTA]},{text:"count true",value:"REDUCE_COUNT_TRUE",valueTypes:[ni.BOOL],metricKinds:[ri.GAUGE,ri.DELTA]},{text:"count false",value:"REDUCE_COUNT_FALSE",valueTypes:[ni.BOOL],metricKinds:[ri.GAUGE,ri.DELTA]},{text:"99th percentile",value:"REDUCE_PERCENTILE_99",valueTypes:[ni.INT64,ni.DOUBLE,ni.MONEY,ni.DISTRIBUTION],metricKinds:[ri.GAUGE,ri.DELTA]},{text:"95th percentile",value:"REDUCE_PERCENTILE_95",valueTypes:[ni.INT64,ni.DOUBLE,ni.MONEY,ni.DISTRIBUTION],metricKinds:[ri.GAUGE,ri.DELTA]},{text:"50th percentile",value:"REDUCE_PERCENTILE_50",valueTypes:[ni.INT64,ni.DOUBLE,ni.MONEY,ni.DISTRIBUTION],metricKinds:[ri.GAUGE,ri.DELTA]},{text:"5th percentile",value:"REDUCE_PERCENTILE_05",valueTypes:[ni.INT64,ni.DOUBLE,ni.MONEY,ni.DISTRIBUTION],metricKinds:[ri.GAUGE,ri.DELTA]}],yi=[{text:"grafana auto",value:"grafana-auto"},{text:"stackdriver auto",value:"stackdriver-auto"},{text:"1m",value:"+60s"},{text:"5m",value:"+300s"},{text:"30m",value:"+1800s"},{text:"1h",value:"+3600s"},{text:"6h",value:"+21600s"},{text:"1d",value:"+86400s"},{text:"1w",value:"+604800s"}],wi={bit:"bits",By:"bytes",s:"s",min:"m",h:"h",d:"d",us:"µs",ms:"ms",ns:"ns",percent:"percent",MiBy:"mbytes","By/s":"Bps",GBy:"decgbytes"},xi=r(635),Si=r.n(xi);!function(t){t.Services="services",t.MetricTypes="metricTypes",t.LabelKeys="labelKeys",t.LabelValues="labelValues",t.ResourceTypes="resourceTypes",t.Aggregations="aggregations",t.Aligners="aligners",t.AlignmentPeriods="alignmentPeriods"}(gi||(gi={}));var ki=r(636),Ci=r.n(ki),Ti=function(t){return Ci()(t,"service")},Ei=function(t,e){return t.filter(function(t){return t.service===e})},_i=function(t,e,r,n){var a=Ei(t,n).map(function(t){return{value:t.type,name:t.displayName}});return{metricTypes:a,selectedMetricType:a.some(function(t){return t.value===r})?e:a[0].value}},Mi=function(t,e){return t?vi.filter(function(r){return-1!==r.valueTypes.indexOf(t)&&-1!==r.metricKinds.indexOf(e)}):[]},Ai=function(t,e){return e?bi.filter(function(r){return-1!==r.valueTypes.indexOf(t)&&-1!==r.metricKinds.indexOf(e)}):[]},Pi=function(t,e){return J.b(void 0,void 0,void 0,function(){var r,n;return J.d(this,function(a){switch(a.label){case 0:return r="handleLabelKeysQuery",[4,t.getLabels(e,r)];case 1:return n=a.sent(),[2,n.meta?Object.keys(n.meta.resourceLabels).map(function(t){return"resource.label."+t}).concat(Object.keys(n.meta.metricLabels).map(function(t){return"metric.label."+t})):[]]}})})},$i=function(){function t(t){this.datasource=t}return t.prototype.execute=function(t){return J.b(this,void 0,void 0,function(){return J.d(this,function(e){try{switch(t.selectedQueryType){case gi.Services:return[2,this.handleServiceQuery()];case gi.MetricTypes:return[2,this.handleMetricTypesQuery(t)];case gi.LabelKeys:return[2,this.handleLabelKeysQuery(t)];case gi.LabelValues:return[2,this.handleLabelValuesQuery(t)];case gi.ResourceTypes:return[2,this.handleResourceTypeQuery(t)];case gi.Aligners:return[2,this.handleAlignersQuery(t)];case gi.AlignmentPeriods:return[2,this.handleAlignmentPeriodQuery()];case gi.Aggregations:return[2,this.handleAggregationQuery(t)];default:return[2,[]]}}catch(e){return console.error("Could not run StackdriverMetricFindQuery "+t,e),[2,[]]}return[2]})})},t.prototype.handleServiceQuery=function(){return J.b(this,void 0,void 0,function(){var t;return J.d(this,function(e){switch(e.label){case 0:return[4,this.datasource.getMetricTypes(this.datasource.projectName)];case 1:return t=e.sent(),[2,Ti(t).map(function(t){return{text:t.serviceShortName,value:t.service,expandable:!0}})]}})})},t.prototype.handleMetricTypesQuery=function(t){var e=t.selectedService;return J.b(this,void 0,void 0,function(){var t;return J.d(this,function(r){switch(r.label){case 0:return e?[4,this.datasource.getMetricTypes(this.datasource.projectName)]:[2,[]];case 1:return t=r.sent(),[2,Ei(t,this.datasource.templateSrv.replace(e)).map(function(t){return{text:t.displayName,value:t.type,expandable:!0}})]}})})},t.prototype.handleLabelKeysQuery=function(t){var e=t.selectedMetricType;return J.b(this,void 0,void 0,function(){return J.d(this,function(t){switch(t.label){case 0:return e?[4,Pi(this.datasource,e)]:[2,[]];case 1:return[2,t.sent().map(this.toFindQueryResult)]}})})},t.prototype.handleLabelValuesQuery=function(t){var e=t.selectedMetricType,r=t.labelKey;return J.b(this,void 0,void 0,function(){var t,n,a,i,s;return J.d(this,function(o){switch(o.label){case 0:return e?(t="handleLabelValuesQuery",[4,this.datasource.getLabels(e,t)]):[2,[]];case 1:return n=o.sent(),a=this.datasource.templateSrv.replace(r),i=a.split(".").reverse()[0],s=[],n.meta&&n.meta.metricLabels&&n.meta.metricLabels.hasOwnProperty(i)?s=n.meta.metricLabels[i]:n.meta&&n.meta.resourceLabels&&n.meta.resourceLabels.hasOwnProperty(i)&&(s=n.meta.resourceLabels[i]),[2,s.map(this.toFindQueryResult)]}})})},t.prototype.handleResourceTypeQuery=function(t){var e=t.selectedMetricType;return J.b(this,void 0,void 0,function(){var t,r;return J.d(this,function(n){switch(n.label){case 0:return e?(t="handleResourceTypeQueryQueryType",[4,this.datasource.getLabels(e,t)]):[2,[]];case 1:return[2,(r=n.sent()).meta.resourceTypes?r.meta.resourceTypes.map(this.toFindQueryResult):[]]}})})},t.prototype.handleAlignersQuery=function(t){var e=t.selectedMetricType;return J.b(this,void 0,void 0,function(){var t,r,n,a,i=this;return J.d(this,function(s){switch(s.label){case 0:return e?[4,this.datasource.getMetricTypes(this.datasource.projectName)]:[2,[]];case 1:return t=s.sent(),r=t.find(function(t){return t.type===i.datasource.templateSrv.replace(e)}),n=r.valueType,a=r.metricKind,[2,Mi(n,a).map(this.toFindQueryResult)]}})})},t.prototype.handleAggregationQuery=function(t){var e=t.selectedMetricType;return J.b(this,void 0,void 0,function(){var t,r,n,a,i=this;return J.d(this,function(s){switch(s.label){case 0:return e?[4,this.datasource.getMetricTypes(this.datasource.projectName)]:[2,[]];case 1:return t=s.sent(),r=t.find(function(t){return t.type===i.datasource.templateSrv.replace(e)}),n=r.valueType,a=r.metricKind,[2,Ai(n,a).map(this.toFindQueryResult)]}})})},t.prototype.handleAlignmentPeriodQuery=function(){return yi.map(this.toFindQueryResult)},t.prototype.toFindQueryResult=function(t){return Si()(t)?{text:t,expandable:!0}:J.a({},t,{expandable:!0})},t}(),Di=function(){function t(t,e,r,n){this.backendSrv=e,this.templateSrv=r,this.timeSrv=n,this.baseUrl="/stackdriver/",this.url=t.url,this.doRequest=this.doRequest,this.id=t.id,this.projectName=t.jsonData.defaultProject||"",this.authenticationType=t.jsonData.authenticationType||"jwt",this.metricTypes=[]}return t.$inject=["instanceSettings","backendSrv","templateSrv","timeSrv"],t.prototype.getTimeSeries=function(t){return J.b(this,void 0,void 0,function(){var e,r=this;return J.d(this,function(n){switch(n.label){case 0:return(e=t.targets.filter(function(t){return!t.hide&&t.metricType}).map(function(e){return e.hasOwnProperty("aggregation")||(e.aggregation={crossSeriesReducer:"REDUCE_MEAN",groupBys:[]}),{refId:e.refId,intervalMs:t.intervalMs,datasourceId:r.id,metricType:r.templateSrv.replace(e.metricType,t.scopedVars||{}),primaryAggregation:r.templateSrv.replace(e.aggregation.crossSeriesReducer,t.scopedVars||{}),perSeriesAligner:r.templateSrv.replace(e.aggregation.perSeriesAligner,t.scopedVars||{}),alignmentPeriod:r.templateSrv.replace(e.aggregation.alignmentPeriod,t.scopedVars||{}),groupBys:r.interpolateGroupBys(e.aggregation.groupBys,t.scopedVars),view:e.view||"FULL",filters:(e.filters||[]).map(function(e){return r.templateSrv.replace(e,t.scopedVars||{})}),aliasBy:r.templateSrv.replace(e.aliasBy,t.scopedVars||{}),type:"timeSeriesQuery"}})).length>0?[4,this.backendSrv.datasourceRequest({url:"/api/tsdb/query",method:"POST",data:{from:t.range.from.valueOf().toString(),to:t.range.to.valueOf().toString(),queries:e}})]:[3,2];case 1:return[2,n.sent().data];case 2:return[2,{results:[]}]}})})},t.prototype.getLabels=function(t,e){return J.b(this,void 0,void 0,function(){return J.d(this,function(r){switch(r.label){case 0:return[4,this.getTimeSeries({targets:[{refId:e,datasourceId:this.id,metricType:this.templateSrv.replace(t),aggregation:{crossSeriesReducer:"REDUCE_NONE"},view:"HEADERS"}],range:this.timeSrv.timeRange()})];case 1:return[2,r.sent().results[e]]}})})},t.prototype.interpolateGroupBys=function(t,e){var r=this,n=[];return(t||[]).forEach(function(t){var a=r.templateSrv.replace(t,e||{},"csv").split(",");Array.isArray(a)?n=n.concat(a):n.push(a)}),n},t.prototype.resolvePanelUnitFromTargets=function(t){var e;return t.length>0&&t.every(function(e){return e.unit===t[0].unit})&&wi.hasOwnProperty(t[0].unit)&&(e=wi[t[0].unit]),e},t.prototype.query=function(t){return J.b(this,void 0,void 0,function(){var e,r,n=this;return J.d(this,function(a){switch(a.label){case 0:return e=[],[4,this.getTimeSeries(t)];case 1:return(r=a.sent()).results?(Object.values(r.results).forEach(function(r){if(r.series){var a=n.resolvePanelUnitFromTargets(t.targets);r.series.forEach(function(t){var n={target:t.name,datapoints:t.points,refId:r.refId,meta:r.meta};a&&(n=J.a({},n,{unit:a})),e.push(n)})}}),[2,{data:e}]):[2,{data:[]}]}})})},t.prototype.annotationQuery=function(t){return J.b(this,void 0,void 0,function(){var e,r,n,a=this;return J.d(this,function(i){switch(i.label){case 0:return e=t.annotation,r=[{refId:"annotationQuery",datasourceId:this.id,metricType:this.templateSrv.replace(e.target.metricType,t.scopedVars||{}),primaryAggregation:"REDUCE_NONE",perSeriesAligner:"ALIGN_NONE",title:this.templateSrv.replace(e.target.title,t.scopedVars||{}),text:this.templateSrv.replace(e.target.text,t.scopedVars||{}),tags:this.templateSrv.replace(e.target.tags,t.scopedVars||{}),view:"FULL",filters:(e.target.filters||[]).map(function(e){return a.templateSrv.replace(e,t.scopedVars||{})}),type:"annotationQuery"}],[4,this.backendSrv.datasourceRequest({url:"/api/tsdb/query",method:"POST",data:{from:t.range.from.valueOf().toString(),to:t.range.to.valueOf().toString(),queries:r}})];case 1:return n=i.sent().data,[2,n.results.annotationQuery.tables[0].rows.map(function(t){return{annotation:e,time:Date.parse(t[0]),title:t[1],tags:[],text:t[3]}})]}})})},t.prototype.metricFindQuery=function(t){return J.b(this,void 0,void 0,function(){return J.d(this,function(e){return[2,new $i(this).execute(t)]})})},t.prototype.testDatasource=function(){return J.b(this,void 0,void 0,function(){var t,e,r,n,a,i,s;return J.d(this,function(o){switch(o.label){case 0:r="Cannot connect to Stackdriver API",o.label=1;case 1:return o.trys.push([1,4,5,6]),[4,this.getDefaultProject()];case 2:return n=o.sent(),a="v3/projects/"+n+"/metricDescriptors",[4,this.doRequest(""+this.baseUrl+a)];case 3:return 200===(i=o.sent()).status?(t="success",e="Successfully queried the Stackdriver API."):(t="error",e=i.statusText?i.statusText:r),[3,6];case 4:return s=o.sent(),t="error",I.a.isString(s)?e=s:(e="Stackdriver: ",e+=s.statusText?s.statusText:r,s.data&&s.data.error&&s.data.error.code&&(e+=": "+s.data.error.code+". "+s.data.error.message)),[3,6];case 5:return[2,{status:t,message:e}];case 6:return[2]}})})},t.prototype.formatStackdriverError=function(t){var e="Stackdriver: ";if(e+=t.statusText?t.statusText+": ":"",t.data&&t.data.error)try{var r=JSON.parse(t.data.error);e+=r.error.code+". "+r.error.message}catch(r){e+=t.data.error}else e+="Cannot connect to Stackdriver API";return e},t.prototype.getDefaultProject=function(){return J.b(this,void 0,void 0,function(){var t,e;return J.d(this,function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),"gce"!==this.authenticationType&&this.projectName?[3,2]:[4,this.backendSrv.datasourceRequest({url:"/api/tsdb/query",method:"POST",data:{queries:[{refId:"ensureDefaultProjectQuery",type:"ensureDefaultProjectQuery",datasourceId:this.id}]}})];case 1:return t=r.sent().data,this.projectName=t.results.ensureDefaultProjectQuery.meta.defaultProject,[2,this.projectName];case 2:return[2,this.projectName];case 3:return[3,5];case 4:throw e=r.sent(),this.formatStackdriverError(e);case 5:return[2]}})})},t.prototype.getMetricTypes=function(t){return J.b(this,void 0,void 0,function(){var e,r,n;return J.d(this,function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),0!==this.metricTypes.length?[3,2]:(e="v3/projects/"+t+"/metricDescriptors",[4,this.doRequest(""+this.baseUrl+e)]);case 1:r=a.sent().data,this.metricTypes=r.metricDescriptors.map(function(t){var e=t.type.split("/")[0],r=e.split(".")[0];return t.service=e,t.serviceShortName=r,t.displayName=t.displayName||t.type,t}),a.label=2;case 2:return[2,this.metricTypes];case 3:return n=a.sent(),bt.a.emit("ds-request-error",this.formatStackdriverError(n)),[2,[]];case 4:return[2]}})})},t.prototype.doRequest=function(t,e){return void 0===e&&(e=1),J.b(this,void 0,void 0,function(){var r=this;return J.d(this,function(n){return[2,this.backendSrv.datasourceRequest({url:this.url+t,method:"GET"}).catch(function(n){if(e>0)return r.doRequest(t,e-1);throw n})]})})},t}(),Oi=function(){return function(){return{templateUrl:"public/app/plugins/datasource/stackdriver/partials/query.aggregation.html",controller:"StackdriverAggregationCtrl",restrict:"E",scope:{target:"=",alignmentPeriod:"<",refresh:"&"}}}}(),Ii=function(){function t(t,e){this.$scope=t,this.templateSrv=e,this.$scope.ctrl=this,this.target=t.target,this.alignmentPeriods=yi,this.aggOptions=bi,this.alignOptions=vi,this.setAggOptions(),this.setAlignOptions();var r=this;t.$on("metricTypeChanged",function(){r.setAggOptions(),r.setAlignOptions()})}return t.$inject=["$scope","templateSrv"],t.prototype.setAlignOptions=function(){var t=this;this.alignOptions=Mi(this.target.valueType,this.target.metricKind),this.alignOptions.find(function(e){return e.value===t.templateSrv.replace(t.target.aggregation.perSeriesAligner)})||(this.target.aggregation.perSeriesAligner=this.alignOptions.length>0?this.alignOptions[0].value:"")},t.prototype.setAggOptions=function(){var t=this;this.aggOptions=Ai(this.target.valueType,this.target.metricKind),this.aggOptions.find(function(e){return e.value===t.templateSrv.replace(t.target.aggregation.crossSeriesReducer)})||this.deselectAggregationOption("REDUCE_NONE"),this.target.aggregation.groupBys.length>0&&(this.aggOptions=this.aggOptions.filter(function(t){return"REDUCE_NONE"!==t.value}),this.deselectAggregationOption("REDUCE_NONE"))},t.prototype.formatAlignmentText=function(){var t=this,e=this.alignOptions.find(function(e){return e.value===t.templateSrv.replace(t.target.aggregation.perSeriesAligner)});return kt.a.secondsToHms(this.$scope.alignmentPeriod)+" interval ("+(e?e.text:"")+")"},t.prototype.deselectAggregationOption=function(t){var e=this.aggOptions.find(function(e){return e.value!==t});this.target.aggregation.crossSeriesReducer=e?e.value:""},t}();z.c.directive("stackdriverAggregation",Oi),z.c.controller("StackdriverAggregationCtrl",Ii);var Ni=function(){function t(t,e,r,n){this.uiSegmentSrv=t,this.target=e,this.getFilterKeysFunc=r,this.getFilterValuesFunc=n}return t.prototype.buildSegmentModel=function(){var t=this;this.removeSegment=this.uiSegmentSrv.newSegment({fake:!0,value:"-- remove filter --"}),this.filterSegments=[],this.target.filters.forEach(function(e,r){switch(r%4){case 0:t.filterSegments.push(t.uiSegmentSrv.newKey(e));break;case 1:t.filterSegments.push(t.uiSegmentSrv.newOperator(e));break;case 2:t.filterSegments.push(t.uiSegmentSrv.newKeyValue(e));break;case 3:t.filterSegments.push(t.uiSegmentSrv.newCondition(e))}}),this.ensurePlusButton(this.filterSegments)},t.prototype.getFilters=function(t,e,r){return J.b(this,void 0,void 0,function(){var n;return J.d(this,function(a){return"condition"===t.type?[2,[this.uiSegmentSrv.newSegment("AND")]]:"operator"===t.type?[2,this.uiSegmentSrv.newOperators(["=","!=","=~","!=~"])]:"key"===t.type||"plus-button"===t.type?r&&t.value&&"-- remove filter --"!==t.value?(this.removeSegment.value="-- remove filter --",[2,Promise.resolve([this.removeSegment])]):[2,this.getFilterKeysFunc(t,"-- remove filter --")]:"value"===t.type&&(n=this.getFilterValuesFunc(e)).length>0?[2,this.getValuesForFilterKey(n)]:[2,[]]})})},t.prototype.getValuesForFilterKey=function(t){var e=this;return t.map(function(t){return e.uiSegmentSrv.newSegment({value:""+t,expandable:!1})})},t.prototype.addNewFilterSegments=function(t,e){e>2&&this.filterSegments.splice(e,0,this.uiSegmentSrv.newCondition("AND")),t.type="key",this.filterSegments.push(this.uiSegmentSrv.newOperator("=")),this.filterSegments.push(this.uiSegmentSrv.newFake("select value","value","query-segment-value"))},t.prototype.removeFilterSegment=function(t){this.filterSegments.splice(t,3),t>2&&"condition"===this.filterSegments[t-1].type&&this.filterSegments.splice(t-1,1),0===t&&this.filterSegments.length>0&&"condition"===this.filterSegments[0].type&&this.filterSegments.splice(0,1)},t.prototype.ensurePlusButton=function(t){var e=t.length,r=t[Math.max(e-1,0)];r&&"plus-button"===r.type||t.push(this.uiSegmentSrv.newPlusButton())},t.prototype.filterSegmentUpdated=function(t,e){return"plus-button"===t.type?this.addNewFilterSegments(t,e):"key"===t.type&&"-- remove filter --"===t.value?(this.removeFilterSegment(e),this.ensurePlusButton(this.filterSegments)):"value"===t.type&&"select value"!==t.value&&this.ensurePlusButton(this.filterSegments),this.filterSegments.filter(function(t){return"plus-button"!==t.type}).map(function(t){return t.value})},t}(),Fi=function(){return function(){return{templateUrl:"public/app/plugins/datasource/stackdriver/partials/query.filter.html",controller:"StackdriverFilterCtrl",controllerAs:"ctrl",restrict:"E",scope:{target:"=",datasource:"=",refresh:"&",defaultDropdownValue:"<",defaultServiceValue:"<",hideGroupBys:"<"}}}}(),qi=function(){function t(t,e,r,n){this.$scope=t,this.uiSegmentSrv=e,this.templateSrv=r,this.$rootScope=n,this.defaultRemoveGroupByValue="-- remove group by --",this.resourceTypeValue="resource.type",this.datasource=t.datasource,this.target=t.target,this.metricType=t.defaultDropdownValue,this.service=t.defaultServiceValue,this.metricDescriptors=[],this.metrics=[],this.services=[],this.getCurrentProject().then(this.loadMetricDescriptors.bind(this)).then(this.getLabels.bind(this)),this.initSegments(t.hideGroupBys)}return t.$inject=["$scope","uiSegmentSrv","templateSrv","$rootScope"],t.prototype.initSegments=function(t){var e=this;t||(this.groupBySegments=this.target.aggregation.groupBys.map(function(t){return e.uiSegmentSrv.getSegmentForValue(t)}),this.ensurePlusButton(this.groupBySegments)),this.removeSegment=this.uiSegmentSrv.newSegment({fake:!0,value:"-- remove group by --"}),this.filterSegments=new Ni(this.uiSegmentSrv,this.target,this.getFilterKeys.bind(this),this.getFilterValues.bind(this)),this.filterSegments.buildSegmentModel()},t.prototype.getCurrentProject=function(){return J.b(this,void 0,void 0,function(){var t=this;return J.d(this,function(e){return[2,new Promise(function(e,r){return J.b(t,void 0,void 0,function(){var t,n;return J.d(this,function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),this.target.defaultProject&&"loading project..."!==this.target.defaultProject?[3,2]:(t=this.target,[4,this.datasource.getDefaultProject()]);case 1:t.defaultProject=a.sent(),a.label=2;case 2:return e(this.target.defaultProject),[3,4];case 3:return n=a.sent(),bt.a.emit("ds-request-error",n),r(),[3,4];case 4:return[2]}})})})]})})},t.prototype.loadMetricDescriptors=function(){return J.b(this,void 0,void 0,function(){var t;return J.d(this,function(e){switch(e.label){case 0:return"loading project..."===this.target.defaultProject?[3,2]:(t=this,[4,this.datasource.getMetricTypes(this.target.defaultProject)]);case 1:return t.metricDescriptors=e.sent(),this.services=this.getServicesList(),this.metrics=this.getMetricsList(),[2,this.metricDescriptors];case 2:return[2,[]]}})})},t.prototype.getServicesList=function(){var t=this,e={value:this.$scope.defaultServiceValue,text:this.$scope.defaultServiceValue},r=this.metricDescriptors.map(function(t){return{value:t.service,text:t.serviceShortName}});return r.find(function(e){return e.value===t.target.service})&&(this.service=this.target.service),r.length>0?[e].concat(I.a.uniqBy(r,"value")):[]},t.prototype.getMetricsList=function(){var t,e=this,r=this.metricDescriptors.map(function(t){return{service:t.service,value:t.type,serviceShortName:t.serviceShortName,text:t.displayName,title:t.description}});return(t=this.target.service===this.$scope.defaultServiceValue?r.map(function(t){return J.a({},t,{text:t.service+" - "+t.text})}):r.filter(function(t){return t.service===e.target.service})).find(function(t){return t.value===e.templateSrv.replace(e.target.metricType)})?this.metricType=this.target.metricType:t.length>0&&(this.metricType=this.target.metricType=t[0].value),t},t.prototype.getLabels=function(){return J.b(this,void 0,void 0,function(){var t=this;return J.d(this,function(e){return this.loadLabelsPromise=new Promise(function(e){return J.b(t,void 0,void 0,function(){var t,r;return J.d(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.datasource.getLabels(this.target.metricType,this.target.refId)];case 1:return t=n.sent().meta,this.metricLabels=t.metricLabels,this.resourceLabels=t.resourceLabels,this.resourceTypes=t.resourceTypes,e(),[3,3];case 2:return(r=n.sent()).data&&r.data.message?console.log(r.data.message):console.log(r),bt.a.emit("alert-error",["Error","Error loading metric labels for "+this.target.metricType]),e(),[3,3];case 3:return[2]}})})}),[2]})})},t.prototype.onServiceChange=function(){var t=this;this.target.service=this.service,this.metrics=this.getMetricsList(),this.setMetricType(),this.getLabels(),this.metrics.find(function(e){return e.value===t.target.metricType})?this.$scope.refresh():this.target.metricType=this.$scope.defaultDropdownValue},t.prototype.onMetricTypeChange=function(){return J.b(this,void 0,void 0,function(){return J.d(this,function(t){return this.setMetricType(),this.$scope.refresh(),this.getLabels(),[2]})})},t.prototype.setMetricType=function(){var t=this;this.target.metricType=this.metricType;var e=this.metricDescriptors.find(function(e){return e.type===t.templateSrv.replace(t.metricType)}),r=e.valueType,n=e.metricKind,a=e.unit;this.target.unit=a,this.target.valueType=r,this.target.metricKind=n,this.$rootScope.$broadcast("metricTypeChanged")},t.prototype.createLabelKeyElements=function(){return J.b(this,void 0,void 0,function(){var t,e=this;return J.d(this,function(r){switch(r.label){case 0:return[4,this.loadLabelsPromise];case 1:return r.sent(),t=(t=Object.keys(this.metricLabels||{}).map(function(t){return e.uiSegmentSrv.newSegment({value:"metric.label."+t,expandable:!1})})).concat(Object.keys(this.resourceLabels||{}).map(function(t){return e.uiSegmentSrv.newSegment({value:"resource.label."+t,expandable:!1})})),this.resourceTypes&&this.resourceTypes.length>0&&(t=t.concat([this.uiSegmentSrv.newSegment({value:this.resourceTypeValue,expandable:!1})])),[2,t]}})})},t.prototype.getFilterKeys=function(t,e){return J.b(this,void 0,void 0,function(){var r,n=this;return J.d(this,function(a){switch(a.label){case 0:return[4,this.createLabelKeyElements()];case 1:return r=a.sent(),-1!==this.target.filters.indexOf(this.resourceTypeValue)&&(r=r.filter(function(t){return t.value!==n.resourceTypeValue})),(!t||"plus-button"===t.type)&&0===r.length?[2,[]]:(this.removeSegment.value=e,[2,r.concat([this.removeSegment])])}})})},t.prototype.getGroupBys=function(t){return J.b(this,void 0,void 0,function(){var e,r=this;return J.d(this,function(n){switch(n.label){case 0:return[4,this.createLabelKeyElements()];case 1:return e=(e=n.sent()).filter(function(t){return-1===r.target.aggregation.groupBys.indexOf(t.value)}),(!t||"plus-button"===t.type)&&0===e.length?[2,[]]:(this.removeSegment.value=this.defaultRemoveGroupByValue,[2,e.concat([this.removeSegment])])}})})},t.prototype.groupByChanged=function(t,e){t.value===this.removeSegment.value?this.groupBySegments.splice(e,1):t.type="value";this.target.aggregation.groupBys=this.groupBySegments.reduce(function(t,e){return e.fake||t.push(e.value),t},[]),this.ensurePlusButton(this.groupBySegments),this.$rootScope.$broadcast("metricTypeChanged"),this.$scope.refresh()},t.prototype.getFilters=function(t,e){return J.b(this,void 0,void 0,function(){var r;return J.d(this,function(n){return r=this.metricLabels&&0===Object.keys(this.metricLabels).length,[2,this.filterSegments.getFilters(t,e,r)]})})},t.prototype.getFilterValues=function(t){var e=this.templateSrv.replace(this.filterSegments.filterSegments[t-2].value);if(!e||!this.metricLabels||0===Object.keys(this.metricLabels).length)return[];var r=e.substring(e.indexOf(".label.")+7);return e.startsWith("metric.label.")&&this.metricLabels.hasOwnProperty(r)?this.metricLabels[r]:e.startsWith("resource.label.")&&this.resourceLabels.hasOwnProperty(r)?this.resourceLabels[r]:e===this.resourceTypeValue?this.resourceTypes:[]},t.prototype.filterSegmentUpdated=function(t,e){this.target.filters=this.filterSegments.filterSegmentUpdated(t,e),this.$scope.refresh()},t.prototype.ensurePlusButton=function(t){var e=t.length,r=t[Math.max(e-1,0)];r&&"plus-button"===r.type||t.push(this.uiSegmentSrv.newPlusButton())},t}();z.c.directive("stackdriverFilter",Fi),z.c.controller("StackdriverFilterCtrl",qi);var Li=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.defaultDropdownValue="Select Metric",n.defaultServiceValue="All Services",n.defaults={defaultProject:"loading project...",metricType:n.defaultDropdownValue,service:n.defaultServiceValue,metric:"",unit:"",aggregation:{crossSeriesReducer:"REDUCE_MEAN",alignmentPeriod:"stackdriver-auto",perSeriesAligner:"ALIGN_MEAN",groupBys:[]},filters:[],showAggregationOptions:!1,aliasBy:"",metricKind:"",valueType:""},I.a.defaultsDeep(n.target,n.defaults),n.panelCtrl.events.on("data-received",n.onDataReceived.bind(n),e),n.panelCtrl.events.on("data-error",n.onDataError.bind(n),e),n}return e.$inject=["$scope","$injector"],J.c(e,t),e.prototype.onDataReceived=function(t){this.lastQueryError=null,this.lastQueryMeta=null;var e=I.a.find(t,{refId:this.target.refId});e&&(this.lastQueryMeta=e.meta,this.lastQueryMeta.rawQueryString=decodeURIComponent(this.lastQueryMeta.rawQuery))},e.prototype.onDataError=function(t){if(t.data&&t.data.results){var e=t.data.results[this.target.refId];if(e&&e.error){this.lastQueryMeta=e.meta,this.lastQueryMeta.rawQueryString=decodeURIComponent(this.lastQueryMeta.rawQuery);var r=void 0;try{r=JSON.parse(e.error)}catch(t){this.lastQueryError=e.error}this.lastQueryError=r.error.message}}},e.templateUrl="partials/query.editor.html",e}(Ht),Ri=function(){function t(t){this.validationErrors=[],this.defaultAuthenticationType="jwt",this.datasourceSrv=t,this.current.jsonData=this.current.jsonData||{},this.current.jsonData.authenticationType=this.current.jsonData.authenticationType?this.current.jsonData.authenticationType:this.defaultAuthenticationType,this.current.secureJsonData=this.current.secureJsonData||{},this.current.secureJsonFields=this.current.secureJsonFields||{},this.authenticationTypes=[{key:this.defaultAuthenticationType,value:"Google JWT File"},{key:"gce",value:"GCE Default Service Account"}]}return t.$inject=["datasourceSrv"],t.prototype.save=function(t){this.current.secureJsonData.privateKey=t.private_key,this.current.jsonData.tokenUri=t.token_uri,this.current.jsonData.clientEmail=t.client_email,this.current.jsonData.defaultProject=t.project_id},t.prototype.validateJwt=function(t){return this.resetValidationMessages(),t.private_key&&0!==t.private_key.length||this.validationErrors.push("Private key field missing in JWT file."),t.token_uri&&0!==t.token_uri.length||this.validationErrors.push("Token URI field missing in JWT file."),t.client_email&&0!==t.client_email.length||this.validationErrors.push("Client Email field missing in JWT file."),t.project_id&&0!==t.project_id.length||this.validationErrors.push("Project Id field missing in JWT file."),0===this.validationErrors.length&&(this.inputDataValid=!0,!0)},t.prototype.onUpload=function(t){this.jsonText="",this.validateJwt(t)&&this.save(t)},t.prototype.onPasteJwt=function(t){try{var e=JSON.parse(t.originalEvent.clipboardData.getData("text/plain")||this.jsonText);this.validateJwt(e)&&this.save(e)}catch(t){this.resetValidationMessages(),this.validationErrors.push("Invalid json: "+t.message)}},t.prototype.resetValidationMessages=function(){this.validationErrors=[],this.inputDataValid=!1,this.jsonText="",this.current.jsonData=Object.assign({},{authenticationType:this.current.jsonData.authenticationType}),this.current.secureJsonData={},this.current.secureJsonFields={}},t.templateUrl="public/app/plugins/datasource/stackdriver/partials/config.html",t}(),ji=function(){function t(){this.defaultDropdownValue="Select Metric",this.defaultServiceValue="All Services",this.defaults={project:{id:"default",name:"loading project..."},metricType:this.defaultDropdownValue,service:this.defaultServiceValue,metric:"",filters:[],metricKind:"",valueType:""},this.annotation.target=this.annotation.target||{},this.annotation.target.refId="annotationQuery",I.a.defaultsDeep(this.annotation.target,this.defaults)}return t.templateUrl="partials/annotations.editor.html",t}(),Ui=function(t){var e=t.label,r=t.onValueChange,n=t.value,a=t.options;return j.a.createElement("div",{className:"gf-form max-width-21"},j.a.createElement("span",{className:"gf-form-label width-10 query-keyword"},e),j.a.createElement("div",{className:"gf-form-select-wrapper max-width-12"},j.a.createElement("select",{className:"gf-form-input",required:!0,onChange:r,value:n},a.map(function(t,e){var r=t.value,n=t.name;return j.a.createElement("option",{key:e,value:r},n)}))))},Vi=function(t){function e(e){var r=t.call(this,e)||this;return r.queryTypes=[{value:gi.Services,name:"Services"},{value:gi.MetricTypes,name:"Metric Types"},{value:gi.LabelKeys,name:"Label Keys"},{value:gi.LabelValues,name:"Label Values"},{value:gi.ResourceTypes,name:"Resource Types"},{value:gi.Aggregations,name:"Aggregations"},{value:gi.Aligners,name:"Aligners"},{value:gi.AlignmentPeriods,name:"Alignment Periods"}],r.defaults={selectedQueryType:r.queryTypes[0].value,metricDescriptors:[],selectedService:"",selectedMetricType:"",labels:[],labelKey:"",metricTypes:[],services:[]},r.state=Object.assign(r.defaults,r.props.query),r}return J.c(e,t),e.prototype.componentDidMount=function(){return J.b(this,void 0,void 0,function(){var t,e,r,n,a,i,s,o,l=this;return J.d(this,function(c){switch(c.label){case 0:return[4,this.props.datasource.getMetricTypes(this.props.datasource.projectName)];case 1:return t=c.sent(),e=Ti(t).map(function(t){return{value:t.service,name:t.serviceShortName}}),r="",e.some(function(t){return t.value===l.props.templateSrv.replace(l.state.selectedService)})?r=this.state.selectedService:e&&e.length>0&&(r=e[0].value),n=_i(t,this.state.selectedMetricType,this.props.templateSrv.replace(this.state.selectedMetricType),this.props.templateSrv.replace(r)),a=n.metricTypes,i=n.selectedMetricType,o=[{services:e,selectedService:r,metricTypes:a,selectedMetricType:i,metricDescriptors:t}],[4,this.getLabels(i)];case 2:return s=J.a.apply(void 0,o.concat([c.sent()])),this.setState(s),[2]}})})},e.prototype.handleQueryTypeChange=function(t){return J.b(this,void 0,void 0,function(){var e,r;return J.d(this,function(n){switch(n.label){case 0:return r=[{selectedQueryType:t.target.value}],[4,this.getLabels(this.state.selectedMetricType,t.target.value)];case 1:return e=J.a.apply(void 0,r.concat([n.sent()])),this.setState(e),[2]}})})},e.prototype.onServiceChange=function(t){return J.b(this,void 0,void 0,function(){var e,r,n,a,i;return J.d(this,function(s){switch(s.label){case 0:return e=_i(this.state.metricDescriptors,this.state.selectedMetricType,this.props.templateSrv.replace(this.state.selectedMetricType),this.props.templateSrv.replace(t.target.value)),r=e.metricTypes,n=e.selectedMetricType,i=[{selectedService:t.target.value,metricTypes:r,selectedMetricType:n}],[4,this.getLabels(n)];case 1:return a=J.a.apply(void 0,i.concat([s.sent()])),this.setState(a),[2]}})})},e.prototype.onMetricTypeChange=function(t){return J.b(this,void 0,void 0,function(){var e,r;return J.d(this,function(n){switch(n.label){case 0:return r=[{selectedMetricType:t.target.value}],[4,this.getLabels(t.target.value)];case 1:return e=J.a.apply(void 0,r.concat([n.sent()])),this.setState(e),[2]}})})},e.prototype.onLabelKeyChange=function(t){this.setState({labelKey:t.target.value})},e.prototype.componentDidUpdate=function(){var t=this,e=this.state,r=(e.metricDescriptors,e.labels,e.metricTypes,e.services,J.e(e,["metricDescriptors","labels","metricTypes","services"])),n=this.queryTypes.find(function(e){return e.value===t.state.selectedQueryType});this.props.onChange(r,"Stackdriver - "+n.name)},e.prototype.getLabels=function(t,e){return void 0===e&&(e=this.state.selectedQueryType),J.b(this,void 0,void 0,function(){var r,n,a,i=this;return J.d(this,function(s){switch(s.label){case 0:return r={labels:this.state.labels,labelKey:this.state.labelKey},t&&e===gi.LabelValues?[4,Pi(this.props.datasource,t)]:[3,2];case 1:n=s.sent(),a=n.some(function(t){return t===i.props.templateSrv.replace(i.state.labelKey)})?this.state.labelKey:n[0],r={labels:n,labelKey:a},s.label=2;case 2:return[2,r]}})})},e.prototype.insertTemplateVariables=function(t){return this.props.templateSrv.variables.map(function(t){return{name:"$"+t.name,value:"$"+t.name}}).concat(t)},e.prototype.renderQueryTypeSwitch=function(t){var e=this;switch(t){case gi.MetricTypes:return j.a.createElement(Ui,{value:this.state.selectedService,options:this.insertTemplateVariables(this.state.services),onValueChange:function(t){return e.onServiceChange(t)},label:"Service"});case gi.LabelKeys:case gi.LabelValues:case gi.ResourceTypes:return j.a.createElement(j.a.Fragment,null,j.a.createElement(Ui,{value:this.state.selectedService,options:this.insertTemplateVariables(this.state.services),onValueChange:function(t){return e.onServiceChange(t)},label:"Service"}),j.a.createElement(Ui,{value:this.state.selectedMetricType,options:this.insertTemplateVariables(this.state.metricTypes),onValueChange:function(t){return e.onMetricTypeChange(t)},label:"Metric Type"}),t===gi.LabelValues&&j.a.createElement(Ui,{value:this.state.labelKey,options:this.insertTemplateVariables(this.state.labels.map(function(t){return{value:t,name:t}})),onValueChange:function(t){return e.onLabelKeyChange(t)},label:"Label Key"}));case gi.Aligners:case gi.Aggregations:return j.a.createElement(j.a.Fragment,null,j.a.createElement(Ui,{value:this.state.selectedService,options:this.insertTemplateVariables(this.state.services),onValueChange:function(t){return e.onServiceChange(t)},label:"Service"}),j.a.createElement(Ui,{value:this.state.selectedMetricType,options:this.insertTemplateVariables(this.state.metricTypes),onValueChange:function(t){return e.onMetricTypeChange(t)},label:"Metric Type"}));default:return""}},e.prototype.render=function(){var t=this;return j.a.createElement(j.a.Fragment,null,j.a.createElement(Ui,{value:this.state.selectedQueryType,options:this.queryTypes,onValueChange:function(e){return t.handleQueryTypeChange(e)},label:"Query Type"}),this.renderQueryTypeSwitch(this.state.selectedQueryType))},e}(R.PureComponent),Bi=function(t){function e(e,r,n,a){var i=t.call(this,e,r)||this;return i.templateSrv=n,i.$sce=a,i.panelDefaults={mode:"markdown",content:"# title"},I.a.defaults(i.panel,i.panelDefaults),i.events.on("init-edit-mode",i.onInitEditMode.bind(i)),i.events.on("refresh",i.onRefresh.bind(i)),i.events.on("render",i.onRender.bind(i)),e.$watch("ctrl.panel.content",I.a.throttle(function(){i.render()},1e3)),i}return e.$inject=["$scope","$injector","templateSrv","$sce"],J.c(e,t),e.prototype.onInitEditMode=function(){this.addEditorTab("Options","public/app/plugins/panel/text/editor.html"),this.editorTabIndex=1,"text"===this.panel.mode&&(this.panel.mode="markdown")},e.prototype.onRefresh=function(){this.render()},e.prototype.onRender=function(){"markdown"===this.panel.mode?this.renderMarkdown(this.panel.content):"html"===this.panel.mode&&this.updateContent(this.panel.content),this.renderingCompleted()},e.prototype.renderText=function(t){t=t.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\n/g,"<br/>"),this.updateContent(t)},e.prototype.renderMarkdown=function(t){var e=this;this.remarkable||(this.remarkable=new qt.a),this.$scope.$applyAsync(function(){e.updateContent(e.remarkable.render(t))})},e.prototype.updateContent=function(t){try{this.content=this.$sce.trustAsHtml(this.templateSrv.replace(t,this.panel.scopedVars))}catch(e){console.log("Text panel error: ",e),this.content=this.$sce.trustAsHtml(t)}},e.templateUrl="public/app/plugins/panel/text/module.html",e.scrollable=!0,e}(Lt),Qi=function(t){function e(e){return t.call(this,e)||this}return J.c(e,t),e.prototype.render=function(){return j.a.createElement("h2",null,"Text Panel!")},e}(R.PureComponent),Hi=r(167),zi=r.n(Hi),Gi=(r(148),r(262),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return J.c(e,t),e.prototype.componentDidUpdate=function(t){t.timeSeries===this.props.timeSeries&&t.timeRange===this.props.timeRange&&t.size===this.props.size||this.draw()},e.prototype.componentDidMount=function(){this.draw()},e.prototype.draw=function(){var t=this.props,e=t.size,r=t.timeSeries,n=t.timeRange,a=t.showLines,i=t.showBars,s=t.showPoints;if(e){var o=(e.width||0)/100,l=n.from.valueOf(),c=n.to.valueOf(),u={legend:{show:!1},series:{lines:{show:a,linewidth:1,zero:!1},points:{show:s,fill:1,fillColor:!1,radius:2},bars:{show:i,fill:1,barWidth:1,zero:!1,lineWidth:0},shadowSize:0},xaxis:{mode:"time",min:l,max:c,label:"Datetime",ticks:o,timeformat:function(t,e,r){if(e&&r&&t){var n=r-e,a=n/t/1e3;return a<=45?"%H:%M:%S":a<=7200||n<=864e5?"%H:%M":a<=8e4?"%m/%d %H:%M":a<=2419200||n<=31536e6?"%m/%d":"%Y-%m"}return"%H:%M"}(o,l,c)},grid:{minBorderMargin:0,markings:[],backgroundColor:null,borderWidth:0,clickable:!0,color:"#a1a1a1",margin:{left:0,right:0},labelMarginX:0}};try{F.a.plot(this.element,r,u)}catch(t){console.log("Graph rendering error",t,u,r)}}},e.prototype.render=function(){var t=this;return j.a.createElement("div",{className:"graph-panel"},j.a.createElement("div",{className:"graph-panel__chart",ref:function(e){return t.element=e}}))},e.defaultProps={showLines:!0,showPoints:!1,showBars:!1},e}(R.PureComponent));var Wi=Object(Hi.withSize)()(Gi),Yi=r(252),Ki=r(36);function Ji(t){var e=t.timeSeries,r=t.nullValueMode;return e.map(function(t,e){for(var n,a,i,s=e%xt.g.length,o=t.target,l=[],c=0,u=-Number.MAX_VALUE,d=Number.MAX_VALUE,p=Number.MAX_VALUE,h=null,f=null,m=null,g=0,v=null,b=null,y=Number.MAX_VALUE,w=!0,x=!0,S=r===Ki.d.Ignore,k=r===Ki.d.AsZero,C=0,T=0,E=!0,_=0;_<t.datapoints.length;_++){if(a=t.datapoints[_][0],n=t.datapoints[_][1],void 0!==i){var M=n-i;M<y&&(y=M)}if(i=n,null===a){if(S)continue;k&&(a=0)}null!==a&&(I.a.isNumber(a)&&(c+=a,w=!1,C++),a>u&&(u=a),a<d&&(d=a),null===m?m=a:T>a?(E=!1,_===t.datapoints.length-1&&(g+=a)):(g+=E?a-T:a,E=!0),T=a,a<p&&a>0&&(p=a),0!==a&&(x=!1)),l.push([n,a])}u===-Number.MAX_VALUE&&(u=null),d===Number.MAX_VALUE&&(d=null),l.length&&!w&&(h=c/C,null===(f=l[l.length-1][1])&&l.length>1&&(f=l[l.length-2][1])),null!==u&&null!==d&&(b=u-d),null!==f&&null!==m&&(v=f-m);var A=l.length;return{data:l,label:o,color:xt.g[s],stats:{total:c,min:d,max:u,current:f,logmin:p,avg:h,diff:v,delta:g,timeStep:y,range:b,count:A,first:m,allIsZero:x,allIsNull:w}}})}var Xi=function(t){function e(e){return t.call(this,e)||this}return J.c(e,t),e.prototype.render=function(){var t=this.props,e=t.timeSeries,r=t.timeRange,n=this.props.options,a=n.showLines,i=n.showBars,s=n.showPoints,o=Ji({timeSeries:e,nullValueMode:Ki.d.Ignore});return j.a.createElement(Wi,{timeSeries:o,timeRange:r,showLines:a,showPoints:s,showBars:i})},e}(R.PureComponent),Zi=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onToggleLines=function(){e.props.onChange(J.a({},e.props.options,{showLines:!e.props.options.showLines}))},e.onToggleBars=function(){e.props.onChange(J.a({},e.props.options,{showBars:!e.props.options.showBars}))},e.onTogglePoints=function(){e.props.onChange(J.a({},e.props.options,{showPoints:!e.props.options.showPoints}))},e}return J.c(e,t),e.prototype.render=function(){var t=this.props.options,e=t.showBars,r=t.showPoints,n=t.showLines;return j.a.createElement("div",null,j.a.createElement("div",{className:"section gf-form-group"},j.a.createElement("h5",{className:"page-heading"},"Draw Modes"),j.a.createElement(Yi.a,{label:"Lines",labelClass:"width-5",checked:n,onChange:this.onToggleLines}),j.a.createElement(Yi.a,{label:"Bars",labelClass:"width-5",checked:e,onChange:this.onToggleBars}),j.a.createElement(Yi.a,{label:"Points",labelClass:"width-5",checked:r,onChange:this.onTogglePoints})))},e}(R.PureComponent);r(354),r(355),r(579),r(580),r(581),r(582);function ts(t,e,r){var n=L.a.element(document).injector(),a=document.createElement("div");a.innerHTML='<annotation-tooltip event="event" on-edit="onEdit()"></annotation-tooltip>',n.invoke(["$compile","$rootScope",function(n,i){var s=r.getOptions().events.manager,o=i.$new(!0);o.event=e,o.onEdit=function(){s.editEvent(e)},n(a)(o),o.$digest(),o.$destroy();var l=new wt.a({target:t[0],content:a,position:"bottom center",classes:"drop-popover drop-popover--annotation",openOn:"hover",hoverCloseDelay:200,tetherOptions:{constraints:[{to:"window",pin:!0,attachment:"both"}]}});l.open(),l.on("close",function(){setTimeout(function(){l.destroy()})})}])}var es=null;function rs(t,e,r){var n=r.getOptions().events.manager;n.editorOpen?es=t:(n.editorOpened(),es=t,setTimeout(function(){var t=L.a.element(document).injector(),r=document.createElement("div");r.innerHTML='<event-editor panel-ctrl="panelCtrl" event="event" close="close()"></event-editor>',t.invoke(["$compile","$rootScope",function(t,a){var i,s=a.$new(!0);s.event=e,s.panelCtrl=n.panelCtrl,s.close=function(){i.close()},t(r)(s),s.$digest(),(i=new wt.a({target:es[0],content:r,position:"bottom center",classes:"drop-popover drop-popover--form",openOn:"click",tetherOptions:{constraints:[{to:"window",pin:!0,attachment:"both"}]}})).open(),n.editorOpened(),i.on("close",function(){setTimeout(function(){n.editorClosed(),s.$destroy(),i.destroy()})})}])},100))}var ns=function(){function t(t,e,r,n,a,i,s,o){this._object=t,this._drawFunc=e,this._clearFunc=r,this._moveFunc=n,this._position={left:a,top:i},this._width=s,this._height=o}return t.$inject=["object","drawFunc","clearFunc","moveFunc","left","top","width","height"],t.prototype.width=function(){return this._width},t.prototype.height=function(){return this._height},t.prototype.position=function(){return this._position},t.prototype.draw=function(){this._drawFunc(this._object)},t.prototype.clear=function(){this._clearFunc(this._object)},t.prototype.getObject=function(){return this._object},t.prototype.moveTo=function(t){this._position=t,this._moveFunc(this._object,this._position)},t}(),as=function(){function t(t,e){this._options=t,this._drawableEvent=e,this._hidden=!1}return t.$inject=["options","drawableEvent"],t.prototype.visual=function(){return this._drawableEvent},t.prototype.getOptions=function(){return this._options},t.prototype.getParent=function(){return this._parent},t.prototype.isHidden=function(){return this._hidden},t.prototype.hide=function(){this._hidden=!0},t.prototype.unhide=function(){this._hidden=!1},t}(),is=function(){function t(t){this._events=[],this._types=[],this._plot=t,this.eventsEnabled=!1}return t.$inject=["plot"],t.prototype.getEvents=function(){return this._events},t.prototype.setTypes=function(t){return this._types=t},t.prototype.setupEvents=function(t){var e=this,r=I.a.partition(t,"isRegion"),n=r[0];t=r[1],F.a.each(t,function(t,r){var n=new as(r,e._buildDiv(r));e._events.push(n)}),F.a.each(n,function(t,r){var n=new as(r,e._buildRegDiv(r));e._events.push(n)}),this._events.sort(function(t,e){var r=t.getOptions(),n=e.getOptions();return r.min>n.min?1:r.min<n.min?-1:0})},t.prototype.drawEvents=function(){var t=this;F.a.each(this._events,function(e,r){t._insidePlot(r.getOptions().min)&&!r.isHidden()?r.visual().draw():r.visual().getObject().hide()})},t.prototype.updateEvents=function(){var t,e,r=this,n=this._plot.getPlotOffset(),a=this._plot.getXAxes()[this._plot.getOptions().events.xaxis-1];F.a.each(this._events,function(i,s){e=n.top+r._plot.height()-s.visual().height(),t=a.p2c(s.getOptions().min)+n.left-s.visual().width()/2,s.visual().moveTo({top:e,left:t})})},t.prototype._clearEvents=function(){F.a.each(this._events,function(t,e){e.visual().clear()}),this._events=[]},t.prototype._buildDiv=function(t){var e,r,n,a,i,s,o,l,c=this,u=this._plot.getPlaceholder(),d=this._plot.getPlotOffset(),p=this._plot.getXAxes()[this._plot.getOptions().events.xaxis-1],h=t.eventType;n=null!==this._types&&this._types[h]&&this._types[h].color?this._types[h].color:"#666",a=null!==this._types&&this._types[h]&&this._types[h].markerSize?this._types[h].markerSize:8,i=null===this._types||!this._types[h]||void 0===this._types[h].markerShow||this._types[h].markerShow,l=null===this._types||!this._types[h]||void 0===this._types[h].markerTooltip||this._types[h].markerTooltip,s=null!=this._types&&this._types[h]&&this._types[h].lineStyle?this._types[h].lineStyle.toLowerCase():"dashed",o=null!=this._types&&this._types[h]&&void 0!==this._types[h].lineWidth?this._types[h].lineWidth:1;var f=p.options.eventSectionHeight||0;f/=3,e=d.top+this._plot.height()+f,r=p.p2c(t.min)+d.left;var m=F()('<div class="events_line flot-temp-elem"></div>').css({position:"absolute",opacity:.8,left:r+"px",top:8,width:o+"px",height:this._plot.height()+.8*f,"border-left-width":o+"px","border-left-style":s,"border-left-color":n,color:n}).appendTo(u);if(i){var g=F()('<div class="events_marker"></div>').css({position:"absolute",left:-a-Math.round(o/2)+"px","font-size":0,"line-height":0,width:0,height:0,"border-left":a+"px solid transparent","border-right":a+"px solid transparent"});g.appendTo(m),this._types[h]&&this._types[h].position&&"BOTTOM"===this._types[h].position.toUpperCase()?g.css({top:e-a-8+"px","border-top":"none","border-bottom":a+"px solid "+n}):g.css({top:"0px","border-top":a+"px solid "+n,"border-bottom":"none"}),g.data({event:t});t.editModel&&rs(g,t.editModel,c._plot);l&&(g.css({cursor:"help"}),g.hover(function(){ts(g,F()(this).data("event"),c._plot)},function(){c._plot.clearSelection()}))}return new ns(m,function(t){t.show()},function(t){t.remove()},function(t,e){t.css({top:e.top,left:e.left})},r,e,m.width(),m.height())},t.prototype._buildRegDiv=function(t){var e,r,n,a,i,s,o,l=this,c=this,u=this._plot.getPlaceholder(),d=this._plot.getPlotOffset(),p=this._plot.getXAxes()[this._plot.getOptions().events.xaxis-1],h=t.eventType;s=null!==this._types&&this._types[h]&&this._types[h].color?this._types[h].color:"#666",o=null===this._types||!this._types[h]||void 0===this._types[h].markerTooltip||this._types[h].markerTooltip,n=null!=this._types&&this._types[h]&&void 0!==this._types[h].lineWidth?this._types[h].lineWidth:1,i=null!=this._types&&this._types[h]&&this._types[h].lineStyle?this._types[h].lineStyle.toLowerCase():"dashed";e=d.top+this._plot.height()+2;var f=Math.min(t.min,t.timeEnd),m=Math.max(t.min,t.timeEnd);r=p.p2c(f)+d.left;var g=p.p2c(m)+d.left;a=g-r,I.a.each([r,g],function(t){F()('<div class="events_line flot-temp-elem"></div>').css({position:"absolute",opacity:.8,left:t+"px",top:8,width:n+"px",height:l._plot.height()+2,"border-left-width":n+"px","border-left-style":i,"border-left-color":s,color:s}).appendTo(u)});var v=F()('<div class="events_marker region_marker flot-temp-elem"></div>').css({position:"absolute",opacity:.5,left:r+"px",top:e,width:Math.round(a+n)+"px",height:"0.5rem","border-left-color":s,color:s,"background-color":s});v.appendTo(u),v.data({event:t});t.editModel&&rs(v,t.editModel,c._plot);return o&&(v.css({cursor:"help"}),v.hover(function(){ts(v,F()(this).data("event"),c._plot)},function(){c._plot.clearSelection()})),new ns(v,function(t){t.show()},function(t){t.remove()},function(t,e){t.css({top:e.top,left:e.left})},r,e,v.width(),v.height())},t.prototype._insidePlot=function(t){var e=this._plot.getXAxes()[this._plot.getOptions().events.xaxis-1],r=e.p2c(t);return r>0&&r<e.p2c(e.max)},t}();function ss(t){var e=this,r=new is(t);t.getEvents=function(){return r._events},t.hideEvents=function(){F.a.each(r._events,function(t,e){e.visual().getObject().hide()})},t.showEvents=function(){t.hideEvents(),F.a.each(r._events,function(t,e){e.hide()}),e.eventMarkers.drawEvents()},t.setEvents=function(t){r.eventsEnabled&&r.setupEvents(t)},t.hooks.processOptions.push(function(t,e){null!=e.events.data&&(r.eventsEnabled=!0)}),t.hooks.draw.push(function(t){var e=t.getOptions();r.eventsEnabled&&(r.getEvents().length<1?(r.setTypes(e.events.types),r.setupEvents(e.events.data)):r.updateEvents()),r.drawEvents()})}function os(t){return t.replace(/([\!\*\+\-\=<>\s\&\|\(\)\[\]\{\}\^\~\?\:\\/"])/g,"\\$1")}F.a.plot.plugins.push({init:ss,options:{events:{data:null,types:null,xaxis:1,position:"BOTTOM"}},name:"events",version:"0.2.5"});var ls=new(function(){function t(){this.regex=or,this.index={},this.grafanaVariables={},this.builtIns={},this.builtIns.__interval={text:"1s",value:"1s"},this.builtIns.__interval_ms={text:"100",value:"100"}}return t.prototype.init=function(t){this.variables=t,this.updateTemplateData()},t.prototype.updateTemplateData=function(){this.index=this.variables.reduce(function(t,e){return e.current&&(e.current.isNone||function(t){return t||""===t}(e.current.value))&&(t[e.name]=e),t},{})},t.prototype.variableInitialized=function(t){this.index[t.name]=t},t.prototype.getAdhocFilters=function(t){var e=[];if(this.variables)for(var r=0;r<this.variables.length;r++){var n=this.variables[r];"adhoc"===n.type&&(null===n.datasource||n.datasource===t?e=e.concat(n.filters):0===n.datasource.indexOf("$")&&this.replace(n.datasource)===t&&(e=e.concat(n.filters)))}return e},t.prototype.luceneFormat=function(t){return"string"==typeof t?os(t):t instanceof Array&&0===t.length?"__empty__":"("+I.a.map(t,function(t){return'"'+os(t)+'"'}).join(" OR ")+")"},t.prototype.formatValue=function(t,e,r){if(r=r||{},"function"==typeof e)return e(t,r,this.formatValue);switch(e){case"regex":if("string"==typeof t)return kt.a.regexEscape(t);var n=I.a.map(t,kt.a.regexEscape);return 1===n.length?n[0]:"("+n.join("|")+")";case"lucene":return this.luceneFormat(t);case"pipe":return"string"==typeof t?t:t.join("|");case"distributed":return"string"==typeof t?t:this.distributeVariable(t,r.name);case"csv":return I.a.isArray(t)?t.join(","):t;default:return I.a.isArray(t)?"{"+t.join(",")+"}":t}},t.prototype.setGrafanaVariable=function(t,e){this.grafanaVariables[t]=e},t.prototype.getVariableName=function(t){this.regex.lastIndex=0;var e=this.regex.exec(t);return e?e.slice(1).find(function(t){return void 0!==t}):null},t.prototype.variableExists=function(t){var e=this.getVariableName(t);return e&&void 0!==this.index[e]},t.prototype.highlightVariablesAsHtml=function(t){var e=this;return t&&I.a.isString(t)?(t=I.a.escape(t),this.regex.lastIndex=0,t.replace(this.regex,function(t,r,n,a,i){return e.index[r||n||i]||e.builtIns[r||n||i]?'<span class="template-variable">'+t+"</span>":t})):t},t.prototype.getAllValue=function(t){if(t.allValue)return t.allValue;for(var e=[],r=1;r<t.options.length;r++)e.push(t.options[r].value);return e},t.prototype.replace=function(t,e,r){var n,a,i,s,o=this;return t?(this.regex.lastIndex=0,t.replace(this.regex,function(t,l,c,u,d,p){return n=o.index[l||c||d],s=u||p||r,e&&(i=e[l||c||d])?o.formatValue(i.value,s,n):n?(a=o.grafanaVariables[n.current.value])?o.formatValue(a,s,n):(i=n.current.value,o.isAllValue(i)&&(i=o.getAllValue(n),n.allValue)?o.replace(i):o.formatValue(i,s,n)):t})):t},t.prototype.isAllValue=function(t){return"$__all"===t||Array.isArray(t)&&"$__all"===t[0]},t.prototype.replaceWithText=function(t,e){var r,n=this;return t?(this.regex.lastIndex=0,t.replace(this.regex,function(t,a,i,s,o){if(e){var l=e[a||i||o];if(l)return l.text}return(r=n.index[a||i||o])?n.grafanaVariables[r.current.value]||r.current.text:t})):t},t.prototype.fillVariableValuesForUrl=function(t,e){I.a.each(this.variables,function(r){if(e&&void 0!==e[r.name]){if(e[r.name].skipUrlSync)return;t["var-"+r.name]=e[r.name].value}else{if(r.skipUrlSync)return;t["var-"+r.name]=r.getValueForUrl()}})},t.prototype.distributeVariable=function(t,e){return(t=I.a.map(t,function(t,r){return 0!==r?e+"="+t:t})).join(",")},t}()),cs=function(){function t(t){this.panelCtrl=t}return t.prototype.getHandleHtml=function(t,e,r){var n=e.colorMode;return"custom"===e.colorMode&&(n="critical"),'\n    <div class="alert-handle-wrapper threshold-drag alert-handle-wrapper--T'+t+'">\n      <div class="alert-handle-line alert-handle-line--'+n+'">\n      </div>\n      <div class="alert-handle" data-handle-index="'+t+'">\n        <i class="icon-gf icon-gf-'+n+" alert-state-"+n+'"></i>\n        <span class="alert-handle-value">'+r+'<i class="alert-handle-grip"></i></span>\n      </div>\n    </div>'},t.prototype.getThresholdInfoHtml=function(t,e,r){return e.showValue?'\n     <div class="alert-handle-wrapper threshold-show alert-handle-wrapper--T1">\n         <span class="alert-handle-value">'+r+"</span>\n     </div>":""},t.prototype.initDragging=function(t){var e,r=F()(t.currentTarget).parents(".alert-handle-wrapper"),n=F()(t.currentTarget).data("handleIndex"),a=null,i=this.plot,s=this.panelCtrl,o=this.thresholds[n];function l(t){if(null===a)a=t.clientY;else{var n=t.clientY-a;e+=n,a=t.clientY,r.css({top:e+n}),r.css("margin-right","36px")}}function c(){var t=i.c2p({left:0,top:e}).y;t=parseInt(t.toFixed(0),10),o.valueTrue=t,r.off("mousemove",l),r.off("mouseup",l),r.off("mouseleave",l),s.$scope.$apply(function(){s.render(),s.events.emit("threshold-changed",{threshold:o,handleIndex:n})})}a=null,e=r.position().top,r.on("mousemove",l),r.on("mouseup",c),r.on("mouseleave",c)},t.prototype.cleanUp=function(){this.placeholder.find(".threshold-drag").remove(),this.needsCleanup=!1},t.prototype.renderHandle=function(t,e){var r=this.thresholds[t],n=r.valueTrue,a=n,i=0;if(I.a.isNumber(n)){var s=this.plot.p2c({x:0,y:n});i=Math.round(Math.min(Math.max(s.top,0),this.height)-12)}else a="",i=e;var o=F()(this.getHandleHtml(t,r,a));this.placeholder.append(o),o.toggleClass("alert-handle-wrapper--no-value",""===a),o.css({top:i}),o.css("margin-right","36px")},t.prototype.renderThresholdInfo=function(t,e){var r=this.thresholds[t],n=r.valueTrue,a=n,i=0;if(I.a.isNumber(n)){var s=this.plot.p2c({x:0,y:n});i=Math.round(Math.min(Math.max(s.top,0),this.height)-12)}else a="",i=e;var o=F()(this.getThresholdInfoHtml(t,r,a));this.placeholder.append(o),o.toggleClass("alert-handle-wrapper--no-value",""===a),o.css({top:i}),o.css("margin-right","36px")},t.prototype.showThresholdValue=function(t){this.placeholder.find(".threshold-show").remove(),this.height=t.height();for(var e=0;e<this.thresholds.length;e++)this.renderThresholdInfo(e,this.height-10-20*e)},t.prototype.shouldDrawHandles=function(){return!this.hasSecondYAxis&&this.panelCtrl.editingThresholds&&this.panelCtrl.panel.thresholds.length>0},t.prototype.prepare=function(t,e){this.hasSecondYAxis=!1;for(var r=0;r<e.length;r++)if(e[r].yaxis>1){this.hasSecondYAxis=!0;break}if(this.shouldDrawHandles()){var n=this.panelCtrl.panel.thresholds.length>1?"220px":"110px";t.css("margin-right",n)}else this.needsCleanup&&t.css("margin-right","0")},t.prototype.draw=function(t){this.thresholds=this.panelCtrl.panel.thresholds,this.plot=t,this.placeholder=t.getPlaceholder(),this.needsCleanup&&this.cleanUp(),this.showThresholdValue(t),this.shouldDrawHandles()&&(this.height=t.height(),this.thresholds.length>0&&this.renderHandle(0,10),this.thresholds.length>1&&this.renderHandle(1,this.height-30),this.placeholder.off("mousedown",".alert-handle"),this.placeholder.on("mousedown",".alert-handle",this.initDragging.bind(this)),this.needsCleanup=!0)},t.prototype.addFlotOptions=function(t,e){if(e.thresholds&&0!==e.thresholds.length){var r,n,a,i=1/0,s=-1/0;for(r=0;r<e.thresholds.length;r++){n=e.thresholds[r];var o=JSON.parse(JSON.stringify(n.value));if(0===n.value||n.value){if(n.valueTrue=Number(n.value),isNaN(n.value)){if(n.valueTrue=ls.replace(o),!I.a.isNumber(n.valueTrue-0))continue;n.valueTrue=n.valueTrue-0}var l=void 0;switch(n.op){case"gt":l=i,e.thresholds.length>r+1&&(a=e.thresholds[r+1]).valueTrue>n.valueTrue&&(s=l=a.valueTrue);break;case"lt":l=s,e.thresholds.length>r+1&&(a=e.thresholds[r+1]).valueTrue<n.valueTrue&&(i=l=a.valueTrue)}var c=void 0,u=void 0;switch(n.colorMode){case"critical":c="rgba(234, 112, 112, 0.12)",u="rgba(237, 46, 24, 0.60)";break;case"warning":c="rgba(235, 138, 14, 0.12)",u="rgba(247, 149, 32, 0.60)";break;case"ok":c="rgba(11, 237, 50, 0.090)",u="rgba(6,163,69, 0.60)";break;case"custom":c=n.fillColor,u=n.lineColor}n.fill&&("right"===n.yaxis&&this.hasSecondYAxis?t.grid.markings.push({y2axis:{from:n.valueTrue,to:l},color:c}):t.grid.markings.push({yaxis:{from:n.valueTrue,to:l},color:c})),n.line&&("right"===n.yaxis&&this.hasSecondYAxis?t.grid.markings.push({y2axis:{from:n.valueTrue,to:n.valueTrue},color:u}):t.grid.markings.push({yaxis:{from:n.valueTrue,to:n.valueTrue},color:u}))}}}},t}(),us={gray:{themeDependent:!0,title:"Gray",darkColor:{fill:"rgba(255, 255, 255, 0.09)",line:"rgba(255, 255, 255, 0.2)"},lightColor:{fill:"rgba(0, 0, 0, 0.09)",line:"rgba(0, 0, 0, 0.2)"}},red:{title:"Red",color:{fill:"rgba(234, 112, 112, 0.12)",line:"rgba(237, 46, 24, 0.60)"}},green:{title:"Green",color:{fill:"rgba(11, 237, 50, 0.090)",line:"rgba(6,163,69, 0.60)"}},blue:{title:"Blue",color:{fill:"rgba(11, 125, 238, 0.12)",line:"rgba(11, 125, 238, 0.60)"}},yellow:{title:"Yellow",color:{fill:"rgba(235, 138, 14, 0.12)",line:"rgba(247, 149, 32, 0.60)"}},custom:{title:"Custom"}};function ds(t){if(-1===Object.keys(us).indexOf(t.colorMode)&&(t.colorMode="red"),"custom"===t.colorMode)return{fill:t.fillColor,line:t.lineColor};var e=us[t.colorMode];return!0===e.themeDependent?B.a.bootData.user.lightTheme?e.lightColor:e.darkColor:e.color}var ps=function(){function t(t){this.panelCtrl=t}return t.prototype.draw=function(t){this.timeRegions=this.panelCtrl.panel.timeRegions,this.plot=t},t.prototype.addFlotOptions=function(t,e){if(e.timeRegions&&0!==e.timeRegions.length){var r,n,a,i,s,o,l,c={from:H()(this.panelCtrl.range.from).utc(),to:H()(this.panelCtrl.range.to).utc()},u=e.timeRegions.map(function(t){return J.a({},t)});for(r=0;r<u.length;r++)if(((a=u[r]).fromDayOfWeek||a.from||a.toDayOfWeek||a.to)&&(a.from&&!a.to&&(a.to=a.from),!a.from&&a.to&&(a.from=a.to),n={from:this.parseTimeRange(a.from),to:this.parseTimeRange(a.to)},!a.fromDayOfWeek&&a.toDayOfWeek&&(a.fromDayOfWeek=a.toDayOfWeek),!a.toDayOfWeek&&a.fromDayOfWeek&&(a.toDayOfWeek=a.fromDayOfWeek),a.fromDayOfWeek&&(n.from.dayOfWeek=Number(a.fromDayOfWeek)),a.toDayOfWeek&&(n.to.dayOfWeek=Number(a.toDayOfWeek)),n.from.dayOfWeek&&null===n.from.h&&null===n.from.m&&(n.from.h=0,n.from.m=0,n.from.s=0),n.to.dayOfWeek&&null===n.to.h&&null===n.to.m&&(n.to.h=23,n.to.m=59,n.to.s=59),n.from&&n.to)){if(i=[],n.from.h>=c.from.hour()&&n.from.h<=c.from.hour()&&n.from.m>=c.from.minute()&&n.from.m<=c.from.minute()&&n.to.h>=c.to.hour()&&n.to.h<=c.to.hour()&&n.to.m>=c.to.minute()&&n.to.m<=c.to.minute())i.push({from:c.from.valueOf(),to:c.to.startOf("hour").valueOf()});else for((s=H()(c.from)).set("hour",0),s.set("minute",0),s.set("second",0),s.add(n.from.h,"hours"),s.add(n.from.m,"minutes"),s.add(n.from.s,"seconds");s.unix()<=c.to.unix();){for(;n.from.dayOfWeek&&n.from.dayOfWeek!==s.isoWeekday();)s.add(24,"hours");if(s.unix()>c.to.unix())break;if(o=H()(s),n.from.h<=n.to.h)o.add(n.to.h-n.from.h,"hours");else if(n.from.h+n.to.h<23)for(o.add(n.to.h,"hours");o.hour()!==n.to.h;)o.add(-1,"hours");else for(o.add(24-n.from.h,"hours");o.hour()!==n.to.h;)o.add(1,"hours");for(o.set("minute",n.to.m),o.set("second",n.to.s);n.to.dayOfWeek&&n.to.dayOfWeek!==o.isoWeekday();)o.add(24,"hours");s.unix()<c.from.unix()&&o.unix()<c.from.unix()||s.unix()>c.to.unix()&&o.unix()>c.to.unix()||i.push({from:s.valueOf(),to:o.valueOf()}),s.add(24,"hours")}l=ds(a);for(var d=0;d<i.length;d++){var p=i[d];a.fill&&t.grid.markings.push({xaxis:{from:p.from,to:p.to},color:l.fill}),a.line&&(t.grid.markings.push({xaxis:{from:p.from,to:p.from},color:l.line}),t.grid.markings.push({xaxis:{from:p.to,to:p.to},color:l.line}))}}}},t.prototype.parseTimeRange=function(t){var e={h:null,m:null},r=/^([\d]+):?(\d{2})?/.exec(t);return r?(r.length>1&&(e.h=Number(r[1]),e.m=0,r.length>2&&void 0!==r[2]&&(e.m=Number(r[2])),e.h>23&&(e.h=23),e.m>59&&(e.m=59)),e):e},t}(),hs=function(){function t(t,e){this.datasourceSrv=e,this.annotationDefaults={name:"",datasource:null,iconColor:"rgba(255, 96, 96, 1)",enable:!0,showIn:0,hide:!1},this.showOptions=[{text:"All Panels",value:0},{text:"Specific Panels",value:1}],t.ctrl=this,this.mode="list",this.datasources=e.getAnnotationSources(),this.annotations=t.dashboard.annotations.list,this.reset(),this.onColorChange=this.onColorChange.bind(this)}return t.$inject=["$scope","datasourceSrv"],t.prototype.datasourceChanged=function(){var t=this;return this.datasourceSrv.get(this.currentAnnotation.datasource).then(function(e){t.currentDatasource=e})},t.prototype.edit=function(t){this.currentAnnotation=t,this.currentAnnotation.showIn=this.currentAnnotation.showIn||0,this.currentIsNew=!1,this.datasourceChanged(),this.mode="edit",F()(".tooltip.in").remove()},t.prototype.reset=function(){this.currentAnnotation=L.a.copy(this.annotationDefaults),this.currentAnnotation.datasource=this.datasources[0].name,this.currentIsNew=!0,this.datasourceChanged()},t.prototype.update=function(){this.reset(),this.mode="list"},t.prototype.setupNew=function(){this.mode="new",this.reset()},t.prototype.backToList=function(){this.mode="list"},t.prototype.move=function(t,e){I.a.move(this.annotations,t,t+e)},t.prototype.add=function(){this.annotations.push(this.currentAnnotation),this.reset(),this.mode="list"},t.prototype.removeAnnotation=function(t){var e=I.a.indexOf(this.annotations,t);this.annotations.splice(e,1)},t.prototype.onColorChange=function(t){this.currentAnnotation.iconColor=t},t}();function fs(t,e){var r=I.a.partition(t,"regionId"),n=r[0],a=r[1],i=function(t,e){var r=I.a.filter(t,function(t){return t.regionId}),n=I.a.groupBy(r,"regionId");return n=I.a.compact(I.a.map(n,function(t){var r=I.a.head(t);return t&&t.length>1?(r.timeEnd=t[1].time,r.isRegion=!0,r):t&&t.length?(r.time&&r.timeEnd||(function(t){return t.id&&t.id===t.regionId}(r)?r.timeEnd=e.to.valueOf()-1:(r.timeEnd=r.time,r.time=e.from.valueOf()+1),r.isRegion=!0),r):void 0}))}(n,e.range);return t=I.a.concat(i,a)}function ms(t){return"panel-alert"===t.eventType}z.c.controller("AnnotationsEditorCtrl",hs);var gs=function(){function t(t,e,r,n,a){this.$rootScope=t,this.$q=e,this.datasourceSrv=r,this.backendSrv=n,this.timeSrv=a}return t.$inject=["$rootScope","$q","datasourceSrv","backendSrv","timeSrv"],t.prototype.init=function(t){var e=this;t.on("refresh",function(){e.globalAnnotationsPromise=null,e.alertStatesPromise=null,e.datasourcePromises=null})},t.prototype.getAnnotations=function(t){var e=this;return this.$q.all([this.getGlobalAnnotations(t),this.getAlertStates(t)]).then(function(e){var r=I.a.flattenDeep(e[0]);return{annotations:r=fs(r=function(t){var e=[],r=I.a.partition(t,"id"),n=I.a.groupBy(r[0],"id");return e=I.a.map(n,function(t){return t.length>1&&!I.a.every(t,ms)?I.a.find(t,function(t){return"panel-alert"!==t.eventType}):I.a.head(t)}),e=I.a.concat(e,r[1])}(r=I.a.filter(r,function(e){return!e.panelId||"dashboard"!==e.source.type||e.panelId===t.panel.id})),t),alertState:I.a.find(e[1],{panelId:t.panel.id})}}).catch(function(t){return!t.message&&t.data&&t.data.message&&(t.message=t.data.message),console.log("AnnotationSrv.query error",t),e.$rootScope.appEvent("alert-error",["Annotation Query Failed",t.message||t]),[]})},t.prototype.getAlertStates=function(t){return t.dashboard.id?t.panel&&!t.panel.alert?this.$q.when([]):"now"!==t.range.raw.to?this.$q.when([]):this.alertStatesPromise?this.alertStatesPromise:(this.alertStatesPromise=this.backendSrv.get("/api/alerts/states-for-dashboard",{dashboardId:t.dashboard.id}),this.alertStatesPromise):this.$q.when([])},t.prototype.getGlobalAnnotations=function(t){var e=this,r=t.dashboard;if(this.globalAnnotationsPromise)return this.globalAnnotationsPromise;for(var n=this.timeSrv.timeRange(),a=[],i=[],s=function(t){if(!t.enable)return"continue";if(t.snapshotData)return{value:o.translateQueryResult(t,t.snapshotData)};var s=o.datasourceSrv.get(t.datasource);i.push(s),a.push(s.then(function(e){return e.annotationQuery({range:n,rangeRaw:n.raw,annotation:t,dashboard:r})}).then(function(n){return r.snapshot&&(t.snapshotData=L.a.copy(n)),e.translateQueryResult(t,n)}))},o=this,l=0,c=r.annotations.list;l<c.length;l++){var u=s(c[l]);if("object"==typeof u)return u.value}return this.datasourcePromises=this.$q.all(i),this.globalAnnotationsPromise=this.$q.all(a),this.globalAnnotationsPromise},t.prototype.saveAnnotationEvent=function(t){return this.globalAnnotationsPromise=null,this.backendSrv.post("/api/annotations",t)},t.prototype.updateAnnotationEvent=function(t){return this.globalAnnotationsPromise=null,this.backendSrv.put("/api/annotations/"+t.id,t)},t.prototype.deleteAnnotationEvent=function(t){this.globalAnnotationsPromise=null;var e="/api/annotations/"+t.id;return t.isRegion&&(e="/api/annotations/region/"+t.regionId),this.backendSrv.delete(e)},t.prototype.translateQueryResult=function(t,e){t.snapshotData&&delete(t=L.a.copy(t)).snapshotData;for(var r=0,n=e;r<n.length;r++){n[r].source=t}return e},t}();z.c.service("annotationsSrv",gs);var vs=function(){function t(t){this.annotationsSrv=t,this.event.panelId=this.panelCtrl.panel.id,this.event.dashboardId=this.panelCtrl.dashboard.id,this.event.time=bs(this.event.time),this.event.isRegion&&(this.event.timeEnd=bs(this.event.timeEnd)),this.timeFormated=this.panelCtrl.dashboard.formatDate(this.event.time)}return t.$inject=["annotationsSrv"],t.prototype.save=function(){var t=this;if(this.form.$valid){var e=I.a.cloneDeep(this.event);e.time=e.time.valueOf(),e.timeEnd=0,e.isRegion&&(e.timeEnd=this.event.timeEnd.valueOf(),e.timeEnd<e.time)?console.log("invalid time"):e.id?this.annotationsSrv.updateAnnotationEvent(e).then(function(){t.panelCtrl.refresh(),t.close()}).catch(function(){t.panelCtrl.refresh(),t.close()}):this.annotationsSrv.saveAnnotationEvent(e).then(function(){t.panelCtrl.refresh(),t.close()}).catch(function(){t.panelCtrl.refresh(),t.close()})}},t.prototype.delete=function(){var t=this;return this.annotationsSrv.deleteAnnotationEvent(this.event).then(function(){t.panelCtrl.refresh(),t.close()}).catch(function(){t.panelCtrl.refresh(),t.close()})},t}();function bs(t){if(t&&I.a.isNumber(t)){var e=Number(t);return H()(e)}return t}G.e.directive("eventEditor",function(){return{restrict:"E",controller:vs,bindToController:!0,controllerAs:"ctrl",templateUrl:"public/app/features/annotations/partials/event_editor.html",scope:{panelCtrl:"=",event:"=",close:"&"}}});var ys=r(120),ws=r.n(ys),xs=function(){return function(){}}(),Ss=function(){function t(t){this.panelCtrl=t}return t.prototype.editorClosed=function(){this.event=null,this.editorOpen=!1,this.panelCtrl.render()},t.prototype.editorOpened=function(){this.editorOpen=!0},t.prototype.updateTime=function(t){this.event||(this.event=new xs,this.event.dashboardId=this.panelCtrl.dashboard.id,this.event.panelId=this.panelCtrl.panel.id),this.event.time=H()(t.from),this.event.isRegion=!1,t.to&&(this.event.timeEnd=H()(t.to),this.event.isRegion=!0),this.panelCtrl.render()},t.prototype.editEvent=function(t,e){this.event=t,this.panelCtrl.render()},t.prototype.addFlotEvents=function(t,e){if(this.event||0!==t.length){var r={$__alerting:{color:xt.a,position:"BOTTOM",markerSize:5},$__ok:{color:xt.d,position:"BOTTOM",markerSize:5},$__no_data:{color:xt.c,position:"BOTTOM",markerSize:5},$__pending:{color:xt.e,position:"BOTTOM",markerSize:5},$__editing:{color:xt.b,position:"BOTTOM",markerSize:5}};if(this.event)t=this.event.isRegion?[{isRegion:!0,min:this.event.time.valueOf(),timeEnd:this.event.timeEnd.valueOf(),text:this.event.text,eventType:"$__editing",editModel:this.event}]:[{min:this.event.time.valueOf(),text:this.event.text,editModel:this.event,eventType:"$__editing"}];else for(var n=0;n<t.length;n++){var a=t[n];a.min=a.time,a.max=a.time,a.eventType=a.source.name,a.newState?a.eventType="$__"+a.newState:r[a.source.name]||(r[a.source.name]={color:a.source.iconColor,position:"BOTTOM",markerSize:5})}!function(t,e){var r,n=e.grid.markings,a=xt.b;I.a.each(t,function(t){r=function(t,e){var r=ws()(t);return r.isValid()?(r.setAlpha(e),r.toRgbString()):t}(r=t.source&&t.source.iconColor||a,xt.f),n.push({xaxis:{from:t.min,to:t.timeEnd},color:r})})}(function(t){return I.a.filter(t,"isRegion")}(t),e);e.grid.eventSectionHeight=7,e.xaxis.eventSectionHeight=20,e.events={levels:I.a.keys(r).length+1,data:t,types:r,manager:this}}},t}();function ks(t,e,r,n){function a(e){try{return t(e)}catch(t){return console.log("Could not sanitize annotation string, html escaping instead"),I.a.escape(e)}}return{restrict:"E",scope:{event:"=",onEdit:"&"},link:function(t,r){var i=t.event,s=i.title,o=i.text,l=e.getCurrent(),c='<div class="graph-annotation">',u="";if(i.alertId){var d=Wt.a.getStateDisplayModel(i.newState);u=d.stateClass,s='<i class="'+d.iconClass+'"></i> '+d.text,o=Wt.a.getAlertAnnotationInfo(i),i.text&&(o=o+"<br />"+i.text)}else s&&(o=s+"<br />"+(I.a.isString(o)?o:""),s="");var p='<div class="graph-annotation__header">';i.login&&(p+='<div class="graph-annotation__user" bs-tooltip="\'Created by '+i.login+'\'"><img src="'+i.avatarUrl+'" /></div>'),p+='\n          <span class="graph-annotation__title '+u+'">'+a(s)+'</span>\n          <span class="graph-annotation__time">'+l.formatDate(i.min)+"</span>\n      ",i.id&&l.meta.canEdit&&(p+='\n          <span class="pointer graph-annotation__edit-icon" ng-click="onEdit()">\n            <i class="fa fa-pencil-square"></i>\n          </span>\n        '),c+=p+="</div>",c+='<div class="graph-annotation__body">',o&&(c+="<div>"+a(o.replace(/\n/g,"<br>"))+"</div>");var h=i.tags;h&&h.length&&(t.tags=h,c+='<span class="label label-tag small" ng-repeat="tag in tags" tag-color-from-name="tag">{{tag}}</span><br/>'),c+="</div>",c+="</div>",F()(c).appendTo(r),n(r.contents())(t)}}}function Cs(t,e,r,n,a){return t.map(function(t){var i=function(t){for(var e=[],r=0;r<t.length;r++)for(var n=t[r].datapoints,a=0;a<n.length;a++)null!==n[a][0]&&e.push(n[a][0]);return e}([t]);if(t.histogram=!0,r[t.alias])t.data=[];else{var s=function(t,e,r,n){for(var a={},i=Ts(r,e),s=Ts(n,e),o=i,l=0;o<=s;)a[o]=0,o=i+e*l,l++;for(var c=0;c<t.length;c++){var u=Ts(t[c],e);a[u]=a[u]+1}var d=I.a.map(a,function(t,e){return[Number(e),t]});return I.a.sortBy(d,function(t){return t[0]})}(i,e,n,a);t.data=s}return t})}function Ts(t,e){return Math.floor(t/e)*e}function Es(t,e){if(!isNaN(e)&&function(t){return 2===t.length&&_s(t[0])&&_s(t[1])}(t)){var r=t[0],n=t[1];!function(t,e,r){0!==r&&(t.min-=r,t.max-=r,e.min-=r,e.max-=r)}(r,n,e),function(t,e){t.max===t.min&&(t.min-=.25,t.max+=.25);e.max===e.min&&(e.min-=.25,e.max+=.25)}(r,n);var a=0===r.min||0===n.min||0===r.max||0===n.max,i=Ms(r,n);if(a&&i)r.min=r.max>0?0:r.min,r.max=r.max>0?r.max:0,n.min=n.max>0?0:n.min,n.max=n.max>0?n.max:0;else if(function(t,e){return t.min>=0&&e.max<=0||t.max<=0&&e.min>=0}(r,n))r.min>=0?(r.min=-r.max,n.max=-n.min):(r.max=-r.min,n.min=-n.max);else{var s=function(t,e){var r,n;if(As(t,e))r=e.min?t.min/e.min:0,n=e.max?t.max/e.max:0;else if(Ms(t,e)){var a=Math.abs(t.min),i=Math.abs(t.max),s=Math.abs(e.min),o=Math.abs(e.max),l=I.a.max([a,i]),c=I.a.min([a,i]),u=I.a.max([s,o]),d=I.a.min([s,o]);r=c?l/c:l,n=d?u/d:u}else t.min>0||e.min>0?(r=t.max/e.max,n=0):(r=0,n=t.min/e.min);return r>n?r:n}(r,n);i?r.min>0?(r.min=r.max/s,n.min=n.max/s):(r.max=r.min/s,n.max=n.min/s):As(r,n)?(r.min=n.min?n.min*s:r.min,n.min=r.min?r.min/s:n.min,r.max=n.max?n.max*s:r.max,n.max=r.max?r.max/s:n.max):(r.min=r.min>0?n.min*s:r.min,n.min=n.min>0?r.min/s:n.min,r.max=r.max<0?n.max*s:r.max,n.max=n.max<0?r.max/s:n.max)}!function(t,e,r){0!==r&&(t.min+=r,t.max+=r,e.min+=r,e.max+=r)}(r,n,e)}}function _s(t){return"min"in t&&"max"in t}function Ms(t,e){return t.min>=0&&e.min>=0||t.max<=0&&e.max<=0}function As(t,e){return t.min<=0&&t.max>=0&&e.min<=0&&e.max>=0}z.c.directive("annotationTooltip",ks);var Ps=r(637),$s=r.n(Ps),Ds=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return J.c(e,t),e.prototype.render=function(){var t=this.props,e=t.customClassName,r=t.children,n=J.e(t,["customClassName","children"]);return j.a.createElement($s.a,J.a({className:e,autoHeight:!0,autoHeightMin:"100%",autoHeightMax:"100%",renderTrackHorizontal:function(t){return j.a.createElement("div",J.a({},t,{className:"track-horizontal"}))},renderTrackVertical:function(t){return j.a.createElement("div",J.a({},t,{className:"track-vertical"}))},renderThumbHorizontal:function(t){return j.a.createElement("div",J.a({},t,{className:"thumb-horizontal"}))},renderThumbVertical:function(t){return j.a.createElement("div",J.a({},t,{className:"thumb-vertical"}))},renderView:function(t){return j.a.createElement("div",J.a({},t,{className:"view"}))}},n),r)},e.defaultProps={customClassName:"custom-scrollbars",autoHide:!0,autoHideTimeout:200,autoHideDuration:200,hideTracksWhenNotNeeded:!1},e}(R.PureComponent),Os=r(340),Is=function(t){function e(e){var r=t.call(this,e)||this;return r.onClickToOpen=function(){r.colorPickerDrop&&r.destroyDrop();var t=r.props,e=t.color,n=t.yaxis,a=t.onColorChange,i=t.onToggleAxis,s=j.a.createElement(Os.a,{color:e,yaxis:n,onColorChange:a,onToggleAxis:i}),o=document.createElement("div");V.a.render(s,o);var l=new wt.a({target:r.pickerElem,content:o,position:"bottom center",classes:"drop-popover",openOn:"hover",hoverCloseDelay:200,remove:!0,tetherOptions:{constraints:[{to:"scrollParent",attachment:"none both"}]}});l.on("close",r.closeColorPicker.bind(r)),r.colorPickerDrop=l,r.colorPickerDrop.open()},r}return J.c(e,t),e.prototype.componentWillUnmount=function(){this.destroyDrop()},e.prototype.closeColorPicker=function(){var t=this;setTimeout(function(){t.destroyDrop()},100)},e.prototype.destroyDrop=function(){this.colorPickerDrop&&this.colorPickerDrop.tether&&(this.colorPickerDrop.destroy(),this.colorPickerDrop=null)},e.prototype.render=function(){var t=this,e=this.props,r=e.optionalClass,n=e.children;return j.a.createElement("div",{className:r,ref:function(e){return t.pickerElem=e},onClick:this.onClickToOpen},n)},e.defaultProps={optionalClass:"",yaxis:void 0,onToggleAxis:function(){}},e}(j.a.Component),Ns=["min","max","avg","current","total"],Fs=function(t){function e(e){var r=t.call(this,e)||this;return r.onLabelClick=function(t){return r.props.onLabelClick(r.props.series,t)},r.onToggleAxis=function(){var t=2===r.state.yaxis?1:2,e={alias:r.props.series.alias,yaxis:t};r.setState({yaxis:t}),r.props.onToggleAxis(e)},r.onColorChange=function(t){r.props.onColorChange(r.props.series,t),r.forceUpdate()},r.state={yaxis:r.props.series.yaxis},r}return J.c(e,t),e.prototype.renderLegendValues=function(){for(var t=this.props,e=t.series,r=t.asTable,n=[],a=0,i=Ns;a<i.length;a++){var s=i[a];if(this.props[s]){var o=e.formatValue(e.stats[s]);n.push(j.a.createElement(js,{key:s,valueName:s,value:o,asTable:r}))}}return n},e.prototype.render=function(){var t=this.props,e=t.series,r=t.values,n=t.asTable,a=t.hidden,i=Dn()({"graph-legend-series-hidden":a,"graph-legend-series--right-y":2===e.yaxis}),s=r?this.renderLegendValues():[],o=j.a.createElement(qs,{label:e.alias,color:e.color,yaxis:this.state.yaxis,onLabelClick:this.onLabelClick,onColorChange:this.onColorChange,onToggleAxis:this.onToggleAxis});return n?j.a.createElement("tr",{className:"graph-legend-series "+i},j.a.createElement("td",null,o),s):j.a.createElement("div",{className:"graph-legend-series "+i},o,s)},e.defaultProps={asTable:!1,hidden:!1,onLabelClick:function(){},onColorChange:function(){},onToggleAxis:function(){}},e}(R.PureComponent),qs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return J.c(e,t),e.prototype.render=function(){var t=this,e=this.props,r=e.label,n=e.color,a=e.yaxis,i=this.props,s=i.onColorChange,o=i.onToggleAxis;return[j.a.createElement(Rs,{key:"icon",color:n,yaxis:a,onColorChange:s,onToggleAxis:o}),j.a.createElement("a",{className:"graph-legend-alias pointer",title:r,key:"label",onClick:function(e){return t.props.onLabelClick(e)}},r)]},e.defaultProps={yaxis:void 0,onLabelClick:function(){}},e}(R.PureComponent);function Ls(t){return j.a.createElement("i",{className:"fa fa-minus pointer",style:{color:t.color}})}var Rs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return J.c(e,t),e.prototype.render=function(){return j.a.createElement(Is,{optionalClass:"graph-legend-icon",yaxis:this.props.yaxis,color:this.props.color,onColorChange:this.props.onColorChange,onToggleAxis:this.props.onToggleAxis},j.a.createElement(Ls,{color:this.props.color}))},e.defaultProps={yaxis:void 0,onColorChange:function(){},onToggleAxis:function(){}},e}(R.PureComponent);function js(t){var e=t.value,r=t.valueName;return t.asTable?j.a.createElement("td",{className:"graph-legend-value "+r},e):j.a.createElement("div",{className:"graph-legend-value "+r},e)}var Us=function(t){function e(e){var r=t.call(this,e)||this;return r.onToggleSeries=function(t,e){var n=J.a({},r.state.hiddenSeries);e.ctrlKey||e.metaKey||e.shiftKey?n[t.alias]?delete n[t.alias]:n[t.alias]=!0:n=r.toggleSeriesExclusiveMode(t),r.setState({hiddenSeries:n}),r.props.onToggleSeries(n)},r.state={hiddenSeries:r.props.hiddenSeries},r}return J.c(e,t),e.prototype.sortLegend=function(){var t=this,e=this.props.seriesList.slice()||[];return this.props.sort&&(e=I.a.sortBy(e,function(e){var r=e.stats[t.props.sort];return null===r&&(r=-1/0),r}),this.props.sortDesc&&(e=e.reverse())),e},e.prototype.toggleSeriesExclusiveMode=function(t){var e=J.a({},this.state.hiddenSeries);return e[t.alias]&&delete e[t.alias],this.props.seriesList.every(function(r){return r.alias===t.alias||e[r.alias]})?this.props.seriesList.forEach(function(t){delete e[t.alias]}):this.props.seriesList.forEach(function(r){r.alias!==t.alias&&(e[r.alias]=!0)}),e},e.prototype.render=function(){var t=this.props,e=t.optionalClass,r=t.rightSide,n=t.sideWidth,a=t.sort,i=t.sortDesc,s=t.hideEmpty,o=t.hideZero,l={values:t.values,min:t.min,max:t.max,avg:t.avg,current:t.current,total:t.total},c=this.state.hiddenSeries,u={hideEmpty:s,hideZero:o},d={sort:a,sortDesc:i},p=this.sortLegend().filter(function(t){return!t.hideFromLegend(u)}),h=(this.props.alignAsTable?"graph-legend-table":"")+" "+e,f={minWidth:r&&n?n:void 0,width:r&&n?n-1:void 0},m=J.a({seriesList:p,hiddenSeries:c,onToggleSeries:this.onToggleSeries,onToggleAxis:this.props.onToggleAxis,onToggleSort:this.props.onToggleSort,onColorChange:this.props.onColorChange},l,d);return j.a.createElement("div",{className:"graph-legend-content "+h,style:f},this.props.alignAsTable?j.a.createElement(Bs,J.a({},m)):j.a.createElement(Vs,J.a({},m)))},e.defaultProps={values:!1,min:!1,max:!1,avg:!1,current:!1,total:!1,alignAsTable:!1,rightSide:!1,sort:void 0,sortDesc:!1,optionalClass:"",onToggleSeries:function(){},onToggleSort:function(){},onToggleAxis:function(){},onColorChange:function(){}},e}(R.PureComponent),Vs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return J.c(e,t),e.prototype.render=function(){var t=this,e=this.props,r=e.seriesList,n=e.hiddenSeries,a={values:e.values,min:e.min,max:e.max,avg:e.avg,current:e.current,total:e.total};return r.map(function(e,r){return j.a.createElement(Fs,J.a({key:e.id+"-"+r,series:e,hidden:n[e.alias]},a,{onLabelClick:t.props.onToggleSeries,onColorChange:t.props.onColorChange,onToggleAxis:t.props.onToggleAxis}))})},e}(R.PureComponent),Bs=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onToggleSort=function(t){var r=e.props.sortDesc,n=e.props.sort;t!==n&&(r=null),!1===r?(n=null,r=null):(r=!r,n=t),e.props.onToggleSort(n,r)},e}return J.c(e,t),e.prototype.render=function(){var t=this,e=this.props.seriesList,r=this.props,n=r.values,a=r.min,i=r.max,s=r.avg,o=r.current,l=r.total,c=r.sort,u=r.sortDesc,d=r.hiddenSeries,p={values:n,min:a,max:i,avg:s,current:o,total:l};return j.a.createElement("table",null,j.a.createElement("colgroup",null,j.a.createElement("col",{style:{width:"100%"}})),j.a.createElement("thead",null,j.a.createElement("tr",null,j.a.createElement("th",{style:{textAlign:"left"}}),Ns.map(function(e){return p[e]&&j.a.createElement(Qs,{key:e,statName:e,sort:c,sortDesc:u,onClick:t.onToggleSort})}))),j.a.createElement("tbody",null,e.map(function(e,r){return j.a.createElement(Fs,J.a({key:e.id+"-"+r,asTable:!0,series:e,hidden:d[e.alias],onLabelClick:t.props.onToggleSeries,onColorChange:t.props.onColorChange,onToggleAxis:t.props.onToggleAxis},p))})))},e}(R.PureComponent),Qs=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onClick=function(){return e.props.onClick(e.props.statName)},e}return J.c(e,t),e.prototype.render=function(){var t=this.props,e=t.statName,r=t.sort,n=t.sortDesc;return j.a.createElement("th",{className:"pointer",onClick:this.onClick},e,r===e&&j.a.createElement("span",{className:n?"fa fa-caret-down":"fa fa-caret-up"}))},e}(R.PureComponent),Hs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return J.c(e,t),e.prototype.render=function(){return j.a.createElement(Ds,null,j.a.createElement(Us,J.a({},this.props)))},e}(R.PureComponent),zs=function(){function t(t,e,r){var n=this;this.scope=t,this.elem=e,this.timeSrv=r,this.ctrl=t.ctrl,this.dashboard=this.ctrl.dashboard,this.panel=this.ctrl.panel,this.annotations=[],this.panelWidth=0,this.eventManager=new Ss(this.ctrl),this.thresholdManager=new cs(this.ctrl),this.timeRegionManager=new ps(this.ctrl),this.tooltip=new function(t,e,r,n){var a=this,i=r.ctrl.panel,s=F()('<div class="graph-tooltip">');this.destroy=function(){s.remove()},this.findHoverIndexFromDataPoints=function(t,e,r){var n,a=e.datapoints.pointsize,i=r*a,s=e.datapoints.points.length;for(n=i;n<s;n+=a)if(!e.lines.steps&&null!=e.datapoints.points[i]&&null==e.datapoints.points[n]||e.datapoints.points[n]>t)return Math.max(n-a,0)/a;return n/a-1},this.findHoverIndexFromData=function(t,e){for(var r,n=0,a=e.data.length-1;;){if(n>a)return Math.max(a,0);if(r=Math.floor((n+a)/2),e.data[r][0]===t)return r;e.data[r][0]<t?n=r+1:a=r-1}},this.renderAndShow=function(t,e,r,n){"time"===n&&(e='<div class="graph-tooltip-time">'+t+"</div>"+e),s.html(e).place_tt(r.pageX+20,r.pageY)},this.getMultiSeriesPlotHoverInfo=function(t,e){var r,n,a,s,o,l,c,u,d,p=[[],[],[]],h=0;for(n=0;n<t.length;n++)!(a=t[n]).data.length||i.legend.hideEmpty&&a.allIsNull?p[0].push({hidden:!0,value:0}):!a.data.length||i.legend.hideZero&&a.allIsZero?p[0].push({hidden:!0,value:0}):a.hideTooltip?p[0].push({hidden:!0,value:0}):(s=this.findHoverIndexFromData(e.x,a),o=e.x-a.data[s][0],l=a.data[s][0],(!u||o>=0&&(o<u||u<0)||o<0&&o>u)&&(u=o,d=l),r=a.stack?"individual"===i.tooltip.value_type?a.data[s][1]:a.stack?h+=a.data[s][1]:a.data[s][1]:a.data[s][1],(a.lines.steps||a.stack)&&(s=this.findHoverIndexFromDataPoints(e.x,a,s)),c=0,a.yaxis&&(c=a.yaxis.n),p[c].push({value:r,hoverIndex:s,color:a.color,label:a.aliasEscaped,time:l,distance:o,index:n}));return(p=p[0].concat(p[1],p[2])).time=d,p},t.mouseleave(function(){if(i.tooltip.shared){var e=t.data().plot;e&&(s.detach(),e.unhighlight())}G.c.emit("graph-hover-clear")}),t.bind("plothover",function(e,r,n){a.show(r,n),r.panelRelY=(r.pageY-t.offset().top)/t.height(),G.c.emit("graph-hover",{pos:r,panel:i})}),t.bind("plotclick",function(t,e,r){G.c.emit("graph-click",{pos:e,panel:i,item:r})}),this.clear=function(t){s.detach(),t.clearCrosshair(),t.unhighlight()},this.show=function(r,o){var l,c,u,d,p,h,f,m,g=t.data().plot,v=g.getData(),b=g.getXAxes()[0].options.mode,y=n(),w=i.tooltip.shared;if(r.panelRelY){var x=g.pointOffset({x:r.x});if(Number.isNaN(x.left)||x.left<0||x.left>t.width())return void a.clear(g);if(r.pageX=t.offset().left+x.left,r.pageY=t.offset().top+t.height()*r.panelRelY,!(r.pageY>=F()(window).scrollTop()&&r.pageY<=F()(window).innerHeight()+F()(window).scrollTop()))return void a.clear(g);if(g.setCrosshair(r),w=!0,e.sharedCrosshairModeOnly())return}if(0!==y.length)if(m=y[0].hasMsResolution?"YYYY-MM-DD HH:mm:ss.SSS":"YYYY-MM-DD HH:mm:ss",w){g.unhighlight();var S=a.getMultiSeriesPlotHoverInfo(v,r);for(f="",u=e.formatDate(S.time,m),2===i.tooltip.sort?S.sort(function(t,e){return e.value-t.value}):1===i.tooltip.sort&&S.sort(function(t,e){return t.value-e.value}),p=0;p<S.length;p++)if(!(d=S[p]).hidden){var k="";o&&d.index===o.seriesIndex&&(k="graph-tooltip-list-item--highlight"),c=(h=y[d.index]).formatValue(d.value),f+='<div class="graph-tooltip-list-item '+k+'"><div class="graph-tooltip-series-name">',f+='<i class="fa fa-minus" style="color:'+d.color+';"></i> '+d.label+":</div>",f+='<div class="graph-tooltip-value">'+c+"</div></div>",g.highlight(d.index,d.hoverIndex)}a.renderAndShow(u,f,r,b)}else o?(h=y[o.seriesIndex],l='<div class="graph-tooltip-list-item"><div class="graph-tooltip-series-name">',l+='<i class="fa fa-minus" style="color:'+o.series.color+';"></i> '+h.aliasEscaped+":</div>",c=i.stack&&"individual"===i.tooltip.value_type?o.datapoint[1]-o.datapoint[2]:o.datapoint[1],c=h.formatValue(c),u=e.formatDate(o.datapoint[0],m),l+='<div class="graph-tooltip-value">'+c+"</div>",a.renderAndShow(u,l,r,b)):s.detach()}}(this.elem,this.ctrl.dashboard,this.scope,function(){return n.sortedSeries}),this.ctrl.events.on("panel-teardown",this.onPanelTeardown.bind(this)),this.ctrl.events.on("render",this.onRender.bind(this)),G.c.on("graph-hover",this.onGraphHover.bind(this),t),G.c.on("graph-hover-clear",this.onGraphHoverClear.bind(this),t),this.elem.bind("plotselected",this.onPlotSelected.bind(this)),this.elem.bind("plotclick",this.onPlotClick.bind(this)),this.elem&&this.elem.parent&&(this.legendElem=this.elem.parent().find(".graph-legend")[0])}return t.prototype.onRender=function(t){var e=this;if(this.data=t||this.data,this.data){this.annotations=this.ctrl.annotations||[],this.buildFlotPairs(this.data);var r=this.elem.height();if(Object(G.h)(this.data,this.panel,r),!this.panel.legend.show)return this.legendElem.hasChildNodes()&&V.a.unmountComponentAtNode(this.legendElem),void this.renderPanel();var n=this.panel.legend,a=n.values,i=n.min,s=n.max,o=n.avg,l=n.current,c=n.total,u=this.panel.legend,d={alignAsTable:u.alignAsTable,rightSide:u.rightSide,sideWidth:u.sideWidth,sort:u.sort,sortDesc:u.sortDesc,hideEmpty:u.hideEmpty,hideZero:u.hideZero},p={values:a,min:i,max:s,avg:o,current:l,total:c},h=J.a({seriesList:this.data,hiddenSeries:this.ctrl.hiddenSeries},d,p,{onToggleSeries:this.ctrl.onToggleSeries,onToggleSort:this.ctrl.onToggleSort,onColorChange:this.ctrl.onColorChange,onToggleAxis:this.ctrl.onToggleAxis}),f=j.a.createElement(Hs,h);V.a.render(f,this.legendElem,function(){return e.renderPanel()})}},t.prototype.onGraphHover=function(t){this.dashboard.sharedTooltipModeEnabled()&&this.plot&&t.panel.id!==this.panel.id&&!this.ctrl.otherPanelInFullscreenMode()&&this.tooltip.show(t.pos)},t.prototype.onPanelTeardown=function(){this.thresholdManager=null,this.timeRegionManager=null,this.plot&&(this.plot.destroy(),this.plot=null),this.tooltip.destroy(),this.elem.off(),this.elem.remove(),V.a.unmountComponentAtNode(this.legendElem)},t.prototype.onGraphHoverClear=function(t,e){this.plot&&this.tooltip.clear(this.plot)},t.prototype.onPlotSelected=function(t,e){var r=this;"time"===this.panel.xaxis.mode?(e.ctrlKey||e.metaKey)&&(this.dashboard.meta.canEdit||this.dashboard.meta.canMakeEditable)?setTimeout(function(){r.eventManager.updateTime(e.xaxis)},100):this.scope.$apply(function(){r.timeSrv.setTime({from:H.a.utc(e.xaxis.from),to:H.a.utc(e.xaxis.to)})}):this.plot.clearSelection()},t.prototype.onPlotClick=function(t,e,r){var n=this;"time"===this.panel.xaxis.mode&&((e.ctrlKey||e.metaKey)&&(this.dashboard.meta.canEdit||this.dashboard.meta.canMakeEditable)&&(e.x!==e.x1||setTimeout(function(){n.eventManager.updateTime({from:e.x,to:null})},100)))},t.prototype.shouldAbortRender=function(){return!this.data||0===this.panelWidth},t.prototype.drawHook=function(t){this.panel.yaxes[0].label&&this.panel.yaxes[0].show&&F()("<div class='axisLabel left-yaxis-label flot-temp-elem'></div>").text(this.panel.yaxes[0].label).appendTo(this.elem),this.panel.yaxes[1].label&&this.panel.yaxes[1].show&&F()("<div class='axisLabel right-yaxis-label flot-temp-elem'></div>").text(this.panel.yaxes[1].label).appendTo(this.elem),this.ctrl.dataWarning&&F()('<div class="datapoints-warning flot-temp-elem">'+this.ctrl.dataWarning.title+"</div>").appendTo(this.elem),this.thresholdManager.draw(t),this.timeRegionManager.draw(t)},t.prototype.processOffsetHook=function(t,e){var r=this.panel.yaxes[0],n=this.panel.yaxes[1];r.show&&r.label&&(e.left=20),n.show&&n.label&&(e.right=20);for(var a=t.getYAxes(),i=0;i<a.length;i++){var s=a[i],o=this.panel.yaxes[i];s.options.max=null!==s.options.max?s.options.max:o.max,s.options.min=null!==s.options.min?s.options.min:o.min}},t.prototype.processRangeHook=function(t){var e=t.getYAxes(),r=this.panel.yaxis.align||!1;if(e.length>1&&!0===r){var n=this.panel.yaxis.alignLevel||0;Es(e,parseFloat(n))}},t.prototype.getMinTimeStepOfSeries=function(t){for(var e=Number.MAX_VALUE,r=0;r<t.length;r++)if(t[r].stats.timeStep){if(this.panel.bars){if(t[r].bars&&!1===t[r].bars.show)continue}else if(void 0===t[r].bars||void 0===t[r].bars.show||!t[r].bars.show)continue;t[r].stats.timeStep<e&&(e=t[r].stats.timeStep)}return e},t.prototype.renderPanel=function(){if(this.panelWidth=this.elem.width(),!this.shouldAbortRender()){this.thresholdManager.prepare(this.elem,this.data),this.panel.dashes=!!this.panel.lines&&this.panel.dashes;var t=this.buildFlotOptions(this.panel);this.prepareXAxis(t,this.panel),this.configureYAxisOptions(this.data,t),this.thresholdManager.addFlotOptions(t,this.panel),this.timeRegionManager.addFlotOptions(t,this.panel),this.eventManager.addFlotEvents(this.annotations,t),this.sortedSeries=this.sortSeries(this.data,this.panel),this.callPlot(t,!0)}},t.prototype.buildFlotPairs=function(t){for(var e=0;e<t.length;e++){var r=t[e];r.data=r.getFlotPairs(r.nullPointMode||this.panel.nullPointMode),this.panel.lines&&this.panel.smoothLine&&r.data.length>0&&(r.data=this.unLinearRegression(r.data)),this.ctrl.hiddenSeries[r.alias]&&(r.data=[],r.stack=!1)}},t.prototype.unLinearRegression=function(t){for(var e,r,n,a=0,i=0,s=0,o=0,l=0,c=0,u=0,d=t.length,p=0;p<t.length;p++)a+=p+1,s+=Math.pow(p+1,2),l+=Math.pow(p+1,3),u+=Math.pow(p+1,4),i+=t[p][1],o+=t[p][1]*(p+1),c+=t[p][1]*Math.pow(p+1,2);e=i/d-a/d*(r=(c*d-s*i-(u*d-s*s)*(n=((o*d-a*i)*(l*d-a*s)-(c*d-s*i)*(s*d-a*a))/((l*d-a*s)*(l*d-a*s)-(s*d-a*a)*(u*d-s*s))))/(l*d-a*s))-s/d*n;for(var h=[],f=0;f<t.length;f++){var m=e+r*(f+1)+(f+1)*(f+1)*n;h.push([t[f][0],m])}return h},t.prototype.prepareXAxis=function(t,e){switch(e.xaxis.mode){case"series":t.series.bars.barWidth=e.barsWidth||.7,t.series.bars.align="center";for(var r=0;r<this.data.length;r++){var n=this.data[r];n.data=[[r+1,n.stats[e.xaxis.values[0]]]]}this.addXSeriesAxis(t);break;case"histogram":var a=void 0;if(this.data.length){var i=I.a.min(I.a.map(this.data,function(t){return t.stats.min})),s=I.a.max(I.a.map(this.data,function(t){return t.stats.max})),o=e.xaxis.buckets||this.panelWidth/50;a=Object(Ee.tickStep)(i,s,o),t.series.bars.barWidth=.8*a,this.data=Cs(this.data,a,this.ctrl.hiddenSeries,i,s)}else a=0;this.addXHistogramAxis(t,a);break;case"table":t.series.bars.barWidth=e.barsWidth||.7,t.series.bars.align="center",this.addXTableAxis(t);break;default:t.series.bars.barWidth=this.getMinTimeStepOfSeries(this.data)/1.5,this.addTimeAxis(t)}},t.prototype.callPlot=function(t,e){try{this.plot=F.a.plot(this.elem,this.sortedSeries,t),this.ctrl.renderError&&(delete this.ctrl.error,delete this.ctrl.inspector)}catch(t){console.log("flotcharts error",t),this.ctrl.error=t.message||"Render Error",this.ctrl.renderError=!0,this.ctrl.inspector={error:t}}e&&this.ctrl.renderingCompleted()},t.prototype.buildFlotOptions=function(t){var e="#c8c8c8";!0===B.a.bootData.user.lightTheme&&(e="#a1a1a1");var r=!!t.stack||null;return{hooks:{draw:[this.drawHook.bind(this)],processOffset:[this.processOffsetHook.bind(this)],processRange:[this.processRangeHook.bind(this)]},legend:{show:!1},series:{stackpercent:!!t.stack&&t.percentage,stack:t.percentage?null:r,lines:{show:t.lines,zero:!1,fill:this.translateFillOption(t.fill),lineWidth:t.dashes?0:t.linewidth,steps:t.steppedLine},dashes:{show:t.dashes,lineWidth:t.linewidth,dashLength:[t.dashLength,t.spaceLength]},bars:{show:t.bars,fill:1,barWidth:t.barsWidth||1,zero:!1,lineWidth:0},points:{show:t.points,fill:1,fillColor:!1,radius:t.points?t.pointradius:2},shadowSize:0},yaxes:[],xaxis:{},grid:{minBorderMargin:0,markings:[],backgroundColor:null,borderWidth:0,hoverable:!0,clickable:!0,color:e,margin:{left:0,right:0},labelMarginX:0},selection:{mode:"x",color:"#666"},crosshair:{mode:"x"}}},t.prototype.sortSeries=function(t,e){var r=e.legend.sort,n=e.legend.sortDesc,a=null!==r&&void 0!==r,i=null!==n&&void 0!==n,s=e.stack&&a&&i,o=!0===e.legend.sortDesc?-1:1;return s?I.a.sortBy(t,function(t){return t.stats[r]*o}):I.a.sortBy(t,function(t){return t.zindex})},t.prototype.translateFillOption=function(t){return this.panel.percentage&&this.panel.stack&&0===t?.001:t/10},t.prototype.addTimeAxis=function(t){var e=this.panelWidth/100,r=I.a.isUndefined(this.ctrl.range.from)?null:this.ctrl.range.from.valueOf(),n=I.a.isUndefined(this.ctrl.range.to)?null:this.ctrl.range.to.valueOf();t.xaxis={timezone:this.dashboard.getTimezone(),show:this.panel.xaxis.show,mode:"time",min:r,max:n,label:"Datetime",ticks:e,timeformat:this.time_format(e,r,n)}},t.prototype.addXSeriesAxis=function(t){var e=I.a.map(this.data,function(t,e){return[e+1,t.alias]});t.xaxis={timezone:this.dashboard.getTimezone(),show:this.panel.xaxis.show,mode:null,min:0,max:e.length+1,label:"Datetime",ticks:e}},t.prototype.addXHistogramAxis=function(t,e){var r,n,a,i=this.panelWidth/50;if(this.data.length&&e){for(var s=[],o=0,l=this.data;o<l.length;o++)for(var c=0,u=l[o].data;c<u.length;c++){s[u[c][0]]=!0}r=Object.keys(s).map(function(t){return Number(t)}),n=I.a.min(r),a=I.a.max(r);for(var d=e,p=Math.floor((a-n)/d);p>i;)d*=2,p=Math.ceil((a-n)/d);n=Math.floor(n/d)*d,a=Math.ceil(1.01*a/d)*d,r=[];for(var h=n;h<=a;h+=d)r.push(h)}else r=i/2,n=0,a=1;t.xaxis={timezone:this.dashboard.getTimezone(),show:this.panel.xaxis.show,mode:null,min:n,max:a,label:"Histogram",ticks:r},this.configureAxisMode(t.xaxis,"short")},t.prototype.addXTableAxis=function(t){var e=I.a.map(this.data,function(t,e){return I.a.map(t.datapoints,function(r,n){return[e*t.datapoints.length+n+1,r[1]]})});e=I.a.flatten(e,!0),t.xaxis={timezone:this.dashboard.getTimezone(),show:this.panel.xaxis.show,mode:null,min:0,max:e.length+1,label:"Datetime",ticks:e}},t.prototype.configureYAxisOptions=function(t,e){var r={position:"left",show:this.panel.yaxes[0].show,index:1,logBase:this.panel.yaxes[0].logBase||1,min:this.parseNumber(this.panel.yaxes[0].min),max:this.parseNumber(this.panel.yaxes[0].max),tickDecimals:this.panel.yaxes[0].decimals};if(e.yaxes.push(r),I.a.find(t,{yaxis:2})){var n=I.a.clone(r);n.index=2,n.show=this.panel.yaxes[1].show,n.logBase=this.panel.yaxes[1].logBase||1,n.position="right",n.min=this.parseNumber(this.panel.yaxes[1].min),n.max=this.parseNumber(this.panel.yaxes[1].max),n.tickDecimals=this.panel.yaxes[1].decimals,e.yaxes.push(n),this.applyLogScale(e.yaxes[1],t),this.configureAxisMode(e.yaxes[1],this.panel.percentage&&this.panel.stack?"percent":this.panel.yaxes[1].format)}this.applyLogScale(e.yaxes[0],t),this.configureAxisMode(e.yaxes[0],this.panel.percentage&&this.panel.stack?"percent":this.panel.yaxes[0].format)},t.prototype.parseNumber=function(t){return null===t||void 0===t?null:I.a.toNumber(t)},t.prototype.applyLogScale=function(t,e){if(1!==t.logBase){var r,n,a=0===t.min;t.min<Number.MIN_VALUE&&(t.min=null),t.max<Number.MIN_VALUE&&(t.max=null);var i=t.max,s=t.min;for(n=0;n<e.length;n++)(r=e[n]).yaxis===t.index&&((!i||i<r.stats.max)&&(i=r.stats.max),(!s||s>r.stats.logmin)&&(s=r.stats.logmin));t.transform=function(e){return e<Number.MIN_VALUE?null:Math.log(e)/Math.log(t.logBase)},t.inverseTransform=function(e){return Math.pow(t.logBase,e)},i||s?i?s||(s=i*t.inverseTransform(-4)):i=s*t.inverseTransform(4):(i=t.inverseTransform(2),s=t.inverseTransform(-2)),s=t.min?t.inverseTransform(Math.ceil(t.transform(t.min))):t.min=t.inverseTransform(Math.floor(t.transform(s))),i=t.max?t.inverseTransform(Math.floor(t.transform(t.max))):t.max=t.inverseTransform(Math.ceil(t.transform(i))),!s||s<Number.MIN_VALUE||!i||i<Number.MIN_VALUE||(Number.isFinite(s)&&Number.isFinite(i)?(a&&(t.min=.1,s=1),t.ticks=this.generateTicksForLogScaleYAxis(s,i,t.logBase),a&&t.ticks.unshift(.1),t.ticks[t.ticks.length-1]>t.max&&(t.max=t.ticks[t.ticks.length-1])):(t.ticks=[1,2],delete t.min,delete t.max))}},t.prototype.generateTicksForLogScaleYAxis=function(t,e,r){var n,a=[];for(n=t;n<=e;n*=r)a.push(n);var i=Math.ceil(this.ctrl.height/25),s=a.length;if(s>i){var o=Math.ceil(s/i)*r;for(a=[],n=t;n<=e*o;n*=o)a.push(n)}return a},t.prototype.configureAxisMode=function(t,e){t.tickFormatter=function(t,r){if(!kt.a.valueFormats[e])throw new Error("Unit '"+e+"' is not supported");return kt.a.valueFormats[e](t,r.tickDecimals,r.scaledDecimals)}},t.prototype.time_format=function(t,e,r){if(e&&r&&t){var n=r-e,a=n/t/1e3;return a<=45?"%H:%M:%S":a<=7200||n<=86400010?"%H:%M":a<=8e4?"%m/%d %H:%M":a<=2419200||n<=31536e6?"%m/%d":"%Y-%m"}return"%H:%M"},t}();function Gs(t,e,r){return{restrict:"A",template:"",link:function(e,r){return new zs(e,r,t)}}}function Ws(t,e,r){t.overrideMenu=[],t.currentOverrides=[],t.override=t.override||{},t.addOverrideOption=function(e,r,n){var a={text:e,propertyName:r,index:t.overrideMenu.lenght,values:n,submenu:I.a.map(n,function(t){return{text:String(t),value:t}})};t.overrideMenu.push(a)},t.setOverride=function(e,r){"color"!==e.propertyName?(t.override[e.propertyName]=r.value,"fillBelowTo"===e.propertyName&&(t.override.lines=!1,t.ctrl.addSeriesOverride({alias:r.value,lines:!1})),t.updateCurrentOverrides(),t.ctrl.render()):t.openColorSelector(t.override.color)},t.colorSelected=function(e){t.override.color=e,t.updateCurrentOverrides(),t.ctrl.render()},t.openColorSelector=function(n){var a={color:n};r.show({element:e.find(".dropdown")[0],position:"top center",openOn:"click",template:'<series-color-picker-popover series="series" onColorChange="colorSelected" />',model:{autoClose:!0,colorSelected:t.colorSelected,series:a},onClose:function(){t.ctrl.render()}})},t.removeOverride=function(e){delete t.override[e.propertyName],t.updateCurrentOverrides(),t.ctrl.refresh()},t.getSeriesNames=function(){return I.a.map(t.ctrl.seriesList,function(t){return t.alias})},t.updateCurrentOverrides=function(){t.currentOverrides=[],I.a.each(t.overrideMenu,function(e){var r=t.override[e.propertyName];I.a.isUndefined(r)||t.currentOverrides.push({name:e.text,propertyName:e.propertyName,value:String(r)})})},t.addOverrideOption("Bars","bars",[!0,!1]),t.addOverrideOption("Lines","lines",[!0,!1]),t.addOverrideOption("Line fill","fill",[0,1,2,3,4,5,6,7,8,9,10]),t.addOverrideOption("Line width","linewidth",[0,1,2,3,4,5,6,7,8,9,10]),t.addOverrideOption("Null point mode","nullPointMode",["connected","null","null as zero"]),t.addOverrideOption("Fill below to","fillBelowTo",t.getSeriesNames()),t.addOverrideOption("Staircase line","steppedLine",[!0,!1]),t.addOverrideOption("Smooth line","smoothLine",[!0,!1]),t.addOverrideOption("Dashes","dashes",[!0,!1]),t.addOverrideOption("Dash Length","dashLength",[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]),t.addOverrideOption("Dash Space","spaceLength",[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]),t.addOverrideOption("Points","points",[!0,!1]),t.addOverrideOption("Points Radius","pointradius",[1,2,3,4,5]),t.addOverrideOption("Stack","stack",[!0,!1,"A","B","C","D"]),t.addOverrideOption("Color","color",["change"]),t.addOverrideOption("Y-axis","yaxis",[1,2]),t.addOverrideOption("Z-index","zindex",[-3,-2,-1,0,1,2,3]),t.addOverrideOption("Transform","transform",["negative-Y"]),t.addOverrideOption("Legend","legend",[!0,!1]),t.addOverrideOption("Hide in tooltip","hideTooltip",[!0,!1]),t.updateCurrentOverrides()}G.e.directive("grafanaGraph",Gs),z.c.controller("SeriesOverridesCtrl",Ws);var Ys=function(){function t(t){var e=this;this.panel=this.panelCtrl.panel,this.panel.alert&&(this.disabled=!0);var r=t.$on("$destroy",function(){e.panelCtrl.editingThresholds=!1,e.panelCtrl.render(),r()});this.panelCtrl.editingThresholds=!0}return t.$inject=["$scope"],t.prototype.addThreshold=function(){this.panel.thresholds.push({value:void 0,colorMode:"critical",op:"gt",fill:!0,line:!0,yaxis:"left",showValue:!1}),this.panelCtrl.render()},t.prototype.removeThreshold=function(t){this.panel.thresholds.splice(t,1),this.panelCtrl.render()},t.prototype.render=function(){this.panelCtrl.render()},t.prototype.onFillColorChange=function(t){var e=this;return function(r){e.panel.thresholds[t].fillColor=r,e.render()}},t.prototype.onLineColorChange=function(t){var e=this;return function(r){e.panel.thresholds[t].lineColor=r,e.render()}},t}();z.c.directive("graphThresholdForm",function(){return{restrict:"E",templateUrl:"public/app/plugins/panel/graph/thresholds_form.html",controller:Ys,bindToController:!0,controllerAs:"ctrl",scope:{panelCtrl:"="}}});var Ks=function(){function t(t){var e=this;this.panel=this.panelCtrl.panel;var r=t.$on("$destroy",function(){e.panelCtrl.editingTimeRegions=!1,e.panelCtrl.render(),r()});this.colorModes=I.a.map(Object.keys(us),function(t){return{key:t,value:us[t].title}}),this.panelCtrl.editingTimeRegions=!0}return t.$inject=["$scope"],t.prototype.render=function(){this.panelCtrl.render()},t.prototype.addTimeRegion=function(){this.panel.timeRegions.push({op:"time",fromDayOfWeek:void 0,from:void 0,toDayOfWeek:void 0,to:void 0,colorMode:"background6",fill:!0,line:!1}),this.panelCtrl.render()},t.prototype.removeTimeRegion=function(t){this.panel.timeRegions.splice(t,1),this.panelCtrl.render()},t.prototype.onFillColorChange=function(t){var e=this;return function(r){e.panel.timeRegions[t].fillColor=r,e.render()}},t.prototype.onLineColorChange=function(t){var e=this;return function(r){e.panel.timeRegions[t].lineColor=r,e.render()}},t}();z.c.directive("graphTimeRegionForm",function(){return{restrict:"E",templateUrl:"public/app/plugins/panel/graph/time_regions_form.html",controller:Ks,bindToController:!0,controllerAs:"ctrl",scope:{panelCtrl:"="}}});var Js=function(){function t(t){this.panel=t}return t.prototype.getSeriesList=function(t){var e,r=this;if(!t.dataList||0===t.dataList.length)return[];if(t.dataList&&t.dataList.length>0){e=t.dataList[0];var n=this.getAutoDetectXAxisMode(e);this.panel.xaxis.mode!==n&&(this.panel.xaxis.mode=n,this.setPanelDefaultsForNewXAxisMode())}switch(this.panel.xaxis.mode){case"series":case"time":return t.dataList.map(function(e,n){return r.timeSeriesHandler(e,n,t)});case"histogram":return(this.panel.stack?t.dataList:[{target:"count",datapoints:I.a.concat([],I.a.flatten(I.a.map(t.dataList,"datapoints")))}]).map(function(e,n){return r.timeSeriesHandler(e,n,t)});case"field":return this.customHandler(e)}},t.prototype.getAutoDetectXAxisMode=function(t){switch(t.type){case"docs":case"table":return"field";default:return"series"===this.panel.xaxis.mode?"series":"histogram"===this.panel.xaxis.mode?"histogram":"time"}},t.prototype.setPanelDefaultsForNewXAxisMode=function(){switch(this.panel.xaxis.mode){case"time":this.panel.bars=!1,this.panel.lines=!0,this.panel.points=!1,this.panel.legend.show=!0,this.panel.tooltip.shared=!0,this.panel.xaxis.values=[];break;case"series":this.panel.bars=!0,this.panel.lines=!1,this.panel.points=!1,this.panel.stack=!1,this.panel.legend.show=!1,this.panel.tooltip.shared=!1,this.panel.xaxis.values=["total"];break;case"histogram":this.panel.bars=!0,this.panel.lines=!1,this.panel.points=!1,this.panel.stack=!1,this.panel.legend.show=!1,this.panel.tooltip.shared=!1}},t.prototype.timeSeriesHandler=function(t,e,r){var n=t.datapoints||[],a=t.target,i=e%xt.g.length,s=this.panel.aliasColors[a]||xt.g[i],o=new re.a({datapoints:n,alias:a,color:s,unit:t.unit});n&&n.length>0&&(n[n.length-1][1]-r.range.from<-1e4&&(o.isOutsideRange=!0));return o},t.prototype.customHandler=function(t){if(!this.panel.xaxis.name)throw{message:"No field name specified to use for x-axis, check your axes settings"};return[]},t.prototype.validateXAxisSeriesValue=function(){switch(this.panel.xaxis.mode){case"series":if(0===this.panel.xaxis.values.length)return void(this.panel.xaxis.values=["total"]);var t=this.getXAxisValueOptions({});return void(I.a.find(t,{value:this.panel.xaxis.values[0]})||(this.panel.xaxis.values=["total"]))}},t.prototype.getDataFieldNames=function(t,e){if(0===t.length)return[];var r=[],n=t[0],a=[];if("docs"===n.type){if(0===n.datapoints.length)return[];!function t(n){I.a.forEach(n,function(n,i){if(I.a.isObject(n))a.push(i),t(n);else if(!e||I.a.isNumber(n)){var s=a.concat(i).join(".");r.push(s)}}),a.pop()}(n.datapoints[0])}return r},t.prototype.getXAxisValueOptions=function(t){switch(this.panel.xaxis.mode){case"series":return[{text:"Avg",value:"avg"},{text:"Min",value:"min"},{text:"Max",value:"max"},{text:"Total",value:"total"},{text:"Count",value:"count"}]}return[]},t.prototype.pluckDeep=function(t,e){for(var r=e.split("."),n=t,a=0;a<r.length;++a){if(!n[r[a]])return;n=n[r[a]]}return n},t}(),Xs=function(){function t(t,e){this.$scope=t,this.$q=e,this.panelCtrl=t.ctrl,this.panel=this.panelCtrl.panel,this.$scope.ctrl=this,this.unitFormats=kt.a.getUnitFormats(),this.logScales={linear:1,"log (base 2)":2,"log (base 10)":10,"log (base 32)":32,"log (base 1024)":1024},this.xAxisModes={Time:"time",Series:"series",Histogram:"histogram"},this.xAxisStatOptions=[{text:"Avg",value:"avg"},{text:"Min",value:"min"},{text:"Max",value:"max"},{text:"Total",value:"total"},{text:"Count",value:"count"},{text:"Current",value:"current"}],"custom"===this.panel.xaxis.mode&&(this.panel.xaxis.name||(this.panel.xaxis.name="specify field"))}return t.$inject=["$scope","$q"],t.prototype.setUnitFormat=function(t,e){t.format=e.value,this.panelCtrl.render()},t.prototype.render=function(){this.panelCtrl.render()},t.prototype.xAxisModeChanged=function(){this.panelCtrl.processor.setPanelDefaultsForNewXAxisMode(),this.panelCtrl.onDataReceived(this.panelCtrl.dataList)},t.prototype.xAxisValueChanged=function(){this.panelCtrl.onDataReceived(this.panelCtrl.dataList)},t.prototype.getDataFieldNames=function(t){var e=this.panelCtrl.processor.getDataFieldNames(this.panelCtrl.dataList,t).map(function(t){return{text:t,value:t}});return this.$q.when(e)},t}();function Zs(){return{restrict:"E",scope:!0,templateUrl:"public/app/plugins/panel/graph/axes_editor.html",controller:Xs}}var to=function(t){function e(e,r,n){var a=t.call(this,e,r,{showPrecision:!0})||this;return a.annotationsSrv=n,a.hiddenSeries={},a.seriesList=[],a.dataList=[],a.annotations=[],a.colors=[],a.panelDefaults={datasource:null,renderer:"flot",yaxes:[{label:null,show:!0,logBase:1,min:null,max:null,format:"short"},{label:null,show:!0,logBase:1,min:null,max:null,format:"short"}],xaxis:{show:!0,mode:"time",name:null,values:[],buckets:null},yaxis:{align:!1,alignLevel:null},lines:!0,fill:1,linewidth:1,dashes:!1,dashLength:10,spaceLength:10,points:!1,pointradius:5,bars:!1,stack:!1,percentage:!1,legend:{show:!0,values:!1,min:!1,max:!1,current:!1,total:!1,avg:!1},nullPointMode:"null",steppedLine:!1,smoothLine:!1,tooltip:{value_type:"individual",shared:!0,sort:0},timeFrom:null,timeShift:null,targets:[{}],aliasColors:{},seriesOverrides:[],thresholds:[],timeRegions:[]},a.onColorChange=function(t,e){t.setColor(e),a.panel.aliasColors[t.alias]=t.color,a.render()},a.onToggleSeries=function(t){a.hiddenSeries=t,a.render()},a.onToggleSort=function(t,e){a.panel.legend.sort=t,a.panel.legend.sortDesc=e,a.render()},a.onToggleAxis=function(t){var e=I.a.find(a.panel.seriesOverrides,{alias:t.alias});e||(e={alias:t.alias},a.panel.seriesOverrides.push(e)),e.yaxis=t.yaxis,a.render()},I.a.defaults(a.panel,a.panelDefaults),I.a.defaults(a.panel.tooltip,a.panelDefaults.tooltip),I.a.defaults(a.panel.legend,a.panelDefaults.legend),I.a.defaults(a.panel.xaxis,a.panelDefaults.xaxis),a.processor=new Js(a.panel),a.events.on("render",a.onRender.bind(a)),a.events.on("data-received",a.onDataReceived.bind(a)),a.events.on("data-error",a.onDataError.bind(a)),a.events.on("data-snapshot-load",a.onDataSnapshotLoad.bind(a)),a.events.on("init-edit-mode",a.onInitEditMode.bind(a)),a.events.on("init-panel-actions",a.onInitPanelActions.bind(a)),a}return e.$inject=["$scope","$injector","annotationsSrv"],J.c(e,t),e.prototype.onInitEditMode=function(){this.addEditorTab("Axes",Zs,2),this.addEditorTab("Legend","public/app/plugins/panel/graph/tab_legend.html",3),this.addEditorTab("Display","public/app/plugins/panel/graph/tab_display.html",4),B.a.alertingEnabled&&this.addEditorTab("Alert",Kt,5),this.subTabIndex=0},e.prototype.onInitPanelActions=function(t){t.push({text:"导出CSV",click:"ctrl.exportCsv()"}),t.push({text:"切换说明",click:"ctrl.toggleLegend()",shortcut:"p l"})},e.prototype.issueQueries=function(e){var r=this;return this.annotationsPromise=this.annotationsSrv.getAnnotations({dashboard:this.dashboard,panel:this.panel,range:this.range}),this.annotationsSrv.datasourcePromises.then(function(n){return t.prototype.issueQueries.call(r,e)})},e.prototype.zoomOut=function(t){this.publishAppEvent("zoom-out",2)},e.prototype.onDataSnapshotLoad=function(t){this.annotationsPromise=this.annotationsSrv.getAnnotations({dashboard:this.dashboard,panel:this.panel,range:this.range}),this.onDataReceived(t)},e.prototype.onDataError=function(t){this.seriesList=[],this.annotations=[],this.render([])},e.prototype.onDataReceived=function(t){var e=this;if(this.dataList=t,this.seriesList=this.processor.getSeriesList({dataList:t,range:this.range}),this.dataWarning=null,0===this.seriesList.reduce(function(t,e){return t+e.datapoints.length},0))this.dataWarning={title:"无数据点",tip:"数据查询没有返回的数据点"};else for(var r=0,n=this.seriesList;r<n.length;r++){if(n[r].isOutsideRange){this.dataWarning={title:"数据点在时间范围以外",tip:"可能是由于查询中的时区不匹配或时间过滤器缺失造成的"};break}}this.annotationsPromise.then(function(t){e.loading=!1,e.alertState=t.alertState,e.annotations=t.annotations,e.render(e.seriesList)},function(){e.loading=!1,e.render(e.seriesList)})},e.prototype.onRender=function(){if(this.seriesList)for(var t=0,e=this.seriesList;t<e.length;t++){var r=e[t];r.applySeriesOverrides(this.panel.seriesOverrides),r.unit&&(this.panel.yaxes[r.yaxis-1].format=r.unit)}},e.prototype.addSeriesOverride=function(t){this.panel.seriesOverrides.push(t||{})},e.prototype.removeSeriesOverride=function(t){this.panel.seriesOverrides=I.a.without(this.panel.seriesOverrides,t),this.render()},e.prototype.toggleLegend=function(){this.panel.legend.show=!this.panel.legend.show,this.refresh()},e.prototype.legendValuesOptionChanged=function(){var t=this.panel.legend;t.values=t.min||t.max||t.avg||t.current||t.total,this.render()},e.prototype.exportCsv=function(){var t=this.$scope.$new(!0);t.seriesList=this.seriesList,this.publishAppEvent("show-modal",{templateHtml:'<export-data-modal data="seriesList"></export-data-modal>',scope:t,modalClass:"modal--narrow"})},e.template='\n<div class="graph-panel" ng-class="{\'graph-panel--legend-right\': ctrl.panel.legend.rightSide}">\n  <div class="graph-panel__chart" grafana-graph ng-dblclick="ctrl.zoomOut()">\n  </div>\n\n  <div class="graph-legend">\n    <div class="graph-legend-content" graph-legend></div>\n  </div>\n</div>\n',e}(Bt),eo=function(t){function e(e,r,n,a){var i=t.call(this,e,r)||this;return i.backendSrv=n,i.dashboardSrv=a,i.panelDefaults={query:"",limit:10,tags:[],recent:!1,search:!1,starred:!0,headings:!0,folderId:null},I.a.defaults(i.panel,i.panelDefaults),i.panel.tag&&(i.panel.tags=[i.panel.tag],delete i.panel.tag),i.events.on("refresh",i.onRefresh.bind(i)),i.events.on("init-edit-mode",i.onInitEditMode.bind(i)),i.groups=[{list:[],show:!1,header:"星标仪表盘"},{list:[],show:!1,header:"最近查看的仪表盘"},{list:[],show:!1,header:"查询"}],i.panel.mode&&("starred"===i.panel.mode&&(i.panel.starred=!0,i.panel.headings=!1),"recently viewed"===i.panel.mode&&(i.panel.recent=!0,i.panel.starred=!1,i.panel.headings=!1),"search"===i.panel.mode&&(i.panel.search=!0,i.panel.starred=!1,i.panel.headings=!1),delete i.panel.mode),i}return e.$inject=["$scope","$injector","backendSrv","dashboardSrv"],J.c(e,t),e.prototype.onInitEditMode=function(){this.editorTabIndex=1,this.modes=["starred","search","recently viewed"],this.addEditorTab("Options","public/app/plugins/panel/dashlist/editor.html")},e.prototype.onRefresh=function(){var t=[];return t.push(this.getRecentDashboards()),t.push(this.getStarred()),t.push(this.getSearch()),Promise.all(t).then(this.renderingCompleted.bind(this))},e.prototype.getSearch=function(){var t=this;if(this.groups[2].show=this.panel.search,!this.panel.search)return Promise.resolve();var e={limit:this.panel.limit,query:this.panel.query,tag:this.panel.tags,folderIds:this.panel.folderId,type:"dash-db"};return this.backendSrv.search(e).then(function(e){t.groups[2].list=e})},e.prototype.getStarred=function(){var t=this;if(this.groups[0].show=this.panel.starred,!this.panel.starred)return Promise.resolve();var e={limit:this.panel.limit,starred:"true"};return this.backendSrv.search(e).then(function(e){t.groups[0].list=e})},e.prototype.starDashboard=function(t,e){this.dashboardSrv.starDashboard(t.id,t.isStarred).then(function(e){t.isStarred=e}),e&&(e.stopPropagation(),e.preventDefault())},e.prototype.getRecentDashboards=function(){var t=this;if(this.groups[1].show=this.panel.recent,!this.panel.recent)return Promise.resolve();var e=I.a.take(_e.a.getDashboardOpened(),this.panel.limit);return this.backendSrv.search({dashboardIds:e,limit:this.panel.limit}).then(function(r){t.groups[1].list=e.map(function(t){return I.a.find(r,function(e){return e.id===t})}).filter(function(t){return void 0!==t})})},e.prototype.onFolderChange=function(t){this.panel.folderId=t.id,this.refresh()},e.templateUrl="module.html",e.scrollable=!0,e}(Lt),ro=function(t){function e(e,r,n){var a=t.call(this,e,r)||this;return a.backendSrv=n,a.panelDefaults={},I.a.defaults(a.panel,a.panelDefaults),a.events.on("init-edit-mode",a.onInitEditMode.bind(a)),a.pluginList=[],a.viewModel=[{header:"已安装的应用",list:[],type:"app"},{header:"已安装的面板",list:[],type:"panel"},{header:"已安装的数据源",list:[],type:"datasource"}],a.update(),a}return e.$inject=["$scope","$injector","backendSrv"],J.c(e,t),e.prototype.onInitEditMode=function(){this.editorTabIndex=1,this.addEditorTab("Options","public/app/plugins/panel/pluginlist/editor.html")},e.prototype.gotoPlugin=function(t,e){e&&e.stopPropagation(),this.$location.url("plugins/"+t.id+"/edit")},e.prototype.updateAvailable=function(t,e){e.stopPropagation(),e.preventDefault();var r=this.$scope.$new(!0);r.plugin=t,this.publishAppEvent("show-modal",{src:"public/app/features/plugins/partials/update_instructions.html",scope:r})},e.prototype.update=function(){var t=this;this.backendSrv.get("api/plugins",{embedded:0,core:0}).then(function(e){t.pluginList=e,t.viewModel[0].list=I.a.filter(e,{type:"app"}),t.viewModel[1].list=I.a.filter(e,{type:"panel"}),t.viewModel[2].list=I.a.filter(e,{type:"datasource"});for(var r=0,n=t.pluginList;r<n.length;r++){var a=n[r];a.hasUpdate?a.state="has-update":a.enabled||(a.state="not-enabled")}})},e.templateUrl="module.html",e.scrollable=!0,e}(Lt),no=function(t){function e(e,r,n){var a=t.call(this,e,r)||this;for(var i in a.backendSrv=n,a.showOptions=[{text:"Current state",value:"current"},{text:"Recent state changes",value:"changes"}],a.sortOrderOptions=[{text:"Alphabetical (asc)",value:1},{text:"Alphabetical (desc)",value:2},{text:"Importance",value:3}],a.stateFilter={},a.currentAlerts=[],a.alertHistory=[],a.panelDefaults={show:"current",limit:10,stateFilter:[],onlyAlertsOnDashboard:!1,sortOrder:1,dashboardFilter:"",nameFilter:"",folderId:null},I.a.defaults(a.panel,a.panelDefaults),a.events.on("init-edit-mode",a.onInitEditMode.bind(a)),a.events.on("refresh",a.onRefresh.bind(a)),a.panel.stateFilter)a.stateFilter[a.panel.stateFilter[i]]=!0;return a}return e.$inject=["$scope","$injector","backendSrv"],J.c(e,t),e.prototype.sortResult=function(t){if(3===this.panel.sortOrder)return I.a.sortBy(t,function(t){return Wt.a.alertStateSortScore[t.state]});var e=I.a.sortBy(t,function(t){return t.name.toLowerCase()});return 2===this.panel.sortOrder&&e.reverse(),e},e.prototype.updateStateFilter=function(){var t=[];for(var e in this.stateFilter)this.stateFilter[e]&&t.push(e);this.panel.stateFilter=t,this.onRefresh()},e.prototype.onRefresh=function(){var t,e=this;"current"===this.panel.show&&(t=this.getCurrentAlertState()),"changes"===this.panel.show&&(t=this.getStateChanges()),t.then(function(){e.renderingCompleted()})},e.prototype.onFolderChange=function(t){this.panel.folderId=t.id,this.refresh()},e.prototype.getStateChanges=function(){var t=this,e={limit:this.panel.limit,type:"alert",newState:this.panel.stateFilter};return this.panel.onlyAlertsOnDashboard&&(e.dashboardId=this.dashboard.id),e.from=1e3*Ct.parse(this.dashboard.time.from).unix(),e.to=1e3*Ct.parse(this.dashboard.time.to).unix(),this.backendSrv.get("/api/annotations",e).then(function(e){return t.alertHistory=I.a.map(e,function(e){return e.time=t.dashboard.formatDate(e.time,"MMM D, YYYY HH:mm:ss"),e.stateModel=Wt.a.getStateDisplayModel(e.newState),e.info=Wt.a.getAlertAnnotationInfo(e),e}),t.noAlertsMessage=0===t.alertHistory.length?"No alerts in current time range":"",t.alertHistory})},e.prototype.getCurrentAlertState=function(){var t=this,e={state:this.panel.stateFilter};return this.panel.nameFilter&&(e.query=this.panel.nameFilter),this.panel.folderId>=0&&(e.folderId=this.panel.folderId),this.panel.dashboardFilter&&(e.dashboardQuery=this.panel.dashboardFilter),this.panel.onlyAlertsOnDashboard&&(e.dashboardId=this.dashboard.id),this.panel.dashboardTags&&(e.dashboardTag=this.panel.dashboardTags),this.backendSrv.get("/api/alerts",e).then(function(e){return t.currentAlerts=t.sortResult(I.a.map(e,function(t){return t.stateModel=Wt.a.getStateDisplayModel(t.state),t.newStateDateAgo=H()(t.newStateDate).locale("en").fromNow(!0),t})),t.currentAlerts.length>t.panel.limit&&(t.currentAlerts=t.currentAlerts.slice(0,t.panel.limit)),t.noAlertsMessage=0===t.currentAlerts.length?"No alerts":"",t.currentAlerts})},e.prototype.onInitEditMode=function(){this.addEditorTab("Options","public/app/plugins/panel/alertlist/editor.html")},e.templateUrl="module.html",e.scrollable=!0,e}(Lt),ao=r(20),io=r(639);function so(t,e,r,n){void 0===n&&(n=0);var a=io[t.value],i="always"===t.invert||t.invert===(e?"light":"dark"),s=i?r:n,o=i?n:r;return ao.scaleSequential(a).domain([s,o])}function oo(t,e,r){var n;return void 0===r&&(r=0),"linear"===t.colorScale?n=ao.scaleLinear().domain([r,e]).range([0,1]):"sqrt"===t.colorScale&&(n=ao.scalePow().exponent(t.exponent).domain([r,e]).range([0,1])),n}var lo=0,co=0;function uo(t,e,r,n,a,i,s){var o=F()(t).find("svg"),l=ao.select(o.get(0));if(!(s<=0||0===o.get(0).childNodes.length)){var c=ao.scaleLinear().domain([0,n]).range([0,s]),u=function(t,e,r,n){for(var a=e-t,i=Object(Ee.tickStep)(t,e,3),s=Math.round(a/i),o=[],l=0;l<s;l++){var c=i*l;ho(n,c,i)?o.push(n):(n<c&&o.push(n),ho(r,c,i)?o.push(r):(r<c&&o.push(r),o.push(i*l)))}ho(r,e,i)||o.push(r);return o.push(e),o=I.a.sortBy(I.a.uniq(o))}(0,n,a,i),d=ao.axisBottom(c).tickValues(u).tickSize(lo),p=o.find(":first-child"),h=function(t){var e=t.get(0);return e&&e.height&&e.height.baseVal?e.height.baseVal.value:0}(o)+co,f=function(t){var e=t.get(0);return e&&e.x&&e.x.baseVal?e.x.baseVal.value:0}(p);ao.select(o.get(0)).append("g").attr("class","axis").attr("transform","translate("+f+","+h+")").call(d),l.select(".axis").select(".domain").remove()}}function po(t){F()(t).find("svg").empty()}function ho(t,e,r){return Math.abs(t-e)<.3*r}z.c.directive("colorLegend",function(){return{restrict:"E",template:'<div class="heatmap-color-legend"><svg width="16.5rem" height="24px"></svg></div>',link:function(t,e,r){var n=t.ctrl,a=t.ctrl.panel;function i(){var t=F()(e).find("svg"),r=Math.floor(t.outerWidth());if("spectrum"===a.color.mode){var i=so(I.a.find(n.colorSchemes,{value:a.color.colorScheme}),G.d.user.lightTheme,r);!function(t,e){var r=F()(t).find("svg");po(t);var n=Math.floor(r.outerWidth()),a=r.attr("height");if(n){var i=Math.floor(n/2),s=Math.floor(n/i),o=ao.range(0,n,s),l=ao.select(r.get(0)),c=l.selectAll(".heatmap-color-legend-rect").data(o);c.enter().append("rect").attr("x",function(t){return t}).attr("y",0).attr("width",s+1).attr("height",a).attr("stroke-width",0).attr("fill",function(t){return e(t)})}}(e,i)}else if("opacity"===a.color.mode){var s=a.color;!function(t,e){var r=F()(t).find("svg");po(t);var n=ao.select(r.get(0)),a=Math.floor(r.outerWidth()),i=r.attr("height");if(a){var s;"linear"===e.colorScale?s=ao.scaleLinear().domain([0,a]).range([0,1]):"sqrt"===e.colorScale&&(s=ao.scalePow().exponent(e.exponent).domain([0,a]).range([0,1]));var o=ao.range(0,a,10),l=n.selectAll(".heatmap-opacity-legend-rect").data(o);l.enter().append("rect").attr("x",function(t){return t}).attr("y",0).attr("width",10).attr("height",i).attr("stroke-width",0).attr("fill",e.cardColor).style("opacity",function(t){return s(t)})}}(e,s)}}i(),n.events.on("render",function(){i()})}}}),z.c.directive("heatmapLegend",function(){return{restrict:"E",template:'<div class="heatmap-color-legend"><svg width="100px" height="6px"></svg></div>',link:function(t,e,r){var n=t.ctrl,a=t.ctrl.panel;function i(){if(po(e),!I.a.isEmpty(n.data)&&!I.a.isEmpty(n.data.cards)){var t=n.data.cardStats.max,r=a.color.max||t,i=a.color.min||0;if("spectrum"===a.color.mode){var s=I.a.find(n.colorSchemes,{value:a.color.colorScheme});!function(t,e,r,n,a,i){var s=F()(t).find("svg"),o=ao.select(s.get(0));po(t);var l=Math.floor(s.outerWidth())-30,c=s.attr("height"),u=1;n-r>l&&(u=Math.floor((n-r)/l));var d=l/(n-r),p=ao.range(r,n,u),h=so(e,G.d.user.lightTheme,a,i);o.selectAll(".heatmap-color-legend-rect").data(p).enter().append("rect").attr("x",function(t){return t*d}).attr("y",0).attr("width",u*d+1).attr("height",c).attr("stroke-width",0).attr("fill",function(t){return h(t)}),uo(t,h,r,n,a,i,l)}(e,s,0,t,r,i)}else if("opacity"===a.color.mode){var o=a.color;!function(t,e,r,n,a,i){var s=F()(t).find("svg"),o=ao.select(s.get(0));po(t);var l=Math.floor(s.outerWidth())-30,c=s.attr("height"),u=1;n-r>l&&(u=Math.floor((n-r)/l));var d=l/(n-r),p=ao.range(r,n,u),h=oo(e,a,i);o.selectAll(".heatmap-opacity-legend-rect").data(p).enter().append("rect").attr("x",function(t){return t*d}).attr("y",0).attr("width",u*d).attr("height",c).attr("stroke-width",0).attr("fill",e.cardColor).style("opacity",function(t){return h(t)}),uo(t,h,r,n,a,i,l)}(e,o,0,t,r,i)}}}i(),n.events.on("render",function(){i()})}}});var fo=function(){function t(t,e){t.editor=this,this.panelCtrl=t.ctrl,this.panel=this.panelCtrl.panel,this.unitFormats=kt.a.getUnitFormats(),this.logScales={linear:1,"log (base 2)":2,"log (base 10)":10,"log (base 32)":32,"log (base 1024)":1024},this.dataFormats={"Time series":"timeseries","Time series buckets":"tsbuckets"},this.yBucketBoundModes={Auto:"auto",Upper:"upper",Lower:"lower"}}return t.$inject=["$scope","uiSegmentSrv"],t.prototype.setUnitFormat=function(t){this.panel.yAxis.format=t.value,this.panelCtrl.render()},t}();function mo(){return{restrict:"E",scope:!0,templateUrl:"public/app/plugins/panel/heatmap/partials/axes_editor.html",controller:fo}}var go=function(){function t(t){t.editor=this,this.panelCtrl=t.ctrl,this.panel=this.panelCtrl.panel,this.panelCtrl.render()}return t.$inject=["$scope"],t}();function vo(){return{restrict:"E",scope:!0,templateUrl:"public/app/plugins/panel/heatmap/partials/display_editor.html",controller:go}}var bo=0,yo=1;function wo(t,e){var r,n;try{r=xo(t.label),n=xo(e.label)}catch(t){return console.log(t.message||t),0}return r>n?1:r<n?-1:0}function xo(t){if("+Inf"===t||"inf"===t)return 1/0;var e=Number(t);if(isNaN(e))throw new Error("Error parsing histogram label: "+t+" is not a number");return e}function So(t){var e=0,r=0,n=[];return I.a.forEach(t,function(t){I.a.forEach(t.buckets,function(a){var i={x:t.x,y:a.y,yBounds:a.bounds,values:a.values,count:a.count};n.push(i),1===n.length&&(e=a.count,r=a.count),e=a.count<e?a.count:e,r=a.count>r?a.count:r})}),{cards:n,cardStats:{min:e,max:r}}}function ko(t,e,r,n){void 0===n&&(n=1);for(var a={},i=function(t){var e=t.datapoints,n=t.label;I.a.forEach(e,function(t){var e=_o(t[yo],r);!function(t,e,r,n){var a=e[bo];if(null===a||void 0===a||isNaN(a))return;var i=I.a.concat(e,n);t[r]&&t[r].values?(t[r].values.push(a),t[r].points.push(i)):t[r]={x:r,values:[a],points:[i]}}(a,t,e,n)})},s=0,o=t;s<o.length;s++){i(o[s])}return I.a.forEach(a,function(t){t.buckets=1!==n?function(t,e,r){var n=t.values,a=t.points,i={};return I.a.forEach(n,function(t,n){var s=Mo(t,e,r),o=s.bottom;Co(i,o,t,a[n],s)}),i}(t,e,n):function(t,e){var r=t.values,n=t.points,a={};return I.a.forEach(r,function(t,r){var i=Eo(t,e),s=i.bottom;Co(a,s,t,n[r],i)}),a}(t,e)}),a}function Co(t,e,r,n,a){var i=1;n.length>3&&(i=parseInt(n[2],10)),t[e]?(t[e].values.push(r),t[e].points.push(n),t[e].count+=i):t[e]={y:e,bounds:a,values:[r],points:[n],count:i}}function To(t,e,r){return 1===r?_o(t,e):function(t,e,r){return Mo(t,e,r).bottom}(t,e,r)}function Eo(t,e){return{bottom:Math.floor(t/e)*e,top:(Math.floor(t/e)+1)*e}}function _o(t,e){return Eo(t,e).bottom}function Mo(t,e,r){if(0===t)return{bottom:0,top:0};var n,a,i=Ao(t,r);if(1!==e&&e){var s=1/e,o=i-Math.floor(i);o=Math.floor(o/s)*s,a=(n=Math.floor(i)+o)+s}else a=(n=Math.floor(i))+1;return{bottom:Math.pow(r,n),top:Math.pow(r,a)}}function Ao(t,e){return Math.log(t)/Math.log(e)}function Po(t,e,r){return void 0===r&&(r=1),1===r?Math.abs(e-t):Ao(Math.max(t,e)/Math.min(t,e),r)}var $o=function(){function t(t,e){this.scope=e,this.dashboard=e.ctrl.dashboard,this.panelCtrl=e.ctrl,this.panel=e.ctrl.panel,this.heatmapPanel=t,this.mouseOverBucket=!1,this.originalFillColor=null,t.on("mouseleave",this.onMouseLeave.bind(this))}return t.prototype.onMouseLeave=function(){this.destroy()},t.prototype.onMouseMove=function(t){this.panel.tooltip.show&&this.move(t)},t.prototype.add=function(){this.tooltip=ao.select("body").append("div").attr("class","heatmap-tooltip graph-tooltip grafana-tooltip")},t.prototype.destroy=function(){this.tooltip&&this.tooltip.remove(),this.tooltip=null},t.prototype.show=function(t,e){if(this.panel.tooltip.show&&e&&!t.panelRelY){var r=this.getBucketIndexes(t,e),n=r.xBucketIndex,a=r.yBucketIndex;if(e.buckets[n]){var i,s;this.tooltip||this.add();var o,l,c=e.buckets[n],u=I.a.find(c.buckets,function(t,e){return t.bounds.bottom===a||e===a.toString()}),d=this.dashboard.formatDate(c.x,"YYYY-MM-DD HH:mm:ss");if(I.a.isNumber(this.panel.tooltipDecimals))o=this.countValueFormatter(this.panel.tooltipDecimals,null),l=this.panelCtrl.tickValueFormatter(this.panelCtrl.decimals,null);else{var p=(this.panelCtrl.decimals||-1)+1;o=this.countValueFormatter(p,this.panelCtrl.scaledDecimals+2),l=this.panelCtrl.tickValueFormatter(p,this.panelCtrl.scaledDecimals+2)}var h='<div class="graph-tooltip-time">'+d+'</div>\n      <div class="heatmap-histogram"></div>';if(u)if(u.bounds){if(e.tsBuckets){var f=function(t){return e.tsBucketsFormatted?e.tsBucketsFormatted[t]:e.tsBuckets[t]};i=f(a),s=a<e.tsBuckets.length-1?f(a+1):""}else{i=l(u.y?u.bounds.bottom:0),s=l(u.bounds.top)}h+="<div>\n          bucket: <b>"+i+" - "+s+"</b> <br>\n          count: <b>"+o(u.count)+"</b> <br>\n        </div>"}else h+="<div>count: <b>"+u.count+"</b><br></div>";else{if(!this.panel.tooltip.showHistogram)return void this.destroy();i=a,s="",0}this.tooltip.html(h),this.panel.tooltip.showHistogram&&this.addHistogram(c),this.move(t)}else this.destroy()}},t.prototype.getBucketIndexes=function(t,e){return{xBucketIndex:this.getXBucketIndex(t.x,e),yBucketIndex:this.getYBucketIndex(t.y,e)}},t.prototype.getXBucketIndex=function(t,e){var r=I.a.find(e.buckets,function(r){return t>r.x&&t-r.x<=e.xBucketSize});return r?r.x:To(t,e.xBucketSize,1)},t.prototype.getYBucketIndex=function(t,e){return e.tsBuckets?Math.floor(t):To(t,e.yBucketSize,this.panel.yAxis.logBase)},t.prototype.getSharedTooltipPos=function(t){return t.pageX=this.heatmapPanel.offset().left+this.scope.xScale(t.x),t.pageY=this.heatmapPanel.offset().top+this.scope.chartHeight*t.panelRelY,t},t.prototype.addHistogram=function(t){var e,r,n,a=this.scope.ctrl.data.buckets[t.x],i=this.scope.ctrl.data.yBucketSize;this.scope.ctrl.data.tsBuckets?(e=0,r=this.scope.ctrl.data.tsBuckets.length-1,n=this.scope.ctrl.data.tsBuckets.length):(e=this.scope.ctrl.data.yAxis.min,r=this.scope.ctrl.data.yAxis.max,n=this.scope.ctrl.data.yAxis.ticks);var s=I.a.map(a.buckets,function(t){var e=void 0!==t.count?t.count:t.values.length;return[t.bounds.bottom,e]});s=I.a.filter(s,function(t){return t[0]>=e&&t[0]<=r});var o,l=this.scope.yScale.copy().domain([e,r]).range([0,160]);if(1===this.panel.yAxis.logBase)o=Math.floor(160/(r-e)*i*.9);else{var c=i||1;o=Math.floor(160/n/c*.9)}o=Math.max(o,1);var u=I.a.reduce(I.a.map(s,function(t){return t[1]}),function(t,e){return t+e},0),d=ao.scaleLinear().domain([0,u]).range([0,40]);this.tooltip.select(".heatmap-histogram").append("svg").attr("width",160).attr("height",40).selectAll(".bar").data(s).enter().append("rect").attr("x",function(t){return l(t[0])}).attr("width",o).attr("y",function(t){return 40-d(t[1])}).attr("height",function(t){return d(t[1])})},t.prototype.move=function(t){if(this.tooltip){var e=F()(this.tooltip.node())[0],r=e.clientWidth,n=e.clientHeight,a=t.pageX+30,i=t.pageY+5;return t.pageX+r+40>window.innerWidth&&(a=t.pageX-r-30),t.pageY-window.pageYOffset+n+20>window.innerHeight&&(i=t.pageY-n-5),this.tooltip.style("left",a+"px").style("top",i+"px")}},t.prototype.countValueFormatter=function(t,e){void 0===e&&(e=null);return function(r){return kt.a.valueFormats.short(r,t,e)}},t}(),Do=1.2;var Oo=function(){function t(t,e,r,n){this.scope=t,this.elem=e,this.ctrl=n,this.$heatmap=this.elem.find(".heatmap-panel"),this.tooltip=new $o(this.$heatmap,this.scope),this.selection={active:!1,x1:-1,x2:-1},this.padding={left:0,right:0,top:0,bottom:0},this.margin={left:25,right:15,top:10,bottom:20},this.dataRangeWidingFactor=Do,this.ctrl.events.on("render",this.onRender.bind(this)),this.ctrl.tickValueFormatter=this.tickValueFormatter.bind(this),G.c.on("graph-hover",this.onGraphHover.bind(this),this.scope),G.c.on("graph-hover-clear",this.onGraphHoverClear.bind(this),this.scope),this.$heatmap.on("mousedown",this.onMouseDown.bind(this)),this.$heatmap.on("mousemove",this.onMouseMove.bind(this)),this.$heatmap.on("mouseleave",this.onMouseLeave.bind(this))}return t.prototype.onGraphHoverClear=function(){this.clearCrosshair()},t.prototype.onGraphHover=function(t){this.drawSharedCrosshair(t.pos)},t.prototype.onRender=function(){this.render(),this.ctrl.renderingCompleted()},t.prototype.setElementHeight=function(){try{var t=this.ctrl.height||this.panel.height||this.ctrl.row.height;return I.a.isString(t)&&(t=parseInt(t.replace("px",""),10)),t-=this.panel.legend.show?28:11,this.$heatmap.css("height",t+"px"),!0}catch(t){return!1}},t.prototype.getYAxisWidth=function(t){var e=t.selectAll(".axis-y text").nodes();return I.a.max(I.a.map(e,function(t){return t.getBBox().width}))},t.prototype.getXAxisHeight=function(t){if(t.select(".axis-x line").empty())return 30;var e=parseFloat(t.select(".axis-x line").attr("y2"));return parseFloat(t.attr("height"))-e},t.prototype.addXAxis=function(){this.scope.xScale=this.xScale=ao.scaleTime().domain([this.timeRange.from,this.timeRange.to]).range([0,this.chartWidth]);var t,e=this.chartWidth/100,r=Ee.grafanaTimeFormat(e,this.timeRange.from,this.timeRange.to);t="utc"===this.ctrl.dashboard.getTimezone()?ao.utcFormat(r):ao.timeFormat(r);var n=ao.axisBottom(this.xScale).ticks(e).tickFormat(t).tickPadding(10).tickSize(this.chartHeight),a=this.margin.top,i=this.yAxisWidth;this.heatmap.append("g").attr("class","axis axis-x").attr("transform","translate("+i+","+a+")").call(n),this.heatmap.select(".axis-x").select(".domain").remove()},t.prototype.addYAxis=function(){var t=Math.ceil(this.chartHeight/50),e=Ee.tickStep(this.data.heatmapStats.min,this.data.heatmapStats.max,t),r=this.wideYAxisRange(this.data.heatmapStats.min,this.data.heatmapStats.max,e),n=r.yMin,a=r.yMax;n=null!==this.panel.yAxis.min?this.panel.yAxis.min:n,a=null!==this.panel.yAxis.max?this.panel.yAxis.max:a,e=Ee.tickStep(n,a,t),t=Math.ceil((a-n)/e);var i=Ee.getPrecision(e),s=null===this.panel.yAxis.decimals?i:this.panel.yAxis.decimals,o=Ee.getFlotTickSize(n,a,t,i),l=Ee.getScaledDecimals(s,o);this.ctrl.decimals=s,this.ctrl.scaledDecimals=l,I.a.isEmpty(this.data.buckets)&&(a=1,n=-1,t=3,s=1),this.data.yAxis={min:n,max:a,ticks:t},this.scope.yScale=this.yScale=ao.scaleLinear().domain([n,a]).range([this.chartHeight,0]);var c=ao.axisLeft(this.yScale).ticks(t).tickFormat(this.tickValueFormatter(s,l)).tickSizeInner(0-this.width).tickSizeOuter(0).tickPadding(5);this.heatmap.append("g").attr("class","axis axis-y").call(c);var u=this.margin.top,d=this.getYAxisWidth(this.heatmap)+5;this.heatmap.select(".axis-y").attr("transform","translate("+d+","+u+")"),this.heatmap.select(".axis-y").select(".domain").remove()},t.prototype.wideYAxisRange=function(t,e,r){var n,a,i=(e*(this.dataRangeWidingFactor-1)-t*(this.dataRangeWidingFactor-1))/2;return 0===r?r=((a=e*this.dataRangeWidingFactor)-(n=t-t*(this.dataRangeWidingFactor-1)))/2:(a=Math.ceil((e+i)/r)*r,n=Math.floor((t-i)/r)*r),t>=0&&n<0&&(n=0),{yMin:n,yMax:a}},t.prototype.addLogYAxis=function(){var t=this.panel.yAxis.logBase,e=this.adjustLogRange(this.data.heatmapStats.minLog,this.data.heatmapStats.max,t),r=e.yMin,n=e.yMax;r=this.panel.yAxis.min&&"0"!==this.panel.yAxis.min?this.adjustLogMin(this.panel.yAxis.min,t):r,n=null!==this.panel.yAxis.max?this.adjustLogMax(this.panel.yAxis.max,t):n,I.a.isEmpty(this.data.buckets)&&(n=Math.pow(t,2),r=1),this.scope.yScale=this.yScale=ao.scaleLog().base(this.panel.yAxis.logBase).domain([r,n]).range([this.chartHeight,0]);var a=this.yScale.domain(),i=this.logScaleTickValues(a,t),s=Ee.getPrecision(r),o=this.panel.yAxis.decimals||s,l=Ee.getFlotTickSize(r,n,i.length,s),c=Ee.getScaledDecimals(o,l);this.ctrl.decimals=o,this.ctrl.scaledDecimals=c,this.data.yAxis={min:r,max:n,ticks:i.length};var u=ao.axisLeft(this.yScale).tickValues(i).tickFormat(this.tickValueFormatter(o,c)).tickSizeInner(0-this.width).tickSizeOuter(0).tickPadding(5);this.heatmap.append("g").attr("class","axis axis-y").call(u);var d=this.margin.top,p=this.getYAxisWidth(this.heatmap)+5;this.heatmap.select(".axis-y").attr("transform","translate("+p+","+d+")"),r<1&&this.heatmap.select(".axis-y").select(".tick text").text("0"),this.heatmap.select(".axis-y").select(".domain").remove()},t.prototype.addYAxisFromBuckets=function(){var t=this.data.tsBuckets;this.scope.yScale=this.yScale=ao.scaleLinear().domain([0,t.length-1]).range([this.chartHeight,0]);var e=I.a.map(t,function(t,e){return e}),r=I.a.max(I.a.map(t,Ee.getStringPrecision)),n=null===this.panel.yAxis.decimals?r:this.panel.yAxis.decimals;this.ctrl.decimals=n;var a=this.tickValueFormatter.bind(this);function i(e){var r=t[e];return I.a.isNaN(I.a.toNumber(r))||""===r||(r=a(n)(I.a.toNumber(r))),r}var s=I.a.map(t,function(t,e){return i(e)});this.data.tsBucketsFormatted=s;var o=ao.axisLeft(this.yScale).tickValues(e).tickFormat(i).tickSizeInner(0-this.width).tickSizeOuter(0).tickPadding(5);this.heatmap.append("g").attr("class","axis axis-y").call(o);var l=this.margin.top,c=this.getYAxisWidth(this.heatmap)+5;this.heatmap.select(".axis-y").attr("transform","translate("+c+","+l+")"),this.heatmap.select(".axis-y").select(".domain").remove()},t.prototype.adjustLogRange=function(t,e,r){return this.data.heatmapStats.minLog,{yMin:this.data.heatmapStats.minLog>1||!this.data.heatmapStats.minLog?1:this.adjustLogMin(this.data.heatmapStats.minLog,r),yMax:this.adjustLogMax(this.data.heatmapStats.max,r)}},t.prototype.adjustLogMax=function(t,e){return Math.pow(e,Math.ceil(Ee.logp(t,e)))},t.prototype.adjustLogMin=function(t,e){return Math.pow(e,Math.floor(Ee.logp(t,e)))},t.prototype.logScaleTickValues=function(t,e){var r=t[0],n=t[1],a=[];if(r<1)for(var i=Math.floor(Ee.logp(r,e));i<0;i++){var s=Math.pow(e,i);a.push(s)}var o=Math.ceil(Ee.logp(n,e));for(i=0;i<=o;i++){s=Math.pow(e,i);a.push(s)}return a},t.prototype.tickValueFormatter=function(t,e){void 0===e&&(e=null);var r=this.panel.yAxis.format;return function(n){try{return"none"!==r?kt.a.valueFormats[r](n,t,e):n}catch(t){return console.error(t.message||t),n}}},t.prototype.fixYAxisTickSize=function(){this.heatmap.select(".axis-y").selectAll(".tick line").attr("x2",this.chartWidth)},t.prototype.addAxes=function(){this.chartHeight=this.height-this.margin.top-this.margin.bottom,this.chartTop=this.margin.top,this.chartBottom=this.chartTop+this.chartHeight,"tsbuckets"===this.panel.dataFormat?this.addYAxisFromBuckets():1===this.panel.yAxis.logBase?this.addYAxis():this.addLogYAxis(),this.yAxisWidth=this.getYAxisWidth(this.heatmap)+5,this.chartWidth=this.width-this.yAxisWidth-this.margin.right,this.fixYAxisTickSize(),this.addXAxis(),this.xAxisHeight=this.getXAxisHeight(this.heatmap),this.panel.yAxis.show||this.heatmap.select(".axis-y").selectAll("line").style("opacity",0),this.panel.xAxis.show||this.heatmap.select(".axis-x").selectAll("line").style("opacity",0)},t.prototype.addHeatmapCanvas=function(){var t=this.$heatmap[0];this.width=Math.floor(this.$heatmap.width())-this.padding.right,this.height=Math.floor(this.$heatmap.height())-this.padding.bottom,this.cardPadding=null!==this.panel.cards.cardPadding?this.panel.cards.cardPadding:1,this.cardRound=null!==this.panel.cards.cardRound?this.panel.cards.cardRound:0,this.heatmap&&this.heatmap.remove(),this.heatmap=ao.select(t).append("svg").attr("width",this.width).attr("height",this.height)},t.prototype.addHeatmap=function(){var t=this;if(this.addHeatmapCanvas(),this.addAxes(),1!==this.panel.yAxis.logBase&&"tsbuckets"!==this.panel.dataFormat){var e=this.panel.yAxis.logBase,r=this.yScale.domain(),n=this.logScaleTickValues(r,e);this.data.buckets=function(t,e){return I.a.forEach(t,function(t){var r=t.buckets,n={bounds:{bottom:0,top:0},values:[],points:[],count:0},a=r[0]||n,i=r[e]||n,s={y:0,bounds:{bottom:e,top:i.bounds.top||e},values:[],points:[],count:0};s.points=a.points.concat(i.points),s.values=a.values.concat(i.values),s.count=s.values.length,0!==s.count&&(delete r[e],r[0]=s)}),t}(this.data.buckets,I.a.min(n))}var a=this.data.cards,i=this.data.cardStats.max,s=this.panel.color.max||i,o=this.panel.color.min||0,l=I.a.find(this.ctrl.colorSchemes,{value:this.panel.color.colorScheme});this.colorScale=so(l,G.d.user.lightTheme,s,o),this.opacityScale=oo(this.panel.color,s),this.setCardSize();var c=this.heatmap.selectAll(".heatmap-card").data(a);c.append("title"),c=c.enter().append("rect").attr("x",this.getCardX.bind(this)).attr("width",this.getCardWidth.bind(this)).attr("y",this.getCardY.bind(this)).attr("height",this.getCardHeight.bind(this)).attr("rx",this.cardRound).attr("ry",this.cardRound).attr("class","bordered heatmap-card").style("fill",this.getCardColor.bind(this)).style("stroke",this.getCardColor.bind(this)).style("stroke-width",0).style("opacity",this.getCardOpacity.bind(this)),this.$heatmap.find(".heatmap-card").on("mouseenter",function(e){t.tooltip.mouseOverBucket=!0,t.highlightCard(e)}).on("mouseleave",function(e){t.tooltip.mouseOverBucket=!1,t.resetCardHighLight(e)})},t.prototype.highlightCard=function(t){var e=ao.select(t.target).style("fill"),r=ao.color(e).darker(2),n=ao.color(e).brighter(4),a=ao.select(t.target);this.tooltip.originalFillColor=e,a.style("fill",r.toString()).style("stroke",n.toString()).style("stroke-width",1)},t.prototype.resetCardHighLight=function(t){ao.select(t.target).style("fill",this.tooltip.originalFillColor).style("stroke",this.tooltip.originalFillColor).style("stroke-width",0)},t.prototype.setCardSize=function(){var t=Math.floor(this.xScale(this.data.xBucketSize)-this.xScale(0)),e=Math.floor(this.yScale(this.yScale.invert(0)-this.data.yBucketSize));if(1!==this.panel.yAxis.logBase){var r=this.panel.yAxis.logBase,n=this.data.yBucketSize||1;e=Math.floor((this.yScale(1)-this.yScale(r))/n)}this.cardWidth=t-2*this.cardPadding,this.cardHeight=e?e-2*this.cardPadding:0},t.prototype.getCardX=function(t){return this.xScale(t.x)<0?this.yAxisWidth+this.cardPadding:this.xScale(t.x)+this.yAxisWidth+this.cardPadding},t.prototype.getCardWidth=function(t){var e;if(this.xScale(t.x)<0){var r=this.xScale(t.x)+this.cardWidth;e=r>0?r:0}else e=this.xScale(t.x)+this.cardWidth>this.chartWidth?this.chartWidth-this.xScale(t.x)-this.cardPadding:this.cardWidth;return e=Math.max(e,1)},t.prototype.getCardY=function(t){var e=this.yScale(t.y)+this.chartTop-this.cardHeight-this.cardPadding;return 1!==this.panel.yAxis.logBase&&0===t.y?e=this.chartBottom-this.cardHeight-this.cardPadding:e<this.chartTop&&(e=this.chartTop),e},t.prototype.getCardHeight=function(t){var e=this.yScale(t.y)+this.chartTop-this.cardHeight-this.cardPadding,r=this.cardHeight;return 1!==this.panel.yAxis.logBase&&0===t.y?this.cardHeight:(e<this.chartTop?r=this.yScale(t.y)-this.cardPadding:this.yScale(t.y)>this.chartBottom?r=this.chartBottom-e:e+this.cardHeight>this.chartBottom&&(r=this.chartBottom-e),r=Math.min(r,this.chartHeight),r=Math.max(r,1))},t.prototype.getCardColor=function(t){return"opacity"===this.panel.color.mode?this.panel.color.cardColor:this.colorScale(t.count)},t.prototype.getCardOpacity=function(t){return"opacity"===this.panel.color.mode?this.opacityScale(t.count):1},t.prototype.getEventOffset=function(t){var e=this.$heatmap.offset();return{x:Math.floor(t.clientX-e.left),y:Math.floor(t.clientY-e.top)}},t.prototype.onMouseDown=function(t){var e=this,r=this.getEventOffset(t);this.selection.active=!0,this.selection.x1=r.x,this.mouseUpHandler=function(){e.onMouseUp()},F()(document).one("mouseup",this.mouseUpHandler.bind(this))},t.prototype.onMouseUp=function(){F()(document).unbind("mouseup",this.mouseUpHandler.bind(this)),this.mouseUpHandler=null,this.selection.active=!1;var t=Math.abs(this.selection.x2-this.selection.x1);if(this.selection.x2>=0&&t>2){var e=this.xScale.invert(Math.min(this.selection.x1,this.selection.x2)-this.yAxisWidth),r=this.xScale.invert(Math.max(this.selection.x1,this.selection.x2)-this.yAxisWidth);this.ctrl.timeSrv.setTime({from:H.a.utc(e),to:H.a.utc(r)})}this.clearSelection()},t.prototype.onMouseLeave=function(){G.c.emit("graph-hover-clear"),this.clearCrosshair()},t.prototype.onMouseMove=function(t){if(this.heatmap){var e=this.getEventOffset(t);if(this.selection.active)this.clearCrosshair(),this.tooltip.destroy(),this.selection.x2=this.limitSelection(e.x),this.drawSelection(this.selection.x1,this.selection.x2);else{var r=this.getEventPos(t,e);this.drawCrosshair(e.x),this.tooltip.show(r,this.data),this.emitGraphHoverEvent(r)}}},t.prototype.getEventPos=function(t,e){var r=this.xScale.invert(e.x-this.yAxisWidth).valueOf(),n=this.yScale.invert(e.y-this.chartTop);return{pageX:t.pageX,pageY:t.pageY,x:r,x1:r,y:n,y1:n,panelRelY:null,offset:e}},t.prototype.emitGraphHoverEvent=function(t){t.panelRelY=Math.max(t.offset.y/this.height,.001),G.c.emit("graph-hover",{pos:t,panel:this.panel})},t.prototype.limitSelection=function(t){return t=Math.max(t,this.yAxisWidth),t=Math.min(t,this.chartWidth+this.yAxisWidth)},t.prototype.drawSelection=function(t,e){if(this.heatmap){this.heatmap.selectAll(".heatmap-selection").remove();var r=Math.min(t,e),n=Math.abs(t-e);n>2&&this.heatmap.append("rect").attr("class","heatmap-selection").attr("x",r).attr("width",n).attr("y",this.chartTop).attr("height",this.chartHeight)}},t.prototype.clearSelection=function(){this.selection.x1=-1,this.selection.x2=-1,this.heatmap&&this.heatmap.selectAll(".heatmap-selection").remove()},t.prototype.drawCrosshair=function(t){if(this.heatmap){this.heatmap.selectAll(".heatmap-crosshair").remove();var e=t;e=Math.max(e,this.yAxisWidth),e=Math.min(e,this.chartWidth+this.yAxisWidth),this.heatmap.append("g").attr("class","heatmap-crosshair").attr("transform","translate("+e+",0)").append("line").attr("x1",1).attr("y1",this.chartTop).attr("x2",1).attr("y2",this.chartBottom).attr("stroke-width",1)}},t.prototype.drawSharedCrosshair=function(t){if(this.heatmap&&0!==this.ctrl.dashboard.graphTooltip){var e=this.xScale(t.x)+this.yAxisWidth;this.drawCrosshair(e)}},t.prototype.clearCrosshair=function(){this.heatmap&&this.heatmap.selectAll(".heatmap-crosshair").remove()},t.prototype.render=function(){if(this.data=this.ctrl.data,this.panel=this.ctrl.panel,this.timeRange=this.ctrl.range,this.setElementHeight()&&this.data){if(I.a.isEmpty(this.data.buckets))return this.addHeatmapCanvas(),void this.addAxes();this.addHeatmap(),this.scope.yAxisWidth=this.yAxisWidth,this.scope.xAxisHeight=this.xAxisHeight,this.scope.chartHeight=this.chartHeight,this.scope.chartWidth=this.chartWidth,this.scope.chartTop=this.chartTop}},t}(),Io={heatmap:{},cards:{cardPadding:null,cardRound:null},color:{mode:"spectrum",cardColor:"#b4ff00",colorScale:"sqrt",exponent:.5,colorScheme:"interpolateOranges"},legend:{show:!1},dataFormat:"timeseries",yBucketBound:"auto",xAxis:{show:!0},yAxis:{show:!0,format:"short",decimals:null,logBase:1,splitFactor:null,min:null,max:null},xBucketSize:null,xBucketNumber:null,yBucketSize:null,yBucketNumber:null,tooltip:{show:!0,showHistogram:!1},highlightCards:!0},No=["opacity","spectrum"],Fo=["linear","sqrt"],qo=[{name:"Spectral",value:"interpolateSpectral",invert:"always"},{name:"RdYlGn",value:"interpolateRdYlGn",invert:"always"},{name:"Blues",value:"interpolateBlues",invert:"dark"},{name:"Greens",value:"interpolateGreens",invert:"dark"},{name:"Greys",value:"interpolateGreys",invert:"dark"},{name:"Oranges",value:"interpolateOranges",invert:"dark"},{name:"Purples",value:"interpolatePurples",invert:"dark"},{name:"Reds",value:"interpolateReds",invert:"dark"},{name:"Viridis",value:"interpolateViridis",invert:"light"},{name:"Magma",value:"interpolateMagma",invert:"light"},{name:"Inferno",value:"interpolateInferno",invert:"light"},{name:"Plasma",value:"interpolatePlasma",invert:"light"},{name:"Warm",value:"interpolateWarm",invert:"light"},{name:"Cool",value:"interpolateCool",invert:"light"},{name:"Cubehelix",value:"interpolateCubehelixDefault",invert:"light"},{name:"BuGn",value:"interpolateBuGn",invert:"dark"},{name:"BuPu",value:"interpolateBuPu",invert:"dark"},{name:"GnBu",value:"interpolateGnBu",invert:"dark"},{name:"OrRd",value:"interpolateOrRd",invert:"dark"},{name:"PuBuGn",value:"interpolatePuBuGn",invert:"dark"},{name:"PuBu",value:"interpolatePuBu",invert:"dark"},{name:"PuRd",value:"interpolatePuRd",invert:"dark"},{name:"RdPu",value:"interpolateRdPu",invert:"dark"},{name:"YlGnBu",value:"interpolateYlGnBu",invert:"dark"},{name:"YlGn",value:"interpolateYlGn",invert:"dark"},{name:"YlOrBr",value:"interpolateYlOrBr",invert:"dark"},{name:"YlOrRd",value:"interpolateYlOrRd",invert:"dark"}],Lo=["prometheus","elasticsearch"],Ro=function(t){function e(e,r,n){var a=t.call(this,e,r)||this;return a.opacityScales=[],a.colorModes=[],a.colorSchemes=[],a.timeSrv=n,a.selectionActivated=!1,I.a.defaultsDeep(a.panel,Io),a.opacityScales=Fo,a.colorModes=No,a.colorSchemes=qo,a.events.on("render",a.onRender.bind(a)),a.events.on("data-received",a.onDataReceived.bind(a)),a.events.on("data-error",a.onDataError.bind(a)),a.events.on("data-snapshot-load",a.onDataReceived.bind(a)),a.events.on("init-edit-mode",a.onInitEditMode.bind(a)),a.onCardColorChange=a.onCardColorChange.bind(a),a}return e.$inject=["$scope","$injector","timeSrv"],J.c(e,t),e.prototype.onInitEditMode=function(){this.addEditorTab("Axes",mo,2),this.addEditorTab("Display",vo,3),this.unitFormats=kt.a.getUnitFormats()},e.prototype.zoomOut=function(t){this.publishAppEvent("zoom-out",2)},e.prototype.onRender=function(){this.range&&("tsbuckets"===this.panel.dataFormat?this.convertHistogramToHeatmapData():this.convertTimeSeriesToHeatmapData())},e.prototype.convertTimeSeriesToHeatmapData=function(){var t,e,r,n,a=this.panel.yAxis.logBase,i=this.panel.xBucketNumber||30,s=Math.floor((this.range.to-this.range.from)/i);t=kt.a.interval_regex.test(this.panel.xBucketSize)?kt.a.interval_to_ms(this.panel.xBucketSize):isNaN(Number(this.panel.xBucketSize))||""===this.panel.xBucketSize||null===this.panel.xBucketSize?s:Number(this.panel.xBucketSize),n=this.parseSeries(this.series);var o=this.panel.yBucketNumber||10;1!==a?e=this.panel.yAxis.splitFactor:(e=n.max===n.min?n.max?n.max/10:1:(n.max-n.min)/o,e=this.panel.yBucketSize||e),r=ko(this.series,e,t,a),n.min||n.max||(n={min:-1,max:1,minLog:1},e=1);var l=So(r),c=l.cards,u=l.cardStats;this.data={buckets:r,heatmapStats:n,xBucketSize:t,yBucketSize:e,cards:c,cardStats:u}},e.prototype.convertHistogramToHeatmapData=function(){var t,e,r,n=this.getPanelDataSourceType();I.a.includes(Lo,n)||this.series.sort(wo),e=function(t){for(var e={},r=0;r<t.length;r++){var n=t[r],a=r;if(isNaN(a))return e;for(var i=0,s=n.datapoints;i<s.length;i++){var o=s[i],l=o[bo],c=o[yo];if(I.a.isNumber(l)){var u=e[c];u||(u=e[c]={x:c,buckets:{}}),u.buckets[a]={y:a,count:l,bounds:{top:null,bottom:a},values:[],points:[]}}}}return e}(this.series),r=I.a.map(this.series,"label");var a=this.panel.yBucketBound;"prometheus"===n&&"lower"!==a||"upper"===a?r=[""].concat(r):r.push(""),t=function(t,e){void 0===e&&(e=1);var r=1/0;if(0===t.length)return 0;if(1===t.length)return t[0];t=I.a.sortBy(t);for(var n=1;n<t.length;n++){var a=Po(t[n],t[n-1],e);r=a<r?a:r}return r}(I.a.map(I.a.keys(e),function(t){return Number(t)}));var i=So(e),s=i.cards,o=i.cardStats;this.data={buckets:e,xBucketSize:t,yBucketSize:1,tsBuckets:r,cards:s,cardStats:o}},e.prototype.getPanelDataSourceType=function(){return this.datasource.meta&&this.datasource.meta.id?this.datasource.meta.id:"unknown"},e.prototype.onDataReceived=function(t){if(this.series=t.map(this.seriesHandler.bind(this)),this.dataWarning=null,0===I.a.reduce(this.series,function(t,e){return t+e.datapoints.length},0))this.dataWarning={title:"No data points",tip:"No datapoints returned from data query"};else for(var e=0,r=this.series;e<r.length;e++){if(r[e].isOutsideRange){this.dataWarning={title:"Data points outside time range",tip:"Can be caused by timezone mismatch or missing time filter in query"};break}}this.render()},e.prototype.onDataError=function(){this.series=[],this.render()},e.prototype.onCardColorChange=function(t){this.panel.color.cardColor=t,this.render()},e.prototype.seriesHandler=function(t){if(void 0===t.datapoints)throw new Error("Heatmap error: data should be a time series");var e=new re.a({datapoints:t.datapoints,alias:t.target});e.flotpairs=e.getFlotPairs(this.panel.nullPointMode);var r=t.datapoints||[];r&&r.length>0&&(r[r.length-1][1]-this.range.from<-1e4&&(e.isOutsideRange=!0));return e},e.prototype.parseSeries=function(t){var e=I.a.min(I.a.map(t,function(t){return t.stats.min})),r=I.a.min(I.a.map(t,function(t){return t.stats.logmin}));return{max:I.a.max(I.a.map(t,function(t){return t.stats.max})),min:e,minLog:r}},e.prototype.parseHistogramSeries=function(t){var e=I.a.map(t,function(t){return Number(t.alias)}),r=I.a.min(e),n=I.a.min(e);return{max:I.a.max(e),min:r,minLog:n}},e.prototype.link=function(t,e,r,n){!function(t,e,r,n){new Oo(t,e,r,n)}(t,e,r,n)},e.templateUrl="module.html",e}(Bt),jo={};jo.timeseries_to_rows={description:"Time series to rows",getColumns:function(){return[]},transform:function(t,e,r){r.columns=[{text:"Time",type:"date"},{text:"Metric"},{text:"Value"}];for(var n=0;n<t.length;n++)for(var a=t[n],i=0;i<a.datapoints.length;i++){var s=a.datapoints[i];r.rows.push([s[1],a.target,s[0]])}}},jo.timeseries_to_columns={description:"Time series to columns",getColumns:function(){return[]},transform:function(t,e,r){r.columns.push({text:"Time",type:"date"});for(var n={},a=0;a<t.length;a++){var i=t[a];r.columns.push({text:i.target});for(var s=0;s<i.datapoints.length;s++){var o=i.datapoints[s],l=o[1].toString();n[l]?n[l][a]=o[0]:(n[l]={time:o[1]},n[l][a]=o[0])}}for(var c in n){var u=n[c],d=[u.time];for(a=0;a<t.length;a++){var p=u[a];d.push(p)}r.rows.push(d)}}},jo.timeseries_aggregations={description:"Time series aggregations",getColumns:function(){return[{text:"Avg",value:"avg"},{text:"Min",value:"min"},{text:"Max",value:"max"},{text:"Total",value:"total"},{text:"Current",value:"current"},{text:"Count",value:"count"}]},transform:function(t,e,r){var n,a;for(r.columns.push({text:"Metric"}),n=0;n<e.columns.length;n++)r.columns.push({text:e.columns[n].text});for(n=0;n<t.length;n++){var i=new re.a({datapoints:t[n].datapoints,alias:t[n].target});i.getFlotPairs("connected");var s=[i.alias];for(a=0;a<e.columns.length;a++)s.push(i.stats[e.columns[a].value]);r.rows.push(s)}}},jo.annotations={description:"Annotations",getColumns:function(){return[]},transform:function(t,e,r){if(r.columns.push({text:"Time",type:"date"}),r.columns.push({text:"Title"}),r.columns.push({text:"Text"}),r.columns.push({text:"Tags"}),t&&t.annotations&&0!==t.annotations.length)for(var n=0;n<t.annotations.length;n++){var a=t.annotations[n];r.rows.push([a.time,a.title,a.text,a.tags])}}},jo.table={description:"Table",getColumns:function(t){if(!t||0===t.length)return[];if(1===t.length)return t[0].columns.slice();var e={};return t.reduce(function(t,r){return r.columns.forEach(function(r){var n=r.text;void 0===e[n]&&(e[n]=t.length,t.push(r))}),t},[])},transform:function(t,e,r){if(t&&0!==t.length){var n=I.a.findIndex(t,function(t){return"table"!==t.type});if(n>-1)throw{message:"Result of query #"+String.fromCharCode(65+n)+" is not in table format, try using another transform."};ne.b.apply(void 0,[r].concat(t))}}},jo.json={description:"JSON Data",getColumns:function(t){if(!t||0===t.length)return[];for(var e={},r=0;r<t.length;r++){var n=t[r];if("docs"===n.type)for(var a=Math.min(n.datapoints.length,100),i=0;i<a;i++){var s=Te(n.datapoints[i],null);for(var o in s)e[o]=!0}}return I.a.map(e,function(t,e){return{text:e,value:e}})},transform:function(t,e,r){for(var n,a,i,s=0,o=e.columns;s<o.length;s++){var l={text:o[s].text};t.length>0&&t[0].filterable&&(l.filterable=!0),r.columns.push(l)}for(0===r.columns.length&&r.columns.push({text:"JSON"}),n=0;n<t.length;n++){var c=t[n];for(a=0;a<c.datapoints.length;a++){var u=c.datapoints[a],d=[];if(I.a.isObject(u)&&e.columns.length>0){var p=Te(u,null);for(i=0;i<e.columns.length;i++)d.push(p[e.columns[i].value])}else d.push(JSON.stringify(u));r.rows.push(d)}}}};var Uo=function(){function t(t,e,r){this.$q=e,this.uiSegmentSrv=r,t.editor=this,this.panelCtrl=t.ctrl,this.panel=this.panelCtrl.panel,this.transformers=jo,this.fontSizes=["80%","90%","100%","110%","120%","130%","150%","160%","180%","200%","220%","250%"],this.addColumnSegment=r.newPlusButton(),this.updateTransformHints()}return t.$inject=["$scope","$q","uiSegmentSrv"],t.prototype.updateTransformHints=function(){switch(this.canSetColumns=!1,this.columnsHelpMessage="",this.panel.transform){case"timeseries_aggregations":case"json":this.canSetColumns=!0;break;case"table":this.columnsHelpMessage="Columns and their order are determined by the data query"}},t.prototype.getColumnOptions=function(){var t=this;if(!this.panelCtrl.dataRaw)return this.$q.when([]);var e=this.transformers[this.panel.transform].getColumns(this.panelCtrl.dataRaw),r=I.a.map(e,function(e){return t.uiSegmentSrv.newSegment({value:e.text})});return this.$q.when(r)},t.prototype.addColumn=function(){var t=jo[this.panel.transform].getColumns(this.panelCtrl.dataRaw),e=I.a.find(t,{text:this.addColumnSegment.value});e&&(this.panel.columns.push(e),this.render());var r=this.uiSegmentSrv.newPlusButton();this.addColumnSegment.html=r.html,this.addColumnSegment.value=r.value},t.prototype.transformChanged=function(){this.panel.columns=[],"timeseries_aggregations"===this.panel.transform&&this.panel.columns.push({text:"Avg",value:"avg"}),this.updateTransformHints(),this.render()},t.prototype.render=function(){this.panelCtrl.render()},t.prototype.removeColumn=function(t){this.panel.columns=I.a.without(this.panel.columns,t),this.panelCtrl.render()},t}();function Vo(t,e){return{restrict:"E",scope:!0,templateUrl:"public/app/plugins/panel/table/editor.html",controller:Uo}}var Bo=function(){function t(t){var e=this;t.editor=this,this.activeStyleIndex=0,this.panelCtrl=t.ctrl,this.panel=this.panelCtrl.panel,this.unitFormats=kt.a.getUnitFormats(),this.colorModes=[{text:"Disabled",value:null},{text:"Cell",value:"cell"},{text:"Value",value:"value"},{text:"Row",value:"row"}],this.columnTypes=[{text:"Number",value:"number"},{text:"String",value:"string"},{text:"Date",value:"date"},{text:"Hidden",value:"hidden"}],this.fontSizes=["80%","90%","100%","110%","120%","130%","150%","160%","180%","200%","220%","250%"],this.dateFormats=[{text:"YYYY-MM-DD HH:mm:ss",value:"YYYY-MM-DD HH:mm:ss"},{text:"YYYY-MM-DD HH:mm:ss.SSS",value:"YYYY-MM-DD HH:mm:ss.SSS"},{text:"MM/DD/YY h:mm:ss a",value:"MM/DD/YY h:mm:ss a"},{text:"MMMM D, YYYY LT",value:"MMMM D, YYYY LT"},{text:"YYYY-MM-DD",value:"YYYY-MM-DD"}],this.mappingTypes=[{text:"Value to text",value:1},{text:"Range to text",value:2}],this.getColumnNames=function(){return e.panelCtrl.table?I.a.map(e.panelCtrl.table.columns,function(t){return t.text}):[]},this.onColorChange=this.onColorChange.bind(this)}return t.$inject=["$scope"],t.prototype.render=function(){this.panelCtrl.render()},t.prototype.setUnitFormat=function(t,e){t.unit=e.value,this.panelCtrl.render()},t.prototype.addColumnStyle=function(){var t=this.panel.styles,e=t.length,r=e;e>0&&("/.*/"===t[e-1].pattern&&(r=e-1));t.splice(r,0,{unit:"short",type:"number",alias:"",decimals:2,colors:["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],colorMode:null,pattern:"",dateFormat:"YYYY-MM-DD HH:mm:ss",thresholds:[],mappingType:1,matchCol:[{whichColumn:"",matchItems:[{matchVal:"",ValAs:""}]}]}),this.activeStyleIndex=r},t.prototype.removeColumnStyle=function(t){this.panel.styles=I.a.without(this.panel.styles,t)},t.prototype.addMatchColumn=function(t){this.panel.styles[t].matchCol.push({whichColumn:"",matchItems:[{matchVal:"",ValAs:""}]}),this.panelCtrl.render()},t.prototype.removeMatchColumn=function(t,e){this.panel.styles[t].matchCol.splice(e,1),this.panelCtrl.render()},t.prototype.removeMatchValue=function(t,e,r){this.panel.styles[t].matchCol[e].matchItems.splice(r,1),this.panelCtrl.render()},t.prototype.addMatchValue=function(t,e){this.panel.styles[t].matchCol[e].matchItems.push({matchVal:"",ValAs:""}),this.panelCtrl.render()},t.prototype.invertColorOrder=function(t){var e=this.panel.styles[t].colors,r=e[0];e[0]=e[2],e[2]=r,this.panelCtrl.render()},t.prototype.onColorChange=function(t,e){var r=this;return function(n){r.panel.styles[t].colors[e]=n,r.render()}},t.prototype.addValueMap=function(t){t.valueMaps||(t.valueMaps=[]),t.valueMaps.push({value:"",text:""}),this.panelCtrl.render()},t.prototype.removeValueMap=function(t,e){t.valueMaps.splice(e,1),this.panelCtrl.render()},t.prototype.addRangeMap=function(t){t.rangeMaps||(t.rangeMaps=[]),t.rangeMaps.push({from:"",to:"",text:""}),this.panelCtrl.render()},t.prototype.removeRangeMap=function(t,e){t.rangeMaps.splice(e,1),this.panelCtrl.render()},t}();function Qo(t,e){return{restrict:"E",scope:!0,templateUrl:"public/app/plugins/panel/table/column_options.html",controller:Bo}}var Ho=function(){function t(t,e,r,n,a){this.panel=t,this.table=e,this.isUtc=r,this.sanitize=n,this.templateSrv=a,this.initColumns()}return t.prototype.setTable=function(t){this.table=t,this.initColumns()},t.prototype.initColumns=function(){this.formatters=[],this.colorState={};for(var t=0;t<this.table.columns.length;t++){var e=this.table.columns[t];e.title=e.text;for(var r=0;r<this.panel.styles.length;r++){var n=this.panel.styles[r],a=kt.a.stringToJsRegex(n.pattern);if(e.text.match(a)){e.style=n,n.alias&&(e.title=e.text.replace(a,n.alias));break}}this.formatters[t]=this.createColumnFormatter(e)}},t.prototype.getColorForValue=function(t,e){if(!e.thresholds)return null;for(var r=e.thresholds.length;r>0;r--)if(t>=e.thresholds[r-1])return e.colors[r];return I.a.first(e.colors)},t.prototype.defaultCellFormatter=function(t,e){return null===t||void 0===t||void 0===t?"":(I.a.isArray(t)&&(t=t.join(", ")),e&&e.sanitize?this.sanitize(t):I.a.escape(t))},t.prototype.createColumnFormatter=function(t){var e=this;if(!t.style)return this.defaultCellFormatter;if("hidden"===t.style.type)return function(t){};if("date"===t.style.type)return function(r){if(void 0===r||null===r)return"-";I.a.isArray(r)&&(r=r[0]);var n=H()(r);return e.isUtc&&(n=n.utc()),t.style.dateFormat&&t.style.dateFormat.indexOf("[[")>=0?t.style.dateFormatOne=e.templateSrv.replace(t.style.dateFormat):t.style.dateFormatOne=t.style.dateFormat,n.format(t.style.dateFormatOne)};if("string"===t.style.type)return function(r){I.a.isArray(r)&&(r=r.join(", "));var n=t.style.mappingType||0;if(1===n&&t.style.valueMaps)for(var a=0;a<t.style.valueMaps.length;a++){var i=t.style.valueMaps[a];if(null!==r){if(!I.a.isString(r)&&Number(i.value)===Number(r)||i.value===r)return e.setColorState(r,t.style),e.defaultCellFormatter(i.text,t.style)}else if("null"===i.value)return i.text}if(2===n&&t.style.rangeMaps)for(a=0;a<t.style.rangeMaps.length;a++){i=t.style.rangeMaps[a];if(null!==r){if(Number(i.from)<=Number(r)&&Number(i.to)>=Number(r))return e.setColorState(r,t.style),e.defaultCellFormatter(i.text,t.style)}else if("null"===i.from&&"null"===i.to)return i.text}return null===r||void 0===r?"-":(e.setColorState(r,t.style),e.defaultCellFormatter(r,t.style))};if("number"===t.style.type){var r=kt.a.valueFormats[t.unit||t.style.unit];return function(n){return null===n||void 0===n?"-":I.a.isString(n)||I.a.isArray(n)?e.defaultCellFormatter(n,t.style):(e.setColorState(n,t.style),r(n,t.style.decimals,null))}}return function(r){return e.defaultCellFormatter(r,t.style)}},t.prototype.setColorState=function(t,e){if(e.colorMode&&null!==t&&void 0!==t&&!I.a.isArray(t)){var r=Number(t);isNaN(r)||(this.colorState[e.colorMode]=this.getColorForValue(r,e))}},t.prototype.renderRowVariables=function(t,e){var r={},n=this.table.rows[t],a=this.table.columns[e].style.matchCol;if(a)for(var i=0;i<a.length;i++)if(a[i].whichColumn&&a[i].matchItems.length>0){for(var s=void 0,o="",l=0;l<this.table.columns.length;l++)a[i].whichColumn===this.table.columns[l].text&&(o="__superM_params_"+i,s=l);for(var c=0;c<a[i].matchItems.length;c++)if(a[i].matchItems[c].matchVal&&a[i].matchItems[c].ValAs){var u=n[s].indexOf(a[i].matchItems[c].matchVal);void 0!==u&&u>=0&&(r[o]={value:a[i].matchItems[c].ValAs})}}for(var d=0;d<n.length;d++)r["__cell_"+d]={value:n[d]};return r},t.prototype.formatColumnValue=function(t,e){return this.formatters[t]?this.formatters[t](e):e},t.prototype.renderCell=function(t,e,r,n){void 0===n&&(n=!1),r=this.formatColumnValue(t,r);var a=this.table.columns[t],i="",s="",o=[],l="";this.colorState.cell?(i=' style="background-color:'+this.colorState.cell+'"',o.push("table-panel-color-cell"),this.colorState.cell=null):this.colorState.value&&(s=' style="color:'+this.colorState.value+'"',this.colorState.value=null);var c="";if(n&&(c='<div class="table-panel-width-hack">'+this.table.columns[t].title+"</div>"),void 0===r?(i=' style="display:none;"',a.hidden=!0):a.hidden=!1,!0===a.hidden)return"";if(a.style&&a.style.preserveFormat&&o.push("table-panel-cell-pre"),a.style&&a.style.link){var u=this.renderRowVariables(e,t);u.__cell={value:r};var d=this.templateSrv.replace(a.style.linkUrl,u,encodeURIComponent),p=this.templateSrv.replace(a.style.linkTooltip,u),h=a.style.linkTargetBlank?"_blank":"";o.push("table-panel-cell-link"),c+='\n        <a href="'+d+'" target="'+h+'" data-link-tooltip data-original-title="'+p+'" data-placement="right"'+s+">\n          "+r+"\n        </a>\n      "}else c+=r;return a.filterable&&(o.push("table-panel-cell-filterable"),c+='\n        <a class="table-panel-filter-link" data-link-tooltip data-original-title="Filter out value" data-placement="bottom"\n           data-row="'+e+'" data-column="'+t+'" data-operator="!=">\n          <i class="fa fa-search-minus"></i>\n        </a>\n        <a class="table-panel-filter-link" data-link-tooltip data-original-title="Filter for value" data-placement="bottom"\n           data-row="'+e+'" data-column="'+t+'" data-operator="=">\n          <i class="fa fa-search-plus"></i>\n        </a>'),o.length&&(l=' class="'+o.join(" ")+'"'),c="<td"+l+i+s+">"+c+"</td>"},t.prototype.render=function(t){for(var e=this.panel.pageSize||100,r=t*e,n=Math.min(r+e,this.table.rows.length),a="",i=[],s="",o=r;o<n;o++){for(var l=this.table.rows[o],c="",u="",d=0;d<this.table.columns.length;d++)c+=this.renderCell(d,o,l[d],o===r);this.colorState.row&&(u=' style="background-color:'+this.colorState.row+'"',i.push("table-panel-color-row"),this.colorState.row=null),i.length&&(s=' class="'+i.join(" ")+'"'),a+="<tr "+s+u+">"+c+"</tr>"}return a},t.prototype.render_values=function(){for(var t=[],e=0;e<this.table.rows.length;e++){for(var r=this.table.rows[e],n=[],a=0;a<this.table.columns.length;a++)n.push(this.formatColumnValue(a,r[a]));t.push(n)}return{columns:this.table.columns,rows:t}},t}(),zo=function(t){function e(e,r,n,a,i,s){var o=t.call(this,e,r)||this;return o.annotationsSrv=a,o.$sanitize=i,o.variableSrv=s,o.panelDefaults={targets:[{}],transform:"timeseries_to_columns",pageSize:null,showHeader:!0,styles:[{type:"date",pattern:"Time",alias:"Time",dateFormat:"YYYY-MM-DD HH:mm:ss",dateFormatOne:"",matchCol:[{witchColumn:"",matchItems:[{matchVal:"",ValAs:""}]}]},{unit:"short",type:"number",alias:"",decimals:2,colors:["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],colorMode:null,pattern:"/.*/",thresholds:[],matchCol:[{witchColumn:"",matchItems:[{matchVal:"",ValAs:""}]}]}],columns:[],scroll:!0,fontSize:"100%",sort:{col:0,desc:!0}},o.pageIndex=0,void 0===o.panel.styles&&(o.panel.styles=o.panel.columns,o.panel.columns=o.panel.fields,delete o.panel.columns,delete o.panel.fields),I.a.defaults(o.panel,o.panelDefaults),o.events.on("data-received",o.onDataReceived.bind(o)),o.events.on("data-error",o.onDataError.bind(o)),o.events.on("data-snapshot-load",o.onDataReceived.bind(o)),o.events.on("init-edit-mode",o.onInitEditMode.bind(o)),o.events.on("init-panel-actions",o.onInitPanelActions.bind(o)),o.events.on("get-data",o.onGetData.bind(o)),o}return e.$inject=["$scope","$injector","templateSrv","annotationsSrv","$sanitize","variableSrv"],J.c(e,t),e.prototype.onInitEditMode=function(){this.addEditorTab("Options",Vo,2),this.addEditorTab("Column Styles",Qo,3)},e.prototype.onInitPanelActions=function(t){t.push({text:"Export CSV",click:"ctrl.exportCsv()"})},e.prototype.onGetData=function(t){t.push(this.renderer.render_values())},e.prototype.issueQueries=function(e){return this.pageIndex=0,"annotations"===this.panel.transform?(this.setTimeQueryStart(),this.annotationsSrv.getAnnotations({dashboard:this.dashboard,panel:this.panel,range:this.range}).then(function(t){return{data:t}})):t.prototype.issueQueries.call(this,e)},e.prototype.onDataError=function(t){this.dataRaw=[],this.render()},e.prototype.onDataReceived=function(t){this.dataRaw=t,this.pageIndex=0,this.dataRaw&&this.dataRaw.length&&("table"===this.dataRaw[0].type?this.panel.transform="table":"docs"===this.dataRaw[0].type?this.panel.transform="json":"table"!==this.panel.transform&&"json"!==this.panel.transform||(this.panel.transform="timeseries_to_rows")),this.render()},e.prototype.render=function(){return this.table=function(t,e){var r=new ne.a;if(!t||0===t.length)return r;var n=jo[e.transform];if(!n)throw{message:"Transformer "+e.transform+" not found"};return n.transform(t,e,r),r}(this.dataRaw,this.panel),this.table.sort(this.panel.sort),this.renderer=new Ho(this.panel,this.table,this.dashboard.isTimezoneUtc(),this.$sanitize,this.templateSrv),t.prototype.render.call(this,this.table)},e.prototype.toggleColumnSort=function(t,e){this.table.columns[this.panel.sort.col]&&(this.table.columns[this.panel.sort.col].sort=!1),this.panel.sort.col===e?this.panel.sort.desc?this.panel.sort.desc=!1:this.panel.sort.col=null:(this.panel.sort.col=e,this.panel.sort.desc=!0),this.render()},e.prototype.moveQuery=function(e,r){t.prototype.moveQuery.call(this,e,r),t.prototype.refresh.call(this)},e.prototype.exportCsv=function(){var t=this.$scope.$new(!0);t.tableData=this.renderer.render_values(),t.panel="table",this.publishAppEvent("show-modal",{templateHtml:'<export-data-modal panel="panel" data="tableData"></export-data-modal>',scope:t,modalClass:"modal--narrow"})},e.prototype.link=function(t,e,r,n){var a,i=n.panel,s=0;function o(){var t=e.parents(".panel-content"),r=e.find(".table-panel-scroll"),o=e.find("tbody"),l=e.find(".table-panel-footer");e.css({"font-size":i.fontSize}),t.addClass("table-panel-content"),function(t){n.renderer.setTable(a),t.empty(),t.html(n.renderer.render(n.pageIndex))}(o),function(t){t.empty();var e=i.pageSize||100;if(1!==(s=Math.ceil(a.rows.length/e))){for(var r=Math.max(n.pageIndex-3,0),o=Math.min(s,r+9),l=F()("<ul></ul>"),c=r;c<o;c++){var u=c===n.pageIndex?"active":"",d=F()('<li><a class="table-panel-page-link pointer '+u+'">'+(c+1)+"</a></li>");l.append(d)}t.append(l)}}(l),r.css({"max-height":i.scroll?function(){var t=n.height;return s>1&&(t-=26),t-31+"px"}():""})}e.tooltip({selector:"[data-link-tooltip]"}),e.on("click",".table-panel-page-link",function(t){var e=F()(t.currentTarget);n.pageIndex=parseInt(e.text(),10)-1,o()}),e.on("click",".table-panel-filter-link",function(t){var e=F()(t.currentTarget).data(),r={datasource:i.datasource,key:a.columns[e.column].text,value:a.rows[e.row][e.column],operator:e.operator};n.variableSrv.setAdhocFilter(r)});var l=t.$on("$destroy",function(){e.off("click",".table-panel-page-link"),e.off("click",".table-panel-filter-link"),l()});n.events.on("render",function(t){(a=t||a)&&o(),n.renderingCompleted()})},e.templateUrl="module.html",e}(Bt),Go=(r(584),function(){function t(t,e){this.templateSrv=t,this.timeSrv=e}return t.$inject=["templateSrv","timeSrv"],t.prototype.getLinkUrl=function(t){var e=this.templateSrv.replace(t.url||""),r={};if(t.keepTime){var n=this.timeSrv.timeRangeForUrl();r.from=n.from,r.to=n.to}return t.includeVars&&this.templateSrv.fillVariableValuesForUrl(r),this.addParamsToUrl(e,r)},t.prototype.addParamsToUrl=function(t,e){var r=[];return I.a.each(e,function(t,e){null!==t&&(!0===t?r.push(e):I.a.isArray(t)?I.a.each(t,function(t){r.push(e+"="+encodeURIComponent(t))}):r.push(e+"="+encodeURIComponent(t)))}),0===r.length?t:this.appendToQueryString(t,r.join("&"))},t.prototype.appendToQueryString=function(t,e){if(!I.a.isUndefined(e)&&null!==e&&""!==e){var r=t.indexOf("?");-1!==r?t.length-r>1&&(t+="&"):t+="?",t+=e}return t},t.prototype.getAnchorInfo=function(t){var e={};return e.href=this.getLinkUrl(t),e.title=this.templateSrv.replace(t.title||""),e},t.prototype.getPanelLinkAnchorInfo=function(t,e){var r={};if("absolute"===t.type)r.target=t.targetBlank?"_blank":"_self",r.href=this.templateSrv.replace(t.url||"",e),r.title=this.templateSrv.replace(t.title||"",e);else if(t.url)r.href=t.url,r.title=this.templateSrv.replace(t.title||"",e),r.target=t.targetBlank?"_blank":"";else if(t.dashUri)r.href="dashboard/"+t.dashUri+"?",r.title=this.templateSrv.replace(t.title||"",e),r.target=t.targetBlank?"_blank":"_self";else{r.title=this.templateSrv.replace(t.title||"",e);var n=kt.a.slugifyForUrl(t.dashboard||"");r.href="dashboard/db/"+n+"?"}var a={};if(t.keepTime){var i=this.timeSrv.timeRangeForUrl();a.from=i.from,a.to=i.to}return t.includeVars&&this.templateSrv.fillVariableValuesForUrl(a,e),r.href=this.addParamsToUrl(r.href,a),t.params&&(r.href=this.appendToQueryString(r.href,this.templateSrv.replace(t.params,e))),r},t}());L.a.module("grafana.services").service("linkSrv",Go);var Wo=function(t){function e(e,r,n,a){var i=t.call(this,e,r,{showCover:!0})||this;return i.linkSrv=n,i.$sanitize=a,i.dataType="timeseries",i.valueNameOptions=[{value:"min",text:"Min"},{value:"max",text:"Max"},{value:"avg",text:"Average"},{value:"current",text:"Current"},{value:"total",text:"Total"},{value:"name",text:"Name"},{value:"first",text:"First"},{value:"delta",text:"Delta"},{value:"diff",text:"Difference"},{value:"range",text:"Range"},{value:"last_time",text:"Time of last point"}],i.panelDefaults={links:[],datasource:null,maxDataPoints:100,interval:null,targets:[{}],cacheTimeout:null,format:"none",prefix:"",postfix:"",nullText:null,valueMaps:[{value:"null",op:"=",text:"N/A"}],mappingTypes:[{name:"value to text",value:1},{name:"range to text",value:2}],rangeMaps:[{from:"null",to:"null",text:"N/A"}],mappingType:1,tipType:1,tipTypes:[{name:"静态文本",value:1},{name:"动态提示",value:2}],kksTips:[],textTips:"",tipText:[],nullPointMode:"connected",valueName:"avg",prefixFontSize:"50%",valueFontSize:"80%",postfixFontSize:"50%",thresholds:"",colorBackground:!1,colorValue:!1,colors:["#299c46","rgba(237, 129, 40, 0.89)","#d44a3a"],sparkline:{show:!1,full:!1,lineColor:"rgb(31, 120, 193)",fillColor:"rgba(31, 118, 189, 0.18)"},gauge:{show:!1,minValue:0,maxValue:100,thresholdMarkers:!0,thresholdLabels:!1},tableColumn:"",alertPlayTimer:null},I.a.defaults(i.panel,i.panelDefaults),i.events.on("data-received",i.onDataReceived.bind(i)),i.events.on("data-error",i.onDataError.bind(i)),i.events.on("data-snapshot-load",i.onDataReceived.bind(i)),i.events.on("init-edit-mode",i.onInitEditMode.bind(i)),i.events.on("panel-teardown",i.destoryData.bind(i)),i.onSparklineColorChange=i.onSparklineColorChange.bind(i),i.onSparklineFillChange=i.onSparklineFillChange.bind(i),i}return e.$inject=["$scope","$injector","linkSrv","$sanitize"],J.c(e,t),e.prototype.onInitEditMode=function(){this.fontSizes=["20%","30%","50%","70%","80%","100%","110%","120%","150%","170%","200%"],this.addEditorTab("Options","public/app/plugins/panel/singlestat/editor.html",2),this.addEditorTab("Value Mappings","public/app/plugins/panel/singlestat/mappings.html",3),this.addEditorTab("Config Tips","public/app/plugins/panel/singlestat/tips.html",4),this.unitFormats=kt.a.getUnitFormats()},e.prototype.setUnitFormat=function(t){this.panel.format=t.value,this.refresh()},e.prototype.destoryData=function(){this.panel.alertPlayTimer&&clearInterval(this.panel.alertPlayTimer)},e.prototype.onDataError=function(t){this.onDataReceived([])},e.prototype.onDataReceived=function(t){var e={scopedVars:I.a.extend({},this.panel.scopedVars),alert:{}};if(null!==t&&t.length>0&&void 0!==t[0].alarm&&(e.alert=t[0].alarm),t.length>0&&"table"===t[0].type){this.dataType="table";var r=t.map(this.tableHandler.bind(this));this.setTableValues(r,e)}else this.dataType="timeseries",this.series=t.map(this.seriesHandler.bind(this)),this.setValues(e);this.data=e,this.render()},e.prototype.seriesHandler=function(t){var e=new re.a({datapoints:t.datapoints||[],alias:t.target});return e.flotpairs=e.getFlotPairs(this.panel.nullPointMode),e},e.prototype.tableHandler=function(t){var e=[],r={};return t.columns.forEach(function(t,e){r[e]=t.text}),this.tableColumnOptions=r,I.a.find(t.columns,["text",this.panel.tableColumn])||this.setTableColumnToSensibleDefault(t),t.rows.forEach(function(t){var n={};t.forEach(function(t,e){var a=r[e];n[a]=t}),e.push(n)}),e},e.prototype.setTableColumnToSensibleDefault=function(t){1===t.columns.length?this.panel.tableColumn=t.columns[0].text:this.panel.tableColumn=I.a.find(t.columns,function(t){return"time"!==t.type}).text},e.prototype.setTableValues=function(t,e){if(t&&0!==t.length&&0!==t[0].length&&void 0!==t[0][0][this.panel.tableColumn]){var r=t[0][0];if(e.value=r[this.panel.tableColumn],I.a.isString(e.value))e.valueFormatted=I.a.escape(e.value),e.value=0,e.valueRounded=0;else{var n=this.getDecimalsForValue(e.value),a=kt.a.valueFormats[this.panel.format];e.valueFormatted=a(r[this.panel.tableColumn],n.decimals,n.scaledDecimals),e.valueRounded=kt.a.roundValue(e.value,this.panel.decimals||0)}this.setValueMapping(e)}},e.prototype.canModifyText=function(){return!this.panel.gauge.show},e.prototype.setColoring=function(t){t.background?(this.panel.colorValue=!1,this.panel.colors=["rgba(71, 212, 59, 0.4)","rgba(245, 150, 40, 0.73)","rgba(225, 40, 40, 0.59)"]):(this.panel.colorBackground=!1,this.panel.colors=["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"]),this.render()},e.prototype.invertColorOrder=function(){var t=this.panel.colors[0];this.panel.colors[0]=this.panel.colors[2],this.panel.colors[2]=t,this.render()},e.prototype.onColorChange=function(t){var e=this;return function(r){e.panel.colors[t]=r,e.render()}},e.prototype.onSparklineColorChange=function(t){this.panel.sparkline.lineColor=t,this.render()},e.prototype.onSparklineFillChange=function(t){this.panel.sparkline.fillColor=t,this.render()},e.prototype.getDecimalsForValue=function(t){if(I.a.isNumber(this.panel.decimals))return{decimals:this.panel.decimals,scaledDecimals:null};var e,r=t/2,n=-Math.floor(Math.log(r)/Math.LN10),a=Math.pow(10,-n),i=r/a;i<1.5?e=1:i<3?(e=2,i>2.25&&(e=2.5,++n)):e=i<7.5?5:10,e*=a,Math.floor(t)===t&&(n=0);var s={};return s.decimals=Math.max(0,n),s.scaledDecimals=s.decimals-Math.floor(Math.log(e)/Math.LN10)+2,s},e.prototype.setValues=function(t){if(t.flotpairs=[],this.series.length>1){var e=new Error;throw e.message="Multiple Series Error",e.data="Metric query returns "+this.series.length+" series. Single Stat Panel expects a single series.\n\nResponse:\n"+JSON.stringify(this.series),e}if(this.series&&this.series.length>0){var r=I.a.last(this.series[0].datapoints),n=I.a.isArray(r)?r[0]:null;if("name"===this.panel.valueName)t.value=0,t.valueRounded=0,t.valueFormatted=this.series[0].alias;else if(I.a.isString(n))t.value=0,t.valueFormatted=I.a.escape(n),t.valueRounded=0;else if("last_time"===this.panel.valueName){var a=kt.a.valueFormats[this.panel.format];t.value=r[1],t.valueRounded=t.value,t.valueFormatted=a(t.value,this.dashboard.isTimezoneUtc())}else{t.value=this.series[0].stats[this.panel.valueName],t.flotpairs=this.series[0].flotpairs;var i=this.getDecimalsForValue(t.value);a=kt.a.valueFormats[this.panel.format];t.valueFormatted=a(t.value,i.decimals,i.scaledDecimals),t.valueRounded=kt.a.roundValue(t.value,i.decimals)}if(void 0!==t.alert.value&&null!=t.alert.value){var s=this.getDecimalsForValue(t.alert.value),o=kt.a.valueFormats[this.panel.format];t.alert.value=o(t.alert.value,s.decimals,s.scaledDecimals)}t.scopedVars.__name={value:this.series[0].label}}this.setValueMapping(t)},e.prototype.getKDMData=function(){if(this.panel.kdm&&this.datasource&&"oge-kdm"===this.datasource.type){for(var t,e=[],r=0;r<this.panel.kksTips.length;r++){var n=this.panel.kksTips[r].value;e.push(n)}t=1===this.panel.kdm.dataType?{method:"getRTDataSnapshot",kksCodes:e.join()}:{method:"getRTDataHistory",kksCodes:e.join(),startTime:this.timeSrv.timeRange().from._d.getTime(),endTime:this.timeSrv.timeRange().to._d.getTime()};var a=this.datasource.url+"/kdmService/rest/1.0/kksData";return F.a.ajax({type:"POST",url:a,data:t,dataType:"json"})}console.warn("此数据源仅支持kdm数据源查询")},e.prototype.getKPIData=function(){if(this.panel.kdm&&this.datasource&&"oge-kkm"===this.datasource.type){for(var t,e,r=[],n=0;n<this.panel.kksTips.length;n++){var a=this.panel.kksTips[n].value;r.push(a)}return 1===this.panel.kdm.dataType?(t={_postkpis_last:{kpi_ids:r}},e="/services/kpi_datas/kpis/last"):(t={_postkpis:{kpi_ids:r,start_time:this.timeSrv.timeRange().from._d.getTime(),end_time:this.timeSrv.timeRange().to._d.getTime()}},e="/services/kpi_datas/kpis"),this.postRequest(e,t)}console.warn("此数据源仅支持kkm数据源查询")},e.prototype.postRequest=function(t,e){return this.datasource.backendSrv.datasourceRequest({url:this.datasource.url+t,method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},data:e})},e.prototype.setValueMapping=function(t){if(1===this.panel.mappingType)for(var e=0;e<this.panel.valueMaps.length;e++){if("null"!==(r=this.panel.valueMaps[e]).value){if(parseFloat(r.value)===t.valueRounded)return void(t.valueFormatted=r.text)}else if(null===t.value||void 0===t.value)return void(t.valueFormatted=r.text)}else if(2===this.panel.mappingType)for(e=0;e<this.panel.rangeMaps.length;e++){var r;if("null"!==(r=this.panel.rangeMaps[e]).from||"null"!==r.to){var n=parseFloat(r.from);if(parseFloat(r.to)>=t.valueRounded&&n<=t.valueRounded)return void(t.valueFormatted=r.text)}else if(null===t.value||void 0===t.value)return void(t.valueFormatted=r.text)}null!==t.value&&void 0!==t.value||(t.valueFormatted="no value")},e.prototype.groupKPIData=function(t){for(var e={},r=[],n=0;n<t.length;n++){var a=t[n];if(e[a.kpi_id])for(var i=0;i<r.length;i++){var s=r[i];if(s.kpi_id==a.kpi_id){s.data.push(a);break}}else r.push({kpi_id:a.kpi_id,data:[a]}),e[a.kpi_id]=a}return r},e.prototype.compare=function(t){return function(e,r){return e[t]-r[t]}},e.prototype.removeKKSTip=function(t){var e=I.a.indexOf(this.panel.kksTips,t);this.panel.kksTips.splice(e,1),this.render()},e.prototype.addKKSTip=function(){this.panel.kksTips.push({value:"",alias:""})},e.prototype.removeTextTip=function(){delete this.panel.textTips,this.panel.tipText=[],this.render()},e.prototype.removeValueMap=function(t){var e=I.a.indexOf(this.panel.valueMaps,t);this.panel.valueMaps.splice(e,1),this.render()},e.prototype.addValueMap=function(){this.panel.valueMaps.push({value:"",op:"=",text:""})},e.prototype.removeRangeMap=function(t){var e=I.a.indexOf(this.panel.rangeMaps,t);this.panel.rangeMaps.splice(e,1),this.render()},e.prototype.addRangeMap=function(){this.panel.rangeMaps.push({from:"",to:"",text:""})},e.prototype.link=function(t,e,r,n){var a,i,s,o=this.$location,l=this.linkSrv,c=this.$timeout,u=this.$sanitize,d=n.panel,p=this.templateSrv,h=e.find(".panel-container");function f(t,e,r,i){return i=u(p.replace(i,a.scopedVars)),'<span class="'+t+'" style="font-size:'+e+'">'+(i=r?function(t){var e=n.getOgeColorForValue(a,a.value);return e?'<span style="color:'+e+'">'+t+"</span>":t}(i):i)+"</span>"}function m(){var t=e.width(),r=e.height(),i=Math.min(t,1.3*r);if(n.invalidGaugeRange=!1,d.gauge.minValue>d.gauge.maxValue)n.invalidGaugeRange=!0;else{var s=F()("<div></div>"),o={top:"10px",margin:"auto",position:"relative",height:.9*r+"px",width:i+"px"};s.css(o);for(var l=[],c=0;c<a.thresholds.length;c++)l.push({value:a.thresholds[c],color:a.colorMap[c]});l.push({value:d.gauge.maxValue,color:a.colorMap[a.colorMap.length-1]});var u=B.a.bootData.user.lightTheme?"rgb(230,230,230)":"rgb(38,38,38)",h=parseInt(d.valueFontSize,10)/100,f=Math.min(i/5,100)*h,m=d.gauge.thresholdLabels?1.5:1,g=Math.min(i/6,60)/m,v=g/5,b=f/2.5,y={series:{gauges:{gauge:{min:d.gauge.minValue,max:d.gauge.maxValue,background:{color:u},border:{color:null},shadow:{show:!1},width:g},frame:{show:!1},label:{show:!1},layout:{margin:0,thresholdWidth:0},cell:{border:{width:0}},threshold:{values:l,label:{show:d.gauge.thresholdLabels,margin:v+1,font:{size:b}},show:d.gauge.thresholdMarkers,width:v},value:{color:d.ogeAlertEnabled&&"V"===d.ogeAlertColorType||!d.ogeAlertEnabled&&d.colorValue?n.getOgeColorForValue(a,a.valueRounded):null,formatter:function(){return function(){var t=d.prefix?p.replace(d.prefix,a.scopedVars):"";return t+=a.valueFormatted,t+=d.postfix?p.replace(d.postfix,a.scopedVars):""}()},font:{size:f,family:'"Helvetica Neue", Helvetica, Arial, sans-serif'}},show:!0}}};e.append(s);var w={data:[[0,a.value]]};F.a.plot(s,[w],y)}}function g(){var t=e.width()+20;if(t<30)setTimeout(g,30);else{var r=n.height,i=F()("<div></div>"),s={position:"absolute"};if(d.sparkline.full){s.bottom="5px",s.left="-5px",s.width=t-10+"px";var o=r<=100?5:15*Math.round(r/100)+5;s.height=r-o+"px"}else s.bottom="0px",s.left="-5px",s.width=t-10+"px",s.height=Math.floor(.25*r)+"px";i.css(s);var l={legend:{show:!1},series:{lines:{show:!0,fill:1,zero:!1,lineWidth:1,fillColor:d.sparkline.fillColor}},yaxes:{show:!1},xaxis:{show:!1,mode:"time",min:n.range.from.valueOf(),max:n.range.to.valueOf()},grid:{hoverable:!1,show:!1}};e.append(i);var c={data:a.flotpairs,color:d.sparkline.lineColor};F.a.plot(i,[c],l)}}function v(){if(n.data){a=n.data,d.ogeAlertEnabled&&("B"===d.ogeAlertColorType?(d.colorBackground=!0,d.colorValue=!1):"V"===d.ogeAlertColorType&&(d.colorBackground=!1,d.colorValue=!0)),a.thresholds=d.thresholds.split(",").map(function(t){return Number(t.trim())}),a.colorMap=d.colors;var r=d.gauge.show?"":function(){var t='<div class="singlestat-panel-value-container" style="font-size:1.5rem;">';return d.prefix&&(t+=f("singlestat-panel-prefix",d.prefixFontSize,d.colorPrefix,d.prefix)),d.ogeAlertEnabled&&d.ogeAlertNameCoverValue?t+=f("singlestat-panel-value",d.valueFontSize,d.colorValue,a.alert.level+""):d.ogeAlertEnabled&&d.ogeAlertValueCoverValue?t+=f("singlestat-panel-value",d.valueFontSize,d.colorValue,a.alert.value):t+=f("singlestat-panel-value",d.valueFontSize,d.colorValue,a.valueFormatted),d.postfix&&(t+=f("singlestat-panel-postfix",d.postfixFontSize,d.colorPostfix,d.postfix)),t+="</div>"}();if(d.colorBackground&&!isNaN(a.value)){var o=n.getOgeColorForValue(a,a.value);o&&(h.css("background-color",o),t.fullscreen?e.css("background-color",o):e.css("background-color",""))}else h.css("background-color",""),e.css("background-color","");if(e.html(r),d.sparkline.show&&g(),d.gauge.show&&m(),e.toggleClass("pointer",d.links.length>0),i=d.links.length>0?l.getPanelLinkAnchorInfo(d.links[0],a.scopedVars):null,s=d.kksTips.length>0?d.kksTips:null,d.alertPlayTimer&&clearInterval(d.alertPlayTimer),d.ogeAlertSound&&3===a.alert.level){var c=h.find(".audio-obj");setTimeout(function(){b(c)},2e3),d.timeInterval>0&&setTimeout(function(){d.alertPlayTimer=function(t){return setInterval(function(){b(t)},d.timeInterval)}(c)},d.timeInterval+2e3)}}}function b(t){t&&t.get(0).paused&&t.get(0).play().catch(function(){console.warn("paly warn, 请联系管理员设置chrome浏览器")})}e=e.find(".singlestat-panel"),function(){var t=F()('<div id="tooltip" class="">hello</div>"');e.mouseleave(function(){n.panel.tipText=[],c(function(){t.detach()})}),e.click(function(e){i&&(F()(e).parents(".panel-header").length>0||("_blank"!==i.target?(0===i.href.indexOf("http")?window.location.href=i.href:c(function(){o.url(i.href)}),t.detach()):window.open(i.href,"_blank")))}),e.mouseenter(function(t){if(n.panel.tipText=[],1===n.panel.tipType)if(""===n.panel.textTips||void 0===n.panel.textTips)n.panel.tipText=[];else{var e=n.panel.textTips;n.panel.tipText.push(e)}else if(2===n.panel.tipType)if("oge-kdm"===n.datasource.type){if(!(r=n.getKDMData()))return;r.then(function(t){if(1===t.BasicResponse.succeeded)for(var e=void 0,r=0;r<s.length;r++)if(0===t.RTDataSets.length){e="--";var a=s[r].alias+":"+e;n.panel.tipText.push(a)}else for(var i=0;i<t.RTDataSets.length;i++){if(s[r].value===t.RTDataSets[i].kksCode){if(t.RTDataSets[i].RTDataValues&&0!==t.RTDataSets[i].RTDataValues.length||(e="--"),t.RTDataSets[i].RTDataValues&&t.RTDataSets[i].RTDataValues.length>1){var o=t.RTDataSets[i].RTDataValues.length;e=t.RTDataSets[i].RTDataValues[o-1].Value}t.RTDataSets[i].RTDataValues&&1===t.RTDataSets[i].RTDataValues.length&&(e=t.RTDataSets[i].RTDataValues[0].Value)}else e="--";a=s[r].alias+":"+e,n.panel.tipText.push(a)}}).catch(function(t){console.log(t)})}else if("oge-kkm"===n.datasource.type){var r;if(!(r=n.getKPIData()))return;r.then(function(t){for(var e,r=0;r<s.length;r++){if(t.config.data._postkpis_last)if(t.data.kpi_datas.kpi)for(var a=0;a<t.data.kpi_datas.kpi.length;a++){var i=t.data.kpi_datas.kpi[a];if(s[r].value===i.kpi_id){e=i.value;break}e="--"}else e="--";else if(t.data.kpi_datas.kpi)for(a=0;a<t.data.kpi_datas.kpi.length;a++)for(var o=t.data.kpi_datas.kpi,l=n.groupKPIData(o),c=0;c<l.length;c++){if(i=l[c].data.sort(n.compare("datetime")),s[r].value===l[c].kpi_id){e=i[i.length-1].value;break}e="--"}else e="--";var u=s[r].alias+":"+e;n.panel.tipText.push(u)}}).catch(function(t){console.log(t)})}}),e.mousemove(function(e){n.panel.tipText.length>0&&(t.text(n.panel.tipText.join()),t.place_tt(e.pageX,e.pageY-50))})}(),this.events.on("render",function(){v(),n.renderingCompleted()})},e.prototype.getOgeColorForValue=function(t,e){return this.panel.ogeAlertEnabled?this.getAlertLevelColor(this.data.alert.level):Yo(t,e)},e.templateUrl="module.html",e}(Qt);function Yo(t,e){if(!I.a.isFinite(e))return null;for(var r=t.thresholds.length;r>0;r--)if(e>=t.thresholds[r-1])return t.colorMap[r];return I.a.first(t.colorMap)}var Ko=function(t){function e(e,r,n,a,i){var s=t.call(this,e,r)||this;return s.backendSrv=n,s.$q=i,s.stepIndex=0,s.steps=[],s.steps.push({title:"安装KAM",icon:"icon-gf icon-gf-check",href:"/",target:"_blank",note:"查看安装文档",check:function(){return i.when(!0)}}),s.steps.push({title:"创建您的第一个数据源",cta:"添加数据源",icon:"icon-gf icon-gf-datasources",href:"datasources/new?gettingstarted",check:function(){return i.when(a.getMetricSources().filter(function(t){return!0!==t.meta.builtIn}).length>0)}}),s.steps.push({title:"创建您的第一个仪表盘",cta:"新建仪表盘",icon:"icon-gf icon-gf-dashboard",href:"dashboard/new?gettingstarted",check:function(){return s.backendSrv.search({limit:1}).then(function(t){return t.length>0})}}),s.steps.push({title:"邀请您的团队",cta:"添加用户",icon:"icon-gf icon-gf-users",href:"org/users?gettingstarted",check:function(){return s.backendSrv.get("/api/org/users").then(function(t){return t.length>1})}}),s.steps.push({title:"安装插件",cta:"查询插件库",icon:"icon-gf icon-gf-apps",href:"/",check:function(){return s.backendSrv.get("/api/plugins",{embedded:0,core:0}).then(function(t){return t.length>0})}}),s}return e.$inject=["$scope","$injector","backendSrv","datasourceSrv","$q"],J.c(e,t),e.prototype.$onInit=function(){var t=this;return this.stepIndex=-1,this.nextStep().then(function(e){t.checksDone=!0})},e.prototype.nextStep=function(){var t=this;if(this.stepIndex===this.steps.length-1)return this.$q.when();this.stepIndex+=1;var e=this.steps[this.stepIndex];return e.check().then(function(r){return r?(e.cssClass="completed",t.nextStep()):(e.cssClass="active",t.$q.when())})},e.prototype.dismiss=function(){this.dashboard.removePanel(this.panel,!1),this.backendSrv.request({method:"PUT",url:"/api/user/helpflags/1",showSuccessAlert:!1}).then(function(t){G.d.user.helpFlags1=t.helpFlags1})},e.templateUrl="public/app/plugins/panel/gettingstarted/module.html",e}(Lt),Jo=["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],Xo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return J.c(e,t),e.prototype.componentDidMount=function(){this.draw()},e.prototype.componentDidUpdate=function(t){this.draw()},e.prototype.draw=function(){var t=this.props,e=t.maxValue,r=t.minValue,n=t.showThresholdLables,a=t.size,i=t.showThresholdMarkers,s=t.timeSeries,o=t.thresholds,l=a.width,c=a.height,u=Math.min(l,1.3*c),d=B.a.bootData.user.lightTheme?"rgb(230,230,230)":"rgb(38,38,38)",p=B.a.bootData.user.lightTheme?"rgb(38,38,38)":"rgb(230,230,230)",h=parseInt("80",10)/100,f=Math.min(u/5,100)*h,m=Math.min(u/6,60),g=m/5,v=f/2.5,b=[];o.forEach(function(t,e){b.push({value:t,color:Jo[e]})});var y={series:{gauges:{gauge:{min:r,max:e,background:{color:d},border:{color:null},shadow:{show:!1},width:m},frame:{show:!1},label:{show:!1},layout:{margin:0,thresholdWidth:0},cell:{border:{width:0}},threshold:{values:b,label:{show:n,margin:g+1,font:{size:v}},show:i,width:g},value:{color:p,formatter:function(){return Math.round(s[0].stats.avg)},font:{size:f,family:'"Helvetica Neue", Helvetica, Arial, sans-serif'}},show:!0}}},w={data:[[0,s[0].stats.avg]]};try{F.a.plot(this.canvasElement,[w],y)}catch(t){console.log("Gauge rendering error",t,y,s)}},e.prototype.render=function(){var t=this,e=this.props.size,r=e.height,n=e.width;return j.a.createElement("div",{className:"singlestat-panel",ref:function(e){return t.parentElement=e}},j.a.createElement("div",{style:{height:.9*r+"px",width:Math.min(n,1.3*r)+"px",top:"10px",margin:"auto"},ref:function(e){return t.canvasElement=e}}))},e.defaultProps={minValue:0,maxValue:100,showThresholdMarkers:!0,showThresholdLables:!1,thresholds:[]},e}(R.PureComponent),Zo=Object(Hi.withSize)({monitorHeight:!0})(Xo),tl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return J.c(e,t),e.prototype.render=function(){var t=Ji({timeSeries:this.props.timeSeries,nullValueMode:Ki.d.Ignore});return j.a.createElement(Zo,{maxValue:100,minValue:0,timeSeries:t,thresholds:[0,100]})},e}(R.PureComponent),el={"app/plugins/datasource/graphite/module":s,"app/plugins/datasource/cloudwatch/module":o,"app/plugins/datasource/elasticsearch/module":l,"app/plugins/datasource/opentsdb/module":c,"app/plugins/datasource/grafana/module":u,"app/plugins/datasource/influxdb/module":d,"app/plugins/datasource/logging/module":p,"app/plugins/datasource/mixed/module":h,"app/plugins/datasource/mysql/module":f,"app/plugins/datasource/postgres/module":m,"app/plugins/datasource/mssql/module":v,"app/plugins/datasource/prometheus/module":g,"app/plugins/datasource/testdata/module":b,"app/plugins/datasource/stackdriver/module":y,"app/plugins/panel/text/module":w,"app/plugins/panel/text2/module":x,"app/plugins/panel/graph2/module":S,"app/plugins/panel/graph/module":k,"app/plugins/panel/dashlist/module":C,"app/plugins/panel/pluginlist/module":T,"app/plugins/panel/alertlist/module":E,"app/plugins/panel/heatmap/module":_,"app/plugins/panel/table/module":M,"app/plugins/panel/singlestat/module":A,"app/plugins/panel/gettingstarted/module":P,"app/plugins/panel/gauge/module":$},rl=r(54),nl=r(352),al=(r(1335),r(1337),r(1346),r(1349),r(1356),"?_cache="+Date.now());function il(t,e){_t.a.registerDynamic(t,[],!0,function(t,r,n){n.exports=e})}_t.a.registry.set("plugin-loader",_t.a.newModule({locate:function(t){return t.address+al}})),_t.a.config({baseURL:"public",defaultExtension:"js",packages:{plugins:{defaultExtension:"js"}},map:{text:"vendor/plugin-text/text.js",css:"vendor/plugin-css/css.js"},meta:{"/*":{esModule:!0,authorization:!0,loader:"plugin-loader"}}}),il("lodash",I.a),il("moment",H.a),il("jquery",F.a),il("angular",L.a),il("d3",ao),il("rxjs/Subject",nl.Subject),il("rxjs/Observable",rl.Observable),il("prismjs",Xt.a),il("slate",Zt.default),il("slate-react",te.b),il("slate-plain-serializer",ee.a),il("react",j.a),il("react-dom",V.a),il("vendor/npm/rxjs/Rx",{Subject:nl.Subject,Observable:rl.Observable}),il("app/features/dashboard/impression_store",{impressions:_e.a,__esModule:!0}),il("app/plugins/sdk",n),il("app/core/utils/datemath",Ct),il("app/core/utils/file_export",a),il("app/core/utils/flatten",i),il("app/core/utils/kbn",kt.a),il("app/core/utils/ticks",Ee),il("app/core/config",B.a),il("app/core/time_series",re.a),il("app/core/time_series2",re.a),il("app/core/table_model",ne.a),il("app/core/app_events",G.c),il("app/core/core_module",G.e),il("app/core/core",{coreModule:G.e,appEvents:G.c,contextSrv:G.d,__esModule:!0});for(var sl=0,ol=["jquery.flot","jquery.flot.pie","jquery.flot.time","jquery.flot.fillbelow","jquery.flot.crosshair","jquery.flot.stack","jquery.flot.selection","jquery.flot.stackpercent","jquery.flot.events","jquery.flot.gauge"];sl<ol.length;sl++){il(ol[sl],{fakeDep:1})}function ll(t){var e=el[t];return e?Promise.resolve(e):_t.a.import(t)}function cl(t){B.a.bootData.user.lightTheme?_t.a.import(t.light+"!css"):_t.a.import(t.dark+"!css")}var ul,dl=function(){function t(t,e,r,n){this.$q=t,this.$injector=e,this.$rootScope=r,this.templateSrv=n,this.init()}return t.$inject=["$q","$injector","$rootScope","templateSrv"],t.prototype.init=function(){this.datasources={}},t.prototype.get=function(t){return t?"default"===(t=this.templateSrv.replace(t))?this.get(B.a.defaultDatasource):this.datasources[t]?this.$q.when(this.datasources[t]):this.loadDatasource(t):this.get(B.a.defaultDatasource)},t.prototype.loadDatasource=function(t){var e=this,r=B.a.datasources[t];if(!r)return this.$q.reject({message:"未发现名为 "+t+" 的仪表盘"});var n=this.$q.defer(),a=r.meta;return ll(a.module).then(function(i){if(e.datasources[t])n.resolve(e.datasources[t]);else{if(!i.Datasource)throw new Error("插件模块缺少数据源构造函数");var s=e.$injector.instantiate(i.Datasource,{instanceSettings:r});s.meta=a,s.name=t,s.pluginExports=i,e.datasources[t]=s,n.resolve(s)}}).catch(function(t){e.$rootScope.appEvent("alert-error",[r.name+" 插件失败",t.toString()])}),n.promise},t.prototype.getAll=function(){return B.a.datasources},t.prototype.getAnnotationSources=function(){var t=[];return this.addDataSourceVariables(t),I.a.each(B.a.datasources,function(e){e.meta&&e.meta.annotations&&t.push(e)}),t},t.prototype.getExploreSources=function(){var t=B.a.datasources,e=Object.keys(t).map(function(e){return t[e]}).filter(function(t){return t.meta&&t.meta.explore});return I.a.sortBy(e,["name"])},t.prototype.getMetricSources=function(t){var e=[];return I.a.each(B.a.datasources,function(t,r){if(t.meta&&t.meta.metrics){var n={value:r,name:r,meta:t.meta,sort:r};"grafana"===t.meta.id?n.sort=String.fromCharCode(253):"mixed"===t.meta.id&&(n.sort=String.fromCharCode(254)),e.push(n),r===B.a.defaultDatasource&&(n={value:null,name:"default",meta:t.meta,sort:r},e.push(n))}}),t&&t.skipVariables||this.addDataSourceVariables(e),e.sort(function(t,e){return t.sort.toLowerCase()>e.sort.toLowerCase()?1:t.sort.toLowerCase()<e.sort.toLowerCase()?-1:0}),e},t.prototype.addDataSourceVariables=function(t){for(var e=0;e<this.templateSrv.variables.length;e++){var r=this.templateSrv.variables[e];if("datasource"===r.type){var n=r.current.value;"default"===n&&(n=B.a.defaultDatasource);var a=B.a.datasources[n];if(a){var i="$"+r.name;t.push({name:i,value:i,meta:a.meta,sort:i})}}}},t}();z.c.service("datasourceSrv",dl);var pl,hl=function(){function t(t,e){this.$compile=t,this.$rootScope=e}return t.$inject=["$compile","$rootScope"],t.prototype.load=function(t,e,r){var n=this.$rootScope.$new();I.a.assign(n,e);var a=this.$compile(r)(n);return L.a.element(t).append(a),{destroy:function(){n.$destroy(),a.remove()}}},t}();function fl(){return pl}z.c.service("angularLoader",hl);var ml=function(){function t(t,e,r,n,a,i,s,o,l,c){!function(t){pl=t}(c),Object(St.b)(s),function(t){ul=t}(l),function(t){gt=t}(o),Object(Z.a)(),t.init=function(){t.contextSrv=a,t.appSubUrl=B.a.appSubUrl,t._=I.a,vt.a.init(B.a,r),e.init(),i.init()},r.colors=xt.g,t.initDashboard=function(e,r){t.appEvent("dashboard-fetch-end",e),n("DashboardCtrl",{$scope:r}).init(e)},r.onAppEvent=function(t,e,n){var a=r.$on(t,e),i=this;1!==i.$id||n||console.log("warning rootScope onAppEvent called without localscope"),n&&(i=n),i.$on("$destroy",a)},r.appEvent=function(t,e){r.$emit(t,e),bt.a.emit(t,e)},t.init()}return t.$inject=["$scope","utilSrv","$rootScope","$controller","contextSrv","bridgeSrv","backendSrv","timeSrv","datasourceSrv","angularLoader"],t}();function gl(t,e,r){switch(t.removeClass("view-mode--tv"),t.removeClass("view-mode--kiosk"),t.removeClass("view-mode--inactive"),e){case"tv":t.removeClass("sidemenu-open"),t.addClass("view-mode--tv");break;case"1":case!0:t.removeClass("sidemenu-open"),t.addClass("view-mode--kiosk");break;default:t.toggleClass("sidemenu-open",r)}}function vl(t,e,r,n,a){return{restrict:"E",controller:ml,link:function(e,r){var n,i,s=F()("body");F.a.fn.modal.Constructor.prototype.enforceFocus=function(){},F()(".preloader").remove(),n=e.contextSrv.sidemenu,s.toggleClass("sidemenu-open",n),bt.a.on("toggle-sidemenu",function(){n=e.contextSrv.sidemenu,s.toggleClass("sidemenu-open")}),bt.a.on("toggle-sidemenu-mobile",function(){s.toggleClass("sidemenu-open--xs")}),bt.a.on("toggle-sidemenu-hidden",function(){s.toggleClass("sidemenu-hidden")}),e.$watch(function(){return t.isPlaying},function(t){r.toggleClass("view-mode--playlist",!0===t)}),-1!==document.cookie.indexOf("renderKey")&&s.addClass("body--phantomjs"),e.$on("$routeChangeSuccess",function(t,e){i&&s.removeClass(i),e.$$route&&(i=e.$$route.pageClass)&&s.addClass(i),s.removeClass("sidemenu-open--xs"),F()("#tooltip, .tooltip").remove(),gl(s,e.params.kiosk,n);for(var r=0,a=wt.a.drops;r<a.length;r++){a[r].destroy()}}),bt.a.on("toggle-kiosk-mode",function(t){var e=a.search();switch(t&&t.exit&&(e.kiosk="1"),e.kiosk){case"tv":e.kiosk=!0,bt.a.emit("alert-success",["按ESC退出Kiosk模式"]);break;case"1":case!0:delete e.kiosk;break;default:e.kiosk="tv"}a.search(e),gl(s,e.kiosk,n)});var o=(new Date).getTime(),l=!0,c=3e5;function u(){l&&s.hasClass("page-dashboard")&&(new Date).getTime()-o>c&&(l=!1,s.addClass("view-mode--inactive"),s.removeClass("sidemenu-open"))}function d(){o=(new Date).getTime(),l||(l=!0,s.removeClass("view-mode--inactive"),s.toggleClass("sidemenu-open",n))}s.mousemove(d),s.keydown(d),document.addEventListener("wheel",d,{capture:!0,passive:!0}),document.addEventListener("visibilitychange",d),setInterval(u,2e3),bt.a.on("toggle-view-mode",function(){o=0,u()}),s.click(function(n){var a=F()(n.target);if(0!==a.parents().length){s.find(".dropdown-menu-open").removeClass("dropdown-menu-open");var i=a.closest("[data-click-hide]");if(i.length){var o=i.parent();i.detach(),setTimeout(function(){o.append(i)},100)}0===a.parents(".navbar-buttons--playlist").length&&t.stop(),s.find(".search-container").length>0&&0===a.parents(".search-results-container, .search-field-wrapper").length&&e.$apply(function(){e.appEvent("hide-dash-search")});var l=r.find(".popover");l.length>0&&0===a.parents(".graph-legend").length&&l.hide()}})}}}z.c.directive("grafanaApp",vl);var bl=function(){function t(t,e,r,n,a){var i=this;t.variableTypes=cr,t.ctrl={},t.namePattern=/^(?!__).*$/,t._=I.a,t.optionsLimit=20,t.refreshOptions=[{value:0,text:"Never"},{value:1,text:"On Dashboard Load"},{value:2,text:"On Time Range Change"}],t.sortOptions=[{value:0,text:"Disabled"},{value:1,text:"Alphabetical (asc)"},{value:2,text:"Alphabetical (desc)"},{value:3,text:"Numerical (asc)"},{value:4,text:"Numerical (desc)"},{value:5,text:"Alphabetical (case-insensitive, asc)"},{value:6,text:"Alphabetical (case-insensitive, desc)"}],t.hideOptions=[{value:0,text:""},{value:1,text:"标签"},{value:2,text:"变量"}],t.init=function(){t.mode="list",t.variables=n.variables,t.reset(),t.$watch("mode",function(e){"new"===e&&t.reset()})},t.setMode=function(e){t.mode=e},t.add=function(){t.isValid()&&(n.addVariable(t.current),t.update())},t.isValid=function(){if(!t.ctrl.form.$valid)return!1;if(!t.current.name.match(/^\w+$/))return bt.a.emit("alert-warning",["Validation","变量名中只允许有单词和数字字符"]),!1;var e=I.a.find(t.variables,{name:t.current.name});return e&&e!==t.current?(bt.a.emit("alert-warning",["Validation","已经存在同名的变量"]),!1):"query"!==t.current.type||!I.a.isString(t.current.query)||!t.current.query.match(new RegExp("\\$"+t.current.name+"(/| |$)"))||(bt.a.emit("alert-warning",["Validation","查询不能包含对自身的引用。变量: $"+t.current.name]),!1)},t.validate=function(){t.infoText="","adhoc"===t.current.type&&null!==t.current.datasource&&(t.infoText="特别过滤器会自动应用到所有以此数据源为目标的查询",e.get(t.current.datasource).then(function(e){e.getTagKeys||(t.infoText="此数据源还不支持特别过滤器。")}))},t.runQuery=function(){return t.optionsLimit=20,n.updateOptions(t.current).catch(function(t){t.data&&t.data.message&&(t.message=t.data.message),bt.a.emit("alert-error",["Templating","无法初始化模板变量: "+t.message])})},t.onQueryChange=function(e,r){t.current.query=e,t.current.definition=r,t.runQuery()},t.edit=function(r){t.current=r,t.currentIsNew=!1,t.mode="edit",t.validate(),e.get(t.current.datasource).then(function(e){t.currentDatasource=e})},t.duplicate=function(e){var r=I.a.cloneDeep(e.getSaveModel());t.current=n.createVariableFromModel(r),t.current.name="copy_of_"+e.name,n.addVariable(t.current)},t.update=function(){t.isValid()&&t.runQuery().then(function(){t.reset(),t.mode="list",a.updateTemplateData()})},t.reset=function(){t.currentIsNew=!0,t.current=n.createVariableFromModel({type:"query"}),t.datasources=I.a.filter(e.getMetricSources(),function(t){return!t.meta.mixed&&null!==t.value}),t.datasourceTypes=I()(t.datasources).uniqBy("meta.id").map(function(t){return{text:t.meta.name,value:t.meta.id}}).value()},t.typeChanged=function(){var e=t.current;t.current=n.createVariableFromModel({type:t.current.type}),t.current.name=e.name,t.current.hide=e.hide,t.current.label=e.label;var r=I.a.indexOf(this.variables,e);-1!==r&&(this.variables[r]=t.current),t.validate()},t.searchDashboards=function(t,e){r.search({query:t}).then(function(t){var r=I.a.map(t,function(t){return t.title});e(r)})},t.dashboardChanged=function(t){r.search({query:t.dashboard}).then(function(e){var r=I.a.find(e,{title:t.dashboard});r&&(t.dashUri=r.uri,t.title=r.title)})},t.removeOneLink=function(e){t.current.links.splice(e,1)},t.addOneLink=function(){t.current.links=t.current.links||[],t.current.links.push({type:"dashboard",dashboard:"",title:"",params:"",keepTime:!1,includeVars:!1,targetBlank:!1}),t.runQuery()},t.moveOneLink=function(e,r){I.a.move(t.current.links,e,e+r)},t.removeVariable=function(t){n.removeVariable(t)},t.showMoreOptions=function(){t.optionsLimit+=20},t.datasourceChanged=function(){return J.b(i,void 0,void 0,function(){return J.d(this,function(r){return e.get(t.current.datasource).then(function(e){t.current.query="",t.currentDatasource=e}),[2]})})}}return t.$inject=["$scope","datasourceSrv","backendSrv","variableSrv","templateSrv"],t}();z.c.controller("VariableEditorCtrl",bl);var yl=new(function(){function t(){this.templateSrv=ls}return t.prototype.changeTargets=function(t){var e=this.templateSrv.replace("$jz");if("$jz"!==e)for(var r=this.templateSrv.replace("$dc"),n=0;n<t.length;n++){var a=t[n].target;void 0===a&&(a=t[n]),"$dc"!==r&&(a=r+a.substring(5)),a=a.substring(0,6)+e+a.substring(8),void 0===t[n].target?t[n]=a:t[n].target=a}},t.prototype.changeStart=function(t){var e=this.templateSrv.replace("$jz");if("$jz"===e)return t;var r=ls.replace("$dc");return"$dc"!==r&&(t=-1!=t.indexOf("[[dc]]")?t.replace("[[dc]]",r):r+t.substring(5)),-1!=t.indexOf("[[jz]]")?t.replace("[[jz]]",e):t.substring(0,6)+e+t.substring(8)},t.prototype.addPoints=function(t,e){if(void 0===e&&(e="target"),this.templateSrv.selectTargets&&1===t.length&&"__shu-zhi-fen-xi"===t[0][e]){t.splice(0,t.length);for(var r=this.templateSrv.selectTargets,n=0;n<r.length;n++){var a={};a[e]=r[n],t.push(a)}}},t}()),wl=function(){function t(){}return t.prototype._linkTo=function(t,e){e<=0&&t.inputEdges.push(this),e>=0&&t.outputEdges.push(this),t.edges.push(this)},t.prototype.link=function(t,e){if(!t)throw Error("inputNode is required");if(!e)throw Error("outputNode is required");return this.unlink(),this.inputNode=t,this.outputNode=e,this._linkTo(t,1),this._linkTo(e,-1),this},t.prototype.unlink=function(){var t,e=this.inputNode,r=this.outputNode;e&&r&&((t=e.edges.indexOf(this))>-1&&e.edges.splice(t,1),(t=r.edges.indexOf(this))>-1&&r.edges.splice(t,1),(t=e.outputEdges.indexOf(this))>-1&&e.outputEdges.splice(t,1),(t=r.inputEdges.indexOf(this))>-1&&r.inputEdges.splice(t,1),this.inputNode=null,this.outputNode=null)},t}(),xl=function(){function t(t){this.name=t,this.edges=[],this.inputEdges=[],this.outputEdges=[]}return t.prototype.getEdgeFrom=function(t){return t?"object"==typeof t?this.inputEdges.find(function(e){return e.inputNode.name===t.name}):this.inputEdges.find(function(e){return e.inputNode.name===t}):null},t.prototype.getEdgeTo=function(t){return t?"object"==typeof t?this.outputEdges.find(function(e){return e.outputNode.name===t.name}):this.outputEdges.find(function(e){return e.outputNode.name===t}):null},t.prototype.getOptimizedInputEdges=function(){var t=this,e=[];return this.inputEdges.forEach(function(r){r.inputNode.inputEdges.map(function(t){return t.inputNode}).forEach(function(r){var n=r.getEdgeTo(t.name);n&&e.push(n)})}),this.inputEdges.filter(function(t){return-1===e.indexOf(t)})},t}(),Sl=function(){function t(){this.nodes={}}return t.prototype.createNode=function(t){var e=new xl(t);return this.nodes[t]=e,e},t.prototype.createNodes=function(t){var e=this,r=[];return t.forEach(function(t){r.push(e.createNode(t))}),r},t.prototype.link=function(t,e){var r=this,n=[],a=[],i=[],s=[];n=t instanceof Array?t:[t],a=e instanceof Array?e:[e];for(var o=0;o<n.length;o++){if("string"==typeof(c=n[o])){var l=this.getNode(c);if(!l)throw Error("cannot link input node named "+c+" since it doesn't exist in graph");i.push(l)}else i.push(c)}for(o=0;o<a.length;o++){var c;if("string"==typeof(c=a[o])){var u=this.getNode(c);if(!u)throw Error("cannot link output node named "+c+" since it doesn't exist in graph");s.push(u)}else s.push(c)}var d=[];return i.forEach(function(t){s.forEach(function(e){d.push(r.createEdge().link(t,e))})}),d},t.prototype.createEdge=function(){return new wl},t.prototype.getNode=function(t){return this.nodes[t]},t}(),kl=function(){function t(t,e,r,n,a){this.$rootScope=t,this.$q=e,this.$location=r,this.$injector=n,this.templateSrv=a,t.$on("template-variable-value-updated",this.updateUrlParamsWithCurrentVariables.bind(this),t)}return t.$inject=["$rootScope","$q","$location","$injector","templateSrv"],t.prototype.init=function(t){var e=this;this.dashboard=t,this.dashboard.events.on("time-range-updated",this.onTimeRangeUpdated.bind(this)),this.variables=t.templating.list=t.templating.list.map(this.createVariableFromModel.bind(this)),this.templateSrv.init(this.variables);for(var r=0,n=this.variables;r<n.length;r++){n[r].initLock=this.$q.defer()}var a=this.$location.search();return this.$q.all(this.variables.map(function(t){return e.processVariable(t,a)})).then(function(){e.templateSrv.updateTemplateData()})},t.prototype.onTimeRangeUpdated=function(){var t=this,e=this.variables.filter(function(t){return 2===t.refresh}).map(function(e){var r=e.options.slice();return e.updateOptions().then(function(){L.a.toJson(r)!==L.a.toJson(e.options)&&t.$rootScope.$emit("template-variable-value-updated")})});return this.$q.all(e).then(function(){t.dashboard.startRefresh()})},t.prototype.processVariable=function(t,e){for(var r=this,n=[],a=0,i=this.variables;a<i.length;a++){var s=i[a];t.dependsOn(s)&&n.push(s.initLock.promise)}return this.$q.all(n).then(function(){var r=e["var-"+t.name];return void 0!==r?t.setValueFromUrl(r).then(t.initLock.resolve):1===t.refresh||2===t.refresh?t.updateOptions().then(t.initLock.resolve):void t.initLock.resolve()}).finally(function(){r.templateSrv.variableInitialized(t),delete t.initLock})},t.prototype.createVariableFromModel=function(t){var e=cr[t.type].ctor;if(!e)throw{message:"Unable to find variable constructor for "+t.type};return this.$injector.instantiate(e,{model:t})},t.prototype.addVariable=function(t){this.variables.push(t),this.templateSrv.updateTemplateData(),this.dashboard.updateSubmenuVisibility()},t.prototype.removeVariable=function(t){var e=I.a.indexOf(this.variables,t);this.variables.splice(e,1),this.templateSrv.updateTemplateData(),this.dashboard.updateSubmenuVisibility()},t.prototype.updateOptions=function(t){return t.updateOptions()},t.prototype.variableUpdated=function(t,e){var r=this;if(t.initLock)return this.$q.when();var n=this.createGraph().getNode(t.name),a=[];return n&&(a=n.getOptimizedInputEdges().map(function(t){return r.updateOptions(r.variables.find(function(e){return e.name===t.inputNode.name}))})),this.$q.all(a).then(function(){e&&(r.$rootScope.$emit("template-variable-value-updated"),r.dashboard.startRefresh())})},t.prototype.selectOptionsForCurrentValue=function(t){var e,r,n,a,i=[];for(e=0;e<t.options.length;e++)if((a=t.options[e]).selected=!1,I.a.isArray(t.current.value))for(r=0;r<t.current.value.length;r++)n=t.current.value[r],a.value===n&&(a.selected=!0,i.push(a));else a.value===t.current.value&&(a.selected=!0,i.push(a));return i},t.prototype.validateVariableSelectionState=function(t){if(t.current||(t.current={}),I.a.isArray(t.current.value)){var e=this.selectOptionsForCurrentValue(t);return e=0===e.length?t.options[0]:{value:I.a.map(e,function(t){return t.value}),text:I.a.map(e,function(t){return t.text}).join(" + ")},t.setValue(e)}var r=I.a.find(t.options,{text:t.current.text});return r?t.setValue(r):t.options.length?t.setValue(t.options[0]):Promise.resolve()},t.prototype.setOptionFromUrl=function(t,e){var r=this.$q.when();return t.refresh&&(r=t.updateOptions()),r.then(function(){var r=I.a.find(t.options,function(t){return t.text===e||t.value===e}),n=e,a=e;if(!r&&I.a.isArray(e)){n=[];for(var i=function(r){var a=I.a.find(t.options,function(t){return t.value===e[r]});a&&n.push(a.text)},s=0;s<e.length;s++)i(s)}return r=r||{text:n,value:a},t.setValue(r)})},t.prototype.setOptionAsCurrent=function(t,e){return t.current=I.a.cloneDeep(e),I.a.isArray(t.current.text)&&(t.current.text=t.current.text.join(" + ")),this.selectOptionsForCurrentValue(t),this.variableUpdated(t)},t.prototype.updateUrlParamsWithCurrentVariables=function(){var t=this.$location.search();I.a.each(t,function(e,r){0===r.indexOf("var-")&&delete t[r]}),this.templateSrv.fillVariableValuesForUrl(t),this.$location.search(t)},t.prototype.setAdhocFilter=function(t){var e=I.a.find(this.variables,{type:"adhoc",datasource:t.datasource});e||(e=this.createVariableFromModel({name:"Filters",type:"adhoc",datasource:t.datasource}),this.addVariable(e));var r=e.filters,n=I.a.find(r,{key:t.key,value:t.value});n||(n={key:t.key,value:t.value},r.push(n)),n.operator=t.operator,this.variableUpdated(e,!0)},t.prototype.createGraph=function(){var t=this,e=new Sl;return this.variables.forEach(function(t){e.createNode(t.name)}),this.variables.forEach(function(r){t.variables.forEach(function(t){r!==t&&r.dependsOn(t)&&e.link(r.name,t.name)})}),e},t}();z.c.service("variableSrv",kl);var Cl=function(){function t(t,e,r,n){this.model=t,this.timeSrv=e,this.templateSrv=r,this.variableSrv=n,this.defaults={type:"interval",name:"",hide:0,label:"",refresh:2,options:[],current:{},query:"1m,10m,30m,1h,6h,12h,1d,7d,14d,30d",auto:!1,auto_min:"10s",auto_count:30,skipUrlSync:!1},Object(sr.a)(this,t,this.defaults),this.refresh=2}return t.$inject=["model","timeSrv","templateSrv","variableSrv"],t.prototype.getSaveModel=function(){return Object(sr.a)(this.model,this,this.defaults),this.model},t.prototype.setValue=function(t){return this.updateAutoValue(),this.variableSrv.setOptionAsCurrent(this,t)},t.prototype.updateAutoValue=function(){if(this.auto){this.options.length&&"auto"!==this.options[0].text&&this.options.unshift({text:"auto",value:"$__auto_interval_"+this.name});var t=kt.a.calculateInterval(this.timeSrv.timeRange(),this.auto_count,this.auto_min);this.templateSrv.setGrafanaVariable("$__auto_interval_"+this.name,t.interval),this.templateSrv.setGrafanaVariable("$__auto_interval",t.interval)}},t.prototype.updateOptions=function(){return this.options=I.a.map(this.query.match(/(["'])(.*?)\1|\w+/g),function(t){return{text:(t=t.replace(/["']+/g,"")).trim(),value:t.trim()}}),this.updateAutoValue(),this.variableSrv.validateVariableSelectionState(this)},t.prototype.dependsOn=function(t){return!1},t.prototype.setValueFromUrl=function(t){return this.updateAutoValue(),this.variableSrv.setOptionFromUrl(this,t)},t.prototype.getValueForUrl=function(){return this.current.value},t}();cr.interval={name:"Interval",ctor:Cl,description:"Define a timespan interval (ex 1m, 1h, 1d)"};var Tl=function(){function t(t,e,r,n,a){this.model=t,this.datasourceSrv=e,this.templateSrv=r,this.variableSrv=n,this.timeSrv=a,this.defaults={type:"query",label:null,query:"",regex:"",sort:0,datasource:null,refresh:0,hide:0,name:"",multi:!1,includeAll:!1,allValue:null,options:[],current:{},tags:[],useTags:!1,tagsQuery:"",tagValuesQuery:"",skipUrlSync:!1,definition:""},Object(sr.a)(this,t,this.defaults)}return t.$inject=["model","datasourceSrv","templateSrv","variableSrv","timeSrv"],t.prototype.getSaveModel=function(){return Object(sr.a)(this.model,this,this.defaults),0!==this.refresh&&(this.model.options=[]),this.model},t.prototype.setValue=function(t){return this.variableSrv.setOptionAsCurrent(this,t)},t.prototype.setValueFromUrl=function(t){return this.variableSrv.setOptionFromUrl(this,t)},t.prototype.getValueForUrl=function(){return"All"===this.current.text?"All":this.current.value},t.prototype.updateOptions=function(){return this.datasourceSrv.get(this.datasource).then(this.updateOptionsFromMetricFindQuery.bind(this)).then(this.updateTags.bind(this)).then(this.variableSrv.validateVariableSelectionState.bind(this.variableSrv,this))},t.prototype.updateTags=function(t){var e=this;return this.useTags?this.metricFindQuery(t,this.tagsQuery).then(function(r){e.tags=[];for(var n=0;n<r.length;n++)e.tags.push(r[n].text);return t}):(delete this.tags,t)},t.prototype.getValuesForTag=function(t){var e=this;return this.datasourceSrv.get(this.datasource).then(function(r){var n=e.tagValuesQuery.replace("$tag",t);return e.metricFindQuery(r,n).then(function(t){return I.a.map(t,function(t){return t.text})})})},t.prototype.updateOptionsFromMetricFindQuery=function(t){var e=this;return this.metricFindQuery(t,this.query).then(function(r){return e.options=e.metricNamesToVariableValues(r),e.includeAll&&e.addAllOption(),e.options.length||e.options.push({text:"None",value:"",isNone:!0}),t})},t.prototype.metricFindQuery=function(t,e){var r={range:void 0,variable:this};return 2===this.refresh&&(r.range=this.timeSrv.timeRange()),t.metricFindQuery(e,r)},t.prototype.addAllOption=function(){this.options.unshift({text:"All",value:"$__all"})},t.prototype.metricNamesToVariableValues=function(t){var e,r,n,a;for(r=[],this.regex&&(e=kt.a.stringToJsRegex(this.templateSrv.replace(this.regex,{},"regex"))),n=0;n<t.length;n++){var i=t[n],s=void 0===i.text||null===i.text?i.value:i.text,o=void 0===i.value||null===i.value?i.text:i.value;if(I.a.isNumber(o)&&(o=o.toString()),I.a.isNumber(s)&&(s=s.toString()),e){if(!(a=e.exec(o)))continue;a.length>1&&(o=a[1],s=a[1])}r.push({text:s,value:o})}return r=I.a.uniqBy(r,"value"),this.sortVariableValues(r,this.sort)},t.prototype.sortVariableValues=function(t,e){if(0===e)return t;var r=Math.ceil(e/2),n=e%2==0;return 1===r?t=I.a.sortBy(t,"text"):2===r?t=I.a.sortBy(t,function(t){var e=t.text.match(/.*?(\d+).*/);return!e||e.length<2?-1:parseInt(e[1],10)}):3===r&&(t=I.a.sortBy(t,function(t){return I.a.toLower(t.text)})),n&&(t=t.reverse()),t},t.prototype.dependsOn=function(t){return ur(this.query,this.datasource,this.regex,t.name)},t}();cr.query={name:"Query",ctor:Tl,description:"从数据源查询中获取变量值",supportsMulti:!0};var El=function(){function t(t,e,r,n){this.model=t,this.datasourceSrv=e,this.variableSrv=r,this.templateSrv=n,this.defaults={type:"datasource",name:"",hide:0,label:"",current:{},regex:"",options:[],query:"",refresh:1,skipUrlSync:!1},Object(sr.a)(this,t,this.defaults),this.refresh=1}return t.$inject=["model","datasourceSrv","variableSrv","templateSrv"],t.prototype.getSaveModel=function(){return Object(sr.a)(this.model,this,this.defaults),this.model.options=[],this.model},t.prototype.setValue=function(t){return this.variableSrv.setOptionAsCurrent(this,t)},t.prototype.updateOptions=function(){var t,e=[],r=this.datasourceSrv.getMetricSources({skipVariables:!0});this.regex&&(t=this.templateSrv.replace(this.regex,null,"regex"),t=kt.a.stringToJsRegex(t));for(var n=0;n<r.length;n++){var a=r[n];a.meta.id===this.query&&(t&&!t.exec(a.name)||e.push({text:a.name,value:a.name}))}return 0===e.length&&e.push({text:"No data sources found",value:""}),this.options=e,this.variableSrv.validateVariableSelectionState(this)},t.prototype.dependsOn=function(t){return!!this.regex&&ur(this.regex,t.name)},t.prototype.setValueFromUrl=function(t){return this.variableSrv.setOptionFromUrl(this,t)},t.prototype.getValueForUrl=function(){return this.current.value},t}();cr.datasource={name:"Datasource",ctor:El,description:"Enabled you to dynamically switch the datasource for multiple panels"};var _l=function(){function t(t,e){this.model=t,this.variableSrv=e,this.defaults={type:"custom",name:"",label:"",hide:0,options:[],current:{},query:"",includeAll:!1,multi:!1,allValue:null,skipUrlSync:!1},Object(sr.a)(this,t,this.defaults)}return t.$inject=["model","variableSrv"],t.prototype.setValue=function(t){return this.variableSrv.setOptionAsCurrent(this,t)},t.prototype.getSaveModel=function(){return Object(sr.a)(this.model,this,this.defaults),this.model},t.prototype.updateOptions=function(){return-1===this.query.indexOf("@@")?this.options=I.a.map(this.query.split(/[,]+/),function(t){return{text:t.trim(),value:t.trim()}}):this.options=I.a.map(this.query.split(/[,]+/),function(t){var e=t.split("@@");return{text:e[0].trim(),value:e[1].trim()}}),this.includeAll&&this.addAllOption(),this.variableSrv.validateVariableSelectionState(this)},t.prototype.addAllOption=function(){this.options.unshift({text:"All",value:"$__all"})},t.prototype.dependsOn=function(t){return!1},t.prototype.setValueFromUrl=function(t){return this.variableSrv.setOptionFromUrl(this,t)},t.prototype.getValueForUrl=function(){return"All"===this.current.text?"All":this.current.value},t}();cr.custom={name:"Custom",ctor:_l,description:"Define variable values manually",supportsMulti:!0};var Ml=function(){function t(t,e){this.model=t,this.variableSrv=e,this.defaults={type:"constant",name:"",hide:2,label:"",query:"",current:{},options:[],skipUrlSync:!1},Object(sr.a)(this,t,this.defaults)}return t.$inject=["model","variableSrv"],t.prototype.getSaveModel=function(){return Object(sr.a)(this.model,this,this.defaults),this.model},t.prototype.setValue=function(t){this.variableSrv.setOptionAsCurrent(this,t)},t.prototype.updateOptions=function(){return this.options=[{text:this.query.trim(),value:this.query.trim()}],this.setValue(this.options[0]),Promise.resolve()},t.prototype.dependsOn=function(t){return!1},t.prototype.setValueFromUrl=function(t){return this.variableSrv.setOptionFromUrl(this,t)},t.prototype.getValueForUrl=function(){return this.current.value},t}();cr.constant={name:"Constant",ctor:Ml,description:"Define a hidden constant variable, useful for metric prefixes in dashboards you want to share"};var Al=function(){function t(t){this.model=t,this.defaults={type:"adhoc",name:"",label:"",hide:0,datasource:null,filters:[],skipUrlSync:!1},Object(sr.a)(this,t,this.defaults)}return t.$inject=["model"],t.prototype.setValue=function(t){return Promise.resolve()},t.prototype.getSaveModel=function(){return Object(sr.a)(this.model,this,this.defaults),this.model},t.prototype.updateOptions=function(){return Promise.resolve()},t.prototype.dependsOn=function(t){return!1},t.prototype.setValueFromUrl=function(t){var e=this;return I.a.isArray(t)||(t=[t]),this.filters=t.map(function(t){var r=t.split("|").map(function(t){return e.unescapeDelimiter(t)});return{key:r[0],operator:r[1],value:r[2]}}),Promise.resolve()},t.prototype.getValueForUrl=function(){var t=this;return this.filters.map(function(e){return[e.key,e.operator,e.value].map(function(e){return t.escapeDelimiter(e)}).join("|")})},t.prototype.escapeDelimiter=function(t){return t.replace(/\|/g,"__gfp__")},t.prototype.unescapeDelimiter=function(t){return t.replace(/__gfp__/g,"|")},t.prototype.setFilters=function(t){this.filters=t},t}();cr.adhoc={name:"Ad hoc filters",ctor:Al,description:"Add key/value filters on the fly"};var Pl=function(){function t(t,e){this.model=t,this.variableSrv=e,this.defaults={type:"textbox",name:"",hide:2,label:"",query:"",current:{},options:[],skipUrlSync:!1},Object(sr.a)(this,t,this.defaults)}return t.$inject=["model","variableSrv"],t.prototype.getSaveModel=function(){return Object(sr.a)(this.model,this,this.defaults),this.model},t.prototype.setValue=function(t){this.variableSrv.setOptionAsCurrent(this,t)},t.prototype.updateOptions=function(){return this.options=[{text:this.query.trim(),value:this.query.trim()}],this.current=this.options[0],Promise.resolve()},t.prototype.dependsOn=function(t){return!1},t.prototype.setValueFromUrl=function(t){return this.query=t,this.variableSrv.setOptionFromUrl(this,t)},t.prototype.getValueForUrl=function(){return this.current.value},t}();cr.textbox={name:"Text box",ctor:Pl,description:"Define a textbox variable, where users can enter any arbitrary string"};var $l=function(){function t(t,e,r){this.model=t,this.variableSrv=e,this.linkSrv=r,this.defaults={type:"link",name:"",label:"",hide:0,options:[],current:{},links:[],query:""},Object(sr.a)(this,t,this.defaults)}return t.$inject=["model","variableSrv","linkSrv"],t.prototype.setValue=function(t){return this.variableSrv.setOptionAsCurrent(this,t)},t.prototype.getSaveModel=function(){return Object(sr.a)(this.model,this,this.defaults),this.model},t.prototype.updateOptions=function(){var t=this;return this.options=I.a.map(t.links,function(e){var r=t.variableSrv.templateSrv.variables,n=t.linkSrv.getPanelLinkAnchorInfo(e,r);return t.query=e.title+n.href+"",{text:e.title.trim(),value:n.href.trim(),target:n.target.trim()}}),this.variableSrv.validateVariableSelectionState(this)},t.prototype.dependsOn=function(t){return!1},t.prototype.setValueFromUrl=function(t){return this.variableSrv.setOptionFromUrl(this,t)},t.prototype.getValueForUrl=function(){return this.current.value},t}();cr.link={name:"Link",ctor:$l,description:"Define variable link manually"};var Dl=function(){function t(t,e){this.model=t,this.variableSrv=e,this.defaults={type:"json",name:"",label:"",hide:0,options:[],current:{},query:"",includeAll:!1,multi:!1,unfold:!1,allValue:null},Object(sr.a)(this,t,this.defaults)}return t.$inject=["model","variableSrv"],t.prototype.setValue=function(t){return this.variableSrv.setOptionAsCurrent(this,t)},t.prototype.getSaveModel=function(){return Object(sr.a)(this.model,this,this.defaults),this.model},t.prototype.updateOptions=function(){return this.options=I.a.map(JSON.parse(this.query),function(t){return{text:t.text.trim(),value:t.value}}),this.includeAll&&this.addAllOption(),this.variableSrv.validateVariableSelectionState(this)},t.prototype.addAllOption=function(){this.options.unshift({text:"All",value:"$__all"})},t.prototype.dependsOn=function(t){return!1},t.prototype.setValueFromUrl=function(t){return this.variableSrv.setOptionFromUrl(this,t)},t.prototype.getValueForUrl=function(){return"All"===this.current.text?"All":this.current.value},t}();cr.json={name:"Json",ctor:Dl,description:"Define variable values manually",supportsMulti:!0},z.c.factory("templateSrv",function(){return ls}),z.c.factory("templateChange",function(){return yl});var Ol=function(){function t(t,e,r,n,a,i){this.$scope=t,this.$rootScope=e,this.backendSrv=r,this.$sce=n,this.$routeParams=a,this.pluginId=a.pluginId,this.preUpdateHook=function(){return Promise.resolve()},this.postUpdateHook=function(){return Promise.resolve()},this.init()}return t.$inject=["$scope","$rootScope","backendSrv","$sce","$routeParams","navModelSrv"],t.prototype.setNavModel=function(t){var e="readme";(this.navModel={main:{img:t.info.logos.large,subTitle:t.info.author.name,url:"",text:t.name,breadcrumbs:[{title:"Plugins",url:"plugins"}],children:[{icon:"fa fa-fw fa-file-text-o",id:"readme",text:"Readme",url:"plugins/"+this.model.id+"/edit?tab=readme"}]}},"app"===t.type)&&(this.navModel.main.children.push({icon:"gicon gicon-cog",id:"config",text:"Config",url:"plugins/"+this.model.id+"/edit?tab=config"}),I.a.find(t.includes,{type:"dashboard"})&&this.navModel.main.children.push({icon:"gicon gicon-dashboard",id:"dashboards",text:"Dashboards",url:"plugins/"+this.model.id+"/edit?tab=dashboards"}),e="config");this.tab=this.$routeParams.tab||e;for(var r=0,n=this.navModel.main.children;r<n.length;r++){var a=n[r];a.id===this.tab&&(a.active=!0)}},t.prototype.init=function(){var t=this;return this.backendSrv.get("/api/plugins/"+this.pluginId+"/settings").then(function(e){return t.model=e,t.pluginIcon=t.getPluginIcon(t.model.type),t.model.dependencies.plugins.forEach(function(e){e.icon=t.getPluginIcon(e.type)}),t.includes=I.a.map(e.includes,function(e){return e.icon=t.getPluginIcon(e.type),e}),t.setNavModel(t.model),t.initReadme()})},t.prototype.initReadme=function(){var t=this;return this.backendSrv.get("/api/plugins/"+this.pluginId+"/markdown/readme").then(function(e){var r=new qt.a({linkify:!0});t.readmeHtml=t.$sce.trustAsHtml(r.render(e))})},t.prototype.getPluginIcon=function(t){switch(t){case"datasource":return"icon-gf icon-gf-datasources";case"panel":return"icon-gf icon-gf-panel";case"app":return"icon-gf icon-gf-apps";case"page":return"icon-gf icon-gf-endpoint-tiny";case"dashboard":return"icon-gf icon-gf-dashboard";default:return"icon-gf icon-gf-apps"}},t.prototype.update=function(){var t=this;this.preUpdateHook().then(function(){var e=I.a.extend({enabled:t.model.enabled,pinned:t.model.pinned,jsonData:t.model.jsonData,secureJsonData:t.model.secureJsonData},{});return t.backendSrv.post("/api/plugins/"+t.pluginId+"/settings",e)}).then(this.postUpdateHook).then(function(t){window.location.href=window.location.href})},t.prototype.importDashboards=function(){return Promise.resolve()},t.prototype.setPreUpdateHook=function(t){this.preUpdateHook=t},t.prototype.setPostUpdateHook=function(t){this.postUpdateHook=t},t.prototype.updateAvailable=function(){var t=this.$scope.$new(!0);t.plugin=this.model,this.$rootScope.appEvent("show-modal",{src:"public/app/features/plugins/partials/update_instructions.html",scope:t})},t.prototype.enable=function(){this.model.enabled=!0,this.model.pinned=!0,this.update()},t.prototype.disable=function(){this.model.enabled=!1,this.model.pinned=!1,this.update()},t}();L.a.module("grafana.controllers").controller("PluginEditCtrl",Ol);var Il={},Nl=function(){function t(t,e,r,n){this.backendSrv=t,this.$routeParams=e,this.$rootScope=r,this.navModelSrv=n,this.pluginId=e.pluginId,Il[this.pluginId]?this.initPage(Il[this.pluginId]):this.loadPluginInfo()}return t.$inject=["backendSrv","$routeParams","$rootScope","navModelSrv"],t.prototype.initPage=function(t){if(this.appModel=t,this.page=I.a.find(t.includes,{slug:this.$routeParams.slug}),Il[this.pluginId]=t,!this.page)return this.$rootScope.appEvent("alert-error",["App Page Not Found",""]),void(this.navModel=this.navModelSrv.getNotFoundNav());var e=this.navModelSrv.getNav("plugin-page-"+t.id);this.navModel={main:{img:t.info.logos.large,subTitle:t.name,url:"",text:this.page.name,breadcrumbs:[{title:t.name,url:e.main.url}]}}},t.prototype.loadPluginInfo=function(){var t=this;this.backendSrv.get("/api/plugins/"+this.pluginId+"/settings").then(function(e){t.initPage(e)})},t}();L.a.module("grafana.controllers").controller("AppPageCtrl",Nl);var Fl=function(){function t(t,e,r){var n=this;this.backendSrv=e,this.$rootScope=r,this.dashboards=[],e.get("/api/plugins/"+this.plugin.id+"/dashboards").then(function(t){n.dashboards=t}),bt.a.on("dashboard-list-import-all",this.importAll.bind(this),t)}return t.$inject=["$scope","backendSrv","$rootScope"],t.prototype.importAll=function(t){return this.importNext(0).then(function(){t.resolve("All dashboards imported")}).catch(function(e){t.reject(e)})},t.prototype.importNext=function(t){var e=this;return this.import(this.dashboards[t],!0).then(function(){return t+1<e.dashboards.length?new Promise(function(r){setTimeout(function(){e.importNext(t+1).then(function(){r()})},500)}):Promise.resolve()})},t.prototype.import=function(t,e){var r=this,n={pluginId:this.plugin.id,path:t.path,overwrite:e,inputs:[]};return this.datasource&&n.inputs.push({name:"*",type:"datasource",pluginId:this.datasource.type,value:this.datasource.name}),this.backendSrv.post("/api/dashboards/import",n).then(function(e){r.$rootScope.appEvent("alert-success",["Dashboard Imported",t.title]),I.a.extend(t,e)})},t.prototype.remove=function(t){var e=this;this.backendSrv.delete("/api/dashboards/"+t.importedUri).then(function(){e.$rootScope.appEvent("alert-success",["Dashboard Deleted",t.title]),t.imported=!1})},t}();z.c.directive("dashboardImportList",function(){return{restrict:"E",templateUrl:"public/app/features/plugins/import_list/import_list.html",controller:Fl,bindToController:!0,controllerAs:"ctrl",scope:{plugin:"=",datasource:"="}}});var ql=r(34);var Ll=[],Rl={name:"",type:"graphite",url:"",access:"proxy",jsonData:{},secureJsonFields:{},secureJsonData:{}},jl=!1,Ul=function(){function t(t,e,r,n,a){var i=this;this.$q=t,this.backendSrv=e,this.$routeParams=r,this.$location=n,this.datasourceSrv=a;var s=Z.b.getState();this.navModel=Object(ql.a)(s.navIndex,"datasources"),this.datasources=[],this.loadDatasourceTypes().then(function(){i.$routeParams.id?i.getDatasourceById(i.$routeParams.id):i.initNewDatasourceModel()})}return t.$inject=["$q","backendSrv","$routeParams","$location","datasourceSrv"],t.prototype.initNewDatasourceModel=function(){this.isNew=!0,this.current=I.a.cloneDeep(Rl),this.$location.search().gettingstarted&&(this.gettingStarted=!0,this.current.isDefault=!0),this.typeChanged()},t.prototype.loadDatasourceTypes=function(){var t=this;return Ll.length>0?(this.types=Ll,this.$q.when(null)):this.backendSrv.get("/api/plugins",{enabled:1,type:"datasource"}).then(function(e){Ll=e,t.types=e})},t.prototype.getDatasourceById=function(t){var e=this;this.backendSrv.get("/api/datasources/"+t).then(function(t){return e.isNew=!1,e.current=t,jl&&(jl=!1,e.testDatasource()),e.typeChanged()})},t.prototype.userChangedType=function(){this.current=I.a.defaults({id:this.current.id,name:this.current.name,isDefault:this.current.isDefault,type:this.current.type},I.a.cloneDeep(Rl)),this.typeChanged()},t.prototype.updateNav=function(){this.navModel=function(t,e,r){var n="New",a="Type: "+e.name;t.id&&(n=t.name);var i={img:e.info.logos.large,id:"ds-edit-"+e.id,subTitle:a,url:"",text:n,breadcrumbs:[{title:"Data Sources",url:"datasources"}],children:[{active:"datasource-settings"===r,icon:"fa fa-fw fa-sliders",id:"datasource-settings",text:"Settings",url:"datasources/edit/"+t.id}]};return void 0!==I.a.find(e.includes,{type:"dashboard"})&&t.id&&i.children.push({active:"datasource-dashboards"===r,icon:"fa fa-fw fa-th-large",id:"datasource-dashboards",text:"Dashboards",url:"datasources/edit/"+t.id+"/dashboards"}),B.a.buildInfo.isEnterprise&&i.children.push({active:"datasource-permissions"===r,icon:"fa fa-fw fa-lock",id:"datasource-permissions",text:"Permissions",url:"datasources/edit/"+t.id+"/permissions"}),{main:i,node:I.a.find(i.children,{active:!0})}}(this.current,this.datasourceMeta,"datasource-settings")},t.prototype.typeChanged=function(){var t=this;return this.backendSrv.get("/api/plugins/"+this.current.type+"/settings").then(function(e){t.datasourceMeta=e,t.updateNav()})},t.prototype.updateFrontendSettings=function(){var t=this;return this.backendSrv.get("/api/frontend/settings").then(function(e){B.a.datasources=e.datasources,B.a.defaultDatasource=e.defaultDatasource,t.datasourceSrv.init()})},t.prototype.testDatasource=function(){var t=this;return this.datasourceSrv.get(this.current.name).then(function(e){if(e.testDatasource)return t.testing={done:!1,status:"error"},t.backendSrv.withNoBackendCache(function(){return e.testDatasource().then(function(e){t.testing.message=e.message,t.testing.status=e.status}).catch(function(e){e.statusText?t.testing.message="HTTP Error "+e.statusText:t.testing.message=e.message})}).finally(function(){t.testing.done=!0})})},t.prototype.saveChanges=function(){var t=this;if(this.editForm.$valid&&!this.current.readOnly)return this.current.id?this.backendSrv.put("/api/datasources/"+this.current.id,this.current).then(function(e){return t.current=e.datasource,t.updateNav(),t.updateFrontendSettings().then(function(){return t.testDatasource()})}):this.backendSrv.post("/api/datasources",this.current).then(function(e){t.current=e.datasource,t.updateFrontendSettings(),jl=!0,t.$location.path("datasources/edit/"+e.id)})},t.prototype.confirmDelete=function(){var t=this;this.backendSrv.delete("/api/datasources/"+this.current.id).then(function(){t.$location.path("datasources")})},t.prototype.delete=function(t){var e=this;G.c.emit("confirm-modal",{title:"删除",text:"你确定要删除这个数据源吗?",yesText:"删除",icon:"fa-trash",onConfirm:function(){e.confirmDelete()}})},t}();G.e.controller("DataSourceEditCtrl",Ul),G.e.directive("datasourceHttpSettings",function(){return{scope:{current:"=",suggestUrl:"@",noDirectAccess:"@"},templateUrl:"public/app/features/plugins/partials/ds_http_settings.html",link:{pre:function(t,e,r){t.showAccessOption="true"!==t.noDirectAccess,t.showAccessHelp=!1,t.toggleAccessHelp=function(){t.showAccessHelp=!t.showAccessHelp},t.getSuggestUrls=function(){return[t.suggestUrl]}}}}});var Vl=function(t){function e(e,r){return t.call(this,e,r)||this}return e.$inject=["$scope","$injector"],J.c(e,t),e.templateUrl="public/app/plugins/panel/unknown/module.html",e}(Lt);function Bl(t,e,r,n,a,i,s){function o(t,e){if(t)return 0===t.indexOf("public")?t:e+"/"+t}function l(t,e){var r={name:"panel-plugin-"+t.panel.type,bindings:{dashboard:"=",panel:"=",row:"="},attrs:{dashboard:"dashboard",panel:"panel",class:"panel-height-helper"}},s=B.a.panels[t.panel.type],l=Promise.resolve(Vl);return s&&(l=ll(s.module).then(function(t){return t.PanelCtrl})),l.then(function(t){return r.Component=t,!t||t.registered?r:t.templatePromise?t.templatePromise.then(function(t){return r}):(s&&(t.templateUrl=o(t.templateUrl,s.baseUrl)),t.templatePromise=function(t){if(t.template)return n.when(t.template);var e=i.get(t.templateUrl);return e?n.when(e):a.get(t.templateUrl).then(function(t){return t.data})}(t).then(function(e){return t.templateUrl=null,t.template='<grafana-panel ctrl="ctrl" class="panel-editor-container">'+e+"</grafana-panel>",r}),t.templatePromise)})}function c(e,r,n,a){if(a.notFound)r.empty();else{if(!a.Component)throw{message:"Failed to find exported plugin component for "+a.name};if(!a.Component.registered){var i=n.$normalize(a.name),s=function(t){return t.Component.templateUrl=o(t.Component.templateUrl,t.baseUrl),function(){return{templateUrl:t.Component.templateUrl,template:t.Component.template,restrict:"E",controller:t.Component,controllerAs:"ctrl",bindToController:!0,scope:t.bindings,link:function(t,e,r,n){n.link&&n.link(t,e,r,n),n.init&&n.init()}}}}(a);z.c.directive(i,s),a.Component.registered=!0}!function(e,r,n){var a=L.a.element(document.createElement(n.name));I.a.each(n.attrs,function(t,e){a.attr(e,t)}),t(a)(e),r.empty(),setTimeout(function(){e.$applyAsync(function(){r.append(a),setTimeout(function(){e.$applyAsync(function(){e.$broadcast("component-did-mount")})})})})}(e,r,a)}}return{restrict:"E",link:function(t,r,a){(function(t,r){switch(r.type){case"query-ctrl":var a=t.target.datasource||t.ctrl.panel.datasource;return e.get(a).then(function(e){return t.datasource=e,ll(e.meta.module).then(function(t){return{baseUrl:e.meta.baseUrl,name:"query-ctrl-"+e.meta.id,bindings:{target:"=",panelCtrl:"=",datasource:"="},attrs:{target:"target","panel-ctrl":"ctrl.panelCtrl",datasource:"datasource"},Component:t.QueryCtrl}})});case"query-options-ctrl":return e.get(t.ctrl.panel.datasource).then(function(t){return ll(t.meta.module).then(function(e){var r=e;return r.QueryOptionsCtrl?{baseUrl:t.meta.baseUrl,name:"query-options-ctrl-"+t.meta.id,bindings:{panelCtrl:"="},attrs:{"panel-ctrl":"ctrl.panelCtrl"},Component:r.QueryOptionsCtrl}:{notFound:!0}})});case"annotations-query-ctrl":return ll(t.ctrl.currentDatasource.meta.module).then(function(e){return{baseUrl:t.ctrl.currentDatasource.meta.baseUrl,name:"annotations-query-ctrl-"+t.ctrl.currentDatasource.meta.id,bindings:{annotation:"=",datasource:"="},attrs:{annotation:"ctrl.currentAnnotation",datasource:"ctrl.currentDatasource"},Component:e.AnnotationsQueryCtrl}});case"datasource-config-ctrl":var i=t.ctrl.datasourceMeta;return ll(i.module).then(function(t){return t.ConfigCtrl?{baseUrl:i.baseUrl,name:"ds-config-"+i.id,bindings:{meta:"=",current:"="},attrs:{meta:"ctrl.datasourceMeta",current:"ctrl.current"},Component:t.ConfigCtrl}:{notFound:!0}});case"app-config-ctrl":var s=t.ctrl.model;return ll(s.module).then(function(t){return{baseUrl:s.baseUrl,name:"app-config-"+s.id,bindings:{appModel:"=",appEditCtrl:"="},attrs:{"app-model":"ctrl.model","app-edit-ctrl":"ctrl"},Component:t.ConfigCtrl}});case"app-page":var o=t.ctrl.appModel;return ll(o.module).then(function(e){return{baseUrl:o.baseUrl,name:"app-page-"+o.id+"-"+t.ctrl.page.slug,bindings:{appModel:"="},attrs:{"app-model":"ctrl.appModel"},Component:e[t.ctrl.page.component]}});case"panel":return l(t);default:return n.reject({message:"Could not find component type: "+r.type})}})(t,a).then(function(e){c(t,r,a,e)}).catch(function(t){console.log("Plugin component error",t)})}}}z.c.directive("pluginComponent",Bl);var Ql=function(t){function e(e){var r=t.call(this,e)||this;return r.state={value:e.query},r}return J.c(e,t),e.prototype.handleChange=function(t){this.setState({value:t.target.value})},e.prototype.handleBlur=function(t){this.props.onChange(t.target.value,t.target.value)},e.prototype.render=function(){var t=this;return j.a.createElement("div",{className:"gf-form"},j.a.createElement("span",{className:"gf-form-label width-10"},"Query"),j.a.createElement("input",{type:"text",className:"gf-form-input",value:this.state.value,onChange:function(e){return t.handleChange(e)},onBlur:function(e){return t.handleBlur(e)},placeholder:"metric name or tags query",required:!0}))},e}(R.PureComponent);function Hl(t){var e=this;return{restrict:"E",link:function(r,n){return J.b(e,void 0,void 0,function(){var e,a;return J.d(this,function(i){switch(i.label){case 0:return[4,function(t){return J.b(this,void 0,void 0,function(){var e;return J.d(this,function(r){switch(r.label){case 0:return[4,ll(t)];case 1:return(e=r.sent())&&e.VariableQueryEditor?[2,e.VariableQueryEditor]:[2,Ql]}})})}(r.currentDatasource.meta.module)];case 1:return e=i.sent(),a={datasource:r.currentDatasource,query:r.current.query,onChange:r.onQueryChange,templateSrv:t},V.a.render(j.a.createElement(e,J.a({},a)),n[0]),r.$on("$destroy",function(){V.a.unmountComponentAtNode(n[0])}),[2]}})})}}}z.c.directive("variableQueryEditorLoader",Hl);var zl=function(){function t(t,e,r,n,a,i,s,o,l,c,u){this.$scope=t,this.keybindingSrv=e,this.timeSrv=r,this.variableSrv=n,this.alertingSrv=a,this.dashboardSrv=i,this.unsavedChangesSrv=s,this.dashboardViewStateSrv=o,this.annotationsSrv=l,this.playlistSrv=c,this.backendSrv=u,t.ctrl=this,this.editTab=0,this.getPanelContainer=this.getPanelContainer.bind(this)}return t.$inject=["$scope","keybindingSrv","timeSrv","variableSrv","alertingSrv","dashboardSrv","unsavedChangesSrv","dashboardViewStateSrv","annotationsSrv","playlistSrv","backendSrv"],t.prototype.setupDashboard=function(t){try{this.setupDashboardInternal(t)}catch(t){this.onInitFailed(t,"仪表盘初始化失败",!0)}},t.prototype.setupDashboardInternal=function(t){var e=this,r=this.dashboardSrv.create(t.dashboard,t.meta);this.dashboardSrv.setCurrent(r),this.timeSrv.init(r),this.alertingSrv.init(r,t.alerts),this.annotationsSrv.init(r),this.variableSrv.init(r).catch(this.onInitFailed.bind(this,"模板初始化失败",!1)).finally(function(){e.dashboard=r,e.dashboard.processRepeats(),e.dashboard.updateSubmenuVisibility(),e.dashboard.autoFitPanels(window.innerHeight),e.unsavedChangesSrv.init(r,e.$scope),e.$scope.dashboard=r,e.dashboardViewState=e.dashboardViewStateSrv.create(e.$scope),e.keybindingSrv.setupDashboardBindings(e.$scope,r),e.setWindowTitleAndTheme(),bt.a.emit("dashboard-initialized",r)}).catch(this.onInitFailed.bind(this,"仪表盘初始化失败",!0))},t.prototype.onInitFailed=function(t,e,r){console.log(t,r),r.data&&r.data.message?r.message=r.data.message:r.message||(r={message:r.toString()}),this.$scope.appEvent("alert-error",[t,r.message]),e&&!this.loadedFallbackDashboard&&(this.loadedFallbackDashboard=!0,this.setupDashboard({dashboard:{title:"仪表盘初始化失败"}}))},t.prototype.templateVariableUpdated=function(){this.dashboard.processRepeats()},t.prototype.setWindowTitleAndTheme=function(){window.document.title=B.a.windowTitlePrefix+this.dashboard.title},t.prototype.hiddenOrShowClick=function(){this.$scope.dashboard.showTimes=!this.$scope.dashboard.showTimes,bt.a.emit("toggle-kiosk-mode")},t.prototype.showJsonEditor=function(t,e){var r={object:e.object,updateHandler:e.updateHandler};this.$scope.appEvent("show-dash-editor",{src:"public/app/partials/edit_json.html",model:r})},t.prototype.getDashboard=function(){return this.dashboard},t.prototype.getPanelContainer=function(){return this},t.prototype.onRemovingPanel=function(t,e){if((e=e||{}).panelId){var r=this.dashboard.getPanelInfoById(e.panelId);$t(this.dashboard,r.panel,!0)}},t.prototype.onDestroy=function(){this.dashboard&&this.dashboard.destroy()},t.prototype.init=function(t){var e=this;this.$scope.onAppEvent("show-json-editor",this.showJsonEditor.bind(this)),this.$scope.onAppEvent("template-variable-value-updated",this.templateVariableUpdated.bind(this)),this.$scope.onAppEvent("panel-remove",this.onRemovingPanel.bind(this)),this.$scope.$on("$destroy",this.onDestroy.bind(this)),this.setupDashboard(t),this.backendSrv.get("/api/user/preferences").then(function(t){e.backgroundUrl=t.backgroundUrl?"url(public/img/"+t.backgroundUrl+") no-repeat":"none"})},t}();z.c.controller("DashboardCtrl",zl);var Gl=function(){function t(){}return t.prototype.init=function(t,e){this.dashboard=t,this.alerts=e||[]},t}();z.c.service("alertingSrv",Gl);var Wl=function(){function t(t){this.backendSrv=t}return t.$inject=["backendSrv"],t.prototype.getHistoryList=function(t,e){var r=t&&t.id?t.id:void 0;return r?this.backendSrv.get("api/dashboards/id/"+r+"/versions",e):Promise.resolve([])},t.prototype.calculateDiff=function(t){return this.backendSrv.post("api/dashboards/calculate-diff",t)},t.prototype.restoreDashboard=function(t,e){var r=t&&t.id?t.id:void 0,n="api/dashboards/id/"+r+"/restore";return r&&I.a.isNumber(e)?this.backendSrv.post(n,{version:e}):Promise.resolve({})},t}();z.c.service("historySrv",Wl);var Yl=function(){function t(t,e,r,n,a,i){this.$route=t,this.$rootScope=e,this.$location=r,this.$q=n,this.historySrv=a,this.$scope=i,this.appending=!1,this.diff="basic",this.limit=10,this.loading=!1,this.max=2,this.mode="list",this.start=0,this.canCompare=!1,this.$rootScope.onAppEvent("dashboard-saved",this.onDashboardSaved.bind(this),i),this.resetFromSource()}return t.$inject=["$route","$rootScope","$location","$q","historySrv","$scope"],t.prototype.onDashboardSaved=function(){this.resetFromSource()},t.prototype.switchMode=function(t){this.mode=t,"list"===this.mode&&this.reset()},t.prototype.dismiss=function(){this.$rootScope.appEvent("hide-dash-editor")},t.prototype.addToLog=function(){this.start=this.start+this.limit,this.getLog(!0)},t.prototype.revisionSelectionChanged=function(){var t=I.a.filter(this.revisions,{checked:!0}).length;this.canCompare=2===t},t.prototype.formatDate=function(t){return this.dashboard.formatDate(t)},t.prototype.formatBasicDate=function(t){var e="browser"===this.dashboard.timezone?H()():H.a.utc();return("browser"===this.dashboard.timezone?H()(t):H.a.utc(t)).from(e)},t.prototype.getDiff=function(t){var e=this;if(this.diff=t,this.mode="compare",this.delta[this.diff])return this.$q.when(this.delta[this.diff]);var r=I.a.filter(this.revisions,{checked:!0});this.newInfo=r[0],this.baseInfo=r[1],this.isNewLatest=this.newInfo.version===this.dashboard.version,this.loading=!0;var n={new:{dashboardId:this.dashboard.id,version:this.newInfo.version},base:{dashboardId:this.dashboard.id,version:this.baseInfo.version},diffType:t};return this.historySrv.calculateDiff(n).then(function(t){e.delta[e.diff]=t}).catch(function(){e.mode="list"}).finally(function(){e.loading=!1})},t.prototype.getLog=function(t){var e=this;void 0===t&&(t=!1),this.loading=!t,this.appending=t;var r={limit:this.limit,start:this.start};return this.historySrv.getHistoryList(this.dashboard,r).then(function(r){for(var n=0,a=r;n<a.length;n++){var i=a[n];i.createdDateString=e.formatDate(i.created),i.ageString=e.formatBasicDate(i.created),i.checked=!1}e.revisions=t?e.revisions.concat(r):r}).catch(function(t){e.loading=!1}).finally(function(){e.loading=!1,e.appending=!1})},t.prototype.isLastPage=function(){return I.a.find(this.revisions,function(t){return 1===t.version})},t.prototype.reset=function(){this.delta={basic:"",json:""},this.diff="basic",this.mode="list",this.revisions=I.a.map(this.revisions,function(t){return I.a.extend({},t,{checked:!1})}),this.canCompare=!1,this.start=0,this.isNewLatest=!1},t.prototype.resetFromSource=function(){return this.revisions=[],this.getLog().then(this.reset.bind(this))},t.prototype.restore=function(t){this.$rootScope.appEvent("confirm-modal",{title:"Restore version",text:"",text2:"Are you sure you want to restore the dashboard to version "+t+"? All unsaved changes will be lost.",icon:"fa-history",yesText:"Yes, restore to version "+t,onConfirm:this.restoreConfirm.bind(this,t)})},t.prototype.restoreConfirm=function(t){var e=this;return this.loading=!0,this.historySrv.restoreDashboard(this.dashboard,t).then(function(r){e.$location.url(W.a.stripBaseFromUrl(r.url)).replace(),e.$route.reload(),e.$rootScope.appEvent("alert-success",["Dashboard restored","Restored from version "+t])}).catch(function(){e.mode="list",e.loading=!1})},t}();L.a.module("grafana.directives").directive("gfDashboardHistory",function(){return{restrict:"E",templateUrl:"public/app/features/dashboard/history/history.html",controller:Yl,bindToController:!0,controllerAs:"ctrl",scope:{dashboard:"="}}});var Kl=function(){function t(t,e,r,n,a,i,s,o,l){this.backendSrv=t,this.dashboardSrv=e,this.datasourceSrv=r,this.$http=n,this.$q=a,this.$timeout=i,this.$routeParams=o,this.$rootScope=l}return t.$inject=["backendSrv","dashboardSrv","datasourceSrv","$http","$q","$timeout","contextSrv","$routeParams","$rootScope"],t.prototype._dashboardLoadFailed=function(t,e){return{meta:{canStar:!1,isSnapshot:e=e||!1,canDelete:!1,canSave:!1,canEdit:!1,dashboardNotFound:!0},dashboard:{title:t}}},t.prototype.loadDashboard=function(t,e,r){var n,a=this;return(n="script"===t?this._loadScriptedDashboard(e):"snapshot"===t?this.backendSrv.get("/api/snapshots/"+e).catch(function(){return a._dashboardLoadFailed("未发现快照",!0)}):this.backendSrv.getDashboardByUid(r).then(function(t){if(t.meta.isFolder)throw a.$rootScope.appEvent("alert-error",["未发现仪表盘"]),new Error("未发现仪表盘");return t}).catch(function(){return a._dashboardLoadFailed("未发现",!0)})).then(function(t){return!0!==t.meta.dashboardNotFound&&_e.a.addDashboardImpression(t.dashboard.id),t}),n},t.prototype._loadScriptedDashboard=function(t){var e=this,r="public/dashboards/"+t.replace(/\.(?!js)/,"/")+"?"+(new Date).getTime();return this.$http({url:r,method:"GET"}).then(this._executeScript.bind(this)).then(function(t){return{meta:{fromScript:!0,canDelete:!1,canSave:!1,canStar:!1},dashboard:t.data}},function(t){return console.log("脚本仪表盘错误 "+t),e.$rootScope.appEvent("alert-error",["脚本错误","请确保它存在并返回一个有效的仪表板"]),e._dashboardLoadFailed("Scripted dashboard")})},t.prototype._executeScript=function(t){var e=this,r={dashboardSrv:this.dashboardSrv,datasourceSrv:this.datasourceSrv,$q:this.$q},n=new Function("ARGS","kbn","dateMath","_","moment","window","document","$","jQuery","services",t.data)(this.$routeParams,kt.a,Ct,I.a,H.a,window,document,F.a,F.a,r);if(I.a.isFunction(n)){var a=this.$q.defer();return n(function(t){e.$timeout(function(){a.resolve({data:t})})}),a.promise}return{data:n}},t}();L.a.module("grafana.services").service("dashboardLoaderSrv",Kl);var Jl=function(){function t(t,e,r,n,a){if(this.$scope=t,this.dashboardSrv=e,this.$location=r,this.playlistSrv=n,this.$interval=a,G.c.on("save-dashboard",this.saveDashboard.bind(this),t),t.nowTime=H()(new Date).format("YYYY-MM-DD HH:mm:ss"),a(function(){t.nowTime=H()(new Date).format("YYYY-MM-DD HH:mm:ss")},1e3),this.dashboard.meta.isSnapshot){var i=this.dashboard.meta;this.titleTooltip="Created: &nbsp;"+H()(i.created).calendar(),i.expires&&(this.titleTooltip+="<br>Expires: &nbsp;"+H()(i.expires).fromNow()+"<br>")}}return t.$inject=["$scope","dashboardSrv","$location","playlistSrv","$interval"],t.prototype.toggleSettings=function(){var t=this.$location.search();t.editview?delete t.editview:t.editview="settings",this.$location.search(t)},t.prototype.toggleViewMode=function(){G.c.emit("toggle-kiosk-mode")},t.prototype.close=function(){var t=this.$location.search();t.editview?delete t.editview:t.fullscreen&&(delete t.fullscreen,delete t.edit,delete t.tab,delete t.panelId),this.$location.search(t)},t.prototype.starDashboard=function(){var t=this;this.dashboardSrv.starDashboard(this.dashboard.id,this.dashboard.meta.isStarred).then(function(e){t.dashboard.meta.isStarred=e})},t.prototype.shareDashboard=function(t){var e=this.$scope.$new();e.tabIndex=t,e.dashboard=this.dashboard,G.c.emit("show-modal",{src:"public/app/features/dashboard/partials/shareModal.html",scope:e})},t.prototype.hideTooltip=function(t){L.a.element(t.currentTarget).tooltip("hide")},t.prototype.saveDashboard=function(){return this.dashboardSrv.saveDashboard()},t.prototype.showSearch=function(){G.c.emit("show-dash-search")},t.prototype.addPanel=function(){G.c.emit("dash-scroll",{animate:!0,evt:0}),this.dashboard.panels.length>0&&"add-panel"===this.dashboard.panels[0].type||this.dashboard.addPanel({type:"add-panel",gridPos:{x:0,y:0,w:12,h:9},title:"Panel Title"})},t.prototype.navItemClicked=function(t,e){t.clickHandler&&(t.clickHandler(),e.preventDefault())},t.prototype.printPage=function(){window.print()},t}();L.a.module("grafana.directives").directive("dashnav",function(){return{restrict:"E",templateUrl:"public/app/features/dashboard/dashnav/dashnav.html",controller:Jl,bindToController:!0,controllerAs:"ctrl",transclude:!0,scope:{dashboard:"="}}});var Xl=function(){function t(t,e,r){this.variableSrv=t,this.templateSrv=e,this.$location=r,this.annotations=this.dashboard.templating.list,this.variables=this.variableSrv.variables,this.templateSrv=e}return t.$inject=["variableSrv","templateSrv","$location"],t.prototype.annotationStateChanged=function(){this.dashboard.startRefresh()},t.prototype.getValuesForTag=function(t,e){return this.variableSrv.getValuesForTag(t,e)},t.prototype.regDCandJZ=function(t){var e=this.templateSrv.replaceWithText("$jz"),r=this.templateSrv.replaceWithText("$dc");if("$jz"!==e&&(t=t.replace("${jz}",e)),"$dc"!==r&&(t=t.replace("${dc}",r)),this.templateSrv.variables&&this.templateSrv.variables.length>0&&this.templateSrv.variables[0].current)for(var n=0;n<this.templateSrv.variables.length;n++)if(-1===t.indexOf("@name")){var a="[["+this.templateSrv.variables[n].name+"]]",i=this.templateSrv.variables[n].current.value;this.templateSrv.variables[n].name&&i&&(t=t.replace(a,i))}else{var s="[["+this.templateSrv.variables[n].name+"@name]]",o=this.templateSrv.variables[n].current.text;this.templateSrv.variables[n].name&&o&&(t=t.replace(s,o))}return document.getElementById("a-spacial-class-sd").style.backgroundColor=this.dashboard.bgColor,t},t.prototype.variableUpdated=function(t){this.variableSrv.variableUpdated(t,!0)},t.prototype.openEditView=function(t){var e=I.a.extend(this.$location.search(),{editview:t});this.$location.search(e)},t}();L.a.module("grafana.directives").directive("dashboardSubmenu",function(){return{restrict:"E",templateUrl:"public/app/features/dashboard/submenu/submenu.html",controller:Xl,bindToController:!0,controllerAs:"ctrl",scope:{dashboard:"="}}});var Zl='\n<div class="modal-body">\n\t<div class="modal-header">\n\t\t<h2 class="modal-header-title">\n\t\t\t<i class="fa fa-copy"></i>\n\t\t\t<span class="p-l-1">保存为...</span>\n\t\t</h2>\n\n\t\t<a class="modal-header-close" ng-click="ctrl.dismiss();">\n\t\t\t<i class="fa fa-remove"></i>\n\t\t</a>\n\t</div>\n\n\t<form name="ctrl.saveForm" class="modal-content" novalidate>\n\t\t<div class="p-t-2">\n\t\t\t<div class="gf-form">\n\t\t\t\t<label class="gf-form-label width-7">新名称</label>\n\t\t\t\t<input type="text" class="gf-form-input" ng-model="ctrl.clone.title" give-focus="true" required>\n\t\t\t</div>\n      <div class="gf-form">\n        <folder-picker initial-folder-id="ctrl.folderId"\n                       on-change="ctrl.onFolderChange($folder)"\n                       enter-folder-creation="ctrl.onEnterFolderCreation()"\n                       exit-folder-creation="ctrl.onExitFolderCreation()"\n                       enable-create-new="true"\n                       label-class="width-7">\n        </folder-picker>\n      </div>\n\t\t</div>\n\n\t\t<div class="gf-form-button-row text-center">\n\t\t\t<button type="submit" class="btn btn-success" ng-click="ctrl.save()" ng-disabled="!ctrl.isValidFolderSelection">保存</button>\n\t\t\t<a class="btn-text" ng-click="ctrl.dismiss();">取消</a>\n\t\t</div>\n\t</form>\n</div>\n',tc=function(){function t(t){this.dashboardSrv=t,this.isValidFolderSelection=!0;var e=this.dashboardSrv.getCurrent();this.clone=e.getSaveModelClone(),this.clone.id=null,this.clone.uid="",this.clone.title+=" Copy",this.clone.editable=!0,this.clone.hideControls=!1,this.folderId=e.meta.folderId,e.id>0&&this.clone.panels.forEach(function(t){"graph"===t.type&&t.alert&&delete t.thresholds,delete t.alert}),delete this.clone.autoUpdate}return t.$inject=["dashboardSrv"],t.prototype.save=function(){return this.dashboardSrv.save(this.clone,{folderId:this.folderId}).then(this.dismiss)},t.prototype.keyDown=function(t){13===t.keyCode&&this.save()},t.prototype.onFolderChange=function(t){this.folderId=t.id},t.prototype.onEnterFolderCreation=function(){this.isValidFolderSelection=!1},t.prototype.onExitFolderCreation=function(){this.isValidFolderSelection=!0},t}();z.c.directive("saveDashboardAsModal",function(){return{restrict:"E",template:Zl,controller:tc,bindToController:!0,controllerAs:"ctrl",scope:{dismiss:"&"}}});var ec='\n<div class="modal-body">\n  <div class="modal-header">\n    <h2 class="modal-header-title">\n      <i class="fa fa-save"></i>\n      <span class="p-l-1">保存更改</span>\n    </h2>\n\n    <a class="modal-header-close" ng-click="ctrl.dismiss();">\n      <i class="fa fa-remove"></i>\n    </a>\n  </div>\n\n  <form name="ctrl.saveForm" ng-submit="ctrl.save()" class="modal-content" novalidate>\n    <div class="p-t-1">\n      <div class="gf-form-group" ng-if="ctrl.timeChange || ctrl.variableValueChange">\n\t\t    <gf-form-switch class="gf-form"\n\t\t\t    label="保存当前时间范围" ng-if="ctrl.timeChange" label-class="width-12" switch-class="max-width-6"\n\t\t\t    checked="ctrl.saveTimerange" on-change="buildUrl()">\n\t\t    </gf-form-switch>\n\t\t    <gf-form-switch class="gf-form"\n\t\t\t    label="保存当前变量" ng-if="ctrl.variableValueChange" label-class="width-12" switch-class="max-width-6"\n\t\t\t    checked="ctrl.saveVariables" on-change="buildUrl()">\n\t\t    </gf-form-switch>\n\t    </div>\n      <div class="gf-form">\n        <label class="gf-form-hint">\n          <input\n            type="text"\n            name="message"\n            class="gf-form-input"\n            placeholder="添加注释描述变化。"\n            give-focus="true"\n            ng-model="ctrl.message"\n            ng-model-options="{allowInvalid: true}"\n            ng-maxlength="this.max"\n            maxlength="64"\n            autocomplete="off" />\n          <small class="gf-form-hint-text muted" ng-cloak>\n            <span ng-class="{\'text-error\': ctrl.saveForm.message.$invalid && ctrl.saveForm.message.$dirty }">\n              {{ctrl.message.length || 0}}\n            </span>\n            / {{ctrl.max}} 特性\n          </small>\n        </label>\n      </div>\n    </div>\n\n    <div class="gf-form-button-row text-center">\n      <button\n        id="saveBtn"\n        type="submit"\n        class="btn btn-success"\n        ng-class="{\'btn-success--processing\': ctrl.isSaving}"\n        ng-disabled="ctrl.saveForm.$invalid || ctrl.isSaving"\n      >\n        <span ng-if="!ctrl.isSaving">保存</span>\n        <span ng-if="ctrl.isSaving === true">保存中...</span>\n      </button>\n      <button class="btn btn-inverse" ng-click="ctrl.dismiss();">取消</button>\n    </div>\n  </form>\n</div>\n',rc=function(){function t(t){this.dashboardSrv=t,this.saveVariables=!1,this.saveTimerange=!1,this.current=[],this.originalCurrent=[],this.timeChange=!1,this.variableValueChange=!1,this.message="",this.max=64,this.isSaving=!1,this.timeChange=this.dashboardSrv.getCurrent().hasTimeChanged(),this.variableValueChange=this.dashboardSrv.getCurrent().hasVariableValuesChanged()}return t.$inject=["dashboardSrv"],t.prototype.save=function(){if(this.saveForm.$valid){var t={saveVariables:this.saveVariables,saveTimerange:this.saveTimerange,message:this.message},e=this.dashboardSrv.getCurrent().getSaveModelClone(t);return this.isSaving=!0,this.dashboardSrv.save(e,t).then(this.postSave.bind(this,t))}},t.prototype.postSave=function(t){t.saveVariables&&this.dashboardSrv.getCurrent().resetOriginalVariables(),t.saveTimerange&&this.dashboardSrv.getCurrent().resetOriginalTime(),this.dismiss()},t}();z.c.directive("saveDashboardModal",function(){return{restrict:"E",template:ec,controller:rc,bindToController:!0,controllerAs:"ctrl",scope:{dismiss:"&"}}});var nc='\n<div class="modal-body">\n  <div class="modal-header">\n    <h2 class="modal-header-title">\n      <i class="fa fa-save"></i><span class="p-l-1">无法保存已配置的仪表板</span>\n    </h2>\n\n    <a class="modal-header-close" ng-click="ctrl.dismiss();">\n      <i class="fa fa-remove"></i>\n    </a>\n  </div>\n\n  <div class="modal-content">\n    <small>\n    这个仪表板不能在KAM的UI中保存，因为它是从另一个来源提供的。复制JSON或将其保存到下面的文件中。然后，您可以在相应的源中更新仪表板。\n    </small>\n    <div class="p-t-2">\n      <div class="gf-form">\n        <code-editor content="ctrl.dashboardJson" data-mode="json" data-max-lines=15></code-editor>\n      </div>\n      <div class="gf-form-button-row">\n        <button class="btn btn-success" clipboard-button="ctrl.getJsonForClipboard()">\n          <i class="fa fa-clipboard"></i>&nbsp;复制JSON到剪贴板\n        </button>\n        <button class="btn btn-secondary" clipboard-button="ctrl.save()">\n          <i class="fa fa-save"></i>&nbsp;将JSON保存到文件\n        </button>\n        <a class="btn btn-link" ng-click="ctrl.dismiss();">取消</a>\n      </div>\n    </div>\n  </div>\n</div>\n',ac=function(){function t(t){this.dash=t.getCurrent().getSaveModelClone(),delete this.dash.id,this.dashboardJson=L.a.toJson(this.dash,!0)}return t.$inject=["dashboardSrv"],t.prototype.save=function(){var t=new Blob([L.a.toJson(this.dash,!0)],{type:"application/json;charset=utf-8"});Object(D.saveAs)(t,this.dash.title+"-"+(new Date).getTime()+".json")},t.prototype.getJsonForClipboard=function(){return this.dashboardJson},t}();function ic(t,e,r,n,a,i,s){t.options={forCurrent:!0,includeTemplateVars:!0,theme:"current"},t.editor={index:t.tabIndex||0},t.init=function(){t.panel=t.model&&t.model.panel?t.model.panel:t.panel,t.dashboard=t.model&&t.model.dashboard?t.model.dashboard:t.dashboard,t.modeSharePanel=!!t.panel,t.tabs=[{title:"连接",src:"shareLink.html"}],t.modeSharePanel?(t.modalTitle="分享面板",t.tabs.push({title:"嵌入",src:"shareEmbed.html"})):t.modalTitle="分享",t.dashboard.meta.isSnapshot||t.tabs.push({title:"快照",src:"shareSnapshot.html"}),t.dashboard.meta.isSnapshot||t.modeSharePanel||t.tabs.push({title:"导出",src:"shareExport.html"}),t.buildUrl()},t.buildUrl=function(){var e=r.absUrl(),n=e.indexOf("?");-1!==n&&(e=e.substring(0,n));var o=L.a.copy(r.search()),l=a.timeRange();o.from=l.from.valueOf(),o.to=l.to.valueOf(),o.orgId=B.a.bootData.user.orgId,t.options.includeTemplateVars&&i.fillVariableValuesForUrl(o),t.options.forCurrent||(delete o.from,delete o.to),"current"!==t.options.theme&&(o.theme=t.options.theme),t.modeSharePanel?(o.panelId=t.panel.id,o.fullscreen=!0):(delete o.panelId,delete o.fullscreen),t.shareUrl=s.addParamsToUrl(e,o);var c=e.replace(B.a.appSubUrl+"/dashboard/",B.a.appSubUrl+"/dashboard-solo/");c=c.replace(B.a.appSubUrl+"/d/",B.a.appSubUrl+"/d-solo/"),delete o.fullscreen,delete o.edit,c=s.addParamsToUrl(c,o),t.iframeHtml='<iframe src="'+c+'" width="450" height="200" frameborder="0"></iframe>',t.imageUrl=c.replace(B.a.appSubUrl+"/dashboard-solo/",B.a.appSubUrl+"/render/dashboard-solo/"),t.imageUrl=t.imageUrl.replace(B.a.appSubUrl+"/d-solo/",B.a.appSubUrl+"/render/d-solo/"),t.imageUrl+="&width=1000&height=500"+t.getLocalTimeZone()},t.getLocalTimeZone=function(){var t="&tz=UTC"+encodeURIComponent(H()().format("Z"));if(!window.Intl)return t;var e=window.Intl.DateTimeFormat();if(!e.resolvedOptions)return t;var r=e.resolvedOptions();return r.timeZone?"&tz="+encodeURIComponent(r.timeZone):t},t.getShareUrl=function(){return t.shareUrl}}z.c.directive("saveProvisionedDashboardModal",function(){return{restrict:"E",template:nc,controller:ac,bindToController:!0,controllerAs:"ctrl",scope:{dismiss:"&"}}}),L.a.module("grafana.controllers").controller("ShareModalCtrl",ic);var sc=function(){function t(t,e,r,n,a,i){t.snapshot={name:t.dashboard.title,expires:0,timeoutSeconds:4},t.step=1,t.expireOptions=[{text:"1 Hour",value:3600},{text:"1 Day",value:86400},{text:"7 Days",value:604800},{text:"Never",value:0}],t.accessOptions=[{text:"Anyone with the link",value:1},{text:"Organization users",value:2},{text:"Public on the web",value:3}],t.init=function(){n.get("/api/snapshot/shared-options").then(function(e){t.externalUrl=e.externalSnapshotURL,t.sharingButtonText=e.externalSnapshotName,t.externalEnabled=e.externalEnabled})},t.apiUrl="/api/snapshots",t.createSnapshot=function(e){t.dashboard.snapshot={timestamp:new Date},e||(t.dashboard.snapshot.originalUrl=r.absUrl()),t.loading=!0,t.snapshot.external=e,t.dashboard.startRefresh(),a(function(){t.saveSnapshot(e)},1e3*t.snapshot.timeoutSeconds)},t.saveSnapshot=function(e){var a=t.dashboard.getSaveModelClone();t.scrubDashboard(a);var i={dashboard:a,name:a.title,expires:t.snapshot.expires},s=e?t.externalUrl+t.apiUrl:t.apiUrl;n.post(s,i).then(function(n){if(t.loading=!1,e)t.deleteUrl=n.deleteUrl,t.snapshotUrl=n.url,t.saveExternalSnapshotRef(i,n);else{var a=r.url(),s=r.absUrl();"/"!==a&&(s=s.replace(a,"")+"/"),t.snapshotUrl=s+"dashboard/snapshot/"+n.key,t.deleteUrl=s+"api/snapshots-delete/"+n.deleteKey}t.step=2},function(){t.loading=!1})},t.getSnapshotUrl=function(){return t.snapshotUrl},t.scrubDashboard=function(e){if(e.title=t.snapshot.name,e.time=i.timeRange(),I.a.each(e.panels,function(t){t.targets=[],t.links=[],t.datasource=null}),e.annotations.list=I.a.chain(e.annotations.list).filter(function(t){return t.enable}).map(function(t){return{name:t.name,enable:t.enable,iconColor:t.iconColor,snapshotData:t.snapshotData,type:t.type,builtIn:t.builtIn,hide:t.hide}}).value(),I.a.each(e.templating.list,function(t){t.query="",t.options=t.current,t.refresh=!1}),t.modeSharePanel){var r=t.panel.getSaveModel();r.gridPos.w=24,r.gridPos.x=0,r.gridPos.y=0,r.gridPos.h=20,e.panels=[r]}delete t.dashboard.snapshot,t.dashboard.forEachPanel(function(t){delete t.snapshotData}),I.a.each(t.dashboard.annotations.list,function(t){delete t.snapshotData})},t.deleteSnapshot=function(){n.get(t.deleteUrl).then(function(){t.step=3})},t.saveExternalSnapshotRef=function(t,e){t.external=!0,t.key=e.key,t.deleteKey=e.deleteKey,n.post("/api/snapshots/",t)}}return t.$inject=["$scope","$rootScope","$location","backendSrv","$timeout","timeSrv"],t}();L.a.module("grafana.controllers").controller("ShareSnapshotCtrl",sc);var oc=r(176),lc=function(){function t(t,e,r){this.backendSrv=t,this.$rootScope=e,this.$location=r}return t.$inject=["backendSrv","$rootScope","$location"],t.prototype.create=function(t,e){return new oc.a(t,e)},t.prototype.setCurrent=function(t){this.dash=t},t.prototype.getCurrent=function(){return this.dash},t.prototype.handleSaveDashboardError=function(t,e,r){var n=this;(e=e||{}).overwrite=!0,r.data&&"version-mismatch"===r.data.status&&(r.isHandled=!0,this.$rootScope.appEvent("confirm-modal",{title:"冲突",text:"有人更新了这个仪表板。",text2:"您还想保存这个仪表板吗?",yesText:"保存并且覆盖",icon:"fa-warning",onConfirm:function(){n.save(t,e)}})),r.data&&"name-exists"===r.data.status&&(r.isHandled=!0,this.$rootScope.appEvent("confirm-modal",{title:"冲突",text:"在选定的文件夹中已经存在同名的仪表盘。",text2:"您还想保存这个仪表板吗?",yesText:"保存并且覆盖",icon:"fa-warning",onConfirm:function(){n.save(t,e)}})),r.data&&"plugin-dashboard"===r.data.status&&(r.isHandled=!0,this.$rootScope.appEvent("confirm-modal",{title:"插件仪表板",text:r.data.message,text2:"当你更新插件时，你的更改将会丢失。使用另存为创建自定义版本。",yesText:"覆盖",icon:"fa-warning",altActionText:"保存为",onAltAction:function(){n.showSaveAsModal()},onConfirm:function(){n.save(t,{overwrite:!0})}}))},t.prototype.postSave=function(t,e){this.dash.version=e.version,this.$rootScope.appEvent("dashboard-saved",this.dash),this.$rootScope.appEvent("alert-success",["仪表盘已保存"]);var r=W.a.stripBaseFromUrl(e.url);return r!==this.$location.path()&&this.$location.url(r).replace(),this.dash},t.prototype.save=function(t,e){return(e=e||{}).folderId=e.folderId>=0?e.folderId:this.dash.meta.folderId||t.folderId,this.backendSrv.saveDashboard(t,e).then(this.postSave.bind(this,t)).catch(this.handleSaveDashboardError.bind(this,t,e))},t.prototype.saveDashboard=function(t,e){return e&&this.setCurrent(this.create(e,this.dash.meta)),this.dash.meta.provisioned?this.showDashboardProvisionedModal():this.dash.meta.canSave||!0===t.makeEditable?"新仪表盘"===this.dash.title?this.showSaveAsModal():this.dash.version>0?this.showSaveModal():this.save(this.dash.getSaveModelClone(),t):Promise.resolve()},t.prototype.saveJSONDashboard=function(t){return this.save(JSON.parse(t),{})},t.prototype.showDashboardProvisionedModal=function(){this.$rootScope.appEvent("show-modal",{templateHtml:'<save-provisioned-dashboard-modal dismiss="dismiss()"></save-provisioned-dashboard-modal>'})},t.prototype.showSaveAsModal=function(){this.$rootScope.appEvent("show-modal",{templateHtml:'<save-dashboard-as-modal dismiss="dismiss()"></save-dashboard-as-modal>',modalClass:"modal--narrow"})},t.prototype.showSaveModal=function(){this.$rootScope.appEvent("show-modal",{templateHtml:'<save-dashboard-modal dismiss="dismiss()"></save-dashboard-modal>',modalClass:"modal--narrow"})},t.prototype.starDashboard=function(t,e){var r=this;return(e?this.backendSrv.delete("/api/user/stars/dashboard/"+t).then(function(){return!1}):this.backendSrv.post("/api/user/stars/dashboard/"+t).then(function(){return!0})).then(function(e){return r.dash&&r.dash.id===t&&(r.dash.meta.isStarred=e),e})},t}();z.c.service("dashboardSrv",lc);var cc=function(){function t(t,e,r){this.$location=e,this.$timeout=r;var n=this;n.state={},n.panelScopes=[],n.$scope=t,n.dashboard=t.dashboard,t.onAppEvent("$routeUpdate",function(){var t=n.getQueryStringState();n.needsSync(t)&&n.update(t,!0)}),t.onAppEvent("panel-change-view",function(t,e){n.update(e)}),e.replace(),this.update(this.getQueryStringState())}return t.$inject=["$scope","$location","$timeout"],t.prototype.needsSync=function(t){return!1===I.a.isEqual(this.state,t)},t.prototype.getQueryStringState=function(){var t=this.$location.search();return t.panelId=parseInt(t.panelId,10)||null,t.fullscreen=!!t.fullscreen||null,t.edit="true"===t.edit||!0===t.edit||null,t.editview=t.editview||null,t.orgId=B.a.bootData.user.orgId,t},t.prototype.serializeToUrl=function(){var t=I.a.clone(this.state);return t.fullscreen=!!this.state.fullscreen||null,t.edit=!!this.state.edit||null,t},t.prototype.update=function(t,e){t.toggle&&(delete t.toggle,this.state.fullscreen&&t.fullscreen&&this.state.edit===t.edit&&(t.fullscreen=!t.fullscreen)),I.a.extend(this.state,t),this.dashboard.meta.fullscreen=this.state.fullscreen,this.state.fullscreen||(this.state.fullscreen=null,this.state.edit=null,this.dashboard.meta.soloMode||(this.state.panelId=null)),(this.state.fullscreen||this.dashboard.meta.soloMode)&&this.state.panelId&&this.toggleCollapsedPanelRow(this.state.panelId),this.state.edit||delete this.state.tab,!0!==e&&this.$location.search(this.serializeToUrl()),this.syncState()},t.prototype.toggleCollapsedPanelRow=function(t){for(var e=0,r=this.dashboard.panels;e<r.length;e++){var n=r[e];if(n.collapsed)for(var a=0,i=n.panels;a<i.length;a++){if(i[a].id===t)return void this.dashboard.toggleRow(n)}}},t.prototype.syncState=function(){if(this.dashboard.meta.fullscreen){var t=this.dashboard.getPanelById(this.state.panelId);if(!t)return;t.fullscreen?this.dashboard.meta.isEditing!==this.state.edit&&this.dashboard.setViewMode(t,this.state.fullscreen,this.state.edit):this.enterFullscreen(t)}else this.fullscreenPanel&&this.leaveFullscreen()},t.prototype.leaveFullscreen=function(){var t=this,e=this.fullscreenPanel;this.dashboard.setViewMode(e,!1,!1),delete this.fullscreenPanel,this.$timeout(function(){bt.a.emit("dash-scroll",{restore:!0}),t.oldTimeRange!==t.dashboard.time?t.dashboard.startRefresh():t.dashboard.render()})},t.prototype.enterFullscreen=function(t){var e=this.state.edit&&this.dashboard.meta.canEdit;this.oldTimeRange=this.dashboard.time,this.fullscreenPanel=t,this.$scope.appEvent("dash-scroll",{animate:!1,pos:0}),this.dashboard.setViewMode(t,!0,e)},t}();function uc(t,e){return{create:function(r){return new cc(r,t,e)}}}L.a.module("grafana.services").factory("dashboardViewStateSrv",uc);var dc="dash-folder",pc="dash-db",hc=function(){function t(t,e){this.$q=t,this.backendSrv=e,this.rootName="general"}return t.$inject=["$q","backendSrv"],t.prototype.validateNewDashboardName=function(t,e){return this.validate(t,e,"此文件夹中已存在同名的指示板")},t.prototype.validateNewFolderName=function(t){return this.validate(0,t,"默认文件夹中已存在同名的文件夹或指示板")},t.prototype.validate=function(t,e,r){var n=(e=(e||"").trim()).toLowerCase();if(0===e.length)return this.$q.reject({type:"REQUIRED",message:"名字是必需的"});if(0===t&&n===this.rootName)return this.$q.reject({type:"EXISTING",message:"这是保留名称，不能用于文件夹。"});var a=this.$q.defer(),i=[];return i.push(this.backendSrv.search({type:dc,folderIds:[t],query:e})),i.push(this.backendSrv.search({type:pc,folderIds:[t],query:e})),this.$q.all(i).then(function(t){var e=[];t.length>0&&t[0].length>0&&(e=t[0]),t.length>1&&t[1].length>0&&(e=e.concat(t[1]));for(var i=0,s=e;i<s.length;i++){var o=s[i];if(n===o.title.toLowerCase()){a.reject({type:"EXISTING",message:r});break}}a.resolve()}),a.promise},t}();z.c.service("validationSrv",hc);var fc=function(){function t(t,e,r,n,a,i,s,o){var l=this;this.$location=n,this.$timeout=i,this.contextSrv=s,this.$rootScope=o,this.$location=n,this.$window=a,this.current=t,this.originalPath=n.path(),this.scope=e,e.onAppEvent("dashboard-saved",function(){l.original=l.current.getSaveModelClone(),l.originalPath=n.path()}),a.onbeforeunload=function(){if(!l.ignoreChanges())return l.hasChanges()?"There are unsaved changes to this dashboard":void 0},e.$on("$locationChangeStart",function(t,e){return l.originalPath===n.path()||(!!l.ignoreChanges()||(l.hasChanges()&&(t.preventDefault(),l.next=e,l.$timeout(function(){l.open_modal()})),!1))}),r?this.$timeout(function(){l.original=t.getSaveModelClone()},r):this.original=t.getSaveModelClone()}return t.$inject=["dashboard","scope","originalCopyDelay","$location","$window","$timeout","contextSrv","$rootScope"],t.prototype.ignoreChanges=function(){if(!this.original)return!0;if(!this.contextSrv.isEditor)return!0;if(!this.current||!this.current.meta)return!0;var t=this.current.meta;return!t.canSave||t.fromScript||t.fromFile},t.prototype.cleanDashboardFromIgnoredChanges=function(t){var e=new oc.a(t);e.expandRows();var r=e.getSaveModelClone();return r.time=0,r.refresh=0,r.schemaVersion=0,delete r.iteration,r.panels=I.a.filter(r.panels,function(t){return!t.repeatPanelId&&(t.scopedVars=null,t.legend&&(delete t.legend.sort,delete t.legend.sortDesc),!0)}),I.a.each(r.templating.list,function(t){t.current=null,t.options=null,t.filters=null}),r},t.prototype.hasChanges=function(){var t=this.cleanDashboardFromIgnoredChanges(this.current.getSaveModelClone()),e=this.cleanDashboardFromIgnoredChanges(this.original),r=I.a.find(t.nav,{type:"timepicker"}),n=I.a.find(e.nav,{type:"timepicker"});return r&&n&&(r.now=n.now),L.a.toJson(t,!0)!==L.a.toJson(e,!0)},t.prototype.discardChanges=function(){this.original=null,this.gotoNext()},t.prototype.open_modal=function(){this.$rootScope.appEvent("show-modal",{templateHtml:'<unsaved-changes-modal dismiss="dismiss()"></unsaved-changes-modal>',modalClass:"modal--narrow confirm-modal"})},t.prototype.saveChanges=function(){var t=this,e=this,r=this.$rootScope.$on("dashboard-saved",function(){r(),t.$timeout(function(){e.gotoNext()})});this.$rootScope.appEvent("save-dashboard")},t.prototype.gotoNext=function(){var t=this.$location.absUrl().length-this.$location.url().length,e=this.next.substring(t);this.$location.url(e)},t}();function mc(t,e,r,n,a,i,s){this.init=function(e,i){return this.tracker=new fc(e,i,1e3,r,s,n,a,t),this.tracker}}L.a.module("grafana.services").service("unsavedChangesSrv",mc);var gc='\n<div class="modal-body">\n  <div class="modal-header">\n    <h2 class="modal-header-title">\n      <i class="fa fa-exclamation"></i>\n      <span class="p-l-1">未保存的更改</span>\n    </h2>\n\n    <a class="modal-header-close" ng-click="ctrl.dismiss();">\n      <i class="fa fa-remove"></i>\n    </a>\n  </div>\n\n  <div class="modal-content text-center">\n\n    <div class="confirm-modal-text">\n      您想保存更改吗?\n    </div>\n\n    <div class="confirm-modal-buttons">\n      <button type="button" class="btn btn-success" ng-click="ctrl.save()">保存</button>\n      <button type="button" class="btn btn-danger" ng-click="ctrl.discard()">丢弃</button>\n      <button type="button" class="btn btn-inverse" ng-click="ctrl.dismiss()">取消</button>\n    </div>\n  </div>\n</div>\n',vc=function(){function t(t){this.unsavedChangesSrv=t}return t.$inject=["unsavedChangesSrv"],t.prototype.discard=function(){this.dismiss(),this.unsavedChangesSrv.tracker.discardChanges()},t.prototype.save=function(){this.dismiss(),this.unsavedChangesSrv.tracker.saveChanges()},t}();z.c.directive("unsavedChangesModal",function(){return{restrict:"E",template:gc,controller:vc,bindToController:!0,controllerAs:"ctrl",scope:{dismiss:"&"}}});var bc=function(){function t(e,r,n){var a=this;this.$scope=e,this.$rootScope=r,this.timeSrv=n,this.$scope.ctrl=this,r.onAppEvent("shift-time-forward",function(){return a.move(1)},e),r.onAppEvent("shift-time-backward",function(){return a.move(-1)},e),r.onAppEvent("closeTimepicker",this.openDropdown.bind(this),e),this.dashboard.on("refresh",this.onRefresh.bind(this),e),this.panel=this.dashboard.timepicker,I.a.defaults(this.panel,t.defaults),this.firstDayOfWeek=H.a.localeData().firstDayOfWeek(),this.onRefresh()}return t.$inject=["$scope","$rootScope","timeSrv"],t.prototype.onRefresh=function(){var t=L.a.copy(this.timeSrv.timeRange()),e=L.a.copy(t.raw);this.dashboard.isTimezoneUtc()?this.isUtc=!0:(t.from.local(),t.to.local(),H.a.isMoment(e.from)&&e.from.local(),H.a.isMoment(e.to)&&e.to.local(),this.isUtc=!1),this.rangeString=Rt.b(e),this.absolute={fromJs:t.from.toDate(),toJs:t.to.toDate()},this.tooltip=this.dashboard.formatDate(t.from)+" <br>to<br>",this.tooltip+=this.dashboard.formatDate(t.to),this.timeRaw=e,this.isAbsolute=H.a.isMoment(this.timeRaw.to)},t.prototype.zoom=function(t){this.$rootScope.appEvent("zoom-out",2)},t.prototype.move=function(t){var e,r,n=this.timeSrv.timeRange(),a=(n.to.valueOf()-n.from.valueOf())/2;-1===t?(e=n.to.valueOf()-a,r=n.from.valueOf()-a):1===t?(e=n.to.valueOf()+a,r=n.from.valueOf()+a,e>Date.now()&&n.to<Date.now()&&(e=Date.now(),r=n.from.valueOf())):(e=n.to.valueOf(),r=n.from.valueOf()),this.timeSrv.setTime({from:H.a.utc(r),to:H.a.utc(e)})},t.prototype.openDropdown=function(){this.isOpen?this.closeDropdown():(this.onRefresh(),this.editTimeRaw=this.timeRaw,this.timeOptions=Rt.c(this.panel,this.rangeString),this.refresh={value:this.dashboard.refresh,options:I.a.map(this.panel.refresh_intervals,function(t){return{text:t,value:t}})},this.refresh.options.unshift({text:"off"}),this.isOpen=!0,this.$rootScope.appEvent("timepickerOpen"))},t.prototype.closeDropdown=function(){this.isOpen=!1,this.$rootScope.appEvent("timepickerClosed")},t.prototype.applyCustom=function(){this.refresh.value!==this.dashboard.refresh&&this.timeSrv.setAutoRefresh(this.refresh.value),this.timeSrv.setTime(this.editTimeRaw),this.closeDropdown()},t.prototype.absoluteFromChanged=function(){this.editTimeRaw.from=this.getAbsoluteMomentForTimezone(this.absolute.fromJs)},t.prototype.absoluteToChanged=function(){this.editTimeRaw.to=this.getAbsoluteMomentForTimezone(this.absolute.toJs)},t.prototype.getAbsoluteMomentForTimezone=function(t){return this.dashboard.isTimezoneUtc()?H()(t).utc():H()(t)},t.prototype.setRelativeFilter=function(t){var e={from:t.from,to:t.to};this.panel.nowDelay&&"now"===e.to&&(e.to="now-"+this.panel.nowDelay),this.timeSrv.setTime(e),this.closeDropdown()},t.tooltipFormat="MMM D, YYYY HH:mm:ss",t.defaults={time_options:["5m","15m","1h","6h","12h","24h","2d","7d","30d"],refresh_intervals:["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"]},t}();L.a.module("grafana.directives").directive("gfTimePickerSettings",function(){return{restrict:"E",templateUrl:"public/app/features/dashboard/timepicker/settings.html",controller:bc,bindToController:!0,controllerAs:"ctrl",scope:{dashboard:"="}}}),L.a.module("grafana.directives").directive("gfTimePicker",function(){return{restrict:"E",templateUrl:"public/app/features/dashboard/timepicker/timepicker.html",controller:bc,bindToController:!0,controllerAs:"ctrl",scope:{dashboard:"="}}}),L.a.module("grafana.directives").directive("inputDatetime",function(){return{restrict:"A",require:"ngModel",link:function(t,e,r,n){var a="YYYY-MM-DD HH:mm:ss";n.$parsers.push(function(e){return-1!==e.indexOf("now")?Ct.isValid(e)?(n.$setValidity("error",!0),e):void n.$setValidity("error",!1):(r=t.ctrl.isUtc?H.a.utc(e,a):H()(e,a)).isValid()?(n.$setValidity("error",!0),r):void n.$setValidity("error",!1);var r}),n.$formatters.push(function(t){return H.a.isMoment(t)?t.format(a):t})}}});var yc='\n<input type="file" id="dashupload" name="dashupload" class="hide" onchange="angular.element(this).scope().file_selected"/>\n<label class="btn btn-success" for="dashupload">\n  <i class="fa fa-upload"></i>\n  {{btnText}}\n</label>\n';function wc(t,e){return{restrict:"E",template:yc,scope:{onUpload:"&",btnText:"@?"},link:function(t,e){t.btnText=L.a.isDefined(t.btnText)?t.btnText:"上传json文件";var r=window;r.File&&r.FileReader&&r.FileList&&r.Blob?e[0].addEventListener("change",function(e){for(var r=e.target.files,n=0,a=r[n];a;){var i=new FileReader;i.onload=function(e){var r;try{r=JSON.parse(e.target.result)}catch(t){return console.log(t),void bt.a.emit("alert-error",["导入失败","JSON -> JS序列化失败: "+t.message])}t.$apply(function(){t.onUpload({dash:r})})},i.readAsText(a),a=r[n+=1]}},!1):bt.a.emit("alert-error",["Oops","这个浏览器不完全支持HTML5文件api"])}}}z.c.directive("dashUpload",wc);var xc=function(){function t(t){this.datasourceSrv=t}return t.prototype.makeExportable=function(t){var e=this;t.cleanUpRepeats();var r=t.getSaveModelClone();r.id=null,t.processRepeats();for(var n=[],a={},i={},s=[],o={},l=0,c=r.templating.list;l<c.length;l++){var u=c[l];o[u.name]=u}for(var d=function(t){var r=t.datasource,n=null;r&&0===r.indexOf("$")&&(n=o[r.substring(1)])&&n.current&&(r=n.current.value),s.push(e.datasourceSrv.get(r).then(function(e){if(!e.meta.builtIn&&(a["datasource"+e.meta.id]={type:"datasource",id:e.meta.id,name:e.meta.name,version:e.meta.info.version||"1.0.0"},!n)){var r="DS_"+e.name.replace(" ","_").toUpperCase();i[r]={name:r,label:e.name,description:"",type:"datasource",pluginId:e.meta.id,pluginName:e.meta.name},t.datasource="${"+r+"}"}}))},p=function(t){if(void 0!==t.datasource&&d(t),t.targets)for(var e=0,r=t.targets;e<r.length;e++){var n=r[e];void 0!==n.datasource&&d(n)}var i=B.a.panels[t.type];i&&(a["panel"+i.id]={type:"panel",id:i.id,name:i.name,version:i.info.version})},h=0,f=r.panels;h<f.length;h++){var m=f[h];if(p(m),void 0!==m.collapsed&&!0===m.collapsed&&m.panels)for(var g=0,v=m.panels;g<v.length;g++){p(v[g])}}for(var b=0,y=r.templating.list;b<y.length;b++){"query"===(u=y[b]).type&&(d(u),u.options=[],u.current={},u.refresh=u.refresh>0?u.refresh:1)}for(var w=0,x=r.annotations.list;w<x.length;w++){var S=x[w];d(S)}return a.grafana={type:"grafana",id:"grafana",name:"Grafana",version:B.a.buildInfo.version},Promise.all(s).then(function(){I.a.each(i,function(t,e){n.push(t)});for(var t=0,e=r.templating.list;t<e.length;t++){var s=e[t];if("constant"===s.type){var o="VAR_"+s.name.replace(" ","_").toUpperCase();n.push({name:o,type:"constant",label:s.label||s.name,value:s.current.value,description:""}),s.query="${"+o+"}",s.options[0]=s.current={value:s.query,text:s.query}}}var l={};return l.__inputs=n,l.__requires=I.a.sortBy(a,["id"]),I.a.defaults(l,r),l}).catch(function(t){return console.log("Export failed:",t),{error:t}})},t}(),Sc=function(){function t(t,e,r,n){this.dashboardSrv=t,this.$scope=r,this.$rootScope=n,this.exporter=new xc(e),this.dash=this.dashboardSrv.getCurrent()}return t.$inject=["dashboardSrv","datasourceSrv","$scope","$rootScope"],t.prototype.saveDashboardAsFile=function(){var t=this;this.shareExternally?this.exporter.makeExportable(this.dash).then(function(e){t.$scope.$apply(function(){t.openSaveAsDialog(e)})}):this.openSaveAsDialog(this.dash.getSaveModelClone())},t.prototype.viewJson=function(){var t=this;this.shareExternally?this.exporter.makeExportable(this.dash).then(function(e){t.$scope.$apply(function(){t.openJsonModal(e)})}):this.openJsonModal(this.dash.getSaveModelClone())},t.prototype.openSaveAsDialog=function(t){var e=new Blob([L.a.toJson(t,!0)],{type:"application/json;charset=utf-8"});Object(D.saveAs)(e,t.title+"-"+(new Date).getTime()+".json")},t.prototype.openJsonModal=function(t){var e={object:t,enableCopy:!0};this.$rootScope.appEvent("show-modal",{src:"public/app/partials/edit_json.html",model:e}),this.dismiss()},t}();z.c.directive("dashExportModal",function(){return{restrict:"E",templateUrl:"public/app/features/dashboard/export/export_modal.html",controller:Sc,bindToController:!0,controllerAs:"ctrl",scope:{dismiss:"&"}}});var kc=function(){function t(){this.asRows=!0,this.dateTimeFormat="YYYY-MM-DDTHH:mm:ssZ",this.excel=!1}return t.prototype.export=function(){"table"===this.panel?Se(this.data,this.excel):this.asRows?be(this.data,this.dateTimeFormat,this.excel):we(this.data,this.dateTimeFormat,this.excel),this.dismiss()},t.prototype.dismiss=function(){bt.a.emit("hide-modal")},t}();L.a.module("grafana.directives").directive("exportDataModal",function(){return{restrict:"E",templateUrl:"public/app/features/dashboard/export_data/export_data_modal.html",controller:kc,controllerAs:"ctrl",scope:{panel:"<",data:"<"},bindToController:!0}});var Cc=function(){function t(t,e,r,n,a,i){this.uiSegmentSrv=t,this.datasourceSrv=e,this.$q=r,this.variableSrv=n,this.$rootScope=i,this.removeTagFilterSegment=t.newSegment({fake:!0,value:"-- remove filter --"}),this.buildSegmentModel(),this.$rootScope.onAppEvent("template-variable-value-updated",this.buildSegmentModel.bind(this),a)}return t.$inject=["uiSegmentSrv","datasourceSrv","$q","variableSrv","$scope","$rootScope"],t.prototype.buildSegmentModel=function(){this.segments=[],this.variable.value&&I.a.isArray(this.variable.value);for(var t=0,e=this.variable.filters;t<e.length;t++){var r=e[t];this.segments.length>0&&this.segments.push(this.uiSegmentSrv.newCondition("AND")),void 0!==r.key&&void 0!==r.value&&(this.segments.push(this.uiSegmentSrv.newKey(r.key)),this.segments.push(this.uiSegmentSrv.newOperator(r.operator)),this.segments.push(this.uiSegmentSrv.newKeyValue(r.value)))}this.segments.push(this.uiSegmentSrv.newPlusButton())},t.prototype.getOptions=function(t,e){var r=this;return"operator"===t.type?this.$q.when(this.uiSegmentSrv.newOperators(["=","!=","<",">","=~","!~"])):"condition"===t.type?this.$q.when([this.uiSegmentSrv.newSegment("AND")]):this.datasourceSrv.get(this.variable.datasource).then(function(n){var a={},i=null;return"value"!==t.type?i=n.getTagKeys?n.getTagKeys():Promise.resolve([]):(a.key=r.segments[e-2].value,i=n.getTagValues?n.getTagValues(a):Promise.resolve([])),i.then(function(e){return e=I.a.map(e,function(t){return r.uiSegmentSrv.newSegment({value:t.text})}),"key"===t.type&&e.splice(0,0,L.a.copy(r.removeTagFilterSegment)),e})})},t.prototype.segmentChanged=function(t,e){this.segments[e]=t,t.value===this.removeTagFilterSegment.value?(this.segments.splice(e,3),0===this.segments.length?this.segments.push(this.uiSegmentSrv.newPlusButton()):this.segments.length>2&&(this.segments.splice(Math.max(e-1,0),1),"plus-button"!==this.segments[this.segments.length-1].type&&this.segments.push(this.uiSegmentSrv.newPlusButton()))):("plus-button"===t.type&&(e>2&&this.segments.splice(e,0,this.uiSegmentSrv.newCondition("AND")),this.segments.push(this.uiSegmentSrv.newOperator("=")),this.segments.push(this.uiSegmentSrv.newFake("select value","value","query-segment-value")),t.type="key",t.cssClass="query-segment-key"),e+1===this.segments.length&&this.segments.push(this.uiSegmentSrv.newPlusButton())),this.updateVariableModel()},t.prototype.updateVariableModel=function(){var t=[],e=-1,r=!1;this.segments.forEach(function(n){if("value"===n.type&&n.fake)r=!0;else switch(n.type){case"key":t.push({key:n.value}),e+=1;break;case"value":t[e].value=n.value;break;case"operator":t[e].operator=n.value;break;case"condition":t[e].condition=n.value}}),r||(this.variable.setFilters(t),this.variableSrv.variableUpdated(this.variable,!0))},t}(),Tc='\n<div class="gf-form-inline">\n  <div class="gf-form" ng-repeat="segment in ctrl.segments">\n    <metric-segment segment="segment" get-options="ctrl.getOptions(segment, $index)"\n                    on-change="ctrl.segmentChanged(segment, $index)"></metric-segment>\n  </div>\n</div>\n';z.c.directive("adHocFilters",function(){return{restrict:"E",template:Tc,controller:Cc,bindToController:!0,controllerAs:"ctrl",scope:{variable:"="}}});var Ec='\n<div class="gf-form-select-wrapper max-width-18">\n  <select class="gf-form-input" ng-model="panel.repeat" ng-options="f.value as f.text for f in variables" ng-change="optionChanged()">\n  <option value=""></option>\n</div>\n';function _c(t){return{restrict:"E",template:Ec,scope:{panel:"="},link:function(e,r){r.css({display:"block",width:"100%"}),e.variables=t.variables.map(function(t){return{text:t.name,value:t.name}}),0===e.variables.length&&e.variables.unshift({text:"未发现模板变量",value:null}),e.variables.unshift({text:"禁用",value:null}),e.panel.repeat&&!e.panel.repeatDirection&&(e.panel.repeatDirection="h"),e.optionChanged=function(){e.panel.repeat&&(e.panel.repeatDirection="h")}}}}G.e.directive("dashRepeatOption",_c);var Mc=r(57),Ac=r(638),Pc=r.n(Ac),$c=function(t){function e(e){var r=t.call(this,e)||this;return r.state={collapsed:r.props.panel.collapsed},r.toggle=r.toggle.bind(r),r.openSettings=r.openSettings.bind(r),r.delete=r.delete.bind(r),r.update=r.update.bind(r),r}return J.c(e,t),e.prototype.toggle=function(){this.props.dashboard.toggleRow(this.props.panel),this.setState(function(t){return{collapsed:!t.collapsed}})},e.prototype.update=function(){this.props.dashboard.processRepeats(),this.forceUpdate()},e.prototype.openSettings=function(){bt.a.emit("show-modal",{templateHtml:'<row-options row="model.row" on-updated="model.onUpdated()" dismiss="dismiss()"></row-options>',modalClass:"modal--narrow",model:{row:this.props.panel,onUpdated:this.update.bind(this)}})},e.prototype.delete=function(){var t=this;bt.a.emit("confirm-modal",{title:"删除行",text:"你确定要删除此行以及此行下所有的仪表盘吗?",altActionText:"仅删除行",icon:"fa-trash",onConfirm:function(){t.props.dashboard.removeRow(t.props.panel,!0)},onAltAction:function(){t.props.dashboard.removeRow(t.props.panel,!1)}})},e.prototype.render=function(){var t=Dn()({"dashboard-row":!0,"dashboard-row--collapsed":this.state.collapsed}),e=Dn()({fa:!0,"fa-chevron-down":!this.state.collapsed,"fa-chevron-right":this.state.collapsed}),r=ls.replaceWithText(this.props.panel.title,this.props.panel.scopedVars),n=this.props.panel.panels?this.props.panel.panels.length:0,a=1===n?"panel":"panels",i=!0===this.props.dashboard.meta.canEdit;return j.a.createElement("div",{className:t},j.a.createElement("a",{className:"dashboard-row__title pointer",onClick:this.toggle},j.a.createElement("i",{className:e}),r,j.a.createElement("span",{className:"dashboard-row__panel_count"},"(",n," ",a,")")),i&&j.a.createElement("div",{className:"dashboard-row__actions"},j.a.createElement("a",{className:"pointer",onClick:this.openSettings},j.a.createElement("i",{className:"fa fa-cog"})),j.a.createElement("a",{className:"pointer",onClick:this.delete},j.a.createElement("i",{className:"fa fa-trash"}))),!0===this.state.collapsed&&j.a.createElement("div",{className:"dashboard-row__toggle-target",onClick:this.toggle}," "),i&&j.a.createElement("div",{className:"dashboard-row__drag grid-drag-handle"}))},e}(j.a.Component),Dc=r(170),Oc=r.n(Dc),Ic=function(t){function e(e){var r=t.call(this,e)||this;return r.handleRef=function(t){r.container=t},r}return J.c(e,t),e.prototype.componentDidMount=function(){this.scrollbar=Oc()({root:this.container.parentElement,scroller:this.container,bar:".baron__bar",barOnCls:"_scrollbar",scrollingCls:"_scrolling",track:".baron__track"})},e.prototype.componentDidUpdate=function(){this.scrollbar.update()},e.prototype.componentWillUnmount=function(){this.scrollbar.dispose()},e.prototype.setScrollTop=function(t){return!!this.container&&(this.container.scrollTop=t,this.scrollbar.update(),!0)},e.prototype.setScrollLeft=function(t){return!!this.container&&(this.container.scrollLeft=t,this.scrollbar.update(),!0)},e.prototype.update=function(){this.scrollbar.update()},e.prototype.render=function(){return j.a.createElement("div",{className:"baron baron__root baron__clipper"},j.a.createElement("div",{className:this.props.className+" baron__scroller",ref:this.handleRef},this.props.children),j.a.createElement("div",{className:"baron__track"},j.a.createElement("div",{className:"baron__bar"})))},e}(j.a.Component),Nc=r(166),Fc=r.n(Nc),qc=function(t){function e(e){var r=t.call(this,e)||this;return r.onAddPanel=function(t){var e=r.props.dashboard,n=r.props.panel.gridPos,a={type:t.id,title:"面板标题",gridPos:{x:n.x,y:n.y,w:n.w,h:n.h}};"row"===t.id&&(a.title="行标题",a.gridPos={x:0,y:0}),t.defaults&&(I.a.defaults(a,t.defaults),a.gridPos.w=t.defaults.gridPos.w,a.gridPos.h=t.defaults.gridPos.h,a.title=t.defaults.title,At.a.delete(Pt.f)),e.addPanel(a),e.removePanel(r.props.panel)},r.handleCloseAddPanel=r.handleCloseAddPanel.bind(r),r.renderPanelItem=r.renderPanelItem.bind(r),r.panelSizeChanged=r.panelSizeChanged.bind(r),r.state={panelPlugins:r.getPanelPlugins(""),copiedPanelPlugins:r.getCopiedPanelPlugins(""),filter:"",tab:"Add"},r}return J.c(e,t),e.prototype.componentDidMount=function(){this.props.panel.events.on("panel-size-changed",this.panelSizeChanged)},e.prototype.componentWillUnmount=function(){this.props.panel.events.off("panel-size-changed",this.panelSizeChanged)},e.prototype.panelSizeChanged=function(){var t=this;setTimeout(function(){t.scrollbar.update()})},e.prototype.getPanelPlugins=function(t){var e=I.a.chain(B.a.panels).filter({hideFromList:!1}).map(function(t){return t}).value();return e.push({id:"row",name:"Row",sort:8,info:{logos:{small:"public/img/icn-row.svg"}}}),e=this.filterPanels(e,t),I.a.sortBy(e,"sort")},e.prototype.getCopiedPanelPlugins=function(t){var e=I.a.chain(B.a.panels).filter({hideFromList:!1}).map(function(t){return t}).value(),r=[],n=At.a.get(Pt.f);if(n){var a=JSON.parse(n),i=I.a.find(e,{id:a.type});if(i){var s=I.a.cloneDeep(i);s.name=a.title,s.sort=-1,s.defaults=a,r.push(s)}}return r=this.filterPanels(r,t),I.a.sortBy(r,"sort")},e.prototype.handleCloseAddPanel=function(t){t.preventDefault(),this.props.dashboard.removePanel(this.props.dashboard.panels[0])},e.prototype.renderText=function(t){var e=this.state.filter.split("");return j.a.createElement(Fc.a,{highlightClassName:"highlight-search-match",textToHighlight:t,searchWords:e})},e.prototype.renderPanelItem=function(t,e){var r=this;return j.a.createElement("div",{key:e,className:"add-panel__item",onClick:function(){return r.onAddPanel(t)},title:t.name},j.a.createElement("img",{className:"add-panel__item-img",src:t.info.logos.small}),j.a.createElement("div",{className:"add-panel__item-name"},this.renderText(t.name)))},e.prototype.noCopiedPanelPlugins=function(){return j.a.createElement("div",{className:"add-panel__no-panels"},"还没有复制面板。")},e.prototype.filterChange=function(t){this.setState({filter:t.target.value,panelPlugins:this.getPanelPlugins(t.target.value),copiedPanelPlugins:this.getCopiedPanelPlugins(t.target.value)})},e.prototype.filterKeyPress=function(t){if("Enter"===t.key){var e=I.a.head(this.state.panelPlugins);e&&this.onAddPanel(e)}},e.prototype.filterPanels=function(t,e){var r=new RegExp(e,"i");return t.filter(function(t){return r.test(t.name)})},e.prototype.openCopy=function(){this.setState({tab:"Copy",filter:"",panelPlugins:this.getPanelPlugins(""),copiedPanelPlugins:this.getCopiedPanelPlugins("")})},e.prototype.openAdd=function(){this.setState({tab:"Add",filter:"",panelPlugins:this.getPanelPlugins(""),copiedPanelPlugins:this.getCopiedPanelPlugins("")})},e.prototype.render=function(){var t,e=this,r=Dn()({"active active--panel":"Add"===this.state.tab,"":"Copy"===this.state.tab}),n=Dn()({"":"Add"===this.state.tab,"active active--panel":"Copy"===this.state.tab});return"Add"===this.state.tab?t=this.state.panelPlugins.map(this.renderPanelItem):"Copy"===this.state.tab&&(t=this.state.copiedPanelPlugins.length>0?this.state.copiedPanelPlugins.map(this.renderPanelItem):this.noCopiedPanelPlugins()),j.a.createElement("div",{className:"panel-container add-panel-container"},j.a.createElement("div",{className:"add-panel"},j.a.createElement("div",{className:"add-panel__header"},j.a.createElement("i",{className:"gicon gicon-add-panel"}),j.a.createElement("span",{className:"add-panel__title"},"新面板"),j.a.createElement("ul",{className:"gf-tabs"},j.a.createElement("li",{className:"gf-tabs-item"},j.a.createElement("div",{className:"gf-tabs-link pointer "+r,onClick:this.openAdd.bind(this)},"添加")),j.a.createElement("li",{className:"gf-tabs-item"},j.a.createElement("div",{className:"gf-tabs-link pointer "+n,onClick:this.openCopy.bind(this)},"粘贴"))),j.a.createElement("button",{className:"add-panel__close",onClick:this.handleCloseAddPanel},j.a.createElement("i",{className:"fa fa-close"}))),j.a.createElement(Ic,{ref:function(t){return e.scrollbar=t},className:"add-panel__items"},j.a.createElement("div",{className:"add-panel__searchbar"},j.a.createElement("label",{className:"gf-form gf-form--grow gf-form--has-input-icon"},j.a.createElement("input",{type:"text",autoFocus:!0,className:"gf-form-input gf-form--grow",placeholder:"面板搜索过滤器",value:this.state.filter,onChange:this.filterChange.bind(this),onKeyPress:this.filterKeyPress.bind(this)}),j.a.createElement("i",{className:"gf-form-input-icon fa fa-search"}))),t)))},e}(j.a.Component),Lc=function(t){var e="submenu"===t.type;return"divider"===t.type?j.a.createElement("li",{className:"divider"}):j.a.createElement("li",{className:e?"dropdown-submenu":null},j.a.createElement("a",{onClick:t.onClick},t.iconClassName&&j.a.createElement("i",{className:t.iconClassName}),j.a.createElement("span",{className:"dropdown-item-text"},t.text),t.shortcut&&j.a.createElement("span",{className:"dropdown-menu-item-shortcut"},t.shortcut)),t.children)},Rc=r(44),jc=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.renderItems=function(t,r){return void 0===r&&(r=!1),j.a.createElement("ul",{className:"dropdown-menu dropdown-menu--menu panel-menu",role:r?"":"menu"},t.map(function(t,r){return j.a.createElement(Lc,{key:""+t.text+r,type:t.type,text:t.text,iconClassName:t.iconClassName,onClick:t.onClick,shortcut:t.shortcut},t.subMenu&&e.renderItems(t.subMenu,!0))}))},e}return J.c(e,t),e.prototype.render=function(){var t=this.props,e=function(t,e){var r=[];r.push({text:"查看",iconClassName:"fa fa-fw fa-eye",onClick:function(){Z.b.dispatch(Object(Rc.c)({query:{panelId:e.id,edit:!1,fullscreen:!0},partial:!0}))},shortcut:"v"}),t.meta.canEdit&&r.push({text:"编辑",iconClassName:"fa fa-fw fa-edit",onClick:function(){Z.b.dispatch(Object(Rc.c)({query:{panelId:e.id,edit:!0,fullscreen:!0},partial:!0}))},shortcut:"e"}),r.push({text:"分享",iconClassName:"fa fa-fw fa-share",onClick:function(){Nt(t,e)},shortcut:"p s"});var n=[];return!e.fullscreen&&t.meta.canEdit&&(n.push({text:"创建副本",onClick:function(){Dt(t,e)},shortcut:"p d"}),n.push({text:"复制",onClick:function(){Ot(e)}})),n.push({text:"面板 JSON",onClick:function(){It(t,e)}}),r.push({type:"submenu",text:"更多...",iconClassName:"fa fa-fw fa-cube",subMenu:n}),t.meta.canEdit&&(r.push({type:"divider"}),r.push({text:"删除",iconClassName:"fa fa-fw fa-trash",onClick:function(){$t(t,e,!0)},shortcut:"p r"})),r}(t.dashboard,t.panel);return j.a.createElement("div",{className:"panel-menu-container dropdown"},this.renderItems(e))},e}(R.PureComponent),Uc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return J.c(e,t),e.prototype.render=function(){var t=Dn()({"panel-header":!0,"grid-drag-handle":!0}),e=this.props,r=e.panel,n=e.dashboard;return j.a.createElement("div",{className:t},j.a.createElement("span",{className:"panel-info-corner"},j.a.createElement("i",{className:"fa"}),j.a.createElement("span",{className:"panel-info-corner-inner"})),!1,j.a.createElement("div",{className:"panel-title-container"},j.a.createElement("div",{className:"panel-title"},j.a.createElement("span",{className:"icon-gf panel-alert-icon"}),j.a.createElement("span",{className:"panel-title-text","data-toggle":"dropdown"},r.title," ",j.a.createElement("span",{className:"fa fa-caret-down panel-menu-toggle"})),j.a.createElement(jc,{panel:r,dashboard:n}),j.a.createElement("span",{className:"panel-time-info"},j.a.createElement("i",{className:"fa fa-clock-o"})," 4m"))))},e}(R.PureComponent),Vc=function(t){function e(e){var r=t.call(this,e)||this;return r.issueQueries=function(){return J.b(r,void 0,void 0,function(){var t,e,r,n,a,i,s,o,l,c,u;return J.d(this,function(d){switch(d.label){case 0:if(t=this.props,e=t.isVisible,r=t.queries,n=t.datasource,a=t.panelId,i=t.dashboardId,s=t.timeRange,!e)return[2];if(!r.length)return this.setState({loading:Ki.c.Done}),[2];this.setState({loading:Ki.c.Loading}),d.label=1;case 1:return d.trys.push([1,4,,5]),[4,ul.get(n)];case 2:return o=d.sent(),l={timezone:"browser",panelId:a,dashboardId:i,range:s,rangeRaw:s.raw,interval:"1s",intervalMs:6e4,targets:r,maxDataPoints:500,scopedVars:{},cacheTimeout:null},console.log("Issuing DataPanel query",l),[4,o.query(l)];case 3:return c=d.sent(),console.log("Issuing DataPanel query Resp",c),this.setState({loading:Ki.c.Done,response:c,isFirstLoad:!1}),[3,5];case 4:return u=d.sent(),console.log("Loading error",u),this.setState({loading:Ki.c.Error,isFirstLoad:!1}),[3,5];case 5:return[2]}})})},r.state={loading:Ki.c.NotStarted,response:{data:[]},isFirstLoad:!0},r}return J.c(e,t),e.prototype.componentDidMount=function(){console.log("DataPanel mount")},e.prototype.componentDidUpdate=function(t){return J.b(this,void 0,void 0,function(){return J.d(this,function(e){return this.hasPropsChanged(t)?(this.issueQueries(),[2]):[2]})})},e.prototype.hasPropsChanged=function(t){return this.props.refreshCounter!==t.refreshCounter||this.props.isVisible!==t.isVisible},e.prototype.render=function(){var t=this.state,e=t.response,r=t.loading,n=t.isFirstLoad;console.log("data panel render");var a=e.data;return!n||r!==Ki.c.Loading&&r!==Ki.c.NotStarted?j.a.createElement(j.a.Fragment,null,this.loadingSpinner,this.props.children({timeSeries:a,loading:r})):j.a.createElement("div",{className:"loading"},j.a.createElement("p",null,"Loading"))},Object.defineProperty(e.prototype,"loadingSpinner",{get:function(){return this.state.loading===Ki.c.Loading?j.a.createElement("div",{className:"panel__loading"},j.a.createElement("i",{className:"fa fa-spinner fa-spin"})):null},enumerable:!0,configurable:!0}),e.defaultProps={isVisible:!0,panelId:1,dashboardId:1},e}(R.Component),Bc=function(t){function e(e){var r=t.call(this,e)||this;return r.onRefresh=function(){var t=gt.timeRange();r.setState(function(e){return J.a({},e,{refreshCounter:r.state.refreshCounter+1,timeRange:t})})},r.onRender=function(){console.log("onRender"),r.setState(function(t){return J.a({},t,{renderCounter:r.state.renderCounter+1})})},r.state={refreshCounter:0,renderCounter:0},r}return J.c(e,t),e.prototype.componentDidMount=function(){this.props.panel.events.on("refresh",this.onRefresh),this.props.panel.events.on("render",this.onRender),this.props.dashboard.panelInitialized(this.props.panel)},e.prototype.componentWillUnmount=function(){this.props.panel.events.off("refresh",this.onRefresh)},Object.defineProperty(e.prototype,"isVisible",{get:function(){return!this.props.dashboard.otherPanelInFullscreen(this.props.panel)},enumerable:!0,configurable:!0}),e.prototype.render=function(){var t=this.props,e=t.panel,r=t.dashboard,n=this.state,a=n.refreshCounter,i=n.timeRange,s=n.renderCounter,o=e.datasource,l=e.targets,c=this.props.component;return console.log("panelChrome render"),j.a.createElement("div",{className:"panel-container"},j.a.createElement(Uc,{panel:e,dashboard:r}),j.a.createElement("div",{className:"panel-content"},j.a.createElement(Vc,{datasource:o,queries:l,timeRange:i,isVisible:this.isVisible,refreshCounter:a},function(t){var r=t.loading,n=t.timeSeries;return console.log("panelcrome inner render"),j.a.createElement(c,{loading:r,timeSeries:n,timeRange:i,options:e.getOptions(),renderCounter:s})})))},e}(R.PureComponent),Qc=function(t){function e(e){return t.call(this,e)||this}return J.c(e,t),e.prototype.componentDidMount=function(){if(this.element){var t=this.props,e=t.panel,r=t.dashboard,n=fl(),a={ctrl:{panel:e,dashboard:r,refresh:function(){return e.refresh()}}};this.component=n.load(this.element,a,"<metrics-tab />")}},e.prototype.componentWillUnmount=function(){this.component&&this.component.destroy()},e.prototype.render=function(){var t=this;return j.a.createElement("div",{ref:function(e){return t.element=e},className:"panel-height-helper"})},e}(R.PureComponent),Hc=function(t){function e(e){var r=t.call(this,e)||this;return r.renderVizPlugin=function(t,e){var n=Dn()({"viz-picker__item":!0,"viz-picker__item--selected":t.id===r.props.currentType});return j.a.createElement("div",{key:e,className:n,onClick:function(){return r.props.onTypeChanged(t)},title:t.name},j.a.createElement("img",{className:"viz-picker__item-img",src:t.info.logos.small}),j.a.createElement("div",{className:"viz-picker__item-name"},t.name))},r.state={pluginList:r.getPanelPlugins("")},r}return J.c(e,t),e.prototype.getPanelPlugins=function(t){var e=I.a.chain(B.a.panels).filter({hideFromList:!1}).map(function(t){return t}).value();return I.a.sortBy(e,"sort")},e.prototype.render=function(){return j.a.createElement("div",{className:"viz-picker"},j.a.createElement("div",{className:"viz-picker__search"},j.a.createElement("div",{className:"gf-form gf-form--grow"},j.a.createElement("label",{className:"gf-form--has-input-icon gf-form--grow"},j.a.createElement("input",{type:"text",className:"gf-form-input",placeholder:"Search type"}),j.a.createElement("i",{className:"gf-form-input-icon fa fa-search"})))),j.a.createElement("div",{className:"viz-picker__items"},j.a.createElement(Ds,null,j.a.createElement("div",{className:"scroll-margin-helper"},this.state.pluginList.map(this.renderVizPlugin)))))},e}(R.PureComponent),zc=function(t){function e(e){var r=t.call(this,e)||this;return r.onPanelOptionsChanged=function(t){r.props.panel.updateOptions(t),r.forceUpdate()},r.onChangeTab=function(t){Z.b.dispatch(Object(Rc.c)({query:{tab:t.id},partial:!0})),r.forceUpdate()},r.tabs=[{id:"queries",text:"Queries",icon:"fa fa-database"},{id:"visualization",text:"Visualization",icon:"fa fa-line-chart"}],r}return J.c(e,t),e.prototype.renderQueriesTab=function(){return j.a.createElement(Qc,{panel:this.props.panel,dashboard:this.props.dashboard})},e.prototype.renderPanelOptions=function(){var t=this.props,e=t.pluginExports,r=t.panel;if(e.PanelOptionsComponent){var n=e.PanelOptionsComponent;return j.a.createElement(n,{options:r.getOptions(),onChange:this.onPanelOptionsChanged})}return j.a.createElement("p",null,"Visualization has no options")},e.prototype.renderVizTab=function(){return j.a.createElement("div",{className:"viz-editor"},j.a.createElement("div",{className:"viz-editor-col1"},j.a.createElement(Hc,{currentType:this.props.panel.type,onTypeChanged:this.props.onTypeChanged})),j.a.createElement("div",{className:"viz-editor-col2"},j.a.createElement("h5",{className:"page-heading"},"Options"),this.renderPanelOptions()))},e.prototype.render=function(){var t=this,e=Z.b.getState().location.query.tab||"queries";return j.a.createElement("div",{className:"tabbed-view tabbed-view--new"},j.a.createElement("div",{className:"tabbed-view-header"},j.a.createElement("ul",{className:"gf-tabs"},this.tabs.map(function(r){return j.a.createElement(Gc,{tab:r,activeTab:e,onClick:t.onChangeTab,key:r.id})})),j.a.createElement("button",{className:"tabbed-view-close-btn","ng-click":"ctrl.exitFullscreen();"},j.a.createElement("i",{className:"fa fa-remove"}))),j.a.createElement("div",{className:"tabbed-view-body"},"queries"===e&&this.renderQueriesTab(),"visualization"===e&&this.renderVizTab()))},e}(R.PureComponent);function Gc(t){var e=t.tab,r=t.activeTab,n=t.onClick,a=Dn()({"gf-tabs-link":!0,active:r===e.id});return j.a.createElement("li",{className:"gf-tabs-item",key:e.id},j.a.createElement("a",{className:a,onClick:function(){return n(e)}},j.a.createElement("i",{className:e.icon})," ",e.text))}var Wc=function(t){function e(e){var r=t.call(this,e)||this;return r.specialPanels={},r.onPluginTypeChanged=function(t){r.props.panel.changeType(t.id),r.loadPlugin()},r.onAngularPluginTypeChanged=function(){r.loadPlugin()},r.state={pluginExports:null},r.specialPanels.row=r.renderRow.bind(r),r.specialPanels["add-panel"]=r.renderAddPanel.bind(r),r}return J.c(e,t),e.prototype.isSpecial=function(){return this.specialPanels[this.props.panel.type]},e.prototype.renderRow=function(){return j.a.createElement($c,{panel:this.props.panel,dashboard:this.props.dashboard})},e.prototype.renderAddPanel=function(){return j.a.createElement(qc,{panel:this.props.panel,dashboard:this.props.dashboard})},e.prototype.loadPlugin=function(){var t=this;this.isSpecial()||this.pluginInfo&&this.pluginInfo.id===this.props.panel.type||(this.pluginInfo=B.a.panels[this.props.panel.type],this.pluginInfo.exports?(this.cleanUpAngularPanel(),this.setState({pluginExports:this.pluginInfo.exports})):ll(this.pluginInfo.module).then(function(e){t.cleanUpAngularPanel(),t.pluginInfo.exports=e,t.setState({pluginExports:e})}))},e.prototype.componentDidMount=function(){this.loadPlugin()},e.prototype.componentDidUpdate=function(){if(this.loadPlugin(),this.element&&!this.angularPanel){var t=fl(),e={panel:this.props.panel,dashboard:this.props.dashboard};this.angularPanel=t.load(this.element,e,'<plugin-component type="panel" class="panel-height-helper"></plugin-component>')}},e.prototype.cleanUpAngularPanel=function(){this.angularPanel&&(this.angularPanel.destroy(),this.angularPanel=null)},e.prototype.componentWillUnmount=function(){this.cleanUpAngularPanel()},e.prototype.renderReactPanel=function(){var t=this.state.pluginExports,e=this.props.isEditing?"panel-editor-container":"panel-height-helper",r=this.props.isEditing?"panel-editor-container__panel":"panel-height-helper";return j.a.createElement("div",{className:e},j.a.createElement("div",{className:r},j.a.createElement(Bc,{component:t.PanelComponent,panel:this.props.panel,dashboard:this.props.dashboard})),this.props.panel.isEditing&&j.a.createElement("div",{className:"panel-editor-container__editor"},j.a.createElement(zc,{panel:this.props.panel,panelType:this.props.panel.type,dashboard:this.props.dashboard,onTypeChanged:this.onPluginTypeChanged,pluginExports:t})))},e.prototype.render=function(){var t=this;return this.isSpecial()?this.specialPanels[this.props.panel.type]():this.state.pluginExports?this.state.pluginExports.PanelComponent?this.renderReactPanel():j.a.createElement("div",{ref:function(e){return t.element=e},className:"panel-height-helper"}):null},e}(R.PureComponent),Yc=1200;var Kc=zi()({monitorWidth:!0})(function(t){var e=t.size,r=t.layout,n=t.onLayoutChange,a=t.children,i=t.onDragStop,s=t.onResize,o=t.onResizeStop,l=t.onWidthChange,c=t.className,u=t.isResizable,d=t.isDraggable,p=t.isFullscreen,h=e.width>0?e.width:Yc;return h!==Yc&&!p&&Math.abs(h-Yc)>8&&(l(),Yc=h),j.a.createElement(Pc.a,{width:Yc,className:c,isDraggable:d,isResizable:u,measureBeforeMount:!1,containerPadding:[0,0],useCSSTransforms:!0,margin:[Pt.d,Pt.d],cols:Pt.e,rowHeight:Pt.c,draggableHandle:".grid-drag-handle",layout:r,onResize:s,onResizeStop:o,onDragStop:i,onLayoutChange:n},a)}),Jc=function(t){function e(e){var r=t.call(this,e)||this;r.onLayoutChange=r.onLayoutChange.bind(r),r.onResize=r.onResize.bind(r),r.onResizeStop=r.onResizeStop.bind(r),r.onDragStop=r.onDragStop.bind(r),r.onWidthChange=r.onWidthChange.bind(r),r.state={animated:!1};var n=r.props.dashboard;return n.on("panel-added",r.triggerForceUpdate.bind(r)),n.on("panel-removed",r.triggerForceUpdate.bind(r)),n.on("repeats-processed",r.triggerForceUpdate.bind(r)),n.on("view-mode-changed",r.onViewModeChanged.bind(r)),n.on("row-collapsed",r.triggerForceUpdate.bind(r)),n.on("row-expanded",r.triggerForceUpdate.bind(r)),r}return J.c(e,t),e.prototype.buildLayout=function(){var t=[];this.panelMap={};for(var e=0,r=this.props.dashboard.panels;e<r.length;e++){var n=r[e],a=n.id.toString();if(this.panelMap[a]=n,n.gridPos){var i={i:a,x:n.gridPos.x,y:n.gridPos.y,w:n.gridPos.w,h:n.gridPos.h};"row"===n.type&&(i.w=Pt.e,i.h=1,i.isResizable=!1,i.isDraggable=n.collapsed),t.push(i)}else console.log("panel without gridpos")}return t},e.prototype.onLayoutChange=function(t){for(var e=0,r=t;e<r.length;e++){var n=r[e];this.panelMap[n.i].updateGridPos(n)}this.props.dashboard.sortPanelsByGridPos()},e.prototype.triggerForceUpdate=function(){this.forceUpdate()},e.prototype.onWidthChange=function(){for(var t=0,e=this.props.dashboard.panels;t<e.length;t++){e[t].resizeDone()}},e.prototype.onViewModeChanged=function(t){this.setState({animated:!t.fullscreen})},e.prototype.updateGridPos=function(t,e){this.panelMap[t.i].updateGridPos(t),this.onLayoutChange(e)},e.prototype.onResize=function(t,e,r){this.panelMap[r.i].updateGridPos(r)},e.prototype.onResizeStop=function(t,e,r){this.updateGridPos(r,t),this.panelMap[r.i].resizeDone()},e.prototype.onDragStop=function(t,e,r){this.updateGridPos(r,t)},e.prototype.componentDidMount=function(){var t=this;setTimeout(function(){t.setState({animated:!0})})},e.prototype.renderPanels=function(){for(var t=[],e=0,r=this.props.dashboard.panels;e<r.length;e++){var n=r[e],a=Dn()({panel:!0,"panel--fullscreen":n.fullscreen});t.push(j.a.createElement("div",{key:n.id.toString(),className:a,id:"panel-"+n.id},j.a.createElement(Wc,{panel:n,dashboard:this.props.dashboard,isEditing:n.isEditing,isFullscreen:n.fullscreen})))}return t},e.prototype.render=function(){return j.a.createElement(Kc,{className:Dn()({layout:!0,animated:this.state.animated}),layout:this.buildLayout(),isResizable:this.props.dashboard.meta.canEdit,isDraggable:this.props.dashboard.meta.canEdit,onLayoutChange:this.onLayoutChange,onWidthChange:this.onWidthChange,onDragStop:this.onDragStop,onResize:this.onResize,onResizeStop:this.onResizeStop,isFullscreen:this.props.dashboard.meta.fullscreen},this.renderPanels())},e}(j.a.Component);Object(Mc.a)("dashboardGrid",Jc,[["dashboard",{watchDepth:"reference"}]]);var Xc=function(){function t(){this.source=this.row,this.row=this.row.getSaveModel()}return t.prototype.update=function(){this.source.title=this.row.title,this.source.repeat=this.row.repeat,this.onUpdated(),this.dismiss()},t}();G.e.directive("rowOptions",function(){return{restrict:"E",templateUrl:"public/app/features/dashboard/partials/row_options.html",controller:Xc,bindToController:!0,controllerAs:"ctrl",scope:{row:"=",dismiss:"&",onUpdated:"&"}}});var Zc=function(){function t(t,e,r){this.backendSrv=t,this.validationSrv=e,this.contextSrv=r,this.rootName="General",this.isEditor=this.contextSrv.isEditor,this.labelClass||(this.labelClass="width-7"),this.loadInitialValue()}return t.$inject=["backendSrv","validationSrv","contextSrv"],t.prototype.getOptions=function(t){var e=this,r={query:t,type:"dash-folder",permission:"Edit"};return this.backendSrv.get("api/search",r).then(function(r){return!e.isEditor||""!==t&&"g"!==t.toLowerCase()&&"ge"!==t.toLowerCase()&&"gen"!==t.toLowerCase()&&"gene"!==t.toLowerCase()&&"gener"!==t.toLowerCase()&&"genera"!==t.toLowerCase()&&"general"!==t.toLowerCase()||r.unshift({title:e.rootName,id:0}),e.isEditor&&e.enableCreateNew&&""===t&&r.unshift({title:"-- 新建文件夹 --",id:-1}),e.enableReset&&""===t&&""!==e.initialTitle&&r.unshift({title:e.initialTitle,id:null}),I.a.map(r,function(t){return{text:t.title,value:t.id}})})},t.prototype.onFolderChange=function(t){if(t){if(-1===t.value)return this.createNewFolder=!0,void this.enterFolderCreation()}else t={value:0,text:this.rootName};this.onChange({$folder:{id:t.value,title:t.text}})},t.prototype.newFolderNameChanged=function(){var t=this;this.newFolderNameTouched=!0,this.validationSrv.validateNewFolderName(this.newFolderName).then(function(){t.hasValidationError=!1}).catch(function(e){t.hasValidationError=!0,t.validationError=e.message})},t.prototype.createFolder=function(t){var e=this;return t&&(t.stopPropagation(),t.preventDefault()),this.backendSrv.createFolder({title:this.newFolderName}).then(function(t){bt.a.emit("alert-success",["文件夹已创建","OK"]),e.closeCreateFolder(),e.folder={text:t.title,value:t.id},e.onFolderChange(e.folder)})},t.prototype.cancelCreateFolder=function(t){t&&(t.stopPropagation(),t.preventDefault()),this.closeCreateFolder(),this.loadInitialValue()},t.prototype.closeCreateFolder=function(){this.exitFolderCreation(),this.createNewFolder=!1,this.hasValidationError=!1,this.validationError=null,this.newFolderName="",this.newFolderNameTouched=!1},t.prototype.loadInitialValue=function(){var t=this,e={text:this.initialTitle,value:null},r={text:this.rootName,value:0};this.getOptions("").then(function(n){var a;t.initialFolderId?a=I.a.find(n,{value:t.initialFolderId}):t.enableReset&&t.initialTitle&&null===t.initialFolderId&&(a=e),a||(a=t.isEditor?r:n.length>0?n[0]:e),t.folder=a,t.folder.value!==t.initialFolderId&&t.onChange({$folder:{id:t.folder.value,title:t.folder.text}})})},t}();z.c.directive("folderPicker",function(){return{restrict:"E",templateUrl:"public/app/features/dashboard/folder_picker/folder_picker.html",controller:Zc,bindToController:!0,controllerAs:"ctrl",scope:{initialTitle:"<",initialFolderId:"<",labelClass:"@",rootName:"@",onChange:"&",onCreateFolder:"&",enterFolderCreation:"&",exitFolderCreation:"&",enableCreateNew:"@",enableReset:"@"}}});var tu=function(){function t(t){this.backendSrv=t,this.isValidFolderSelection=!0}return t.$inject=["backendSrv"],t.prototype.onFolderChange=function(t){this.folder=t},t.prototype.save=function(){var t=this;return this.backendSrv.moveDashboards(this.dashboards,this.folder).then(function(e){if(e.successCount>0){var r="仪表盘"+(1===e.successCount?"":"s")+" 已移动",n=e.successCount+" 仪表盘"+(1===e.successCount?"":"s")+" 已移动到 "+t.folder.title;bt.a.emit("alert-success",[r,n])}return e.totalCount===e.alreadyInFolderCount&&bt.a.emit("alert-error",["Error","仪表盘已经移动到文件夹 "+t.folder.title]),t.dismiss(),t.afterSave()})},t.prototype.onEnterFolderCreation=function(){this.isValidFolderSelection=!1},t.prototype.onExitFolderCreation=function(){this.isValidFolderSelection=!0},t}();z.c.directive("moveToFolderModal",function(){return{restrict:"E",templateUrl:"public/app/features/dashboard/move_to_folder_modal/move_to_folder.html",controller:tu,bindToController:!0,controllerAs:"ctrl",scope:{dismiss:"&",dashboards:"=",afterSave:"&"}}});var eu=function(){function t(t,e,r,n,a,i){var s=this;this.$scope=t,this.$route=e,this.$location=r,this.$rootScope=n,this.backendSrv=a,this.dashboardSrv=i,t.dashboard=this.dashboard,this.$scope.$on("$destroy",function(){s.dashboard.updateSubmenuVisibility(),setTimeout(function(){s.$rootScope.appEvent("dash-scroll",{restore:!0}),s.dashboard.startRefresh()})}),this.canSaveAs=this.dashboard.meta.canEdit&&G.d.hasEditPermissionInFolders,this.canSave=this.dashboard.meta.canSave,this.canDelete=this.dashboard.meta.canSave,this.buildSectionList(),this.onRouteUpdated(),this.$rootScope.onAppEvent("$routeUpdate",this.onRouteUpdated.bind(this),t),this.$rootScope.appEvent("dash-scroll",{animate:!1,pos:0}),this.$rootScope.onAppEvent("dashboard-saved",this.onPostSave.bind(this),t)}return t.$inject=["$scope","$route","$location","$rootScope","backendSrv","dashboardSrv"],t.prototype.buildSectionList=function(){this.sections=[],this.dashboard.meta.canEdit&&(this.sections.push({title:"默认",id:"settings",icon:"gicon gicon-preferences"}),this.sections.push({title:"注释",id:"annotations",icon:"gicon gicon-annotation"}),this.sections.push({title:"变量",id:"templating",icon:"gicon gicon-variable"}),this.sections.push({title:"链接",id:"links",icon:"gicon gicon-link"})),this.dashboard.id&&this.dashboard.meta.canSave&&this.sections.push({title:"版本",id:"versions",icon:"fa fa-fw fa-history"}),this.dashboard.id&&this.dashboard.meta.canAdmin&&this.sections.push({title:"权限",id:"permissions",icon:"fa fa-fw fa-lock"}),this.dashboard.meta.canMakeEditable&&this.sections.push({title:"默认",icon:"gicon gicon-preferences",id:"make_editable"}),this.sections.push({title:"JSON模型",id:"dashboard_json",icon:"gicon gicon-json"});for(var t=this.$location.search(),e=this.$location.path(),r=0,n=this.sections;r<n.length;r++){var a=n[r],i=I.a.defaults({editview:a.id},t);a.url=B.a.appSubUrl+e+"?"+F.a.param(i)}},t.prototype.onRouteUpdated=function(){this.viewId=this.$location.search().editview,this.viewId&&(this.json=L.a.toJson(this.dashboard.getSaveModelClone(),!0)),"settings"===this.viewId&&this.dashboard.meta.canMakeEditable&&(this.viewId="make_editable"),I.a.find(this.sections,{id:this.viewId})||(this.sections.unshift({title:"未发现",id:"404",icon:"fa fa-fw fa-warning"}),this.viewId="404")},t.prototype.openSaveAsModal=function(){this.dashboardSrv.showSaveAsModal()},t.prototype.saveDashboard=function(){this.dashboardSrv.saveDashboard()},t.prototype.saveDashboardJson=function(){var t=this;this.dashboardSrv.saveJSONDashboard(this.json).then(function(){t.$route.reload()})},t.prototype.onPostSave=function(){this.hasUnsavedFolderChange=!1},t.prototype.hideSettings=function(){var t=this,e=this.$location.search();delete e.editview,setTimeout(function(){t.$rootScope.$apply(function(){t.$location.search(e)})})},t.prototype.makeEditable=function(){this.dashboard.editable=!0,this.dashboard.meta.canMakeEditable=!1,this.dashboard.meta.canEdit=!0,this.dashboard.meta.canSave=!0,this.canDelete=!0,this.viewId="settings",this.buildSectionList();var t=I.a.find(this.sections,{id:this.viewId});this.$location.url(t.url)},t.prototype.deleteDashboard=function(){var t=this,e="",r=this.dashboard.title,n=I.a.sumBy(this.dashboard.panels,function(t){return t.alert?1:0});n>0&&(e="删除",r="这个仪表盘包含 "+n+" 报警. 删除这个仪表盘，报警信息也将被删除。"),G.c.emit("confirm-modal",{title:"删除",text:"你想删除这个仪表盘?",text2:r,icon:"fa-trash",confirmText:e,yesText:"删除",onConfirm:function(){t.dashboard.meta.canSave=!1,t.deleteDashboardConfirmed()}})},t.prototype.deleteDashboardConfirmed=function(){var t=this;this.backendSrv.deleteDashboard(this.dashboard.uid).then(function(){G.c.emit("alert-success",["删除仪表盘",t.dashboard.title+" 将被删除。"]),t.$location.url("/")})},t.prototype.onFolderChange=function(t){this.dashboard.meta.folderId=t.id,this.dashboard.meta.folderTitle=t.title,this.hasUnsavedFolderChange=!0},t.prototype.getFolder=function(){return{id:this.dashboard.meta.folderId,title:this.dashboard.meta.folderTitle,url:this.dashboard.meta.folderUrl}},t}();G.e.directive("dashboardSettings",function(){return{restrict:"E",templateUrl:"public/app/features/dashboard/settings/settings.html",controller:eu,bindToController:!0,controllerAs:"ctrl",transclude:!0,scope:{dashboard:"="}}});var ru=function(){function t(t,e){t.panel.links=t.panel.links||[],t.addLink=function(){t.panel.links.push({type:"dashboard"})},t.searchDashboards=function(t,r){e.search({query:t}).then(function(t){var e=I.a.map(t,function(t){return t.title});r(e)})},t.dashboardChanged=function(t){e.search({query:t.dashboard}).then(function(e){var r=I.a.find(e,{title:t.dashboard});r&&(r.url?t.url=r.url:t.dashUri=r.uri,t.title=r.title)})},t.deleteLink=function(e){t.panel.links=I.a.without(t.panel.links,e)}}return t.$inject=["$scope","backendSrv"],t}();L.a.module("grafana.directives").directive("panelLinksEditor",function(){return{scope:{panel:"="},restrict:"E",controller:"PanelLinksEditorCtrl",templateUrl:"public/app/features/dashboard/panellinks/module.html",link:function(){}}}).controller("PanelLinksEditorCtrl",ru);var nu={"external link":"fa-external-link",dashboard:"fa-th-large",question:"fa-question",info:"fa-info",bolt:"fa-bolt",doc:"fa-file-text-o",cloud:"fa-cloud"},au=function(){function t(t,e){this.iconMap=nu,this.dashboard.links=this.dashboard.links||[],this.mode="list",t.$on("$destroy",function(){e.appEvent("dash-links-updated")})}return t.$inject=["$scope","$rootScope"],t.prototype.backToList=function(){this.mode="list"},t.prototype.setupNew=function(){this.mode="new",this.link={type:"dashboards",icon:"external link"}},t.prototype.addLink=function(){this.dashboard.links.push(this.link),this.mode="list"},t.prototype.editLink=function(t){this.link=t,this.mode="edit",console.log(this.link)},t.prototype.saveLink=function(){this.backToList()},t.prototype.moveLink=function(t,e){I.a.move(this.dashboard.links,t,t+e)},t.prototype.deleteLink=function(t){this.dashboard.links.splice(t,1),this.dashboard.updateSubmenuVisibility()},t}();function iu(t,e,r){return{restrict:"E",link:function(n,a){var i=n.link,s=n.dashboard,o='<div class="gf-form"><a class="pointer gf-form-label" data-placement="bottom"'+(i.asDropdown?' ng-click="fillDropdown(link)" data-toggle="dropdown"':"")+(i.asExport?' ng-click="exportTable(dashboard)"':"")+"><i></i> <span></span></a>";function l(){var t=r.getAnchorInfo(i),s=a.find("a");a.find("span").text(t.title),i.asDropdown||i.asExport||(s.attr("href",t.href+(i.iskioskTv?t.href&&t.href.indexOf("?")>0?"&kiosk=tv":"?kiosk=tv":"")),function(){var t=a.find("a"),r=e(t.parent().html());t.parent().html(r)}()),s.attr("data-placement","bottom"),s.tooltip({title:e(n.link.tooltip),html:!0,container:"body"}),a.find("a").css("color",i.color),a.find("a").css("background-color",i.bgcolor)}i.asDropdown&&(o+='<ul class="dropdown-menu" role="menu"><li ng-repeat="dash in link.searchHits"><a href="{{dash.url}}" target="{{dash.target}}">{{dash.title}}</a></li></ul>'),o+="</div>",a.html(o),t(a.contents())(n),a.find("i").attr("class","fa fa-fw "+n.link.icon),a.find("a").attr("target",n.link.target),i.asDropdown&&n.$last&&a.find(".dropdown-menu").addClass("pull-right"),l(),s.events.on("refresh",l,n)}}}L.a.module("grafana.directives").directive("dashLinksEditor",function(){return{restrict:"E",controller:au,templateUrl:"public/app/features/dashboard/dashlinks/editor.html",bindToController:!0,controllerAs:"ctrl",scope:{dashboard:"="}}});var su=function(){function t(t,e,r,n,a,i){var s=this,o=a.getCurrent().id;function l(e){return"dashboards"===e.type?e.tags?e.asDropdown?r.when([{title:e.title,tags:e.tags,keepTime:e.keepTime,includeVars:e.includeVars,target:e.targetBlank?"_blank":"_self",icon:"fa fa-bars",asDropdown:!0,iskioskTv:!!e.iskioskTv,color:e.color,bgcolor:e.bgcolor}]):t.searchDashboards(e,7):(console.log("Dashboard link missing tag"),r.when([])):"link"===e.type?r.when([{url:e.url,title:e.title,icon:nu[e.icon],tooltip:e.tooltip,target:e.targetBlank?"_blank":"_self",keepTime:e.keepTime,includeVars:e.includeVars,iskioskTv:!!e.iskioskTv,color:e.color,bgcolor:e.bgcolor}]):"Export CSV"===e.type?r.when([{title:e.title,icon:nu[e.icon],tooltip:e.tooltip,color:e.color,target:e.targetBlank?"_blank":"_self",bgcolor:e.bgcolor,iskioskTv:!!e.iskioskTv,asExport:!0}]):r.when([])}function c(){var e=I.a.map(t.links,l);r.all(e).then(function(e){t.generatedLinks=I.a.flatten(e)})}t.searchDashboards=function(t,e){return n.search({tag:t.tags,limit:e}).then(function(e){return I.a.reduce(e,function(e,r){return r.id!==o&&e.push({title:r.title,url:r.url,target:"_self"===t.target?"":t.target,icon:"fa fa-th-large",keepTime:t.keepTime,iskioskTv:!!t.iskioskTv,includeVars:t.includeVars,color:t.color,bgcolor:t.bgcolor}),e},[])})},t.fillDropdown=function(e){t.searchDashboards(e,100).then(function(t){I.a.each(t,function(t){t.url=i.getLinkUrl(t),e.iskioskTv&&t.url&&(t.url=t.url+(t.url.indexOf("?")>0?"&kiosk=tv":"?kiosk=tv"))}),e.searchHits=t})},t.exportTable=function(t){t.panels.forEach(function(t){if("table"===t.type){var e=[];t.events.emit("get-data",e),Ce(i.templateSrv.replace(t.title,i.templateSrv.variables),e[0])}}).bind(s)},c(),e.onAppEvent("dash-links-updated",c,t)}return t.$inject=["$scope","$rootScope","$q","backendSrv","dashboardSrv","linkSrv"],t}();L.a.module("grafana.directives").directive("dashLinksContainer",function(){return{scope:{links:"=",dashboard:"="},restrict:"E",controller:"DashLinksContainerCtrl",template:'<dash-link ng-repeat="link in generatedLinks" link="link"></dash-link>',link:function(){}}}),L.a.module("grafana.directives").directive("dashLink",iu),L.a.module("grafana.directives").controller("DashLinksContainerCtrl",su);var ou=r(119),lu=r(98),cu=r(101),uu=r(255),du=r(257),pu=r(249),hu=r(245),fu=function(t){function e(e){var r=t.call(this,e)||this;return r.onOpenAddPermissions=function(){r.setState({isAdding:!0})},r.onRemoveItem=function(t){r.props.removeDashboardPermission(r.props.dashboardId,t)},r.onPermissionChanged=function(t,e){r.props.updateDashboardPermission(r.props.dashboardId,t,e)},r.onAddPermission=function(t){return r.props.addDashboardPermission(r.props.dashboardId,t)},r.onCancelAddPermission=function(){r.setState({isAdding:!1})},r.state={isAdding:!1},r}return J.c(e,t),e.prototype.componentDidMount=function(){this.props.getDashboardPermissions(this.props.dashboardId)},e.prototype.render=function(){var t=this.props,e=t.permissions,r=t.folder,n=this.state.isAdding;return j.a.createElement("div",null,j.a.createElement("div",{className:"dashboard-settings__header"},j.a.createElement("div",{className:"page-action-bar"},j.a.createElement("h3",{className:"d-inline-block"},"权限"),j.a.createElement(ou.a,{className:"page-sub-heading-icon",placement:"auto",content:pu.a},j.a.createElement("i",{className:"gicon gicon-question gicon--has-hover"})),j.a.createElement("div",{className:"page-action-bar__spacer"}),j.a.createElement("button",{className:"btn btn-success pull-right",onClick:this.onOpenAddPermissions,disabled:n},j.a.createElement("i",{className:"fa fa-plus"})," 添加权限"))),j.a.createElement(lu.a,{in:n},j.a.createElement(du.a,{onAddPermission:this.onAddPermission,onCancel:this.onCancelAddPermission})),j.a.createElement(uu.a,{items:e,onRemoveItem:this.onRemoveItem,onPermissionChanged:this.onPermissionChanged,isFetching:!1,folderInfo:r}))},e}(R.PureComponent),mu={getDashboardPermissions:cu.c,addDashboardPermission:cu.b,removeDashboardPermission:cu.f,updateDashboardPermission:cu.g},gu=Object(hu.a)(fu,function(t){return{permissions:t.dashboard.permissions}},mu),vu=function(){function t(t){this.backendSrv=t}return t.prototype.load=function(t,e,r){return t.navModel={main:{icon:"fa fa-folder-open",id:"manage-folder",subTitle:"管理目录的仪表盘和权限",url:"",text:"",breadcrumbs:[{title:"Dashboards",url:"dashboards"}],children:[{active:"manage-folder-dashboards"===r,icon:"fa fa-fw fa-th-large",id:"manage-folder-dashboards",text:"仪表盘",url:"dashboards"},{active:"manage-folder-permissions"===r,icon:"fa fa-fw fa-lock",id:"manage-folder-permissions",text:"权限",url:"dashboards/permissions"},{active:"manage-folder-settings"===r,icon:"fa fa-fw fa-cog",id:"manage-folder-settings",text:"设置",url:"dashboards/settings"}]}},this.backendSrv.getFolderByUid(e).then(function(e){t.folderId=e.id;var r=e.title,n=e.url;t.navModel.main.text=r;var a=t.navModel.main.children.find(function(t){return"manage-folder-dashboards"===t.id});(a.url=n,e.canAdmin)?(t.navModel.main.children.find(function(t){return"manage-folder-permissions"===t.id}).url=n+"/permissions",t.navModel.main.children.find(function(t){return"manage-folder-settings"===t.id}).url=n+"/settings"):t.navModel.main.children=[a];return e})},t}(),bu=function(){function t(t,e,r,n){(this.backendSrv=t,this.$routeParams=r,this.$routeParams.uid)&&(this.uid=r.uid,new vu(this.backendSrv).load(this,this.uid,"manage-folder-dashboards").then(function(t){var e=W.a.stripBaseFromUrl(t.url);e!==n.path()&&n.path(e).replace()}))}return t.$inject=["backendSrv","navModelSrv","$routeParams","$location"],t}(),yu=function(){function t(t,e,r,n,a){this.backendSrv=t,this.validationSrv=e,this.$location=n,this.navModel=r.getNav("create","import"),this.step=1,this.nameExists=!1,this.uidExists=!1,this.autoGenerateUid=!0,this.autoGenerateUidValue="auto-generated",this.folderId=a.folderId?Number(a.folderId)||0:null,this.initialFolderTitle="选择一个文件夹",a.gnetId&&(this.gnetUrl=a.gnetId,this.checkGnetDashboard())}return t.$inject=["backendSrv","validationSrv","navModelSrv","$location","$routeParams"],t.prototype.onUpload=function(t){if(this.dash=t,this.dash.id=null,this.step=2,this.inputs=[],this.dash.__inputs)for(var e=0,r=this.dash.__inputs;e<r.length;e++){var n=r[e],a={name:n.name,label:n.label,info:n.description,value:n.value,type:n.type,pluginId:n.pluginId,options:[]};"datasource"===n.type?this.setDatasourceOptions(n,a):a.info||(a.info="指定一个字符串常量"),this.inputs.push(a)}this.inputsValid=0===this.inputs.length,this.titleChanged(),this.uidChanged(!0)},t.prototype.setDatasourceOptions=function(t,e){var r=I.a.filter(B.a.datasources,function(e){return e.type===t.pluginId});0===r.length?e.info="无 "+t.pluginName+" 类型的数据源发现":e.info||(e.info="选择一个 "+t.pluginName+" 数据源"),e.options=r.map(function(t){return{text:t.name,value:t.name}})},t.prototype.inputValueChanged=function(){this.inputsValid=!0;for(var t=0,e=this.inputs;t<e.length;t++){e[t].value||(this.inputsValid=!1)}},t.prototype.titleChanged=function(){var t=this;this.titleTouched=!0,this.nameExists=!1,this.validationSrv.validateNewDashboardName(this.folderId,this.dash.title).then(function(){t.nameExists=!1,t.hasNameValidationError=!1}).catch(function(e){"EXISTING"===e.type&&(t.nameExists=!0),t.hasNameValidationError=!0,t.nameValidationError=e.message})},t.prototype.uidChanged=function(t){var e=this;this.uidExists=!1,this.hasUidValidationError=!1,!0===t&&this.dash.uid&&(this.autoGenerateUidValue="value set"),this.backendSrv.getDashboardByUid(this.dash.uid).then(function(t){e.uidExists=!0,e.hasUidValidationError=!0,e.uidValidationError="在文件夹'"+t.meta.folderTitle+"'中，已经有相同uid的仪表盘 '"+t.dashboard.title+"'"}).catch(function(t){t.isHandled=!0})},t.prototype.onFolderChange=function(t){this.folderId=t.id,this.titleChanged()},t.prototype.onEnterFolderCreation=function(){this.inputsValid=!1},t.prototype.onExitFolderCreation=function(){this.inputValueChanged()},t.prototype.isValid=function(){return this.inputsValid&&null!==this.folderId},t.prototype.saveDashboard=function(){var t=this,e=this.inputs.map(function(t){return{name:t.name,type:t.type,pluginId:t.pluginId,value:t.value}});return this.backendSrv.post("api/dashboards/import",{dashboard:this.dash,overwrite:!0,inputs:e,folderId:this.folderId}).then(function(e){var r=W.a.stripBaseFromUrl(e.importedUrl);t.$location.url(r)})},t.prototype.loadJsonText=function(){try{this.parseError="";var t=JSON.parse(this.jsonText);this.onUpload(t)}catch(t){return console.log(t),void(this.parseError=t.message)}},t.prototype.checkGnetDashboard=function(){var t=this;this.gnetError="";var e,r=/(^\d+$)|dashboards\/(\d+)/.exec(this.gnetUrl);return r&&r[1]?e=r[1]:r&&r[2]?e=r[2]:this.gnetError="无法发现仪表盘",this.backendSrv.get("api/gnet/dashboards/"+e).then(function(e){t.gnetInfo=e,e.json.gnetId=e.id,t.onUpload(e.json)}).catch(function(e){e.isHandled=!0,t.gnetError=e.data.message||e})},t.prototype.back=function(){this.gnetUrl="",this.step=1,this.gnetError="",this.gnetInfo=""},t}(),wu=function(){function t(t,e,r,n){this.backendSrv=t,this.$location=e,this.validationSrv=r,this.title="",this.titleTouched=!1,this.navModel=n.getNav("dashboards","manage-dashboards",0)}return t.$inject=["backendSrv","$location","validationSrv","navModelSrv"],t.prototype.create=function(){var t=this;if(!this.hasValidationError)return this.backendSrv.createFolder({title:this.title}).then(function(e){bt.a.emit("alert-success",["文件夹创建","OK"]),t.$location.url(W.a.stripBaseFromUrl(e.url))})},t.prototype.titleChanged=function(){var t=this;this.titleTouched=!0,this.validationSrv.validateNewFolderName(this.title).then(function(){t.hasValidationError=!1}).catch(function(e){t.hasValidationError=!0,t.validationError=e.message})},t}();Object(Mc.a)("dashboardPermissions",gu,["dashboardId","folder"]),z.c.controller("FolderDashboardsCtrl",bu),z.c.controller("DashboardImportCtrl",yu),z.c.controller("CreateFolderCtrl",wu);var xu=function(){function t(t,e,r){var n=this;this.$scope=t,this.backendSrv=e,this.navModel=r.getNav("dashboards","playlists",0),e.get("/api/playlists").then(function(t){n.playlists=t.map(function(t){return t.startUrl="playlists/play/"+t.id,t})})}return t.$inject=["$scope","backendSrv","navModelSrv"],t.prototype.removePlaylistConfirmed=function(t){var e=this;I.a.remove(this.playlists,{id:t.id}),this.backendSrv.delete("/api/playlists/"+t.id).then(function(){e.$scope.appEvent("alert-success",["Playlist deleted",""])},function(){e.$scope.appEvent("alert-error",["Unable to delete playlist",""]),e.playlists.push(t)})},t.prototype.removePlaylist=function(t){var e=this;this.$scope.appEvent("confirm-modal",{title:"Delete",text:"Are you sure you want to delete playlist "+t.name+"?",yesText:"Delete",icon:"fa-trash",onConfirm:function(){e.removePlaylistConfirmed(t)}})},t}();z.c.controller("PlaylistsCtrl",xu);var Su=function(){function t(t,e){var r=this;this.backendSrv=e,this.query={query:"",tag:[],starred:!1,limit:20},t(function(){r.query.query="",r.query.type="dash-db",r.searchDashboards()},100)}return t.$inject=["$timeout","backendSrv"],t.prototype.searchDashboards=function(){this.tagsMode=!1;var t={};t.promise=this.backendSrv.search(this.query).then(function(t){return{dashboardResult:t,tagResult:[]}}),this.searchStarted(t)},t.prototype.showStarred=function(){this.query.starred=!this.query.starred,this.searchDashboards()},t.prototype.queryHasNoFilters=function(){return""===this.query.query&&!1===this.query.starred&&0===this.query.tag.length},t.prototype.filterByTag=function(t,e){this.query.tag.push(t),this.searchDashboards(),e&&(e.stopPropagation(),e.preventDefault())},t.prototype.getTags=function(){var t={};t.promise=this.backendSrv.get("/api/dashboards/tags").then(function(t){return{dashboardResult:[],tagResult:t}}),this.searchStarted(t)},t}();z.c.directive("playlistSearch",function(){return{restrict:"E",templateUrl:"public/app/features/playlist/partials/playlist_search.html",controller:Su,bindToController:!0,controllerAs:"ctrl",scope:{searchStarted:"&"}}});var ku=r(168),Cu=function(){function t(t,e,r){this.$location=t,this.$timeout=e,this.backendSrv=r}return t.$inject=["$location","$timeout","backendSrv"],t.prototype.next=function(){var t=this;if(this.$timeout.cancel(this.cancelPromise),this.index>this.dashboards.length-1)window.location.href=this.startUrl;else{var e=this.dashboards[this.index],r=this.$location.search(),n=I.a.pickBy(r,function(t){return null!==t});this.$location.url("dashboard/"+e.uri+"?"+Object(ku.b)(n)),this.index++,this.cancelPromise=this.$timeout(function(){return t.next()},this.interval)}},t.prototype.prev=function(){this.index=Math.max(this.index-2,0),this.next()},t.prototype.start=function(t){var e=this;this.stop(),this.startUrl=window.location.href,this.index=0,this.isPlaying=!0,this.backendSrv.get("/api/playlists/"+t).then(function(r){e.backendSrv.get("/api/playlists/"+t+"/dashboards").then(function(t){e.dashboards=t,e.interval=kt.a.interval_to_ms(r.interval),e.next()})})},t.prototype.stop=function(){this.isPlaying&&(this.$location.search().kiosk&&bt.a.emit("toggle-kiosk-mode",{exit:!0}));this.index=0,this.isPlaying=!1,this.cancelPromise&&this.$timeout.cancel(this.cancelPromise)},t}();z.c.service("playlistSrv",Cu);var Tu=function(){function t(t,e,r,n,a){var i=this;if(this.$scope=t,this.backendSrv=e,this.$location=r,this.filteredDashboards=[],this.filteredTags=[],this.searchQuery="",this.loading=!1,this.playlist={interval:"5m"},this.playlistItems=[],this.dashboardresult=[],this.tagresult=[],this.navModel=a.getNav("dashboards","playlists",0),this.isNew=!n.current.params.id,n.current.params.id){var s=n.current.params.id;e.get("/api/playlists/"+s).then(function(t){i.playlist=t}),e.get("/api/playlists/"+s+"/items").then(function(t){i.playlistItems=t})}}return t.$inject=["$scope","backendSrv","$location","$route","navModelSrv"],t.prototype.filterFoundPlaylistItems=function(){var t=this;this.filteredDashboards=I.a.reject(this.dashboardresult,function(e){return I.a.find(t.playlistItems,function(t){return parseInt(t.value,10)===e.id})}),this.filteredTags=I.a.reject(this.tagresult,function(e){return I.a.find(t.playlistItems,function(t){return t.value===e.term})})},t.prototype.addPlaylistItem=function(t){t.value=t.id.toString(),t.type="dashboard_by_id",t.order=this.playlistItems.length+1,this.playlistItems.push(t),this.filterFoundPlaylistItems()},t.prototype.addTagPlaylistItem=function(t){var e={value:t.term,type:"dashboard_by_tag",order:this.playlistItems.length+1,title:t.term};this.playlistItems.push(e),this.filterFoundPlaylistItems()},t.prototype.removePlaylistItem=function(t){I.a.remove(this.playlistItems,function(e){return t===e}),this.filterFoundPlaylistItems()},t.prototype.savePlaylist=function(t,e){var r=this;t.items=e,(t.id?this.backendSrv.put("/api/playlists/"+t.id,t):this.backendSrv.post("/api/playlists",t)).then(function(){r.$scope.appEvent("alert-success",["Playlist saved",""]),r.$location.path("/playlists")},function(){r.$scope.appEvent("alert-error",["Unable to save playlist",""])})},t.prototype.isPlaylistEmpty=function(){return!this.playlistItems.length},t.prototype.backToList=function(){this.$location.path("/playlists")},t.prototype.searchStarted=function(t){var e=this;t.then(function(t){e.dashboardresult=t.dashboardResult,e.tagresult=t.tagResult,e.filterFoundPlaylistItems()})},t.prototype.movePlaylistItem=function(t,e){var r=this.playlistItems.indexOf(t),n=r+e;n>=0&&n<this.playlistItems.length&&(this.playlistItems.splice(r,1),this.playlistItems.splice(n,0,t))},t.prototype.movePlaylistItemUp=function(t){this.movePlaylistItem(t,-1)},t.prototype.movePlaylistItemDown=function(t){this.movePlaylistItem(t,1)},t}();function Eu(t){t.when("/playlists",{templateUrl:"public/app/features/playlist/partials/playlists.html",controllerAs:"ctrl",controller:"PlaylistsCtrl"}).when("/playlists/create",{templateUrl:"public/app/features/playlist/partials/playlist.html",controllerAs:"ctrl",controller:"PlaylistEditCtrl"}).when("/playlists/edit/:id",{templateUrl:"public/app/features/playlist/partials/playlist.html",controllerAs:"ctrl",controller:"PlaylistEditCtrl"}).when("/playlists/play/:id",{template:"",resolve:{init:["playlistSrv","$route",function(t,e){var r=e.current.params.id;t.start(r)}]}})}z.c.controller("PlaylistEditCtrl",Tu),L.a.module("grafana.routes").config(Eu);var _u='\n<span class="panel-title">\n  <span class="icon-gf panel-alert-icon"></span>\n  <span class="panel-title-text">{{ctrl.panel.title | interpolateTemplateVars:this}}</span>\n  <span class="panel-menu-container dropdown">\n    <span class="fa fa-caret-down panel-menu-toggle" data-toggle="dropdown"></span>\n    <ul class="dropdown-menu dropdown-menu--menu panel-menu" role="menu">\n    </ul>\n  </span>\n  <span class="panel-time-info" ng-if="ctrl.timeInfo"><i class="fa fa-clock-o"></i> {{ctrl.timeInfo}}</span>\n</span>';function Mu(t,e){var r="",n="";if(t.divider)return'<li class="divider"></li>';if(t.submenu&&(n="dropdown-submenu"),r+='<li class="'+n+'"><a ',t.click&&(r+=' ng-click="'+t.click+'"'),t.href&&(r+=' href="'+t.href+'"'),r+='><i class="'+t.icon+'"></i>',r+='<span class="dropdown-item-text">'+t.text+"</span>",t.shortcut&&(r+='<span class="dropdown-menu-item-shortcut">'+t.shortcut+"</span>"),r+="</a>",t.submenu){r+='<ul class="dropdown-menu dropdown-menu--menu panel-menu">';for(var a=0,i=t.submenu;a<i.length;a++){r+=Mu(i[a],e)}r+="</ul>"}return r+="</li>"}function Au(t){return{restrict:"E",template:_u,link:function(e,r,n){var a,i,s,o,l=r.find(".panel-menu");function c(){var t=r.find("[data-toggle=dropdown]").parentsUntil(".panel").parent(),e=r.find("[data-toggle=dropdown]").parent();if(t=t&&t.length?t[0]:void 0){t=F()(t),F()(".react-grid-item.panel").removeClass("dropdown-menu-open");var n=!e.hasClass("open");t.toggleClass("dropdown-menu-open",n)}}r.click(function(n){var s=n.target.className;a&&a.$destroy(),a=e.$new();var o=function(t){for(var e="",r=0,n=t.getMenu();r<n.length;r++)e+=Mu(n[r],t);return e}(e.ctrl);l.html(o),t(l)(a),(s.indexOf("panel-title-text")>=0||s.indexOf("panel-title")>=0)&&function(t){i||(t.stopPropagation(),c(),r.find("[data-toggle=dropdown]").dropdown("toggle"))}(n)}),r.find(".panel-menu-toggle").click(function(){c()}),r.mousedown(function(t){s=t.pageX,o=t.pageY}),r.mouseup(function(t){i=s!==t.pageX||o!==t.pageY})}}}G.e.directive("panelHeader",Au);var Pu=L.a.module("grafana.directives");Pu.directive("grafanaPanel",["$rootScope","$document","$timeout",function(t,e,r){return{restrict:"E",template:'\n  <div ng-class="{\'panel-editor-container\': ctrl.panel.isEditing, \'panel-height-helper\': !ctrl.panel.isEditing}">\n    <div ng-class="{\'panel-editor-container__panel\': ctrl.panel.isEditing, \'panel-height-helper\': !ctrl.panel.isEditing}">\n      <div class="panel-container">\n        <div class="panel-header" ng-class="{\'grid-drag-handle\': !ctrl.panel.fullscreen}">\n          <span class="panel-info-corner">\n            <i class="fa"></i>\n            <span class="panel-info-corner-inner"></span>\n          </span>\n\n          <span class="panel-loading" ng-show="ctrl.loading">\n            <i class="fa fa-spinner fa-spin"></i>\n          </span>\n\n          <panel-header class="panel-title-container" panel-ctrl="ctrl"></panel-header>\n        </div>\n\n        <div class="panel-content">\n          <ng-transclude class="panel-height-helper"></ng-transclude>\n        </div>\n      </div>\n    </div>\n\n    <div ng-if="ctrl.panel.isEditing" ng-class="{\'panel-editor-container__editor\': ctrl.panel.isEditing,\n                                                 \'panel-height-helper\': !ctrl.panel.isEditing}">\n      <div class="tabbed-view tabbed-view--new">\n        <div class="tabbed-view-header">\n          <h3 class="tabbed-view-panel-title">\n            {{ctrl.pluginName}}\n          </h3>\n\n          <ul class="gf-tabs">\n            <li class="gf-tabs-item" ng-repeat="tab in ::ctrl.editorTabs">\n              <a class="gf-tabs-link" ng-click="ctrl.changeTab($index)" ng-class="{active: ctrl.editorTabIndex === $index}">\n                {{::tab.title}}\n              </a>\n            </li>\n          </ul>\n\n          <button class="tabbed-view-close-btn" ng-click="ctrl.exitFullscreen();">\n            <i class="fa fa-remove"></i>\n          </button>\n        </div>\n\n        <div class="tabbed-view-body">\n          <div ng-repeat="tab in ctrl.editorTabs" ng-if="ctrl.editorTabIndex === $index" class="panel-height-helper">\n            <panel-editor-tab editor-tab="tab" ctrl="ctrl" index="$index"></panel-editor-tab>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n',transclude:!0,scope:{ctrl:"="},link:function(t,e){var n,a,i,s,o=e.find(".panel-container"),l=e.find(".panel-content"),c=e.find(".panel-info-corner"),u=t.ctrl,d=!1,p=!1;function h(){a&&a.update()}function f(){var t=u.getInfoMode();c[0].className="panel-info-corner panel-info-corner--"+t,t&&(n&&n.destroy(),n=new wt.a({target:c[0],content:function(){return u.getInfoContent({mode:"tooltip"})},classes:u.error?"drop-error":"drop-help",openOn:"hover",hoverOpenDelay:100,tetherOptions:{attachment:"bottom left",targetAttachment:"top left",constraints:[{to:"window",attachment:"together",pin:!0}]}}))}u.panel.transparent&&(d=!0,o.addClass("panel-transparent",!0)),u.events.on("component-did-mount",function(){if(u.__proto__.constructor.scrollable){var t=l,e=l.find(":first").find(":first");t.addClass("baron baron__root baron__clipper panel-content--scrollable"),F()('\n            <div class="baron__track">\n              <div class="baron__bar"></div>\n            </div>\n          ').appendTo(t),e.addClass("baron__scroller"),(a=Oc()({root:t[0],scroller:e[0],bar:".baron__bar",barOnCls:"_scrollbar",scrollingCls:"_scrolling"})).scroll()}}),u.events.on("panel-size-changed",function(){u.calculatePanelHeight(),r(function(){h(),u.render()})}),u.events.on("view-mode-changed",function(){setTimeout(function(){u.calculatePanelHeight(),r(function(){u.render(),h()})})}),u.calculatePanelHeight(),u.events.on("render",function(){d!==u.panel.transparent&&(o.toggleClass("panel-transparent",!0===u.panel.transparent),d=u.panel.transparent),s=void 0!==u.panel.alert,p!==s&&(o.toggleClass("panel-has-alert",s),p=s),u.alertState?(i&&o.removeClass("panel-alert-state--"+i),"ok"!==u.alertState.state&&"alerting"!==u.alertState.state&&"pending"!==u.alertState.state||o.addClass("panel-alert-state--"+u.alertState.state),i=u.alertState.state):i&&(o.removeClass("panel-alert-state--"+i),i=null)}),t.$watchGroup(["ctrl.error","ctrl.panel.description"],f),t.$watchCollection("ctrl.panel.links",f),c.on("click",function(){n.close(),t.$apply(u.openInspector.bind(u))}),e.on("mouseenter",function(){o.toggleClass("panel-hover-highlight",!0),u.dashboard.setPanelFocus(u.panel.id)}),e.on("mouseleave",function(){o.toggleClass("panel-hover-highlight",!1),u.dashboard.setPanelFocus(0)}),t.$on("$destroy",function(){e.off(),c.off(),n&&n.destroy(),a&&a.dispose()})}}}]),Pu.directive("panelHelpCorner",["$rootScope",function(t){return{restrict:"E",template:'\n    <span class="alert-error panel-error small pointer" ng-if="ctrl.error" ng-click="ctrl.openInspector()">\n    <span data-placement="top" bs-tooltip="ctrl.error">\n    <i class="fa fa-exclamation"></i><span class="panel-error-arrow"></span>\n    </span>\n    </span>\n    ',link:function(t,e){}}}]);var $u=function(){function t(t,e,r,n,a,i){var s;t.init=function(){a.sidemenu=!1,bt.a.emit("toggle-sidemenu-hidden");var o=r.search();s=parseInt(o.panelId,10),bt.a.on("dashboard-initialized",t.initPanelScope),"script"===e.type||"snapshot"===e.type||e.uid?n.loadDashboard(e.type,e.slug,e.uid).then(function(e){e.meta.soloMode=!0,t.initDashboard(e,t)}):i.getDashboardBySlug(e.slug).then(function(t){if(t){var e=W.a.stripBaseFromUrl(t.meta.url.replace("/d/","/d-solo/"));r.path(e).replace()}})},t.initPanelScope=function(){var e=t.dashboard.getPanelInfoById(s);t.ctrl={dashboard:t.dashboard},t.panel=e.panel,t.panel.soloMode=!0,t.$index=0,t.panel||t.appEvent("alert-error",["未发现面板",""])},t.init()}return t.$inject=["$scope","$routeParams","$location","dashboardLoaderSrv","contextSrv","backendSrv"],t}();L.a.module("grafana.routes").controller("SoloPanelCtrl",$u);var Du={};function Ou(t){return t.create({scope:{ctrl:"=",editorTab:"=",index:"="},directive:function(t){var e=t.ctrl.pluginId,r=t.editorTab.title.toLowerCase().replace(" ","-");if(Du[e]){if(Du[e][r])return Du[e][r]}else Du[e]=[];var n={fn:function(){return t.editorTab.directiveFn()},name:"panel-editor-tab-"+e+r};return Du[e][r]=n,n}})}L.a.module("grafana.directives").directive("panelEditorTab",Ou);var Iu=L.a.module("grafana.directives"),Nu=function(){function t(){this.panelCtrl=this.queryCtrl.panelCtrl,this.target=this.queryCtrl.target,this.panel=this.panelCtrl.panel,this.target.refId||(this.target.refId=this.panelCtrl.dashboard.getNextQueryLetter(this.panel)),this.toggleCollapse(!0),this.target.isNew&&(delete this.target.isNew,this.toggleCollapse(!1)),this.panel.targets.length<4&&(this.collapsed=!1)}return t.prototype.toggleHideQuery=function(){this.target.hide=!this.target.hide,this.panelCtrl.refresh()},t.prototype.toggleCollapse=function(t){if(this.canCollapse){this.panelCtrl.__collapsedQueryCache||(this.panelCtrl.__collapsedQueryCache={}),t?this.collapsed=!1!==this.panelCtrl.__collapsedQueryCache[this.target.refId]:(this.collapsed=!this.collapsed,this.panelCtrl.__collapsedQueryCache[this.target.refId]=this.collapsed);try{this.collapsedText=this.queryCtrl.getCollapsedText()}catch(t){var e=t.message||t.toString();this.collapsedText="Error: "+e}}},t.prototype.toggleEditorMode=function(){this.canCollapse&&this.collapsed&&(this.collapsed=!1),this.queryCtrl.toggleEditorMode()},t.prototype.removeQuery=function(){this.panelCtrl.__collapsedQueryCache&&delete this.panelCtrl.__collapsedQueryCache[this.target.refId],this.panelCtrl.removeQuery(this.target)},t.prototype.duplicateQuery=function(){var t=L.a.copy(this.target);this.panelCtrl.addQuery(t)},t.prototype.moveQuery=function(t){this.panelCtrl.moveQuery(this.target,t)},t}();Iu.directive("queryEditorRow",function(){return{restrict:"E",controller:Nu,bindToController:!0,controllerAs:"ctrl",templateUrl:"public/app/features/panel/partials/query_editor_row.html",transclude:!0,scope:{queryCtrl:"=",canCollapse:"=",hasTextEditMode:"="}}});var Fu='\n<div class="query-troubleshooter" ng-if="ctrl.isOpen">\n  <div class="query-troubleshooter__header">\n    <a class="pointer" ng-click="ctrl.toggleMocking()">模拟响应</a>\n    <a class="pointer" ng-click="ctrl.toggleExpand()" ng-hide="ctrl.allNodesExpanded">\n      <i class="fa fa-plus-square-o"></i> 全部展开\n    </a>\n    <a class="pointer" ng-click="ctrl.toggleExpand()" ng-show="ctrl.allNodesExpanded">\n      <i class="fa fa-minus-square-o"></i> 全部折叠\n    </a>\n    <a class="pointer" clipboard-button="ctrl.getClipboardText()"><i class="fa fa-clipboard"></i> 复制到剪贴板</a>\n  </div>\n  <div class="query-troubleshooter__body" ng-hide="ctrl.isMocking">\n    <i class="fa fa-spinner fa-spin" ng-show="ctrl.isLoading"></i>\n    <div class="query-troubleshooter-json"></div>\n  </div>\n  <div class="query-troubleshooter__body" ng-show="ctrl.isMocking">\n    <div class="gf-form p-l-1 gf-form--v-stretch">\n\t\t\t<textarea class="gf-form-input" style="width: 95%" rows="10" ng-model="ctrl.mockedResponse"  placeholder="JSON"></textarea>\n    </div>\n  </div>\n</div>\n',qu=function(){function t(t,e){this.$timeout=e,this.onRequestErrorEventListener=this.onRequestError.bind(this),this.onRequestResponseEventListener=this.onRequestResponse.bind(this),bt.a.on("ds-request-response",this.onRequestResponseEventListener),bt.a.on("ds-request-error",this.onRequestErrorEventListener),t.$on("$destroy",this.removeEventsListeners.bind(this)),t.$watch("ctrl.isOpen",this.stateChanged.bind(this))}return t.$inject=["$scope","$timeout"],t.prototype.removeEventsListeners=function(){bt.a.off("ds-request-response",this.onRequestResponseEventListener),bt.a.off("ds-request-error",this.onRequestErrorEventListener)},t.prototype.toggleMocking=function(){this.isMocking=!this.isMocking},t.prototype.onRequestError=function(t){this.isOpen&&(this.isOpen=!0,this.hasError=!0,this.onRequestResponse(t))},t.prototype.stateChanged=function(){this.isOpen&&(this.panelCtrl.refresh(),this.isLoading=!0)},t.prototype.getClipboardText=function(){return this.jsonExplorer?JSON.stringify(this.jsonExplorer.json,null,2):""},t.prototype.handleMocking=function(t){var e;try{e=JSON.parse(this.mockedResponse)}catch(t){return void bt.a.emit("alert-error",["未能解析被模拟的响应"])}t.data=e},t.prototype.onRequestResponse=function(t){this.isOpen&&(this.isMocking?this.handleMocking(t):(this.isLoading=!1,(t=I.a.cloneDeep(t)).headers&&delete t.headers,t.config&&(t.request=t.config,delete t.config,delete t.request.transformRequest,delete t.request.transformResponse,delete t.request.paramSerializer,delete t.request.jsonpCallbackParam,delete t.request.headers,delete t.request.requestId,delete t.request.inspect,delete t.request.retry,delete t.request.timeout),t.data&&(t.response=t.data,200===t.status&&this.hasError&&(this.hasError=!1,this.isOpen=!1),delete t.data,delete t.status,delete t.statusText,delete t.$$config),this.$timeout(I.a.partial(this.renderJsonExplorer,t))))},t.prototype.toggleExpand=function(t){this.jsonExplorer&&(this.allNodesExpanded=!this.allNodesExpanded,this.jsonExplorer.openAtDepth(this.allNodesExpanded?20:1))},t}();G.e.directive("queryTroubleshooter",function(){return{restrict:"E",template:Fu,controller:qu,bindToController:!0,controllerAs:"ctrl",scope:{panelCtrl:"=",isOpen:"="},link:function(t,e,r,n){n.renderJsonExplorer=function(t){var r=e.find(".query-troubleshooter-json");n.jsonExplorer=new G.a(t,3,{animateOpen:!0});var a=n.jsonExplorer.render(!0);r.html(a)}}}});var Lu=L.a.module("grafana.directives"),Ru=function(){function t(t){this.ogeAlertSrv=t;var e=I.a.cloneDeep(t.getAllLevels()),r=this.panelCtrl.panel.ogeAlertColors;if(!I.a.isEmpty(r))for(var n in r)r[n]&&(e[n].useOrigin=r[n].useOrigin,r[n].color&&(e[n].color=r[n].color));this.colors=I.a.toArray(e)}return t.$inject=["ogeAlertSrv"],t.prototype.change=function(){this.panelCtrl.panel.ogeAlertColors={};for(var t=this.isDiffDefault(),e=0;e<this.colors.length;e++)this.panelCtrl.panel.ogeAlertColors[this.colors[e].code]=I.a.clone(this.colors[e]),t||delete this.panelCtrl.panel.ogeAlertColors[this.colors[e].code].color;this.panelCtrl.render()},t.prototype.isDiffDefault=function(){for(var t=this.ogeAlertSrv.getAllLevels(),e=0;e<this.colors.length;e++)if(this.colors[e].color!==t[this.colors[e].code].color)return!0;return!1},t.prototype.invert=function(){for(var t=I.a.cloneDeep(this.colors),e=0;e<this.colors.length;e++)this.colors[e].color=t[this.colors.length-1-e].color;this.change()},t.prototype.reset=function(){for(var t=this.ogeAlertSrv.getAllLevels(),e=0;e<this.colors.length;e++)this.colors[e].color=t[this.colors[e].code].color;this.change()},t}();Lu.directive("ogeAlertColorsSelector",function(){return{restrict:"E",template:'\n<div class="section gf-form-group">\n  <h5 class="section-heading">颜色设置</h5>\n  <div class="gf-form-inline" ng-repeat="c in ctrl.colors | orderBy:c.grade">\n    <div class="gf-form">\n      <label class="gf-form-label width-6" style="text-align:center;">{{c.name}}</label>\n      <div class="gf-form-label">\n        <spectrum-picker ng-model="c.color" ng-change="ctrl.change()" ></spectrum-picker>\n      </div>\n      <gf-form-switch class="gf-form" label-class="width-8" label="使用原生" checked="c.useOrigin"\n        tooltip="勾选此选项，则对应的报警等级使用控件原生的颜色显示"\n        on-change="ctrl.change()"></gf-form-switch>\n    </div>\n  </div>\n  <div class="gf-form">\n    <span class="gf-form-label"><a ng-click="ctrl.invert()">反转颜色</a></span>\n    <span class="gf-form-label"><a ng-click="ctrl.reset()">默认颜色</a></span>\n  </div>\n</div>\n',controller:Ru,bindToController:!0,controllerAs:"ctrl",transclude:!0,scope:{panelCtrl:"="}}});var ju=function(){function t(t,e,r){r.sidemenu=!1,t.navModel={main:{icon:"gicon gicon-branding",subTitle:"Preferences",text:"Select active organization"}},t.init=function(){t.getUserOrgs()},t.getUserOrgs=function(){e.get("/api/user/orgs").then(function(e){t.orgs=e})},t.setUsingOrg=function(t){e.post("/api/user/using/"+t.orgId).then(function(){window.location.href=B.a.appSubUrl+"/"})},t.init()}return t.$inject=["$scope","backendSrv","contextSrv"],t}();L.a.module("grafana.controllers").controller("SelectOrgCtrl",ju);var Uu=function(){function t(t,e,r,n){t.navModel=n.getNav("cfg","admin","global-orgs",1),t.newOrg={name:""},t.createOrg=function(){r.post("/api/orgs/",t.newOrg).then(function(t){r.post("/api/user/using/"+t.orgId).then(function(){window.location.href=B.a.appSubUrl+"/org"})})}}return t.$inject=["$scope","$http","backendSrv","navModelSrv"],t}();L.a.module("grafana.controllers").controller("NewOrgCtrl",Uu);var Vu=function(){function t(t,e,r){this.backendSrv=t,this.$location=r,this.navModel=e.getNav("cfg","users",0),this.invite={name:"",email:"",role:"Editor",sendEmail:!0}}return t.$inject=["backendSrv","navModelSrv","$location"],t.prototype.sendInvite=function(){var t=this;if(this.inviteForm.$valid)return this.backendSrv.post("/api/org/invites",this.invite).then(function(){t.$location.path("org/users/")})},t}();z.c.controller("UserInviteCtrl",Vu);var Bu=function(){function t(t,e,r){this.$scope=t,this.backendSrv=e,this.pages=[],this.perPage=50,this.page=1,this.showPaging=!1,this.navModel=r.getNav("cfg","admin","global-users",1),this.query="",this.getUsers()}return t.$inject=["$scope","backendSrv","navModelSrv"],t.prototype.getUsers=function(){var t=this,e=this.query;" "===this.query&&(e="%20"),this.backendSrv.get("/api/users/search?perpage="+this.perPage+"&page="+this.page+"&query="+e).then(function(e){t.users=e.users,t.page=e.page,t.perPage=e.perPage,t.totalPages=Math.ceil(e.totalCount/e.perPage),t.showPaging=t.totalPages>1,t.pages=[];for(var r=1;r<t.totalPages+1;r++)t.pages.push({page:r,current:r===t.page})})},t.prototype.navigateToPage=function(t){this.page=t.page,this.getUsers()},t.prototype.deleteUser=function(t){var e=this;this.$scope.appEvent("confirm-modal",{title:"Delete",text:"Do you want to delete "+t.login+"?",icon:"fa-trash",yesText:"Delete",onConfirm:function(){e.backendSrv.delete("/api/admin/users/"+t.id).then(function(){e.getUsers()})}})},t}(),Qu=function(){function t(t,e,r,n,a){t.user={},t.newOrg={name:"",role:"Editor"},t.permissions={},t.navModel=a.getNav("cfg","admin","global-users",1),t.init=function(){e.id&&(t.getUser(e.id),t.getUserOrgs(e.id))},t.getUser=function(e){r.get("/api/users/"+e).then(function(r){t.user=r,t.user_id=e,t.permissions.isGrafanaAdmin=r.isGrafanaAdmin})},t.setPassword=function(){if(t.passwordForm.$valid){var e={password:t.password};r.put("/api/admin/users/"+t.user_id+"/password",e).then(function(){n.path("/admin/users")})}},t.updatePermissions=function(){var e=t.permissions;r.put("/api/admin/users/"+t.user_id+"/permissions",e).then(function(){n.path("/admin/users")})},t.emailPattern=function(){var t=/^([a-z0-9]*[-_.]?[a-z0-9]+)+@([a-z0-9]*[-_]?[a-z0-9]+)+[\.][a-z]{2,3}([\.][a-z]{2})?$/;return{test:function(e){return t.test(e)}}}(),t.passwordPattern=function(){return{test:function(t){if(t.indexOf(" ")>-1)return!1;var e=0;return function(t){return!!t&&!!/[a-z]/.test(t)}(t)&&e++,function(t){return!!t&&!!/[A-Z]/.test(t)}(t)&&e++,function(t){return!!t&&!!/[0-9]/.test(t)}(t)&&e++,function(t){return""!=t&&new RegExp("[`~!@#$^&*%()_+=|{}':;',\\-\\[\\].<>/?~！@#￥……&*（）——|{}【】‘；：”“'。，、？]").test(t)}(t)&&e++,e>2}}}(),t.create=function(){t.userForm.$valid&&r.post("/api/admin/users",t.user).then(function(){n.path("/admin/users")})},t.getUserOrgs=function(e){r.get("/api/users/"+e+"/orgs").then(function(e){t.orgs=e})},t.update=function(){t.userForm.$valid&&r.put("/api/users/"+t.user_id,t.user).then(function(){n.path("/admin/users")})},t.updateOrgUser=function(e){r.patch("/api/orgs/"+e.orgId+"/users/"+t.user_id,e).then(function(){})},t.removeOrgUser=function(e){r.delete("/api/orgs/"+e.orgId+"/users/"+t.user_id).then(function(){t.getUser(t.user_id),t.getUserOrgs(t.user_id)})},t.orgsSearchCache=[],t.searchOrgs=function(e,n){t.orgsSearchCache.length>0?n(I.a.map(t.orgsSearchCache,"name")):r.get("/api/orgs",{query:""}).then(function(e){t.orgsSearchCache=e,n(I.a.map(e,"name"))})},t.addOrgUser=function(){if(t.addOrgForm.$valid){var e=I.a.find(t.orgsSearchCache,{name:t.newOrg.name});e&&(t.newOrg.loginOrEmail=t.user.login,r.post("/api/orgs/"+e.id+"/users/",t.newOrg).then(function(){t.getUser(t.user_id),t.getUserOrgs(t.user_id)}))}},t.init()}return t.$inject=["$scope","$routeParams","backendSrv","$location","navModelSrv"],t}(),Hu=function(){function t(t,e,r){t.init=function(){t.navModel=r.getNav("cfg","admin","global-orgs",1),t.getOrgs()},t.getOrgs=function(){e.get("/api/orgs").then(function(e){t.orgs=e})},t.deleteOrg=function(r){t.appEvent("confirm-modal",{title:"Delete",text:"Do you want to delete organization "+r.name+"?",text2:"All dashboards for this organization will be removed!",icon:"fa-trash",yesText:"Delete",onConfirm:function(){e.delete("/api/orgs/"+r.id).then(function(){t.getOrgs()})}})},t.init()}return t.$inject=["$scope","backendSrv","navModelSrv"],t}(),zu=function(){function t(t,e,r,n,a){t.init=function(){t.navModel=a.getNav("cfg","admin","global-orgs",1),e.id&&(t.getOrg(e.id),t.getOrgUsers(e.id))},t.getOrg=function(e){r.get("/api/orgs/"+e).then(function(e){t.org=e})},t.getOrgUsers=function(e){r.get("/api/orgs/"+e+"/users").then(function(e){t.orgUsers=e})},t.update=function(){t.orgDetailsForm.$valid&&r.put("/api/orgs/"+t.org.id,t.org).then(function(){n.path("/admin/orgs")})},t.updateOrgUser=function(t){r.patch("/api/orgs/"+t.orgId+"/users/"+t.userId,t)},t.removeOrgUser=function(e){r.delete("/api/orgs/"+e.orgId+"/users/"+e.userId).then(function(){t.getOrgUsers(t.org.id)})},t.init()}return t.$inject=["$scope","$routeParams","backendSrv","$location","navModelSrv"],t}(),Gu=function(){function t(t,e,r){this.$routeParams=t,this.backendSrv=e,this.buttonNames=["primary","secondary","inverse","success","warning","danger"],this.buttonSizes=["btn-small","","btn-large"],this.buttonVariants=["-"],this.navModel=r.getNav("cfg","admin","styleguide",1),this.theme=B.a.bootData.user.lightTheme?"light":"dark"}return t.$inject=["$routeParams","backendSrv","navModelSrv"],t.prototype.switchTheme=function(){this.$routeParams.theme="dark"===this.theme?"light":"dark";var t={theme:this.$routeParams.theme};this.backendSrv.put("/api/user/preferences",t).then(function(){window.location.href=window.location.href})},t}(),Wu=function(){function t(t,e,r){this.navModel=r.getNav("cfg","admin","server-settings",1),e.get("/api/admin/settings").then(function(e){t.settings=e})}return t.$inject=["$scope","backendSrv","navModelSrv"],t}(),Yu=function(){function t(t){this.navModel=t.getNav("cfg","admin",1)}return t.$inject=["navModelSrv"],t}();z.c.controller("AdminListUsersCtrl",Bu),z.c.controller("AdminEditUserCtrl",Qu),z.c.controller("AdminListOrgsCtrl",Hu),z.c.controller("AdminEditOrgCtrl",zu),z.c.controller("AdminSettingsCtrl",Wu),z.c.controller("AdminHomeCtrl",Yu),z.c.controller("StyleGuideCtrl",Gu);var Ku=function(){function t(t,e,r,n,a){var i=this;this.$routeParams=t,this.backendSrv=e,this.$location=r,this.$templateCache=n,this.testSeverity="critical",this.defaults={type:"email",sendReminder:!1,disableResolveMessage:!1,frequency:"15m",settings:{httpMethod:"POST",autoResolve:!0,uploadImage:!0},isDefault:!1},this.navModel=a.getNav("alerting","channels",0),this.isNew=!this.$routeParams.id,this.getFrequencySuggestion=function(){return["1m","5m","10m","15m","30m","1h"]},this.backendSrv.get("/api/alert-notifiers").then(function(t){i.notifiers=t;for(var e=0,r=i.notifiers;e<r.length;e++){var n=r[e];i.$templateCache.put(i.getNotifierTemplateId(n.type),n.optionsTemplate)}return i.$routeParams.id?i.backendSrv.get("/api/alert-notifications/"+i.$routeParams.id).then(function(t){return i.navModel.breadcrumbs.push({text:t.name}),i.navModel.node={text:t.name},t.settings=I.a.defaults(t.settings,i.defaults.settings),t}):(i.navModel.breadcrumbs.push({text:"新通道"}),i.navModel.node={text:"新通道"},I.a.defaults(i.model,i.defaults))}).then(function(t){i.model=t,i.notifierTemplateId=i.getNotifierTemplateId(i.model.type)})}return t.$inject=["$routeParams","backendSrv","$location","$templateCache","navModelSrv"],t.prototype.save=function(){var t=this;this.theForm.$valid&&(this.model.id?this.backendSrv.put("/api/alert-notifications/"+this.model.id,this.model).then(function(e){t.model=e,G.c.emit("alert-success",["通知已更新",""])}).catch(function(t){t.data&&t.data.error&&G.c.emit("alert-error",[t.data.error])}):this.backendSrv.post("/api/alert-notifications",this.model).then(function(e){G.c.emit("alert-success",["通知已创建",""]),t.$location.path("alerting/notifications")}).catch(function(t){t.data&&t.data.error&&G.c.emit("alert-error",[t.data.error])}))},t.prototype.getNotifierTemplateId=function(t){return"notifier-options-"+t},t.prototype.typeChanged=function(){this.model.settings=I.a.defaults({},this.defaults.settings),this.notifierTemplateId=this.getNotifierTemplateId(this.model.type)},t.prototype.testNotification=function(){if(this.theForm.$valid){var t={name:this.model.name,type:this.model.type,frequency:this.model.frequency,settings:this.model.settings};this.backendSrv.post("/api/alert-notifications/test",t).then(function(t){G.c.emit("alert-success",["测试发送通知",""])})}},t}();G.e.controller("AlertNotificationEditCtrl",Ku);var Ju=function(){function t(t,e){this.backendSrv=t,this.loadNotifications(),this.navModel=e.getNav("alerting","channels",0)}return t.$inject=["backendSrv","navModelSrv"],t.prototype.loadNotifications=function(){var t=this;this.backendSrv.get("/api/alert-notifications").then(function(e){t.notifications=e})},t.prototype.deleteNotification=function(t){var e=this;this.backendSrv.delete("/api/alert-notifications/"+t).then(function(){e.notifications=e.notifications.filter(function(e){return e.id!==t})})},t}();G.e.controller("AlertNotificationsListCtrl",Ju);var Xu=function(){function t(t){this.navModel=t.getNav("dashboards","manage-dashboards",0)}return t.$inject=["navModelSrv"],t}(),Zu=function(){function t(t,e,r){var n=this;this.$rootScope=t,this.backendSrv=e,this.navModel=r.getNav("dashboards","snapshots",0),this.backendSrv.get("/api/dashboard/snapshots").then(function(t){n.snapshots=t})}return t.$inject=["$rootScope","backendSrv","navModelSrv"],t.prototype.removeSnapshotConfirmed=function(t){var e=this;I.a.remove(this.snapshots,{key:t.key}),this.backendSrv.delete("/api/snapshots/"+t.key).then(function(){},function(){e.snapshots.push(t)})},t.prototype.removeSnapshot=function(t){var e=this;this.$rootScope.appEvent("confirm-modal",{title:"Delete",text:"Are you sure you want to delete snapshot "+t.name+"?",yesText:"Delete",icon:"fa-trash",onConfirm:function(){e.removeSnapshotConfirmed(t)}})},t}();z.c.controller("DashboardListCtrl",Xu),z.c.controller("SnapshotListCtrl",Zu);var td=function(){function t(t,e,r){this.backendSrv=t,this.$location=e,this.navModel=r.getNav("cfg","teams",0)}return t.$inject=["backendSrv","$location","navModelSrv"],t.prototype.create=function(){var t=this,e={name:this.name,email:this.email};this.backendSrv.post("/api/teams",e).then(function(e){e.teamId&&t.$location.path("/org/teams/edit/"+e.teamId)})},t}();z.c.controller("CreateTeamCtrl",td);var ed=function(){function t(t,e,r,n){this.backendSrv=t,this.contextSrv=e,this.$location=r,this.teams=[],this.orgs=[],this.showTeamsList=!1,this.showOrgsList=!1,this.readonlyLoginFields=B.a.disableLoginForm,this.getUser(),this.getUserTeams(),this.getUserOrgs(),this.navModel=n.getNav("profile","profile-settings",0)}return t.$inject=["backendSrv","contextSrv","$location","navModelSrv"],t.prototype.getUser=function(){var t=this;this.backendSrv.get("/api/user").then(function(e){t.user=e,t.user.theme=e.theme||"dark"})},t.prototype.getUserTeams=function(){var t=this;this.backendSrv.get("/api/user/teams").then(function(e){t.teams=e,t.showTeamsList=t.teams.length>0})},t.prototype.getUserOrgs=function(){var t=this;this.backendSrv.get("/api/user/orgs").then(function(e){t.orgs=e,t.showOrgsList=e.length>1})},t.prototype.setUsingOrg=function(t){this.backendSrv.post("/api/user/using/"+t.orgId).then(function(){window.location.href=B.a.appSubUrl+"/profile"})},t.prototype.update=function(){var t=this;this.userForm.$valid&&this.backendSrv.put("/api/user/",this.user).then(function(){t.contextSrv.user.name=t.user.name||t.user.login,t.oldTheme!==t.user.theme&&(window.location.href=B.a.appSubUrl+t.$location.path())})},t}();G.e.controller("ProfileCtrl",ed);var rd=function(){function t(t,e,r,n){t.command={},t.authProxyEnabled=B.a.authProxyEnabled,t.ldapEnabled=B.a.ldapEnabled,t.navModel=n.getNav("profile","change-password",0),t.passwordPattern=function(){return{test:function(t){if(t.indexOf(" ")>-1)return!1;var e=0;return function(t){return!!t&&!!/[a-z]/.test(t)}(t)&&e++,function(t){return!!t&&!!/[A-Z]/.test(t)}(t)&&e++,function(t){return!!t&&!!/[0-9]/.test(t)}(t)&&e++,function(t){return""!=t&&new RegExp("[`~!@#$^&*%()_+=|{}':;',\\-\\[\\].<>/?~！@#￥……&*（）——|{}【】‘；：”“'。，、？]").test(t)}(t)&&e++,e>2}}}(),t.changePassword=function(){t.userForm.$valid&&(t.command.oldPassword!==t.command.newPassword?t.command.newPassword===t.command.confirmNew?e.put("/api/user/password",t.command).then(function(){r.path("profile")}):t.appEvent("alert-warning",["新密码不匹配",""]):t.appEvent("alert-warning",["新旧密码不能相同",""]))}}return t.$inject=["$scope","backendSrv","$location","navModelSrv"],t}();L.a.module("grafana.controllers").controller("ChangePasswordCtrl",rd);var nd=r(177);Object(Mc.a)("prefsControl",nd.a,["resourceUri"]),I.a.move=function(t,e,r){return t.splice(r,0,t.splice(e,1)[0]),t};var ad=r(1363);ad.keys().forEach(function(t){ad(t)}),(new(function(){function t(){this.preBootModules=[],this.registerFunctions={},this.ngModuleDependencies=[]}return t.prototype.useModule=function(t){return this.preBootModules?this.preBootModules.push(t):I.a.extend(t,this.registerFunctions),this.ngModuleDependencies.push(t.name),t},t.prototype.init=function(){var t=this,e=L.a.module("grafana",[]);H.a.locale(B.a.bootData.user.locale),e.config(["$locationProvider","$controllerProvider","$compileProvider","$filterProvider","$httpProvider","$provide",function(e,r,n,a,i,s){n.preAssignBindingsEnabled(!0),"development"!==B.a.buildInfo.env&&n.debugInfoEnabled(!1),i.useApplyAsync(!0),t.registerFunctions.controller=r.register,t.registerFunctions.directive=n.directive,t.registerFunctions.factory=s.factory,t.registerFunctions.service=s.service,t.registerFunctions.filter=a.register,s.decorator("$http",["$delegate","$templateCache",function(t,e){var r=t.get;return t.get=function(t,n){return t.match(/\.html$/)&&(e.get(t)||(t+="?v="+(new Date).getTime())),r(t,n)},t}])}]),this.ngModuleDependencies=["grafana.core","ngRoute","ngSanitize","$strap.directives","ang-drag-drop","grafana","pasvaz.bindonce","ui.bootstrap","ui.bootstrap.tpls","react"],I.a.each(z.a,function(e){t.useModule(e)}),z.b.config(mt),Object(G.g)(),F.a.fn.tooltip.defaults.animation=!1,L.a.bootstrap(document,this.ngModuleDependencies).invoke(function(){I.a.each(t.preBootModules,function(e){I.a.extend(e,t.registerFunctions)}),t.preBootModules=null})},t}())).init()}]);
//# sourceMappingURL=app.7d9a1dea2050ea97654a.js.map