{"version":3,"sources":["../src/pageing.js"],"names":["link","scope","elem","attrs","ctrl","data","name","value","alarmCode","kks","geoCoordMap","convertData","res","i","length","geoCoord","push","concat","getAlarmData","eoption","title","padding","text","left","textStyle","color","fontSize","show","tooltip","trigger","formatter","params","ticket","callback","legend","orient","y","x","geo","map","label","normal","emphasis","roam","itemStyle","areaColor","borderColor","series","type","coordinateSystem","symbolSize","val","position","registerMap","$","ajax","url","dataType","async","success","chinaJson","echarts","events","on","nameArr","colorArr","effectScatter","showEffectOn","rippleEffect","brushType","hoverAnimation","shadowBlur","shadowColor","zlevel","div","find","myChart","init","setOption","seriesType","console","log","window","open","_"],"mappings":"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","file":"pageing.js","sourcesContent":["import _ from 'lodash';\r\nimport $ from 'jquery';\r\nimport 'jquery.flot';\r\nimport 'jquery.flot.pie';\r\nimport echarts from 'vendor/echarts/echarts.min.js';\r\n\r\nexport default function link(scope, elem, attrs, ctrl) {\r\n\r\n\tvar data = [\r\n\t\t {name: '向家坝', value: 190, alarmCode: 0, kks : \"EB001\"},\r\n\t\t {name: '拉拉山', value: 101.9, alarmCode: 1, kks : \"EB002\"},\r\n\t\t {name: '景洪', value: 102.6, alarmCode: -1, kks : \"EB003\"},\r\n\t\t {name: '青居', value: 150.6, alarmCode: 2, kks : \"EB004\"},\r\n\t\t {name: '小天都', value: 150.6, alarmCode: 3, kks : \"EB005\"}\r\n\t];\r\n\r\n\tvar geoCoordMap = {\r\n\t\t'向家坝': [104.4171,28.6475],\r\n\t\t'拉拉山': [99.1244,30.0122],\r\n\t\t'景洪': [100.8393,22.0119],\r\n\t\t'青居': [106.1099,30.6827],\r\n\t\t'小天都': [102.1785,30.0778]\r\n\t};\r\n\r\n\tvar convertData = function (data) {\r\n\t\tvar res = [];\r\n\t\tfor (var i = 0; i < data.length; i++) {\r\n\t\t\tvar geoCoord = geoCoordMap[data[i].name];\r\n\t\t\tif (geoCoord) {\r\n\t\t\t\tres.push({\r\n\t\t\t\t\tname: data[i].name,\r\n\t\t\t\t\tkks:  data[i].kks,\r\n\t\t\t\t\tvalue: geoCoord.concat(data[i].value)\r\n\t\t\t\t\t//value: [data[i].value, 0]\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn res;\r\n\t};\r\n\t\r\n\tfunction getAlarmData(data, alarmCode) {\r\n\t\tvar res = [];\r\n\t\tfor (var i = 0; i < data.length; i++) {\r\n\t\t\tif(data[i].alarmCode == alarmCode){\r\n\t\t\t\tres.push(data[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn res;\r\n\t};\r\n\r\n\tvar eoption = {\r\n\t\t//backgroundColor: '#141414',\r\n\t\ttitle: {\r\n\t\t\tpadding: [20, 10],\r\n\t\t\ttext: '水电智能运维平台',\r\n\t\t\tleft: 'center',\r\n\t\t\ttextStyle: {\r\n\t\t\t\tcolor: '#fff',\r\n\t\t\t\tfontSize: 35\r\n\t\t\t},\r\n\t\t\tshow:false\r\n\t\t},\r\n\t\ttooltip : {\r\n\t\t\ttrigger: 'item',\r\n\t\t\tformatter: function (params, ticket, callback) {\r\n\t\t\t\t return '发电量：' + params.value[2] + \" MW\";\r\n\t\t\t }\r\n\t\t},\r\n\t\tlegend: {\r\n\t\t\torient: 'horizontal',\r\n\t\t\ty: 'bottom',\r\n\t\t\tx:'left',\r\n\t\t\tdata:['pm2.5'],\r\n\t\t\ttextStyle: {\r\n\t\t\t\tcolor: '#fff'\r\n\t\t\t}\r\n\t\t},\r\n\t\tgeo: {\r\n\t\t\tmap: 'china',\r\n\t\t\tlabel: {\r\n\t\t\t\tnormal: {\r\n\t\t\t\t\tshow: true\r\n\t\t\t\t},\r\n\t\t\t\temphasis: {\r\n\t\t\t\t\tshow: true\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\troam: true,\r\n\t\t\titemStyle: {\r\n\t\t\t\tnormal: {\r\n\t\t\t\t\tareaColor: '#323c48',\r\n\t\t\t\t\tborderColor: '#111'\r\n\t\t\t\t},\r\n\t\t\t\temphasis: {\r\n\t\t\t\t\tareaColor: '#2a333d'\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tseries : [\r\n\t\t\t\t{\r\n\t\t\t\tname: '发电量',\r\n\t\t\t\ttype: 'scatter',\r\n\t\t\t\tcoordinateSystem: 'geo',\r\n\t\t\t\tdata: convertData(getAlarmData(data, -1)),\r\n\t\t\t\tsymbolSize: function (val) {\r\n\t\t\t\t\treturn val[0] / 10;\r\n\t\t\t\t},\r\n\t\t\t\tlabel: {\r\n\t\t\t\t\tnormal: {\r\n\t\t\t\t\t\tformatter: '{b}',\r\n\t\t\t\t\t\tposition: 'right',\r\n\t\t\t\t\t\tshow: true,\r\n\t\t\t\t\t},\r\n\t\t\t\t\temphasis: {\r\n\t\t\t\t\t\tshow: true\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\titemStyle: {\r\n\t\t\t\t\tnormal: {\r\n\t\t\t\t\t\tcolor: '#ddb926'\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t]\r\n\t};\r\n\r\n\tfunction registerMap(){\r\n\t\t$.ajax({\r\n\t\t\ttype: 'GET',\r\n\t\t\turl: 'public/vendor/echarts/china.json',\r\n\t\t\tdataType: 'json',\r\n\t\t\tasync: false,\r\n\t\t\tsuccess : function (chinaJson) {\r\n\t\t\t\techarts.registerMap('china', chinaJson);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\r\n\tctrl.events.on('render', function() {\r\n\t\tregisterMap();\r\n\t\t\r\n\t\tvar nameArr = [\"优秀\", \"合格\", \"报警\" ,\"危险\"];\r\n\t\tvar colorArr = [\"rgba(0, 255, 0, 0.7)\", \"rgba(0, 170, 0, 0.7)\", \"rgba(255, 255, 0, 0.7)\", \"rgba(255, 0, 0, 0.7)\"];\r\n\t\tfor(var i=0; i<=3; i++){\r\n\t\t\tvar effectScatter = {\r\n\t\t\t\tname: nameArr[i],\r\n\t\t\t\ttype: 'effectScatter',\r\n\t\t\t\tcoordinateSystem: 'geo',\r\n\t\t\t\tdata: convertData(getAlarmData(data, i)),\r\n\t\t\t\tsymbolSize: function (val) {\r\n\t\t\t\t\treturn val[0] / 10;\r\n\t\t\t\t},\r\n\t\t\t\tshowEffectOn: 'render',\r\n\t\t\t\trippleEffect: {\r\n\t\t\t\t\tbrushType: 'stroke'\r\n\t\t\t\t},\r\n\t\t\t\thoverAnimation: true,\r\n\t\t\t\tlabel: {\r\n\t\t\t\t\tnormal: {\r\n\t\t\t\t\t\tformatter: '{b}',\r\n\t\t\t\t\t\tposition: 'right',\r\n\t\t\t\t\t\tshow: true,\r\n\t\t\t\t\t\ttextStyle: {\r\n\t\t\t\t\t\t\tfontSize: 15\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\titemStyle: {\r\n\t\t\t\t\tnormal: {\r\n\t\t\t\t\t\tcolor: colorArr[i],\r\n\t\t\t\t\t\tshadowBlur: 10,\r\n\t\t\t\t\t\tshadowColor: '#333',\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tzlevel: 1\r\n\t\t\t}\r\n\t\t\teoption.series.push(effectScatter);\r\n\t\t}\r\n\t\teoption.legend.data = nameArr;\r\n\t\t\r\n\t\tvar div = elem.find('.echarts_main');\r\n\t\tvar myChart = echarts.init(div[0]);\r\n\t\tmyChart.setOption(eoption);\r\n\t   \r\n\t\tmyChart.on('click', function (params) {\r\n\t\t   if(params.seriesType && params.seriesType == \"effectScatter\"){\r\n\t\t\t   console.log(params.data.kks);\r\n\t\t\t   //跳转主接线图页面：可以根据机组寻找路径，然后再弹出\r\n\t\t\t   window.open(\"http://www.baidu.com?var-kks=\" + params.data.kks);\r\n\t\t   }\r\n\t\t});\r\n\t});\r\n}\r\n\r\n"]}