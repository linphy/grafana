{"version":3,"sources":["../../src/fault_ctrl.js"],"names":["MetricsPanelCtrl","_","panelOptionDefaults","metrics","colors","name","color","fontFamily","fontSize","fontStyle","allDescriptions","allMethods","titleWidth","height","titleBgColor","FaultPanelCtrl","$scope","$injector","defaults","panel","options","events","on","onInitEditMode","bind","onDataReceived","onRender","addEditorTab","dataList","isEmpty","data","rows","i","length","item","level","description","method","render","scope","elem","attrs","ctrl","titleWid","find","width","push","reverse","templateUrl"],"mappings":"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","file":"fault_ctrl.js","sourcesContent":["import {\r\n\tMetricsPanelCtrl\r\n}\r\nfrom 'app/plugins/sdk';\r\nimport _ from 'lodash';\r\nimport './css/fault-panel.css!';\r\n\r\nvar panelOptionDefaults = {\r\n\tmetrics: [],\r\n\tcolors: [\r\n\t\t{name:'正常',color:\"rgba(50, 172, 45, 0.97)\"},\r\n\t\t{name:'轻微',color:\"rgba(237, 129, 40, 0.89)\"},\r\n\t\t{name:'严重',color:\"rgba(245, 54, 54, 0.9)\"},\r\n\t],\r\n\tfontFamily: '微软雅黑',\r\n\tfontSize: '100%',\r\n\tfontStyle: 'normal',\r\n\tallDescriptions: [],\r\n\tallMethods: [],\r\n\ttitleWidth: 40,\r\n\theight: 100,\r\n\ttitleBgColor: 'grey'\r\n};\r\n\r\nexport class FaultPanelCtrl extends MetricsPanelCtrl {\r\n\r\n\t/** @ngInject */\r\n\tconstructor($scope, $injector) {\r\n\t\tsuper($scope, $injector);\r\n\r\n\t\t_.defaults(this.panel, {\r\n\t\t\toptions: {}\r\n\t\t}); //将panelDefaults属性附加到this.panel上\r\n\t\t_.defaults(this.panel.options, panelOptionDefaults);\r\n\r\n\t\tthis.events.on('init-edit-mode', this.onInitEditMode.bind(this));\r\n\t\tthis.events.on('data-received', this.onDataReceived.bind(this));\r\n\t\tthis.events.on('render', this.onRender.bind(this));\r\n\t}\r\n\r\n\tonInitEditMode() {\r\n\t\tthis.addEditorTab('Options',\r\n\t\t\t'public/plugins/oge_fault_diagnosis/editor.html', 2);\r\n\t}\r\n\r\n\tonDataReceived(dataList) {\r\n\t\tthis.panel.options.metrics = [];\r\n\r\n\t\tif (_.isEmpty(dataList)) return;\r\n\t\tthis.data = dataList[0].rows?dataList[0].rows:[];\r\n\r\n\t\tfor (var i = 0; i < this.data.length; i++) {\r\n\t\t\tvar item = this.data[i];\r\n\t\t\tthis.panel.options.metrics[i] ={\r\n\t\t\t\tname: item[0],\r\n\t\t\t\tcolor:'',\r\n\t\t\t\tlevel: item[1],\r\n\t\t\t\tdescription: item[2],\r\n\t\t\t\tmethod: item[3]\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.render();\r\n\t}\r\n\r\n\tonRender() {\r\n\t}\r\n\r\n\tlink(scope, elem, attrs, ctrl) {\r\n\t\tctrl.events.on('render', function () {\r\n\t\t\tctrl.panel.options.height = ctrl.height-20;\r\n\t\t\tlet titleWid = elem.find('.faultTitle').width();\r\n\t\t\tctrl.panel.options.titleWidth = titleWid?titleWid:40;\r\n\t\t\tif (_.isEmpty(ctrl.panel.options.metrics)) return;\r\n\t\t\tctrl.panel.options.allMethods = [];\r\n\t\t\tctrl.panel.options.allDescriptions =[];\r\n\t\t\tfor (var i = 0; i < ctrl.panel.options.metrics.length; i++) {\r\n\t\t\t\tvar item = ctrl.panel.options.metrics[i];\r\n\t\t\t\tif(item.level===0) {\r\n\t\t\t\t\titem.color = ctrl.panel.options.colors[0].color;\r\n\t\t\t\t} else if (item.level===1) {\r\n\t\t\t\t\titem.color = ctrl.panel.options.colors[1].color;\r\n\t\t\t\t\tif(item.description !== '') {\r\n\t\t\t\t\t\tctrl.panel.options.allDescriptions.push(item.name+': '+item.description);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (item.method !== '') {\r\n\t\t\t\t\t\tctrl.panel.options.allMethods.push(item.name+': '+item.method);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (item.level===2) {\r\n\t\t\t\t\titem.color = ctrl.panel.options.colors[2].color;\r\n\t\t\t\t\tif(item.description !== '') {\r\n\t\t\t\t\t\tctrl.panel.options.allDescriptions.push(item.name+': '+item.description);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (item.method !== '') {\r\n\t\t\t\t\t\tctrl.panel.options.allMethods.push(item.name+': '+item.method);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tinvertColorOrder() {\r\n\t\tthis.panel.options.colors.reverse();\r\n\t\tthis.render();\r\n\t}\r\n\r\n}\r\n\r\nFaultPanelCtrl.templateUrl = 'module.html';"]}