{"version":3,"sources":["../src/manualtable_ctrl_v2.js"],"names":["OgeAlertMetricsPanelCtrl","angular","_","$","kbn","config","TimeSeries","panelDefaults","dataAndRefId","numFour","data","valueFontSize","valuesUrl","dataPrecise","statvalues","fontSize","displayMode","link","type","ManualTableCtrl","$scope","$injector","backendSrv","templateSrv","timeSrv","linkSrv","showCover","defaults","panel","displayModeOptions","name","value","valueShowStatOptions","text","manualTableElem","panelNewHeight","events","on","onInitEditMode","bind","onDataReceived","onDataError","that","fontSizes","addEditorTab","err","dataList","compare","prop","obj1","obj2","val1","val2","isNaN","Number","length","alarm","undefined","j","level","color","getAlertLevelColor","dataOne","dataTwo","refId","push","datapoints","isArray","totalNum","statMax","statMin","i","parseFloat","toFixed","lastPoint","last","lastValue","firstValue","sort","concat","getdataAndRefId","cursor","innerIndex","tbodyElem","find","tableStyle","ogeAlertEnabled","ogeAlertColorType","outerIndex","urlIndex","dashUri","url","theTemplates","variables","linkInfo","getPanelLinkAnchorInfo","window","open","href","target","inde","colStyle","tableArr","colWidth","Array","column","row","id","count","fontsize","rowLength","subtract","pop","subtractTableArr","tempArr","columnLength","dataAndRefIdOptions","x","splice","newDataAndRefId","obj","isExist","aj","newTarget","substr","source","sourceCopy","item","objDeepCopy","queryStr","callback","search","query","then","hits","dashboards","map","dash","title","dashboard","uri","scope","elem","attrs","ctrl","height","templateUrl"],"mappings":"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","file":"manualtable_ctrl_v2.js","sourcesContent":["import {\r\n    OgeAlertMetricsPanelCtrl\r\n} from 'app/plugins/sdk';\r\nimport angular from 'angular';\r\nimport _ from 'lodash';\r\nimport $ from 'jquery';\r\nimport './css/multistat-panel.css!';\r\nimport kbn from 'app/core/utils/kbn';\r\nimport config from 'app/core/config';\r\nimport TimeSeries from 'app/core/time_series2';\r\n\r\nvar panelDefaults = {\r\n    dataAndRefId: [],\r\n    numFour: [2, 2],\r\n    data: [],\r\n    valueFontSize: '100%',\r\n    valuesUrl: [],\r\n    dataPrecise: 1,\r\n    statvalues: 'current',\r\n    fontSize: '100%',\r\n    displayMode: 'text',\r\n    link: [{\r\n        type: 'dashboard'\r\n    }],\r\n};\r\nvar that;\r\nexport class ManualTableCtrl extends OgeAlertMetricsPanelCtrl {\r\n\r\n    constructor($scope, $injector, backendSrv, templateSrv, timeSrv, linkSrv) {\r\n        super($scope, $injector, {\r\n            showCover: true\r\n        });\r\n        _.defaults(this.panel, panelDefaults);\r\n        this.displayModeOptions = [{\r\n                name: '文本',\r\n                value: 'text'\r\n            },\r\n            {\r\n                name: '值',\r\n                value: 'value'\r\n            }\r\n        ]\r\n        this.valueShowStatOptions = [{\r\n                text: 'Avg',\r\n                value: 'avg'\r\n            },\r\n            {\r\n                text: 'Min',\r\n                value: 'min'\r\n            },\r\n            {\r\n                text: 'Max',\r\n                value: 'max'\r\n            },\r\n            {\r\n                text: 'Total',\r\n                value: 'total'\r\n            },\r\n            {\r\n                text: 'Count',\r\n                value: 'count'\r\n            },\r\n            {\r\n                text: 'Current',\r\n                value: 'current'\r\n            },\r\n        ];\r\n        this.backendSrv = backendSrv;\r\n        this.timeSrv = timeSrv;\r\n        this.linkSrv = linkSrv;\r\n        this.manualTableElem = [];\r\n        this.panelNewHeight = '';\r\n        this.events.on('init-edit-mode', this.onInitEditMode.bind(this));\r\n        this.events.on('data-received', this.onDataReceived.bind(this));\r\n        this.events.on('data-error', this.onDataError.bind(this));\r\n        that = this;\r\n    }\r\n\r\n    onInitEditMode() {\r\n        this.panel.fontSizes = ['20%', '30%', '50%', '70%', '80%', '100%', '110%', '120%','130%','140%', '150%','160%','170%', '200%'];\r\n        this.addEditorTab('Options', 'public/plugins/oge-manualtable-v2/editor.html', 2);\r\n        this.addEditorTab('Url Setting', 'public/plugins/oge-manualtable-v2/urlsetting.html', 3);\r\n    }\r\n\r\n    onDataError(err) {\r\n        this.onDataReceived([]);\r\n    }\r\n    onDataReceived(dataList) {\r\n    var data=[];\r\n    data = dataList;\r\n    var compare = function (prop) {\r\n      return function (obj1, obj2) {\r\n        var val1 = obj1[prop];\r\n        var val2 = obj2[prop];\r\n        if (!isNaN(Number(val1)) && !isNaN(Number(val2))) {\r\n            val1 = Number(val1);\r\n            val2 = Number(val2);\r\n        }\r\n        if (val1 < val2) {\r\n            return -1;\r\n        } else if (val1 > val2) {\r\n            return 1;\r\n        } else {\r\n            return 0;\r\n        }            \r\n      } \r\n    }\r\n    //处理告警 (你原来的代码，删除了部分，改动了一下部分)   \r\n    if (dataList !== null && dataList.length > 0 && dataList[0].alarm !== undefined) {\r\n        for(var j=0;j< data.length;j++) {\r\n          if(data[j].alarm.level == 0){\r\n            data[j].color = '';  \r\n          }\r\n          data[j].color = this.getAlertLevelColor(data[j].alarm.level);\r\n        }     \r\n    }\r\n    if(dataList && dataList.length > 0) {\r\n      let dataOne = [];\r\n      let dataTwo = [];\r\n      for(var j = 0; j < dataList.length; j++){\r\n        if (isNaN(Number(data[j].refId))) {\r\n          dataOne.push(data[j]);\r\n        } else {\r\n          dataTwo.push(data[j]);\r\n        }\r\n        if((dataList[j].datapoints === undefined) || (dataList[j].datapoints.length === 0) || !(_.isArray(dataList[j].datapoints[0]))){\r\n          dataList[j].value = '';\r\n          data[j].value = '';\r\n          continue;\r\n        }\r\n        var totalNum = 0;\r\n        var statMax = dataList[j].datapoints[0][0];\r\n        var statMin = dataList[j].datapoints[0][0];\r\n        for(var i = 0; i < dataList[j].datapoints.length; i++) {\r\n          if(_.isArray(dataList[j].datapoints[i])){\r\n            var value = dataList[j].datapoints[i][0];\r\n            if(statMax < value) {\r\n              statMax = value;\r\n            }\r\n            if(statMin > value) {\r\n              statMin = value;\r\n            }\r\n            totalNum += value;\r\n          } else {\r\n            dataList[j].value = '';\r\n          }\r\n        }\r\n        switch(this.panel.statvalues) {\r\n          case 'avg':\r\n            data[j].value = parseFloat((totalNum/dataList[j].datapoints.length).toFixed(this.panel.dataPrecise));\r\n            break;\r\n          case 'min':\r\n            data[j].value = parseFloat(statMin.toFixed(this.panel.dataPrecise));\r\n            break;\r\n          case 'max':\r\n            data[j].value = parseFloat(statMax.toFixed(this.panel.dataPrecise));\r\n            break;\r\n          case 'total':\r\n            data[j].value = parseFloat(totalNum.toFixed(this.panel.dataPrecise));\r\n            break;\r\n          case 'count':\r\n            data[j].value = parseFloat(dataList[j].datapoints.length);\r\n            break;\r\n          default:\r\n            var lastPoint = _.last(dataList[j].datapoints);\r\n            var lastValue = _.isArray(lastPoint) ? lastPoint[0] : null;\r\n            var firstValue= _.isArray(lastPoint) ? lastPoint[1] : null;\r\n            if(lastValue == null) {\r\n              data[j].value = '';\r\n            } else {\r\n              data[j].value = parseFloat(lastValue.toFixed(this.panel.dataPrecise));\r\n            }\r\n        }\r\n      }\r\n      dataOne = dataOne.sort(compare('refId'));\r\n      dataTwo = dataTwo.sort(compare('refId'));\r\n      data = dataOne.concat(dataTwo);\r\n    }\r\n    this.data = data;\r\n    this.panel.data = data;\r\n    this.getdataAndRefId();\r\n    }\r\n \r\n    ogeAlertManualTable(fontSize, color, cursor, innerIndex) {//你的代码，没有动\r\n        var tbodyElem = this.manualTableElem.find('tbody');\r\n        this.panel.tableStyle = {};\r\n        if (innerIndex === 0) {\r\n            this.panel.tableStyle = {\r\n                'font-size': fontSize\r\n            };\r\n            return this.panel.tableStyle;\r\n        }\r\n        if (this.panel.ogeAlertEnabled && this.panel.ogeAlertColorType === 'B') {\r\n            this.panel.tableStyle = {\r\n                'font-size': fontSize,\r\n                'background-color': color,\r\n                'cursor': cursor,\r\n            };\r\n        } else if (this.panel.ogeAlertEnabled && this.panel.ogeAlertColorType === 'V') {\r\n            this.panel.tableStyle = {\r\n                'font-size': fontSize,\r\n                'color': color,\r\n                'cursor': cursor,\r\n            };\r\n        } else {\r\n            this.panel.tableStyle = {};\r\n        }\r\n        return this.panel.tableStyle;\r\n    }\r\n    url(outerIndex, innerIndex) {//你的代码，没有动\r\n        if (outerIndex === undefined) {\r\n            var urlIndex = innerIndex;\r\n        } else {\r\n            var urlIndex = outerIndex * this.panel.numFour[1] + innerIndex;\r\n        }\r\n        if (this.panel.link[urlIndex] && this.panel.link[urlIndex].type && (this.panel.link[urlIndex].type === 'dashboard')) {\r\n            if (this.panel.link[urlIndex].dashUri === undefined || this.panel.link[urlIndex].dashUri === '') {\r\n                this.panel.link[urlIndex].url = '';\r\n                return;\r\n            }\r\n        } else if (this.panel.link[urlIndex] && this.panel.link[urlIndex].type && (this.panel.link[urlIndex].type === 'absolute')) {\r\n            if (this.panel.link[urlIndex].url === undefined || this.panel.link[urlIndex].url === '') {\r\n                this.panel.link[urlIndex].dashUri = '';\r\n                return;\r\n            }\r\n        } else {\r\n            this.panel.link[urlIndex].url = '';\r\n            this.panel.link[urlIndex].dashUri = '';\r\n        }\r\n        var theTemplates = this.templateSrv.variables;\r\n        var linkInfo = this.linkSrv.getPanelLinkAnchorInfo(this.panel.link[urlIndex], theTemplates);\r\n        window.open(linkInfo.href, linkInfo.target);\r\n    }\r\n    newWidth(inde) {\r\n        this.panel.colStyle = {\r\n            'width': this.panel.tableArr[0][inde].colWidth\r\n        };\r\n        return this.panel.colStyle;\r\n    }\r\n\r\n    newCreate() {//这个方法创建了表格，并且控制表格的删除和增加\r\n        if (this.panel.tableArr === undefined){//新建表格数组\r\n        var tableArr = new Array();\r\n        for (let column = 0; column < this.panel.numFour[0]; column++) {\r\n            tableArr[column] = new Array();\r\n            for (let row = 0; row < this.panel.numFour[1]; row++) { //填充标题列属性\r\n                if (column === 0) {\r\n                    tableArr[column][row] = {\r\n                        id: column + 1 + \"-\" + (row + 1),\r\n                        text: \"\",\r\n                        colWidth: '20%',\r\n                        displayMode: \"text\",\r\n                        count: column * this.panel.numFour[1] + row\r\n                    };\r\n                }\r\n                tableArr[column][row] = { //填充单元格属性\r\n                    id: column + 1 + \"-\" + (row + 1),\r\n                    target:\"-\",\r\n                    text: \"-\",\r\n                    fontsize: \"100%\",\r\n                    displayMode: \"text\",\r\n                    count: column * this.panel.numFour[1] + row,\r\n                    color: \"\"\r\n                };\r\n            }\r\n        }\r\n            this.panel.tableArr = tableArr;\r\n        }\r\n        else if (this.panel.tableArr && this.panel.tableArr.length > this.panel.numFour[0]){//删除行\r\n            let rowLength = this.panel.tableArr.length\r\n            for (let subtract = rowLength - this.panel.numFour[0];subtract > 0;subtract--){\r\n                this.panel.tableArr.pop();\r\n            }\r\n        }\r\n        else if(this.panel.tableArr && this.panel.tableArr.length < this.panel.numFour[0]){//添加行\r\n            let rowLength = this.panel.tableArr.length;            \r\n            for (let subtract = 1; this.panel.numFour[0]- rowLength - subtract >= 0;subtract++){\r\n                let subtractTableArr = new Array;\r\n                for (let row = 0; row < this.panel.numFour[1]; row++) {                                   \r\n                    let tempArr = new Array;                    \r\n                    tempArr = {\r\n                    id: rowLength + subtract + \"-\" + (row + 1),\r\n                    target:\"-\",\r\n                    text: \"-\",\r\n                    fontsize: \"100%\",\r\n                    displayMode: \"text\",\r\n                    count: rowLength * this.panel.numFour[1] + row,\r\n                    color: \"\"\r\n                    };  \r\n                    subtractTableArr.push(tempArr)\r\n                }\r\n                this.panel.tableArr.push(subtractTableArr);\r\n            }\r\n        }\r\n        else if(this.panel.tableArr && this.panel.tableArr[0].length > this.panel.numFour[1]){//删除列\r\n            let columnLength = this.panel.tableArr[0].length;\r\n            for(let subtract = 0;columnLength - this.panel.numFour[1] - subtract > 0;subtract++){\r\n                for(let column = 0;column < this.panel.tableArr.length;column++){\r\n                    this.panel.tableArr[column].pop();\r\n                }\r\n            }\r\n        }\r\n        else if(this.panel.tableArr && this.panel.tableArr[0].length < this.panel.numFour[1]){//添加列\r\n            let columnLength = this.panel.tableArr[0].length;\r\n            for(let column = 0;column < this.panel.tableArr.length;column++){\r\n                for(let subtract = 0;this.panel.numFour[1] - columnLength -subtract > 0;subtract++){\r\n                    var subtractTableArr = new Array;\r\n                    if( column == 0){\r\n                        subtractTableArr = {\r\n                        id: 1 + \"-\" + (columnLength + subtract + 1),\r\n                        text: \"\",\r\n                        colWidth: '20%',\r\n                        displayMode: \"text\",\r\n                        count: columnLength + subtract \r\n                        }\r\n                        \r\n                        this.panel.tableArr[column].push(subtractTableArr); \r\n                    }\r\n                    else{\r\n                        subtractTableArr = {\r\n                            id: column + 1 + \"-\" + (columnLength + subtract + 1),\r\n                            target:\"-\",\r\n                            text: \"-\",\r\n                            fontsize: \"100%\",\r\n                            displayMode: \"text\",\r\n                            count: column * columnLength + columnLength + subtract + 1,\r\n                            color: \"\"\r\n                        };\r\n                        this.panel.tableArr[column].push(subtractTableArr);\r\n                    }\r\n                    \r\n                }\r\n            }\r\n        }\r\n        else{\r\n            return;\r\n        }\r\n    }\r\n\r\n    getdataAndRefId() {//获取value/name/color，并为target做了标识\r\n        \r\n        if(this.panel.dataAndRefId == undefined || this.panel.dataAndRefId.length == 0){\r\n            if (this.data.length === undefined) {\r\n            return;\r\n        } else if (this.data.length) {\r\n            \r\n            for (let length = 0; length < this.data.length; length++) {\r\n                if (this.data[length].color === undefined){\r\n                  var dataAndRefIdOptions = {\r\n                    target: \"/\" + this.data[length].target,\r\n                    name: this.data[length].target,\r\n                    //value: this.data[length].value,\r\n                    color:''\r\n                }\r\n                this.panel.dataAndRefId.push(dataAndRefIdOptions);    \r\n                }\r\n                else if (this.data[length].color){\r\n                    var dataAndRefIdOptions = {\r\n                    target: \"/\" + this.data[length].target,\r\n                    name: this.data[length].target,\r\n                    //value: this.data[length].value,\r\n                    color: this.data[length].color\r\n                }\r\n                  this.panel.dataAndRefId.push(dataAndRefIdOptions); \r\n                }\r\n            }\r\n            }\r\n        }\r\n        //---------删除kks查询时\r\n        else if(this.panel.data.length < this.panel.dataAndRefId.length){\r\n            for (let i = 0; i < this.panel.dataAndRefId.length; i++) {\r\n                var count = 0;\r\n                for (let x = 0; x < this.panel.data.length; x++){\r\n                    if(\"/\" + this.panel.data[x].target === this.panel.dataAndRefId[i].target){\r\n                        /* this.panel.dataAndRefId[i] = {\r\n                            refId: \"/\" + this.panel.data[x].refId,\r\n                            name: this.panel.data[x].target,\r\n                            value: this.panel.data[x].value,\r\n                            color: this.panel.data[x].color\r\n                        } */\r\n                        break;\r\n                    }else{\r\n                        count ++;\r\n                    }\r\n                }\r\n                if(count == this.panel.data.length){\r\n                    this.panel.dataAndRefId.splice(i, 1);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        //--------增加kks查询时\r\n        else if(this.panel.data.length > this.panel.dataAndRefId.length){\r\n            var newDataAndRefId = [];\r\n            for (let i = 0; i < this.panel.data.length; i++) {\r\n                var dataAndRefIdOptions = {\r\n                    target: \"/\" + this.panel.data[i].target,\r\n                    name: this.panel.data[i].target,\r\n                    //value: this.panel.data[i].value,\r\n                    color: this.panel.data[i].color\r\n                }\r\n                newDataAndRefId.push(dataAndRefIdOptions);\r\n            }\r\n            for(let i = 0; i < newDataAndRefId.length; i++){\r\n                let obj = newDataAndRefId[i];\r\n                let target = obj.target;\r\n                let isExist = false;\r\n                for(let j = 0; j < this.panel.dataAndRefId.length; j++){\r\n                    var aj = this.panel.dataAndRefId[j];\r\n                    var newTarget = aj.target;\r\n                    if(newTarget == target){\r\n                        isExist = true;\r\n                        break;\r\n                    }\r\n                }\r\n                if(!isExist){\r\n                    this.panel.dataAndRefId.push(obj);\r\n                }\r\n            }\r\n        }\r\n    } \r\n    \r\n    getText(target){//get value for text\r\n        if(target == null){\r\n            return \" \";\r\n        }\r\n        if(target.substr(0,1) === \"/\"){\r\n            for (let i=0; i<this.panel.dataAndRefId.length;i++){\r\n                if (target === \"/\" + this.panel.data[i].target){\r\n                    return this.panel.data[i].value;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            return target\r\n        }\r\n    }\r\n    objDeepCopy(source) {\r\n        var sourceCopy = source instanceof Array ? [] : {};\r\n        for (var item in source) {\r\n            sourceCopy[item] = typeof source[item] === 'object' ? this.objDeepCopy(source[item]) : source[item];\r\n        }\r\n        return sourceCopy;\r\n    }\r\n    searchDashboards(queryStr, callback) {\r\n        that.backendSrv.search({\r\n            query: queryStr\r\n        }).then(function(hits) {\r\n            var dashboards = _.map(hits, function(dash) {\r\n                return dash.title;\r\n            });\r\n            callback(dashboards);\r\n        });\r\n    };\r\n    dashboardChanged(link) {\r\n        that.backendSrv.search({\r\n            query: link.dashboard\r\n        }).then(function(hits) {\r\n            var dashboard = _.find(hits, {\r\n                title: link.dashboard\r\n            });\r\n            if (dashboard) {\r\n                link.dashUri = dashboard.uri;\r\n                link.title = dashboard.title;\r\n            }\r\n        });\r\n    };\r\n    link(scope, elem, attrs, ctrl) {\r\n        ctrl.manualTableElem = elem;\r\n        ctrl.panelNewHeight = ctrl.height;\r\n    }\r\n}\r\n\r\nManualTableCtrl.templateUrl = 'module.html';"]}