{"version":3,"sources":["../src/graph_ctrl.js"],"names":["MetricsPanelCtrl","moment","_","TimeSeries","echarts","$","panelDefaults","unit","limit","alarmColor","EchartsCtrl","$scope","$injector","$rootScope","defaults","panel","mode","limits","values","alarm","Array","unitOption","limitOption","alarmColorOption","events","on","onInitEditMode","bind","onDataReceived","addEditorTab","dataList","kpi","undefined","console","info","num","newNum","split","parseFloat","value","toFixed","datapoints","str","i","push","doJudgment","getLimit","render","scope","elem","attrs","ctrl","minInput","maxInput","color","colorInfo","myObject","inc","setGauge","alarmInfo","flag","length","min","param","maxAndLength","max","index","getAlarmColor","cnm","getValue","obj","find","myChart","init","option","series","name","startAngle","endAngle","radius","type","axisLine","lineStyle","axisLabel","formatter","indexOf","splitNumber","detail","offsetCenter","textStyle","fontWeight","title","fontSize","fontStyle","shadowColor","shadowBlur","pointer","width","data","setOption","templateUrl"],"mappings":"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","file":"graph_ctrl.js","sourcesContent":["import {MetricsPanelCtrl} from 'app/plugins/sdk';\r\nimport moment from 'moment';\r\nimport _ from 'lodash';\r\nimport TimeSeries from 'app/core/time_series';\r\nimport './css/clock-panel.css!';\r\nimport echarts from 'vendor/echarts/echarts.min.js';\r\nimport $ from 'jquery';\r\n\r\nvar panelDefaults = {\r\n\tunit:'unit',\r\n\tlimit:'0,200',\r\n\talarmColor:'10,20,30'\r\n}\r\nexport class EchartsCtrl extends MetricsPanelCtrl {\r\n  constructor($scope, $injector, $rootScope) {\r\n    super($scope, $injector);\r\n\tthis.$rootScope = $rootScope;\r\n\t_.defaults(this.panel, panelDefaults);\r\n\tvar mode, limits, values;\r\n\tvar alarm = new Array;\r\n\tvar unitOption = '';\r\n\tvar limitOption = '0,0';\r\n\tvar alarmColorOption = '0,0,0';\r\n\tthis.panel.alarmColorOption = alarmColorOption;\r\n\tthis.panel.limitOption = limitOption;\r\n\tthis.panel.unitOption =unitOption;\r\n\tthis.panel.mode = mode;\r\n\tthis.panel.limits = limits;\r\n\tthis.panel.values =values;\r\n\tthis.panel.alarm = alarm;\r\n\tthis.events.on('init-edit-mode', this.onInitEditMode.bind(this));\r\n\tthis.events.on('data-received', this.onDataReceived.bind(this));\r\n  } \r\n\tonInitEditMode() {\r\n    this.addEditorTab('Options', 'public/plugins/gauge-graphs/editor.html', 2);\r\n  }\r\n\tdoJudgment(){//判断数据源\t  \r\n\t\tif (this.dataList.kpi == undefined){\r\n\t\t\t\tthis.panel.mode = 'Conventional';\r\n\t\t}\t\r\n\t\telse {\r\n\t\t\tthis.panel.mode = 'json'; \r\n\t\t\t}\r\n\t\tconsole.info(this.panel.mode);\r\n\t\t}\r\n\tgetLimit(){\r\n\tvar num = this.panel.limit;\r\n\tvar newNum = num.split(\",\");\r\n\tthis.panel.limits = [parseFloat(newNum[0]),parseFloat(newNum[1])];\r\n\t}\t\r\n\tgetValue(){\r\n\t\tif(this.panel.mode == 'json'){\r\n\t\t\tvar num = this.dataList.kpi.value;\r\n\t\t\tthis.panel.values = num.toFixed(2);\r\n\t\t}\r\n\t\telse if(this.panel.mode == 'Conventional'){\r\n\t\t\tvar num = this.dataList[0].datapoints[0][0];\r\n\t\t\tthis.panel.values = num.toFixed(2);\r\n\t\t}\r\n\t}\r\n\tgetAlarmColor(){//把alarmColor从字符串转为数组\r\n\t\tvar str = this.panel.alarmColor.split(\",\");\r\n\t\tthis.panel.alarm=[];\r\n\t\tfor (var i=0; i<3; i++){\r\n\t\tthis.panel.alarm.push(parseFloat(str[i]));\r\n\t\t}\r\n\t\t\r\n\t}\r\n  onDataReceived(dataList) {\r\n\tthis.dataList=dataList;\r\n\tthis.doJudgment();\r\n\tthis.getLimit();\r\n\tthis.render();\r\n  }\r\n\r\n  onRender(){\r\n\t  //nothing\r\n\t  \r\n  }\r\n\r\n  link(scope, elem, attrs, ctrl) {\t\r\n\tctrl.events.on('render', function() {\r\n\tctrl.doJudgment();\r\n\tctrl.getLimit();\r\n\tvar minInput = ctrl.panel.limits[0];\r\n\tvar maxInput = ctrl.panel.limits[1];\r\n\tvar color = ['#00ff00','#00aa00','#ffff00','#ff0003'];\r\n\tvar colorInfo = new Array;\r\n\tvar myObject = {\r\n\t\tinc:function setGauge(){ //该函数设置了max/minIn put，赋值了lineStyle里color的colorInfo\r\n\t\t\tif(ctrl.panel.mode == 'json'){//当检测到json数据源时\r\n\t\t\tvar alarmInfo = ctrl.dataList.alarmInfo;\r\n\t\t\tvar flag = true;\r\n\t\t\tif(alarmInfo[alarmInfo.length - 1].min < alarmInfo[0].min){\r\n\t\t\t\tflag = false;\r\n\t\t\t}//判断值越大越危险还是越小越危险\r\n\t\t\tminInput = alarmInfo[0].min;\r\n\t\t\tmaxInput = alarmInfo[alarmInfo.length - 1].min * 1.2; \r\n\t\t\tif(!flag){\r\n\t\t\t\tminInput =  alarmInfo[alarmInfo.length - 1].min;\r\n\t\t\t\tmaxInput =  alarmInfo[0].min * 1.2;\r\n\t\t\t}//赋值 minInput和maxInput 结束\r\n\t\t\tvar param = 0;\r\n\t\t\tvar maxAndLength = maxInput - minInput;\r\n\t\t\tfor(var i=0; i<alarmInfo.length; i++){\r\n\t\t\t\tif(flag){\r\n\t\t\t\tparam = (alarmInfo[i].max - alarmInfo[0].min)/maxAndLength;\r\n\t\t\t\t\tif(i == alarmInfo.length - 1){\r\n\t\t\t\t\tparam = 1;\r\n\t\t\t\t\t}\r\n\t\t\t\tcolorInfo.push([param, color[i]]);\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tvar index = alarmInfo.length - 1 - i;\r\n\t\t\t\t\tparam = (alarmInfo[index].max - alarmInfo[3].min)/maxAndLength;\r\n\t\t\t\t\tif(i == alarmInfo.length - 1){\r\n\t\t\t\t\tparam = 1;\r\n\t\t\t\t\t}\r\n\t\t\t\tcolorInfo.push([param, color[index]]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tctrl.panel.unit = ctrl.dataList.kpi.unit;\r\n\t\t}\r\n\t\telse if(ctrl.panel.mode == 'Conventional'){//当数据源为常规数据源时\r\n\t\t\tminInput = ctrl.panel.limits[0];\r\n\t\t\tmaxInput = ctrl.panel.limits[1];\r\n\t\t\tvar maxAndLength = maxInput - minInput;\r\n\t\t\tvar flag = true;\r\n\t\t\tctrl.getAlarmColor();\r\n\t\t\tif (ctrl.panel.alarm[2] - ctrl.panel.alarm[0] < 0){\r\n\t\t\t\tflag = false;\r\n\t\t\t}//判断值越大越危险还是越小越危险\r\n\t\t\tif (flag && colorInfo.length == 0){\r\n\t\t\t\tfor(var i=0; i<ctrl.panel.alarm.length; i++){\r\n\t\t\t\tparam = (ctrl.panel.alarm[i] - minInput )/maxAndLength;\r\n\t\t\t\tcolorInfo.push([param,color[i]]);\r\n\t\t\t\t}\r\n\t\t\t\tcolorInfo.push([1,'#ff0003']);\r\n\t\t\t}\r\n\t\t\tif (!flag && colorInfo.length == 0){\r\n\t\t\t\tfor(var i=0; i<ctrl.panel.alarm.length; i++){\t\t\t\r\n\t\t\t\t\tvar index = ctrl.panel.alarm.length  -1 - i;\r\n\t\t\t\t\tvar cnm = index + 1;//color数组里[3]才是红色\r\n\t\t\t\t\tparam = (ctrl.panel.alarm[index] - minInput)/maxAndLength;\r\n\t\t\t\t\tcolorInfo.push([param, color[cnm]]);\r\n\t\t\t\t}\t\r\n\t\t\t\tcolorInfo.push([1,'#00ff00']);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t\t/*else {//if (ctrl.panel.mode == 'default')\r\n\t\t\tvalue = 0;\r\n\t\t\tminInput = ctrl.panel.limits[0];\r\n\t\t\tmaxInput = ctrl.panel.limits[1];\r\n\t\t\tcolorInfo = [[0.25,'#00ff00'],[0.5,'#00aa00'],[0.75,'#ffff00'],[1,'#ff0003']];\r\n\t\t}*/\r\n\t}\r\n\t};\r\n\tmyObject.inc();\r\n\tctrl.getValue();\r\n\tvar value = ctrl.panel.values;\r\n\tvar unit = ctrl.panel.unit;//unit\r\n\tvar obj = elem.find('.echarts-panel');\r\n\tvar myChart = echarts.init(obj[0]);\r\n\tvar option = {\r\n\t\tseries: [{\r\n\t\t\tname: '',\r\n\t\t\tmin: minInput,\r\n\t\t\tmax: maxInput,\r\n\t\t\tstartAngle: 180,\r\n\t\t\tendAngle: 0,\r\n\t\t\tradius:'100%',\r\n\t\t\ttype: 'gauge',\r\n\t\t\tlength:'100%',\t\r\n\t\t\taxisLine: {\r\n\t\t\t\tlineStyle: {//仪表盘轴线颜色\r\n\t\t\t\t\tcolor: colorInfo\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\taxisLabel:{\r\n\t\t\t\t\t\tformatter: function (value) {\r\n\t\t\t\t\t\t\tvar values = value + \"\";\r\n\t\t\t\t\t\t\tif(values.indexOf('.') == -1){ //没有小数点\r\n\t\t\t\t\t\t\t\treturn value;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar length = values.split(\".\")[1].length; //有小数点，看本来有几位\r\n\t\t\t\t\t\t\tif(length >= 2){\r\n\t\t\t\t\t\t\t\treturn value.toFixed(2);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn value;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\tsplitNumber: 8,//仪表盘刻度的分割段数\r\n\t\t\tdetail: { \r\n\t\t\t\tformatter: '{value}',\r\n\t\t\t\toffsetCenter: [0, 40],       // 相对表盘中心的便宜位置。x, y，单位px\r\n\t\t\t\ttextStyle:{fontWeight:'bolder'}\r\n\t\t\t\t\t},\r\n\t\t\ttitle : {\r\n\t\t\t\ttextStyle: {       // 其余属性默认使用全局文本样式，详见TEXTSTYLE\r\n\t\t\t\t\t\tfontWeight: 'bolder',\r\n\t\t\t\t\t\tfontSize: 20,\r\n\t\t\t\t\t\tfontStyle: 'italic',\r\n\t\t\t\t\t\tcolor: '#fff',\r\n\t\t\t\t\t\tshadowColor : '#fff', //默认透明\r\n\t\t\t\t\t\tshadowBlur: 10\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\tpointer: {           // 指针\r\n\t\t\t\twidth:6,\r\n\t\t\t\tlength:'75%'\r\n\t\t\t\t},\r\n\t\t\tdata: [{ value:value, name:unit}]\r\n\t\t\t\t}]\r\n\t\t\t};\r\n\tmyChart.setOption(option);\r\n  });\r\n  }\r\n  \r\n}\r\n\r\nEchartsCtrl.templateUrl = 'module.html';\r\n"]}