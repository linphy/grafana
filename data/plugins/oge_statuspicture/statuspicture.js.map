{"version":3,"sources":["../../src/statuspicture.js"],"names":["MetricsPanelCtrl","_","$","panelDefaults","threshold","statusPicturePanelCtrl","$scope","$injector","$rootScope","defaults","panel","length","push","thresholds","name","events","on","onInitEditMode","bind","onDataReceived","addEditorTab","dataList","data","render","Object","prototype","toString","call","datapoints","DP","num","fixedData","toFixed","dataPrecise","Fdata","undefined","value","precise","index","splice","scope","elem","attrs","ctrl","obj","find","text","fixed","height","row","isString","parseInt","replace","css","i","FD","str","split","thresholdss","j","Number","html","templateUrl"],"mappings":"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","file":"statuspicture.js","sourcesContent":["import {\r\n\tMetricsPanelCtrl\r\n} from 'app/plugins/sdk';\r\nimport _ from 'lodash';\r\nimport $ from 'jquery';\r\n\r\nvar panelDefaults = {\r\n\tthreshold:[],\r\n};\r\nexport class statusPicturePanelCtrl extends MetricsPanelCtrl {\r\n\tconstructor($scope, $injector, $rootScope) {\r\n\t\tsuper($scope, $injector);\r\n\t\tthis.$rootScope = $rootScope;\r\n\t\t_.defaults(this.panel, panelDefaults);\r\n\t\tif(this.panel.threshold.length == 0){\r\n\t\tthis.panel.threshold.push({ thresholds: '30,60', name: ''});\r\n\t\t}\r\n\t\tthis.events.on('init-edit-mode', this.onInitEditMode.bind(this));\r\n\t\tthis.events.on('data-received', this.onDataReceived.bind(this));\r\n\t}\r\n\tonInitEditMode() {\r\n\t\tthis.addEditorTab('Options', 'public/plugins/oge_statuspicture/editor.html', 2);\r\n\t}\r\n\tonDataReceived(dataList) {\r\n\t\tthis.data = dataList;\r\n\t\tthis.render();\r\n\t}\r\n\tfixed() {\r\n\t\tif (Object.prototype.toString.call(this.data) === '[object Array]') {\r\n\t\t\tif (this.data[0].datapoints.length == 0) {\r\n\t\t\t} else {\r\n\t\t\t\tvar DP = this.data[0].datapoints;\r\n\t\t\t\tvar num = this.data[0].datapoints[DP.length-1][0];\r\n\t\t\t\tvar fixedData = num.toFixed(this.panel.dataPrecise);\r\n\t\t\t\tthis.data.Fdata = fixedData;\r\n\t\t\t}\r\n\t\t} else if ((this.data === undefined) || (this.data.value === undefined)||(this.data.value === null)) {\r\n\t\t\treturn\r\n\t\t} else {\r\n\t\t\tvar num = this.data.value;\r\n\t\t\tif (this.data.precise === null) {\r\n\t\t\t\tvar fixedData = num.toFixed(this.panel.dataPrecise);\r\n\t\t\t} else {\r\n\t\t\t\tvar fixedData = num.toFixed(this.data.precise);\r\n\t\t\t}\r\n\t\t\tthis.data.Fdata = fixedData;\r\n\t\t}\r\n\t}\r\n\tonDelete(index) {\r\n\t    this.panel.threshold.splice(index,1);\r\n\t    this.render()\r\n\t}\r\n\tonAdd() {\r\n\t    this.panel.threshold.push({ thresholds: '30,60', name: ''});\r\n\t    this.render()\r\n\t}\r\n\r\n\tlink(scope, elem, attrs, ctrl) {\r\n\t\tctrl.events.on('render', function() {\r\n\t\t\tvar obj = elem.find('.stateList-panel');\r\n\t\t\tvar text = '<p>值不在设定范围内</p>';\r\n\t\t\tctrl.fixed();\r\n\t\t\tvar height = ctrl.height || ctrl.row.height;\r\n\t\t\tif (_.isString(height)) {\r\n\t\t\t\theight = parseInt(height.replace('px', ''), 10);\r\n\t\t\t}\r\n\t\t\tobj.css('height', height + 'px');\t\t\r\n            for (var i = 0; i < ctrl.panel.threshold.length; i++) {\t\t\t\r\n\t\t\t\tctrl.data.FD = parseInt(ctrl.data.Fdata, 10);\r\n\t            if (ctrl.panel.threshold[i].thresholds == null) {\r\n\t\t\t\t\treturn\r\n\t            } else {\r\n\t            \tvar str = ctrl.panel.threshold[i].thresholds.split(\",\");\r\n\t\t\t\t\tctrl.panel.threshold[i].thresholdss=[];\r\n\t                for (var j = 0; j < 2; j++) {\r\n\t                    ctrl.panel.threshold[i].thresholdss.push(Number(str[j]));\r\n\t                }\r\n\t            }\r\n\t\t\t\tif(ctrl.panel.threshold[i].thresholdss[0]<=ctrl.data.FD && ctrl.data.FD < ctrl.panel.threshold[i].thresholdss[1]){\r\n\t\t\t\t\ttext = '<img src=\"public/plugins/oge_statuspicture/img/' + ctrl.panel.threshold[i].name + '\" style=\"height:' + height + 'px; width:100%; max-width:600px;\" alt=\"'+ ctrl.panel.threshold[i].name +'\">';\r\n\t\t\t\t}\r\n            }\r\n            obj.html(text);\r\n\t\t});\r\n\t}\r\n}\r\n\r\nstatusPicturePanelCtrl.templateUrl = 'module.html';"]}