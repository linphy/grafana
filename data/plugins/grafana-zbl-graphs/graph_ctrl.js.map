{"version":3,"sources":["../src/graph_ctrl.js"],"names":["MetricsPanelCtrl","moment","_","TimeSeries","$","pageing","panelDefaults","mode","alarmColor","dataTime","EchartsCtrl","$scope","$injector","$rootScope","defaults","panel","modeOption","name","value","events","on","onInitEditMode","bind","onDataReceived","addEditorTab","dataList","data","render","start","end","console","log","timeSrv","time","from","range","to","setTime","appEvent","status","p","scope","elem","attrs","ctrl","templateUrl"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAQA,mB,kBAAAA,gB;;AACDC,S;;AACAC,I;;AACAC,a;;AAGAC,I;;AACAC,U;;;;;;;;;;;;;;;;;;;;;AAGHC,gB,GAAgB;AACnBC,UAAM,KADa,EACN;AACbC,gBAAY,CAAC,sBAAD,EAAyB,sBAAzB,EAAiD,wBAAjD,EAA2E,sBAA3E,CAFO,EAE6F;AAChHC,cAAU;AAHS,I;;0BAMPC,W;;;AACX,yBAAYC,MAAZ,EAAoBC,SAApB,EAA+BC,UAA/B,EAA2C;AAAA;;AAAA,2HACnCF,MADmC,EAC3BC,SAD2B;;AAE5C,WAAKC,UAAL,GAAkBA,UAAlB;;AAEAX,OAAEY,QAAF,CAAW,MAAKC,KAAhB,EAAuBT,aAAvB,EAJ4C,CAIL;AACvC,SAAIU,aAAa,CACZ,EAACC,MAAM,QAAP,EAAiBC,OAAO,KAAxB,EADY,EAEf,EAACD,MAAM,QAAP,EAAiBC,OAAO,UAAxB,EAFe,EAIf,EAACD,MAAM,OAAP,EAAgBC,OAAO,SAAvB,EAJe,EAKf,EAACD,MAAM,OAAP,EAAgBC,OAAO,WAAvB,EALe,EAMf,EAACD,MAAM,MAAP,EAAeC,OAAO,WAAtB,EANe,EAOf,EAACD,MAAM,OAAP,EAAgBC,OAAO,cAAvB,EAPe,CAAjB;AASA,WAAKH,KAAL,CAAWC,UAAX,GAAwBA,UAAxB;;AAEA,WAAKG,MAAL,CAAYC,EAAZ,CAAe,gBAAf,EAAiC,MAAKC,cAAL,CAAoBC,IAApB,OAAjC;AACA,WAAKH,MAAL,CAAYC,EAAZ,CAAe,eAAf,EAAgC,MAAKG,cAAL,CAAoBD,IAApB,OAAhC;AAjB4C;AAkB1C;;;;sCAEgB;AACf,WAAKE,YAAL,CAAkB,SAAlB,EAA6B,+CAA7B,EAA8E,CAA9E;AACD;;;oCAEcC,Q,EAAU;AAC1B,WAAKC,IAAL,GAAYD,QAAZ;AACA,WAAKE,MAAL;AACE;;;gCAEUC,K,EAAOC,G,EAAI;AACrBC,cAAQC,GAAR,CAAY,KAAKC,OAAL,CAAaC,IAAb,CAAkBC,IAA9B,EAAoCN,KAApC,EAA2CC,GAA3C;AACA,UAAG,KAAKG,OAAL,CAAaC,IAAb,CAAkBC,IAAlB,IAA0BN,KAA7B,EAAmC;AAClC;AACA;AACD,UAAIO,QAAQ,EAACD,MAAMN,KAAP,EAAcQ,IAAIP,GAAlB,EAAZ;AACA,WAAKG,OAAL,CAAaK,OAAb,CAAqBF,KAArB;AACA,WAAKtB,UAAL,CAAgByB,QAAhB,CAAyB,kBAAzB;AACA;;;gCAGS,CACT;;;8BAEQC,M,EAAQ;AAClB,UAAIC,IAAI,EAAR;AACA,UAAID,UAAU,CAAd,EAAiB;AAChBC,WAAI,KAAKzB,KAAL,CAAWP,UAAX,CAAsB+B,MAAtB,CAAJ;AACA,OAFD,MAEK;AACJC,WAAI,EAAJ;AACA;AACD,aAAO,EAAC,oBAAoBA,CAArB,EAAP;AACE;;;0BAEIC,K,EAAOC,I,EAAMC,K,EAAOC,I,EAAM;AAChCvC,cAAQoC,KAAR,EAAeC,IAAf,EAAqBC,KAArB,EAA4BC,IAA5B;AACE;;;;KAxD8B5C,gB;;;;AA2DjCU,eAAYmC,WAAZ,GAA0B,aAA1B","file":"graph_ctrl.js","sourcesContent":["import {MetricsPanelCtrl} from 'app/plugins/sdk';\r\nimport moment from 'moment';\r\nimport _ from 'lodash';\r\nimport TimeSeries from 'app/core/time_series';\r\nimport './css/clock-panel.css!';\r\n\r\nimport $ from 'jquery';\r\nimport pageing from './pageing';\r\n\r\n\r\nvar panelDefaults = {\r\n\tmode: 'kpi', //默认显示模式\r\n\talarmColor: [\"rgba(0, 255, 0, 0.7)\", \"rgba(0, 170, 0, 0.7)\", \"rgba(255, 255, 0, 0.7)\", \"rgba(255, 0, 0, 0.7)\"], //告警颜色等级0-3 00ff00\\00aa00\\ffff00,#ff0003\r\n\tdataTime: '2016-01-01 00:00:00'\r\n};\r\n\r\nexport class EchartsCtrl extends MetricsPanelCtrl {\r\n  constructor($scope, $injector, $rootScope) {\r\n    super($scope, $injector);\r\n\tthis.$rootScope = $rootScope;\r\n\t\r\n\t_.defaults(this.panel, panelDefaults); //将panelDefaults属性附加到this.panel上\r\n\tvar modeOption = [\r\n      {name: 'KPI主信息', value: \"kpi\"},\r\n\t  {name: 'KPI仪表盘', value: \"kpiGauge\"},\r\n\r\n\t  {name: 'KPI描述', value: \"kpiDesc\"},\r\n\t  {name: 'KPI链接', value: \"kpiWebUrl\"},\r\n\t  {name: '告警信息', value: \"alarmInfo\"},\r\n\t  {name: '关联量信息', value: \"relativeInfo\"},\r\n    ];\r\n\tthis.panel.modeOption = modeOption;\r\n\t\r\n\tthis.events.on('init-edit-mode', this.onInitEditMode.bind(this));\r\n\tthis.events.on('data-received', this.onDataReceived.bind(this));\r\n  }\r\n  \r\n  onInitEditMode() {\r\n    this.addEditorTab('Options', 'public/plugins/grafana-zbl-graphs/editor.html', 2);\r\n  }\r\n  \r\n  onDataReceived(dataList) {\r\n\tthis.data = dataList;\r\n\tthis.render();\r\n  }\r\n  \r\n  changeTime(start, end){\r\n\t  console.log(this.timeSrv.time.from, start, end)\r\n\t  if(this.timeSrv.time.from == start){\r\n\t\t  return;\r\n\t  }\r\n\t  var range = {from: start, to: end};\r\n\t  this.timeSrv.setTime(range);\r\n\t  this.$rootScope.appEvent('hide-dash-editor');\r\n  }\r\n  \r\n  //link中起到监听作用\r\n  onRender(){\r\n  }\r\n  \r\n  setColor(status) {\r\n\tvar p = \"\";\r\n\tif (status <= 3) {\r\n\t\tp = this.panel.alarmColor[status];\r\n\t}else{\r\n\t\tp = '';\r\n\t}\r\n\treturn {\"background-color\": p};\r\n  };\r\n \r\n  link(scope, elem, attrs, ctrl) {\r\n\tpageing(scope, elem, attrs, ctrl);\r\n  }\r\n}\r\n\r\nEchartsCtrl.templateUrl = 'module.html';\r\n"]}