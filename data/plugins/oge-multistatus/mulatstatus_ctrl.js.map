{"version":3,"sources":["../src/mulatstatus_ctrl.js"],"names":["OgeAlertMetricsPanelCtrl","angular","_","$","kbn","config","TimeSeries","panelDefaults","data","fontSizes","valueNum","minValue","minTwoValue","minThreeValue","maxValue","valueEHeight","valueFontSize","titleFontSize","BackgroundEColor","marginLandR","showState","valuesUrl","series","pointNamesSaris","mappingTypes","name","value","coloringTypes","panelListUrl","valueMaps","op","text","rangeMaps","from","to","valueMapsImg","rangeMapsImg","valueColors","thecolorSource","coloringType","theColorvalues","color","theRangeColor","dataSources","regexOne","alisa","mappingType","showUnitOne","dataPrecise","showNetUrl","titlePositionNow","statvalues","dataUnitPrecise","multiStyle","theMainSource","theShowSource","theUrlSource","theUrlRegex","link","type","MultistatusCtrl","$scope","$injector","backendSrv","templateSrv","timeSrv","linkSrv","showCover","defaults","panel","dataTwo","subTabIndex","multiStatElem","valueShowStatOptions","titlePosition","events","on","onInitEditMode","bind","onDataReceived","onDataError","optionPanel","that","addEditorTab","err","dataList","length","alarm","undefined","j","datapoints","isArray","totalNum","statMax","statMin","i","parseFloat","toFixed","lastPoint","last","lastValue","firstValue","objDeepCopy","dataShowSour","reg","eval","regShow","regexMultistatus","m","n","source","sourceCopy","Array","item","multiStat","find","multistatPanel","multiStatNamesSaris","multiStatValuesSaris","multiStatNamesSarisTwo","backgroundOrFontColor","pointNamesIndexBool","indexOf","z","style","cssText","lineHeight","innerHTML","pointNamesSarisReplaceName","replace","pointNamesSarisReplaceIndex","titlePositionStyle","theUnitShow","map","_i","regColors","datasColor","_z","bOaColor","multistatPanelWidth","offsetWidth","height","width","index","dashUri","url","urlDatas","regx","str","arr","target","exec","inputParams","paramsOne","exceParams","paramsReplace","ind","toUpperCase","params","theTemplates","variables","linkInfo","getPanelLinkAnchorInfo","paramsNum","href","paramsNew","dataRefId","refId","theNewIndex","theTemplatesSectences","window","open","Alldata","regexMulti","dataOne","val","match","push","splice","render","rangeMap","mapImg","rangeMapImg","valueColor","indexOne","rangColor","queryStr","callback","search","query","then","hits","dashboards","dash","title","dashboard","uri","scope","elem","attrs","ctrl","templateUrl"],"mappings":"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","file":"mulatstatus_ctrl.js","sourcesContent":["import {OgeAlertMetricsPanelCtrl} from 'app/plugins/sdk';\r\nimport angular from 'angular';\r\nimport _ from 'lodash';\r\nimport $ from 'jquery';\r\nimport './css/multistat-panel.css!';\r\nimport kbn from 'app/core/utils/kbn';\r\nimport config from 'app/core/config';\r\nimport TimeSeries from 'app/core/time_series2';\r\n\r\nvar panelDefaults = {\r\n    data: [],\r\n    fontSizes:[],\r\n    valueNum: 6,\r\n    minValue: 0,\r\n    minTwoValue:1,\r\n    minThreeValue:2,\r\n    maxValue: 3,\r\n    valueEHeight:100,\r\n    valueFontSize: '100%',\r\n    titleFontSize: '100%',\r\n    BackgroundEColor:\"red\",\r\n    marginLandR:3,\r\n    showState: false,\r\n    valuesUrl:'',\r\n    series:[],\r\n    pointNamesSaris:'',\r\n    mappingTypes: [\r\n      {name: 'value to text', value: 1},\r\n      {name: 'range to text', value: 2},\r\n      {name: 'value to image', value: 3},\r\n      {name: 'range to image', value: 4},\r\n    ],\r\n    coloringTypes: [\r\n      {name: 'value to color', value: 1},\r\n      {name: 'range to color', value: 2},\r\n    ],\r\n    panelListUrl:[],\r\n    valueMaps: [\r\n      { value: 'null', op: '=', text: 'N/A' }\r\n    ],\r\n    rangeMaps: [\r\n      { from: 'null', to: 'null', text: 'N/A' }\r\n    ],\r\n    valueMapsImg: [\r\n      { value: 'null', op: '=', text: 'N/A' }\r\n    ],\r\n    rangeMapsImg: [\r\n      { from: 'null', to: 'null', text: 'N/A' }\r\n    ],\r\n    valueColors: [\r\n      { thecolorSource:'',\r\n        coloringType:1,\r\n        theColorvalues:[\r\n          { value: 'null', op: '=', color: 'red' }\r\n        ],\r\n        theRangeColor:[\r\n          { from: 'null', to: 'null', color: 'red' }\r\n        ]\r\n      }\r\n    ],\r\n    // rangeColors: [\r\n    //   { from: 'null', to: 'null', color: 'red' }\r\n    // ],\r\n    dataSources:[\r\n      {regexOne:'', alisa:''}\r\n    ],\r\n    mappingType: 1,\r\n    showUnitOne: false,\r\n    dataPrecise: 0,\r\n    showNetUrl:false,\r\n    titlePositionNow: '中上',\r\n    statvalues: 'current',\r\n    dataUnitPrecise: 1,\r\n    // multiStatElem:{},\r\n    multiStyle:{},\r\n    theMainSource:'',\r\n    theShowSource:'',\r\n    theUrlSource:'',\r\n    theUrlRegex:'',\r\n    link:{\r\n      type: 'dashboard'\r\n    }    \r\n  };\r\n  var that;\r\nexport class MultistatusCtrl extends OgeAlertMetricsPanelCtrl {\r\n\r\n  constructor($scope, $injector, backendSrv, templateSrv, timeSrv, linkSrv) {\r\n    super($scope, $injector, {showCover: true});\r\n    _.defaults(this.panel, panelDefaults);\r\n    this.data=[];\r\n    this.dataTwo;\r\n    this.subTabIndex = 0;\r\n    this.multiStatElem = [];\r\n    // that = this;\r\n    this.valueShowStatOptions =  [\r\n      {text: 'Avg', value: 'avg'},\r\n      {text: 'Min', value: 'min'},\r\n      {text: 'Max', value: 'max'},\r\n      {text: 'Total', value: 'total'},\r\n      {text: 'Count', value: 'count'},\r\n      {text: 'Current', value: 'current'},\r\n    ];\r\n    this.titlePosition = ['左上','中上','右上','左下','中下','右下'];\r\n    this.backendSrv = backendSrv;\r\n    this.timeSrv = timeSrv;\r\n    this.linkSrv = linkSrv;\r\n    this.events.on('init-edit-mode', this.onInitEditMode.bind(this));\r\n    this.events.on('data-received', this.onDataReceived.bind(this));\r\n    this.events.on('data-error', this.onDataError.bind(this));\r\n    this.events.on('render', this.optionPanel.bind(this));\r\n    that = this;\r\n    // this.events.on('refresh', this.optionPanel.bind(this));\r\n  }\r\n\r\n  onInitEditMode() {\r\n    this.panel.fontSizes = ['20%', '30%','50%','70%','80%','100%', '110%', '120%', '150%', '170%', '200%'];\r\n    this.addEditorTab('Options', 'public/plugins/oge-multistatus/editor.html', 2);\r\n    this.addEditorTab('Value Mappings', 'public/plugins/oge-multistatus/mappings.html', 3);\r\n  }\r\n\r\n  onDataError(err) {\r\n    this.onDataReceived([]);\r\n  }\r\n  onDataReceived(dataList) {\r\n    var dataTwo = [];\r\n    dataTwo = dataList;\r\n    //处理告警\r\n    if (dataTwo !== null && dataTwo.length > 0 && dataTwo[0].alarm !== undefined) {\r\n        for(var j=0;j< dataTwo.length;j++) {\r\n          dataTwo[j].alarm = dataList[j].alarm;\r\n        }     \r\n    }\r\n    if(dataList && dataList.length > 0) {\r\n      for(var j=0;j<dataList.length;j++){\r\n        if((dataList[j].datapoints === undefined) || (dataList[j].datapoints.length === 0) || !(_.isArray(dataList[j].datapoints[0]))){\r\n          dataTwo[j].value = 'No datapoint!';\r\n          return;\r\n        }\r\n        var totalNum = 0;\r\n        var statMax = dataList[j].datapoints[0][0];\r\n        var statMin = dataList[j].datapoints[0][0];\r\n        for(var i = 0; i < dataList[j].datapoints.length; i++) {\r\n          if(_.isArray(dataList[j].datapoints[i])){\r\n            var value = dataList[j].datapoints[i][0];\r\n            if(statMax < value) {\r\n              statMax = value;\r\n            }\r\n            if(statMin > value) {\r\n              statMin = value;\r\n            }\r\n            totalNum += value;\r\n          } else {\r\n            dataTwo[j].value = '';\r\n          }\r\n          \r\n        }\r\n        switch(this.panel.statvalues) {\r\n          case 'avg':\r\n            dataTwo[j].value = parseFloat((totalNum/dataList[j].datapoints.length).toFixed(this.panel.dataPrecise));\r\n            break;\r\n          case 'min':\r\n            dataTwo[j].value = parseFloat(statMin.toFixed(this.panel.dataPrecise));\r\n            break;\r\n          case 'max':\r\n            dataTwo[j].value = parseFloat(statMax.toFixed(this.panel.dataPrecise));\r\n            break;\r\n          case 'total':\r\n            dataTwo[j].value = parseFloat(totalNum.toFixed(this.panel.dataPrecise));\r\n            break;\r\n          case 'count':\r\n            dataTwo[j].value = parseFloat(dataList[j].datapoints.length);\r\n            break;\r\n          default:\r\n            var lastPoint = _.last(dataList[j].datapoints);\r\n            var lastValue = _.isArray(lastPoint) ? lastPoint[0] : null;\r\n            var firstValue= _.isArray(lastPoint) ? lastPoint[1] : null;\r\n            if(lastValue == null) {\r\n              dataTwo[j].value = '';\r\n            } else {\r\n              dataTwo[j].value = parseFloat(lastValue.toFixed(this.panel.dataPrecise));\r\n            }\r\n        }\r\n      }   \r\n    }\r\n    this.dataTwo = this.objDeepCopy(dataTwo);\r\n    var data = [];\r\n    var dataShowSour = [];\r\n    let reg = eval(this.panel.theMainSource);\r\n    let regShow = eval(this.panel.theShowSource);\r\n    dataShowSour = this.regexMultistatus(regShow,dataTwo);\r\n    data = this.regexMultistatus(reg,dataTwo);\r\n    if (dataShowSour) {\r\n      if (data && data.length > 0) {\r\n        if ( data.length === dataShowSour.length ) {\r\n          data = dataShowSour;\r\n        } else if (data.length > dataShowSour.length) {\r\n          for (let m = dataShowSour.length; m < data.length; m++) {\r\n            data[m].value = '';\r\n            for (let n = 0; n < dataShowSour.length; n++) {\r\n              data[n] = dataShowSour[n];\r\n            }\r\n          }\r\n        } else if (data.length < dataShowSour.length) {\r\n          for (let n = 0; n < data.length; n++) {\r\n            data[n] = dataShowSour[n];\r\n          }\r\n        }\r\n      }\r\n    }\r\n    this.data = data;\r\n    this.panel.data = data;\r\n  }\r\n  objDeepCopy(source) {\r\n    var sourceCopy = source instanceof Array? [] : {};\r\n    for (var item in source) {\r\n      sourceCopy[item] = typeof source[item] === 'object'?this.objDeepCopy(source[item]) : source[item];\r\n    }\r\n    return sourceCopy;\r\n  }\r\n  optionPanel () {\r\n    if (this.data == undefined||this.data.length == 0)\r\n      return;\r\n    var multiStat = this.multiStatElem.find('.multi-stat');\r\n    var multistatPanel = this.multiStatElem.find('.multistat-panel');\r\n    var multiStatNamesSaris = this.multiStatElem.find('.pointNamesSaris');\r\n    var multiStatValuesSaris = this.multiStatElem.find('.pointValuesSaris');\r\n    var multiStatNamesSarisTwo = this.multiStatElem.find('.pointNamesSarisTwo');\r\n    var backgroundOrFontColor = 'background';\r\n    var pointNamesIndexBool = this.panel.pointNamesSaris.indexOf('{{index}}');\r\n    if (multiStat.length<1)\r\n            return;\r\n    for( var z = 0; z < multiStat.length; z++) {\r\n      if (this.panel.pointNamesSaris == '') {\r\n        multiStatNamesSaris[z].style.cssText = 'height:0px;';\r\n        multiStatValuesSaris[z].style.cssText = 'height:100%;font-size:'+(2.5*(parseFloat(this.panel.valueFontSize)/100))+'em;';\r\n        multiStatValuesSaris[z].style.lineHeight = (this.panel.valueEHeight - (this.panel.valueEHeight * 0.08)) + 'px';\r\n        multiStatNamesSaris[z].innerHTML = '';\r\n      } else if (pointNamesIndexBool >= 0 ) {\r\n        var pointNamesSarisReplaceName = this.panel.pointNamesSaris.replace(/{{index}}/g,function(){\r\n          var pointNamesSarisReplaceIndex = (z + 1) + '';\r\n          return pointNamesSarisReplaceIndex;\r\n        })\r\n        this.titlePositionStyle(z);\r\n        if ((this.panel.titlePositionNow === '左下') || (this.panel.titlePositionNow === '右下') ||(this.panel.titlePositionNow === '中下')) {\r\n          multiStatNamesSaris[z].innerHTML = '';\r\n          multiStatNamesSarisTwo[z].innerHTML = pointNamesSarisReplaceName;\r\n        } else {\r\n          multiStatNamesSarisTwo[z].innerHTML = '';\r\n          multiStatNamesSaris[z].innerHTML = pointNamesSarisReplaceName;\r\n        }\r\n      } else {\r\n        this.titlePositionStyle(z);\r\n        if ((this.panel.titlePositionNow === '左下') || (this.panel.titlePositionNow === '右下') ||(this.panel.titlePositionNow === '中下')) {\r\n          multiStatNamesSaris[z].innerHTML = '';\r\n          multiStatNamesSarisTwo[z].innerHTML = this.panel.pointNamesSaris;\r\n        } else {\r\n          multiStatNamesSarisTwo[z].innerHTML = '';\r\n          multiStatNamesSaris[z].innerHTML = this.panel.pointNamesSaris;\r\n        }\r\n      }\r\n      var theUnitShow = '';\r\n      if (this.panel.showUnitOne) {        \r\n        if ((this.panel.data[z].value >= 0) && (this.panel.data[z].value < 1000)) {\r\n          theUnitShow = this.panel.data[z].value;\r\n        } else if ((this.panel.data[z].value >= 1000) && (this.panel.data[z].value < 1000000)) {\r\n          theUnitShow = (this.panel.data[z].value/1000).toFixed(this.panel.dataUnitPrecise) + 'K';\r\n        } else if ((this.panel.data[z].value >= 1000000) && (this.panel.data[z].value < 1000000000)) {\r\n          theUnitShow = (this.panel.data[z].value/1000000).toFixed(this.panel.dataUnitPrecise) + 'Mil';\r\n        } else if ((this.panel.data[z].value >= 1000000000) && (this.panel.data[z].value < 1000000000000)) {\r\n          theUnitShow = (this.panel.data[z].value/1000000000).toFixed(this.panel.dataUnitPrecise) + 'Bil';\r\n        } else if (this.panel.data[z].value >= 1000000000000) {\r\n          theUnitShow = (this.panel.data[z].value/1000000000000).toFixed(this.panel.dataUnitPrecise) + 'Tri';\r\n        } else {\r\n          theUnitShow = this.panel.data[z].value;\r\n        }\r\n      } else {\r\n        theUnitShow = this.panel.data[z].value;\r\n      }\r\n      multiStatValuesSaris[z].innerHTML = theUnitShow;\r\n      this.data[z].color = 'red';\r\n      if (this.panel.mappingType === 1) {\r\n        for (let i = 0; i < this.panel.valueMaps.length; i++) {\r\n          let map = this.panel.valueMaps[i];   \r\n          var value = parseFloat(map.value);\r\n          if (value === this.panel.data[z].value) {\r\n            if(map.text == '') {\r\n              multiStatValuesSaris[z].innerHTML = theUnitShow;\r\n            } else {\r\n              multiStatValuesSaris[z].innerHTML = map.text;\r\n            }\r\n          }\r\n        }\r\n      } else if (this.panel.mappingType === 2) {\r\n        for(let i = 0; i < this.panel.rangeMaps.length; i++) {\r\n          let map = this.panel.rangeMaps[i];\r\n          var from = parseFloat(map.from);\r\n          var to = parseFloat(map.to);\r\n          if (to > this.panel.data[z].value && from <= this.panel.data[z].value) {\r\n            if(map.text == '') {\r\n              multiStatValuesSaris[z].innerHTML = theUnitShow;\r\n            } else {\r\n              multiStatValuesSaris[z].innerHTML = map.text;\r\n            }\r\n          }\r\n        }\r\n      } else if (this.panel.mappingType === 3) {\r\n        for (let i = 0; i < this.panel.valueMapsImg.length; i++) {\r\n          let map = this.panel.valueMapsImg[i];\r\n          var value = parseFloat(map.value);\r\n          if (map.value === 'null' || map.text == 'N/A') {\r\n\r\n          } else {\r\n            if (value === this.panel.data[z].value) {\r\n              if(map.text == '') {\r\n                multiStatValuesSaris[z].innerHTML = theUnitShow;\r\n              } else {\r\n                multiStat[z].innerHTML = \"<img src='/public/img/\"+map.text+\"' style='width:100%;height:100%;' />\";\r\n              }\r\n            }\r\n          }\r\n        }\r\n      } else if (this.panel.mappingType === 4) {\r\n        for (let i = 0; i < this.panel.rangeMapsImg.length; i++) {\r\n          let map = this.panel.rangeMapsImg[i];\r\n          var from = parseFloat(map.from);\r\n          var to = parseFloat(map.to);\r\n          if (map.value === 'null' || map.text == 'N/A') {\r\n\r\n          } else {\r\n            if (to > this.panel.data[z].value && from <= this.panel.data[z].value) {\r\n              if(map.text == '') {\r\n                multiStatValuesSaris[z].innerHTML = theUnitShow;\r\n              } else {\r\n                multiStat[z].innerHTML = \"<img src='/public/img/\"+map.text+\"' style='width:100%;height:100%;' />\";\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    for (let _i = 0; _i < this.panel.valueColors.length; _i++) {\r\n      let regColors = eval(this.panel.valueColors[_i].thecolorSource);\r\n      let datasColor = this.regexMultistatus(regColors,this.dataTwo);\r\n      if(datasColor && (datasColor.length > 0)) {\r\n        for (let _z = 0; _z < multiStat.length; _z++ ) {\r\n          if (this.panel.valueColors[_i].coloringType === 1) {\r\n            for (let j = 0; j < this.panel.valueColors[_i].theColorvalues.length; j++) {\r\n              let map = this.panel.valueColors[_i].theColorvalues[j];\r\n              var value = parseFloat(map.value);\r\n              if ((datasColor.length < multiStat.length) && (_z >= datasColor.length)) {\r\n                continue;\r\n              }\r\n              if (datasColor[_z].value === '') {\r\n                continue;\r\n              }\r\n              if (value === datasColor[_z].value) {\r\n                this.data[_z].color=map.color;\r\n              }\r\n            }\r\n          } else if (this.panel.valueColors[_i].coloringType === 2) {\r\n            for (let j = 0; j < this.panel.valueColors[_i].theRangeColor.length; j++) {\r\n              let map = this.panel.valueColors[_i].theRangeColor[j];\r\n              var from = parseFloat(map.from);\r\n              var to = parseFloat(map.to);\r\n              if ((datasColor.length < multiStat.length) && (_z >= datasColor.length)) {\r\n                continue;\r\n              }\r\n              if (datasColor[_z].value === '') {\r\n                continue;\r\n              }\r\n              if (to > datasColor[_z].value && from <= datasColor[_z].value) {\r\n                this.data[_z].color=map.color;\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n  initShowPanel (bOaColor,last) {\r\n    var multistatPanel = this.multiStatElem.find('.multistat-panel');\r\n    //每行显示个数计算和字体大小\r\n    if(last) {\r\n      this.optionPanel();\r\n    }\r\n    var multistatPanelWidth=((multistatPanel[0].offsetWidth-12)/this.panel.valueNum)-this.panel.marginLandR*2;\r\n    // var currFontSize = (multistatPanelWidth/16)*(parseFloat(this.panel.valueFontSize)/100);\r\n    this.panel.multiStyle={\r\n            'width':multistatPanelWidth+\"px\",\r\n            'height':this.panel.valueEHeight+\"px\", \r\n            'fontSize':multistatPanelWidth/16 +\"px\",                \r\n            'margin':this.panel.marginLandR+\"px\",      \r\n            'text-align':'center',\r\n            'float':'left',\r\n            'cursor':'pointer',\r\n            'position':'relative',\r\n            'background-color':bOaColor\r\n    }\r\n    this.panel.BackgroundEColor= bOaColor;\r\n\r\n    return this.panel.multiStyle;\r\n  }\r\n  titlePositionStyle(z) {\r\n    var multiStat = this.multiStatElem.find('.multi-stat');\r\n    var multiStatNamesSaris = this.multiStatElem.find('.pointNamesSaris');\r\n    var multiStatValuesSaris = this.multiStatElem.find('.pointValuesSaris');\r\n    var multiStatNamesSarisTwo = this.multiStatElem.find('.pointNamesSarisTwo');\r\n    var height = multiStat[z].style.height;\r\n    multiStatNamesSaris[z].style.cssText = 'height:0px;';\r\n    multiStatValuesSaris[z].style.cssText = 'height:100%;font-size:'+(2.5*(parseFloat(this.panel.valueFontSize)/100))+'em;line-height:'+height+';';\r\n    multiStatNamesSarisTwo[z].style.cssText = 'height:0px;';\r\n      switch (this.panel.titlePositionNow) {\r\n        case '左上':\r\n          multiStatNamesSaris[z].style.cssText = 'font-size:'+(1.3*(parseFloat(this.panel.titleFontSize)/100))+'em; position:absolute; left:3px; top:3px; width:fit-content;';\r\n          break;\r\n        case '中上':\r\n          multiStatNamesSaris[z].style.cssText = 'font-size:'+(1.3*(parseFloat(this.panel.titleFontSize)/100))+'em;position:absolute; left:50%; top:3px;width:auto;';\r\n          var width = multiStatNamesSaris[z].offsetWidth;\r\n          multiStatNamesSaris[z].style.cssText = 'font-size:'+(1.3*(parseFloat(this.panel.titleFontSize)/100))+'em;position:absolute; left:50%; top:3px;width:auto;margin-left:'+(-width/2)+'px;';\r\n          break;\r\n        case '右上':\r\n          multiStatNamesSaris[z].style.cssText = 'font-size:'+(1.3*(parseFloat(this.panel.titleFontSize)/100))+'em; position:absolute; right:3px; top:3px;width:fit-content;';\r\n          break;\r\n        case '左下':\r\n          multiStatNamesSarisTwo[z].style.cssText = 'font-size:'+(1.3*(parseFloat(this.panel.titleFontSize)/100))+'em; position:absolute; left:3px; bottom:3px;width:fit-content;';\r\n          break;\r\n        case '中下':\r\n          multiStatNamesSarisTwo[z].style.cssText = 'font-size:'+(1.3*(parseFloat(this.panel.titleFontSize)/100))+'em;position:absolute; left:50%; bottom:3px;width:auto;';\r\n          var width = multiStatNamesSarisTwo[z].offsetWidth;\r\n          multiStatNamesSarisTwo[z].style.cssText = 'font-size:'+(1.3*(parseFloat(this.panel.titleFontSize)/100))+'em;position:absolute; left:50%; bottom:3px;width:auto;margin-left:'+(-width/2)+'px;';\r\n          break;\r\n        default:\r\n          multiStatNamesSarisTwo[z].style.cssText = 'font-size:'+(1.3*(parseFloat(this.panel.titleFontSize)/100))+'em; position:absolute; right:3px; bottom:3px;width:fit-content;';\r\n          break;    \r\n      }\r\n  }\r\n  url(index){\r\n    if (this.panel.link.type && (this.panel.link.type === 'dashboard')) {\r\n      if (this.panel.link.dashUri === undefined || this.panel.link.dashUri === '') {\r\n        this.panel.link.url = '';\r\n        return;\r\n      }\r\n    } else if (this.panel.link.type && (this.panel.link.type === 'absolute')) {\r\n      if (this.panel.link.url === undefined || this.panel.link.url === '') {\r\n        this.panel.link.dashUri = '';\r\n        return;\r\n      }\r\n    }\r\n    \r\n    var urlDatas;\r\n    if (this.panel.theUrlSource) {\r\n      let regx = eval(this.panel.theUrlSource);\r\n      urlDatas = this.regexMultistatus(regx,this.dataTwo);\r\n    } else {\r\n      urlDatas = this.panel.data;\r\n    }\r\n    var str;\r\n    var reg = eval(this.panel.theUrlRegex);\r\n    var arr;\r\n    if ((reg === undefined) || (urlDatas.length === 0) || !urlDatas[0].target) {\r\n      arr = [];\r\n    } else {\r\n      str = urlDatas[index].target;\r\n      arr = reg.exec(str);\r\n    }\r\n    var inputParams = this.panel.link.paramsOne;\r\n    var exceParams = [];\r\n    let paramsReplace;\r\n    exceParams[0] = inputParams;\r\n    if((inputParams === '') || (arr === null) || (arr.length === 0)) {\r\n    } else {\r\n      for (var n = 0;n < arr.length; n++) {\r\n        var ind = n + 1;\r\n        var text = '$' + ind;\r\n        if (arr[ind] === undefined) {\r\n        } else {\r\n          paramsReplace = arr[ind].toUpperCase();\r\n        }        \r\n        exceParams[n+1] = exceParams[n].replace(text, paramsReplace);\r\n      }\r\n      this.panel.link.params = exceParams[n];\r\n    }\r\n    var theTemplates = this.templateSrv.variables;\r\n    var linkInfo = this.linkSrv.getPanelLinkAnchorInfo(this.panel.link, theTemplates);\r\n    // window.open(linkInfo.href, linkInfo.target); \r\n    var paramsNum = linkInfo.href.indexOf('?');\r\n    var paramsNew = '';\r\n    var dataRefId = this.panel.data[index].refId;\r\n    var theNewIndex;\r\n    var theTemplatesSectences = '';\r\n    if (paramsNum !== -1) {\r\n      if (linkInfo.href.length - paramsNum > 1) {\r\n        paramsNew = '&';\r\n      }\r\n    } else {\r\n      paramsNew = '?';\r\n    }\r\n    if (index < 10) {\r\n      theNewIndex = '0' + index;\r\n    } else {\r\n      theNewIndex = index;\r\n    }\r\n    // if (dataRefId === undefined) {\r\n      // for (var n=0; n<theTemplates.length; n++) {\r\n      //   var jznumber = theTemplates[n].current.value;\r\n      //   var jzName = theTemplates[n].name;\r\n      //   theTemplatesSectences += '&var-' + jzName + '=' + jznumber;\r\n      // }\r\n      window.open( linkInfo.href + paramsNew + 'var-index=' +  theNewIndex, linkInfo.target); \r\n    // } else {\r\n    //   var dataRefIdArr = dataRefId.split('_');\r\n    //   if ( dataRefIdArr === undefined) {\r\n    //     window.open( linkInfo.href + paramsNew +'var-index=' +  theNewIndex, linkInfo.target);\r\n    //   } else if ( dataRefIdArr.length === 1) {\r\n    //     window.open( linkInfo.href, linkInfo.target);\r\n    //   } else {\r\n    //     window.open( linkInfo.href + paramsNew +'var-jz=' +  dataRefIdArr[1] + '&var-dc=' + dataRefIdArr[0], linkInfo.target);\r\n    //   }\r\n    // }\r\n  }\r\n  //正则匹配\r\n  regexMultistatus(reg, Alldata) {\r\n    if (reg === undefined) {\r\n      return Alldata;\r\n    }\r\n    var regexMulti = reg;\r\n    var dataOne = [];\r\n    if (reg && (Alldata.length > 0) && Alldata[0].target) {\r\n      for (let i = 0; i < Alldata.length; i++) {\r\n        let str = Alldata[i].target;\r\n        let val = str.match(reg);\r\n        if (val) {\r\n          dataOne.push(Alldata[i]);\r\n        }\r\n      }\r\n    }\r\n    return dataOne;\r\n  }\r\n  removeValueMap(map) {\r\n    var index = _.indexOf(this.panel.valueMaps, map);\r\n    this.panel.valueMaps.splice(index, 1);\r\n    this.render();\r\n  }\r\n  addValueMap() {\r\n    this.panel.valueMaps.push({value: '', op: '=', text: ''});\r\n  }\r\n\r\n  removeRangeMap(rangeMap) {\r\n    var index = _.indexOf(this.panel.rangeMaps, rangeMap);\r\n    this.panel.rangeMaps.splice(index, 1);\r\n    this.render();\r\n  }\r\n  addRangeMap() {\r\n    this.panel.rangeMaps.push({from: '', to: '', text: ''});\r\n  }\r\n\r\n  removeValueMapImg(mapImg) {\r\n    var index = _.indexOf(this.panel.valueMapsImg, mapImg);\r\n    this.panel.valueMapsImg.splice(index, 1);\r\n    this.render();\r\n  }\r\n  addValueMapImg() {\r\n    this.panel.valueMapsImg.push({value: '', op: '=', text: ''});\r\n  }\r\n\r\n  removeRangeMapImg(rangeMapImg) {\r\n    var index = _.indexOf(this.panel.rangeMapsImg, rangeMapImg);\r\n    this.panel.rangeMapsImg.splice(index, 1);\r\n    this.render();\r\n  }\r\n  addRangeMapImg() {\r\n    this.panel.rangeMapsImg.push({from: '', to: '', text: ''});\r\n  }\r\n  // 颜色\r\n  removeColorValue(valueColor,index) {\r\n    var indexOne = _.indexOf(this.panel.valueColors[index].theColorvalues, valueColor);\r\n    this.panel.valueColors[index].theColorvalues.splice(indexOne, 1);\r\n    this.render();\r\n  }\r\n  addColorValue(index) {\r\n    this.panel.valueColors[index].theColorvalues.push({value: '', op: '=',color:'red' });\r\n  }\r\n  removeColorRang(rangColor,index) {\r\n    var indexOne = _.indexOf(this.panel.valueColors[index].theRangeColor, rangColor);\r\n    this.panel.valueColors[index].theRangeColor.splice(indexOne, 1);\r\n    this.render();\r\n  }\r\n  addColorRang(index) {\r\n    this.panel.valueColors[index].theRangeColor.push({value: '', op: '=',color:'red' });\r\n  }\r\n  addTheValueColors() {\r\n    this.panel.valueColors.push({ \r\n        thecolorSource:'',\r\n        coloringType:1,\r\n        theColorvalues:[\r\n          { value: 'null', op: '=', color: 'red' }\r\n        ],\r\n        theRangeColor:[\r\n          { from: 'null', to: 'null', color: 'red' }\r\n        ]\r\n      });\r\n  }\r\n  removeTheValueColors(item) {\r\n    var index = _.indexOf(this.panel.valueColors, item);\r\n    this.panel.valueColors.splice(index, 1);\r\n    this.render();\r\n  }\r\n  //数据源列表\r\n  removeHasSourceList(index) {\r\n    this.panel.dataSources.splice(index, 1);\r\n    this.render();\r\n  }\r\n  addHasSourceList() {\r\n    this.panel.dataSources.push({regexOne:'', alisa:''});\r\n  }\r\n  searchDashboards(queryStr, callback) {\r\n    that.backendSrv.search({query: queryStr}).then(function(hits) {\r\n      var dashboards = _.map(hits, function(dash) {\r\n        return dash.title;\r\n      });\r\n      callback(dashboards);\r\n    });\r\n  };\r\n  dashboardChanged(link) {\r\n    that.backendSrv.search({query: that.panel.link.dashboard}).then(function(hits) {\r\n      var dashboard = _.find(hits, {title: that.panel.link.dashboard});\r\n      if (dashboard) {\r\n        that.panel.link.dashUri = dashboard.uri;\r\n        that.panel.link.title = dashboard.title;\r\n      }\r\n    });\r\n  };\r\n  link(scope, elem, attrs, ctrl) {\r\n    ctrl.multiStatElem = elem;\r\n  }\r\n}\r\n\r\nMultistatusCtrl.templateUrl = 'module.html';\r\n"]}